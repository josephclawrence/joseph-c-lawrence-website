var AvantiSRSInterop={version:"8.0.0.0",BindSRSMenu:function(){try{console.log("00 - BindSRSMenu");sysproInterop.callBusinessObject("query","COMGET-SRS","<Query><Key><FileType>MF</FileType></Key></Query>","",function(e){console.log(e);try{for(i=0;i<e.ReportMenu.Report.length;i++){if(e.ReportMenu.Report[i].Report=AvantiSRSInterop.ConvertoArray(e.ReportMenu.Report[i].Report),e.ReportMenu.Report[i].Report.hasOwnProperty("length")&&e.ReportMenu.Report[i].Report.length)for(j=0;j<e.ReportMenu.Report[i].Report.length;j++)e.ReportMenu.Report[i].Report[j].Report=AvantiSRSInterop.ConvertoArray(e.ReportMenu.Report[i].Report[j].Report);e.ReportMenu.Report[i].Report.length||(e.ReportMenu.Report[i].Report=AvantiSRSInterop.ConvertoArray(Report))}}catch(e){}var r=new kendo.data.HierarchicalDataSource({data:e.ReportMenu.Report,schema:{model:{children:"Report"}}});console.log("DataSource: "+r),$("#treeview-right").kendoTreeView({dataSpriteCssClassField:"sprite",dataSource:r,select:function(e){this.dataItem(e.node).Type&&(console.log("Report Id - "+this.dataItem(e.node).Id),sysproInterop.callPlugin("SRSMain","srstreeviewevent",this.dataItem(e.node).Id+"|"+this.dataItem(e.node).Description))},dataTextField:["Description","Description"]})},function(e){console.log("error:"+e.message)},!0,!1),console.log("99 - BindSRSMenu")}catch(e){sysproInterop.handleError(e.message,"BindSRSMenu")}},ConvertoArray:function(e){return Array.isArray(e)?e:new Array(e)},BinSRSArchive:function(){try{sysproInterop.callBusinessObject("query","COMQAR","<Query><Key><FileType>BA</FileType></Key></Query>","",function(e){console.log("COMQAR XML OUT"),console.log(e);var r=new kendo.data.HierarchicalDataSource({data:e.Query.ReportArchive.Company,schema:{model:{children:["Company","Year","Month","Operator"]}}});$("#treeview-report-archive").kendoTreeView({dataSource:r})})}catch(e){console.log(e.message),sysproInterop.handleError(e.message,"BinSRSArchive")}},Bind_Report_Queue:function(){try{sysproInterop.callPlugin("SRSMain","refreshreportqueue","")}catch(e){console.log("Bind_Report_Queue: "+e.message),sysproInterop.handleError(e.message,"Bind_Report_Queue")}},GetVersion:function(){return AvantiSRSInterop.version}};