<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <title>SYSPRO Product Visual Builder</title>

        <!-- Bootstrap -->
        <link href="css/new/UX_CSS_bootstrap.css" rel="stylesheet" />
        <link href="css/new/UX_CSS_bootstrap-main.css" rel="stylesheet" />


				<link href="css/postcss.css" rel="stylesheet" />
        <link href="css/UX_CSS_sysprofusionstyle.css" rel="stylesheet" />

				<link rel="stylesheet" href="css/gridstack.min.css">
				<link rel="stylesheet" href="css/gridstack-extra.css">
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css">
            <!-- <link rel=”stylesheet” href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/atom-one-dark.min.css"> -->

        <script>
            window.MSPointerEvent = null;
            window.PointerEvent = null;
        </script>
        <script type="text/javascript">
            WebFontConfig = {
                google: {
                    families: [
                        "Source+Sans+Pro:400,200,300,600,700,900,200italic,300italic,400italic,600italic,700italic,900italic:latin",
                    ],
                },
            };
            (function() {
                var wf = document.createElement("script");
                wf.src = "https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js";
                wf.type = "text/javascript";
                wf.async = "true";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(wf, s);
            })();
        </script>
        <script src="js/new/UX_JS_jquery.min.js"></script>
        <!-- <script src="js/UX_JS_velocity.min.js"></script> -->
        <script src="js/new/UX_JS_kendo.all.min.js"></script>
        <style>
         :root {
         --gradient-shadow: linear-gradient(
            45deg,
            #7B1FA2,
            #b90d7e,
            #ffffff

         );
         }
         

         @keyframes animate {
            0% {
               background-position: 0 0;
            }
            50% {
               background-position: 300% 0;
            }
            100% {
               background-position: 0 0;
            }
         }
         @keyframes border-pulsate {
            0%   { border-color: #b9086f; }
            50%  { border-color: #7B1FA2; }
            100% { border-color: #b9086f; }
         }
         @keyframes pulse-purple {
            0% {
               transform: scale(1);
               box-shadow: 0 0 0 0 rgba(123, 31, 162, 0.7);
            }
            
            70% {
               transform: scale(1);
               box-shadow: 0 0 0 8px rgba(123, 31, 162, 0);
            }
            
            100% {
               transform: scale(1);
               box-shadow: 0 0 0 0 rgba(123, 31, 162, 0);
            }
         }
         #davinciButton {
            border: 3px solid rgba(255, 255, 255, 0.3);
            outline: none;
            background-color: #8e8e8e;
            &.alive {
               background-color: #7B1FA2;
               background-image: linear-gradient(to right top, #7b1fa2, #8f1699, #a00e90, #ae0987, #b90d7e);
            }            
            z-index: 99;
            &.pulse {
               /* animation: border-pulsate 3s infinite; */
               animation: pulse-purple 2.4s infinite;
            }
            & .k-fab-text {
               display: none;
            }
            /* &:before,
            &:after {
               content: "";
               position: absolute;
               top: -2px;
               left: -2px;
               background: var(--gradient-shadow);
               background-size: 400%;
               width: calc(100% + 4px);
               height: calc(100% + 4px);
               z-index: -1;
               animation: animate 20s linear infinite;
            }
            &:after  {
               filter: blur(20px);
            } */
         }
         .k-author {
            display: none;
         }
         .k-typing-indicator-bubble .k-author {
            display: block;
         }
         .k-chat {
            border-color: transparent;
            color: #212529;
            background-color: transparent;
            max-width: none;
            border-top: none;
            & .k-message-box {
               border-top: 1px solid #eee !important;
               padding: 15px 15px 15px;
               justify-content: flex-end;
               & input {
                  background: #eee;
                  border-radius: 20px;
                  height: 40px;
                  margin-right: 5px;
                  max-width: 750px;
               }
               & .k-button {
                  height: 40px;
                  padding: 0px;
                  width: 40px;
                  border-radius: 50%;
                  background-image: linear-gradient(to right top, #7b1fa2, #8f1699, #a00e90, #ae0987, #b90d7e) !important;
               }
            }
            & .k-avatar:not([alt="sysproUser"]) {
               background: #7B1FA2;
               border-radius: 50%;
               padding: 9px;
               background-image: linear-gradient(to right top, #7b1fa2, #8f1699, #a00e90, #ae0987, #b90d7e) !important;
            }
            & .k-card {
               border-color: var(--color_athens_gray_approx) !important;
               & .k-card-header {
                  background-color: var(--color_athens_gray_approx);
                  border-color: var(--color_athens_gray_approx);
               }
               & .k-card-actions {
                  & .k-button {
                     border-radius: 4px;
                     &.k-button-sm {
                        background: transparent !important;
                        color: var(--color_lochmara_approx) !important;
                        font-size: 11px;
                     }
                     &.sys-bg-very-light-gray {
                        background-color: #ecf0f1 !important;
                        color: #2c3e50 !important;
                     }
                  }
               }
            }
            & .k-card-list {
               margin: 2px 0 15px;
               width: 100%;
            }
            & .k-message-group {
               margin-bottom: 15px;
            }
            & .k-quick-replies {
               align-self: flex-end;
            }
            & .k-typing-indicator-bubble {
               & .k-bubble {
                  background-color: transparent;
                  border: none;
                  white-space: normal;
                  & .k-typing-indicator span {
                     background-color: #7b1fa2;
                  }
               }
            }
         }
         #daVinciWindow.k-window-content {
            padding-block: 0;
            padding-inline: 0;
         }
         .k-window[aria-labelledby="daVinciWindow_wnd_title"] {
            position: fixed !important;
            border-radius: 8px;
            & .k-window-titlebar {
               background-color: #7B1FA2 !important;
               background-image: linear-gradient(to right top, #7b1fa2, #8f1699, #a00e90, #ae0987, #b90d7e);
               padding-left: 0.8rem;
               border-top-left-radius: 8px;
               border-top-right-radius: 8px;
               & .k-window-titlebar-action {
                  color: white !important;
               }
            }
         }
         .davinciicon-light {
            color: rgb(162, 0, 162);
            opacity: 0.33;
            transition: opacity 0.25s;
            &:hover {
               opacity: 0.6;
            }
         }
         .davinciicon-dark {
            color: #7B1FA2;
         }
         .daVinciPopover {
            border: none;
            padding: 0px;
            & .popover-header {
               margin-top: 0px;
               background-color: #7B1FA2;
               background-image: linear-gradient(to right top, #7b1fa2, #8f1699, #a00e90, #ae0987, #b90d7e);
               padding: 0.2rem 0.5rem;
               color: #fff;
            }
            & .popover-body {
               padding: 0.5rem;
            }
            & .popover-footer {
               display: flex;
               justify-content: space-around;
               border-bottom-left-radius: 6px;
               border-bottom-right-radius: 6px;
               padding: 0.3rem 0.5rem;
               & a {
                  display: flex;
                  align-items: center;
                  &:hover {
                     text-decoration: none;
                  }
               }
            }
         }
         .daVinciPopoverTrigger, .daVinciDataPopoverTrigger, .daVinciAutoPopoverTrigger {
            cursor: pointer;
         }
         .fileUploadDropZone {
            /* border: none; */
            & .k-upload-button-wrap {
               width: 100%;
            }
         }

         .showmodelcard, .conflevel {
            cursor: pointer;
         }

         .models-table.table > tbody > tr > td {
            vertical-align: middle;
         }
         .davincifield {
            background-color: #e4b3e2 !important;
         }
         span.clickable {
            color: blue;
            text-decoration: underline;
            font-weight:bold;
            cursor: pointer
         }
         .k-chat .k-message-group, .k-chat .k-message-group.k-alt {
            align-items: center;
         }
         .k-message-group[me] {
            /* background: red; */
            flex-direction: row !important;
            & .chat-user-msg-actions {
               visibility: hidden;
               content: "";
               width: 30px;
               height: 30px;
               
            }
            &:hover .chat-user-msg-actions {
               visibility: visible;
            }
         }

         .k-chat .k-message-group.k-alt {
            text-align: start;
         }

         :not(#context-menu-list) #faves-menu.k-menu-vertical > .k-menu-item > .k-menu-link {
            padding-top: 0.35rem;
            padding-bottom: 0.35rem;
            border-bottom: 1px solid #f0f0f0;
         }
         .k-wizard .k-input-solid.k-focus {
            border: 1px solid #0d6efd;
         }
        </style>
    </head>

<body data-theme="" data-column-layout="" class="light-gradient-background body-view-mode">
  <nav id="fusion-toolbar" class="navbar navbar-default fixed-top navbar-controlbar fusion-top-toolbar toolbar-loaded">
    <div class="container-fluid">
        <ul class="nav navbar-nav navbar-left">
            <li class="nav-item">
                <a href="#" class="text-primary offcanvas-toggle fusion-main-page-buttons fusion-maininstance-buttons nav-link js-offcanvas-has-events" data-toggle="offcanvas" data-target="#fusion-sidebar-wrapper2" onclick="sysproInterop.bindProgramList($('#fusion-sidebar-wrapper2'));" style=""><i class="material-icons">menu</i></a>
            </li>
            <li>
                <a class="navbar-brand" href="#" onclick="sysproInterop.backToMenu();">
                    <img alt="Brand" src="img/UX_IMG_SYSPROLogo.png" style="height: 35px">
                </a>
            </li>
            <li class="nav-item back-to-menu">
                <a href="#" onclick="sysproInterop.backToMenu();" class="text-primary fusion-main-page-buttons fusion-maininstance-buttons nav-link" style=""><span class="hidden-xs">Home</span><i class="material-icons visible-xs">home</i></a>
            </li>
            <li class="nav-item breadcrumb-separator fusion-main-page-buttons" style="">
                <i class="material-icons">chevron_right</i>
            </li>
            <li class="nav-item sys-pd-l-10 application-sub-title fusion-main-page-buttons" style="">HOME MENU</li>
        </ul>
        <ul class="nav navbar-nav navbar-right sys-fg-primary">
            <li class=" nav-item">
                <a href="#" class="text-primary fusion-main-page-buttons nav-link fusion-current-account offcanvas-toggle js-offcanvas-has-events" onclick="sysproInterop.bindAvantiNotifications($('#fusion-sidebar-wrapper2'));" style="" data-toggle="offcanvas" data-target="#offcanvas-avanti-notifications">
                    <i class="material-icons">notifications</i>
                    <span class="badge sys-bg-danger avanti-notifications-count" style="display: none;"></span>
                </a>
            </li>

            <li class="dropdown nav-item">
                <a href="#" class="text-primary fusion-main-page-buttons nav-link fusion-current-account" data-toggle="dropdown" style=""><i class="material-icons">account_circle</i>
                    <span class="hidden-xs fusion-current-account-name">SYSPRO Administrator</span></a>
                <ul class="dropdown-menu multi-level nav sys-pd-t-5" role="menu">
                    <li>
                        <a href="#" class="syspro-toolbar-widget" onclick="sysproInterop.callPlugin('SRSMain', 'SRSQUE');"><i class="material-icons">list</i>Report Queue</a>
                    </li>
                    <li>
                        <a href="#" class="syspro-toolbar-widget" onclick="sysproInterop.showHelp();"><i class="material-icons">help</i>Help</a>
                    </li>
                    <li class="dropdown-submenu">
                        <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" href="#"><i class="material-icons">palette</i>Themes</a>
                        <ul class="dropdown-menu sys-pd-t-5">
                            <li>
                                <a href="#" class="avant-theme-switch" data-themename="light" onclick="sysproInterop.setTheme(this);"><i class="material-icons sys-mg-r-5 sys-fg-white">check</i>Light</a>
                            </li>
                            <li>
                                <a href="#" class="avant-theme-switch" data-themename="dark" onclick="sysproInterop.setTheme(this);"><i class="material-icons sys-mg-r-5 sys-fg-white">check</i>Dark</a>
                            </li>
                            <li>
                                <a href="#" class="avant-theme-switch" data-themename="syspro-light" onclick="sysproInterop.setTheme(this);"><i class="material-icons sys-mg-r-5 sys-fg-success">check</i>Pastel</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#" class="syspro-toolbar-widget" onclick="sysproInterop.closeSYSPROFusion(true);"><i class="material-icons">power_settings_new</i> Sign out</a>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
  </nav>


  <span id="errorNotification" style="display:none;"></span>
  <span id="taskdialognotification" style="display:none;"></span>
  <span id="aiSuggestionNotification" style="display:none;"></span>
  <div id="dialog"></div>
  <div id="invisibleNodes"></div>

  <div id="fusion-wrapper">
    <div id="harness-container">
      <div id="wrapper" class="toggled">
        <nav nav="" id="navbar-toolbar" class="navbar navbar-default navbar-static-top navbar-controlbar sys-mg-off-b syspro-toolbar ">
          <div class="container-fluid">

          </div>
        </nav>
        <div class="container-fluid container-id-holder" id="main-container" style="padding-top: 40px;">
           
          <!-- Error Notification empty element -->
          <span id="errorNotification" style="display:none;"></span>
          <div class="row sys-mg-t-15">    
            <div class="col-sm-8 col-12 column-parent">
              <div class="panel sys-bd-off sys-box-shadow-off">
                  <div class="row widget layout-widget grid-stack-item-content ps" >
                     <div class="col-sm-12 ">
                        <div class="panel card sys-widget sys-box-shadow-off " >               
                           <div class="panel-body card-body sys-pd-15">
                              <h2 class="sys-300">Michaelson Cycles usually pays on time, but their most recent invoice is 25 days overdue. Sales to this customer are up 24% year on year. 
                                 <i 
                                    class="material-icons davinciicon-light daVinciPopoverTrigger"
                                    data-bs-toggle="popover" 
                                    data-bs-custom-class="daVinciPopover"
                                    data-content-id="summary"
                                    data-bs-content="This summary was written by DaVinci."
                                 >auto_awesome</i>
                              </h2>
                              <div id="chart"></div>
                           </div>
                        </div>
                     </div>
                  </div>
              </div>

              <div class="panel sys-bd-off sys-box-shadow-off">
               <div class="row widget layout-widget grid-stack-item-content" >
           
               <div class="col-sm-12">
           
                   <div class="panel card sys-widget sys-box-shadow-off    ">                      
           
                       <div class="panel-body card-body sys-pd-10">
                           <form class="form-horizontal" max-width="539px" style="position: relative;">
                                            
                               <div class="row" data-row="0">
                                   <div class="col-xs-12 col-6 data-section" data-section="0">
           
                                       <div class="form-group row is-empty sys-mg-b-10" data-guid="6d63aa1b-0f74-4513-dcbf-52c580965d39"
                                           data-bind="hidden: Fields.IMP040L3CustomerPurchaseOrder.Hidden">
           
           
           
                                           <label for="  Customer purchase order"
                                               class="col-md-5 control-label col-form-label sys-mg-t-5 sys-pd-t-5">
                                               <span
                                                   data-bind="htmltextnonull: Fields.IMP040L3CustomerPurchaseOrder.Caption">Customer
                                                   purchase order</span>
                                               <span class="text-warning mandatory-indication">*</span>
                                           </label>
                                           <div class="col-md-6 col-xs-11 col-11 syspro-entry-content">
                                               <input type="text"
                                               value="AI generated value"
                                                   class="form-control syspro-trackfield-input syspro-trackfield-keydown syspro-trackfield-change syspro-focusable syspro-supports-mask davincifield"
                                                   id="Fields.IMP040L3CustomerPurchaseOrder">
           
           
           
                                           </div>
           
           
                                       </div>
                      
                                       <div class="form-group row is-empty" data-guid="3c8bfbc4-6f28-4733-b2fc-2b3a8ff2ef38"
                                           data-bind="hidden: Fields.IMP040L3OrderDate.Hidden">
           
           
           
                                           <label for="  Order date"
                                               class="col-md-5 control-label col-form-label sys-mg-t-5 sys-pd-t-5">
                                               <span data-bind="htmltextnonull: Fields.IMP040L3OrderDate.Caption">Order date</span>
                                           </label>
                                           <div class="col-md-6 col-xs-11 col-11 syspro-entry-content">
                                               <div class="input-group date">
                                                   <input type="text"
                                                       class="form-control date-input syspro-focusable syspro-trackfield-change"
                                                       placeholder="Enter date" id="Fields.IMP040L3OrderDate">
                                                   <span class="input-group-addon input-group-prepend input-group-append">
                                                       <i class="material-icons text-primary">date_range</i>
                                                   </span>
                                               </div>
           
           
                                           </div>
           
                                       </div>
                                                             
                                   </div>
                                   <div class="col-xs-12 col-6 data-section" data-section="0">
                                    <div class="form-group row is-empty" data-guid="3deea910-592f-4a58-eaa6-c3d9b82c2302"
                                    data-bind="hidden: Fields.IMP040L3ShipDate.Hidden">                      
    
                                       <label for="  Ship date"
                                          class="col-md-5 control-label col-form-label sys-mg-t-5 sys-pd-t-5">
                                          <span data-bind="htmltextnonull: Fields.IMP040L3ShipDate.Caption">Ship date</span>
                                       </label>
                                       <div class="col-md-6 col-xs-11 col-11 syspro-entry-content">
                                          <div class="input-group date">
                                             <input type="text"
                                                   class="form-control date-input syspro-focusable syspro-trackfield-change davincifield"
                                                   placeholder="Enter date" id="Fields.IMP040L3ShipDate" value="10/10/2023">
                                                   
                                             <span class="input-group-addon input-group-prepend input-group-append">
                                                   <i class="material-icons text-primary">date_range</i>
                                             </span>
                                          </div>
      
      
                                       </div>
        
                                </div>

                                   </div>
                               </div>
           
                           </form>
                      
                       </div>
                   </div>
               </div>
           
           </div>
           <div class="row widget layout-widget grid-stack-item-content" >           
               <div class="col-sm-12">
                  <div class="panel card sys-widget sys-box-shadow-off    ">                              
                     <div class="panel-body card-body sys-pd-10">
                        <div id="confGrid"></div>
                     </div>
                  </div>
               </div>

              </div>
              </div>
            </div>
            <div class="col-sm-4 col-12 column-parent">
              <div class="panel sys-bd-off sys-box-shadow-off">
                <div class="panel-body main-column">
                  <div class="row widget layout-widget grid-stack-item-content ps" data-guid="a67c49bb-8305-4026-9613-3c76c74e2859" data-subtype="" data-border="Internal" data-displaystyle="Tiles" data-collapsible="False" style="" >
                     <div class="col-sm-12 tile-widget-wrapper">

                              <div class="panel card sys-widget sys-box-shadow-off    tiles-parent" data-role="droptarget" style="margin-bottom: 0px;">               
                                 <div class="panel-body card-body sys-pd-off">

                     <div class="row sys-tbl" data-row="0">
                        <div class="col-xs-12 col-12  sys-bg-white">
                              <div class="row tile-widget" style="position: relative; width: 426px; height: 299px;">
                                 <div class="tile tile-width-marker col-sm-4 col-xs-6 col-6"></div>


                     <div class="col-sm-4 col-xs-6 col-6 tile " data-tiletype="Text" data-tiletypename="ARS014_Ave_Days_to_Pay_By_Customer" data-tiletypedetail="TILE_a340c557b8244efba9cf8e1db4ce25da" data-parentfieldpath="Customer" data-tileparameters="{&quot;Customer&quot;:&quot;&quot;}" data-tiledetailavailable="Y" style="position: absolute; left: 0px; top: 5px;" data-boundonce="true">
                        
                              <div class="tile-loading-cover" style="display: none;"><span class="spinner"></span></div>
                        <div>
                              <div class="tile-inner sys-fg-white sys-bg-lighter-blue">
                                 <div class="panel-body text-left sys-wrapper sys-pd-off sys-mg-off">
                     <div class="big-tile row" data-bind="tilecolor: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.Title">Avg. Days to Pay</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.SubTitle">Customer:</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger" data-bind="visible: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ErrorMessage, text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ErrorMessage" style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ErrorMessageLong"></span>
                              </div>
                              <div class="tile-bottom-half flex-center">
                                 <div class="mainIconWrapper text-center">
                                    <i class="material-icons text-left tile-icon text-white sys-fg-white main-tile-icon" data-bind="tileicon: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.Icon, tileiconcolor: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.IconColor"></i>
                                 </div>
                                 <span class="tile-value-label text-right" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.Footer"></span>
                                 <div class="valueWrapper text-right metric-only">
                                    <span class="tile-main-value" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.Value, tileiconcolor: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ValueColor" style="white-space: nowrap; display: inline-block;">0</span>
                                 </div>                
                              </div>
                        </div>
                     </div>

                     <div class="wide-tile row" data-bind="tilecolor: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.Title">Avg. Days to Pay</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.SubTitle">Customer:</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger" data-bind="visible: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ErrorMessage, text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ErrorMessage" style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ErrorMessageLong"></span>
                              </div>
                              <div class="tile-bottom-half">
                                 <i class="material-icons tile-icon text-left main-tile-icon sys-fg-primary" data-bind="tileicon: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.Icon, tileiconcolor: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.IconColor"></i>
                                 <div class="valueWrapper text-right">
                                    <span class="text-right tile-value-label" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.Footer"></span>
                                    <span class="tile-main-value" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.Value, tileiconcolor: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ValueColor" style="white-space: nowrap; display: inline-block;">0</span>
                                 </div>
                              </div>
                        </div>
                     </div>
                     <div class="small-tile row" data-bind="tilecolor: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <div class="ai-tile-icon-title">
                                    <span class="text-left tile-title">Avg. Days to Pay</span>
                                    <i class="material-icons pull-right text-right sys-txt-sm daVinciDataPopoverTrigger" data-bs-toggle="popover" 
                                    data-bs-custom-class="daVinciPopover"
                                    data-content-id="tile"
                                    data-bs-content="Future data predicted by Da Vinci.">auto_awesome</i>
                                 </div>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.SubTitle">Customer:</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger" data-bind="visible: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ErrorMessage, text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ErrorMessage" style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ErrorMessageLong"></span>
                              </div>
                              <div class="tile-bottom-half">
                                 <div class="mainIconWrapper text-center">
                                    <i class="material-icons text-left tile-icon sys-fg-primary" data-bind="tileicon: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.Icon, tileiconcolor: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.IconColor"></i>
                                 </div>
                                 <span class="text-right tile-value-label" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.Footer"></span>
                                 <div class="valueWrapper text-right metric-only">
                                    <span class="tile-main-value text-right" data-bind="text: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.Value, tileiconcolor: Query.TILE_a340c557b8244efba9cf8e1db4ce25da.ValueColor" style="white-space: nowrap; display: inline-block; font-size: 30px;">0</span>
                                 </div>
                              </div>
                        </div>
                     </div>
                  </div>

                              </div>
                        </div>
                     </div>


                     <div class="col-sm-4 col-xs-6 col-6 tile " data-tiletype="Text" data-tiletypename="WHM007_Missions_completed_today" data-tiletypedetail="TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a" data-parentfieldpath="Mission" data-tileparameters="{}" data-tiledetailavailable="Y" style="position: absolute; left: 142px; top: 5px;" data-boundonce="true">
                        
                              <div class="tile-loading-cover" style="display: none;"><span class="spinner"></span></div>
                        <div>
                              <div class="tile-inner sys-fg-white sys-bg-lighter-blue">
                                 <div class="panel-body text-left sys-wrapper sys-pd-off sys-mg-off">
                     <div class="big-tile row" data-bind="tilecolor: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Title">Missions completed today</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.SubTitle">Mission</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger" data-bind="visible: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ErrorMessage, text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ErrorMessage" style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ErrorMessageLong"></span>
                              </div>
                              <div class="tile-bottom-half flex-center">
                                 <div class="mainIconWrapper text-center">
                                    <i class="material-icons text-left tile-icon text-white sys-fg-white main-tile-icon" data-bind="tileicon: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Icon, tileiconcolor: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.IconColor"></i>
                                 </div>
                                 <span class="tile-value-label text-right" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Footer"></span>
                                 <div class="valueWrapper text-right metric-only">
                                    <span class="tile-main-value" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Value, tileiconcolor: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ValueColor" style="white-space: nowrap; display: inline-block;">0</span>
                                 </div>                
                              </div>
                        </div>
                     </div>

                     <div class="wide-tile row" data-bind="tilecolor: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Title">Missions completed today</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.SubTitle">Mission</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger" data-bind="visible: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ErrorMessage, text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ErrorMessage" style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ErrorMessageLong"></span>
                              </div>
                              <div class="tile-bottom-half">
                                 <i class="material-icons tile-icon text-left main-tile-icon sys-fg-primary" data-bind="tileicon: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Icon, tileiconcolor: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.IconColor"></i>
                                 <div class="valueWrapper text-right">
                                    <span class="text-right tile-value-label" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Footer"></span>
                                    <span class="tile-main-value" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Value, tileiconcolor: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ValueColor" style="white-space: nowrap; display: inline-block;">0</span>
                                 </div>
                              </div>
                        </div>
                     </div>
                     <div class="small-tile row" data-bind="tilecolor: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title show-more-icon" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Title" style="height: 32px;">Missions completed today</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.SubTitle">Mission</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger" data-bind="visible: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ErrorMessage, text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ErrorMessage" style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ErrorMessageLong"></span>
                              </div>
                              <div class="tile-bottom-half">
                                 <div class="mainIconWrapper text-center">
                                    <i class="material-icons text-left tile-icon sys-fg-primary" data-bind="tileicon: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Icon, tileiconcolor: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.IconColor"></i>
                                 </div>
                                 <span class="text-right tile-value-label" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Footer"></span>
                                 <div class="valueWrapper text-right metric-only">
                                    <span class="tile-main-value text-right" data-bind="text: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.Value, tileiconcolor: Query.TILE_a3afe1b0226a43a0a7eb78a5c91cdc0a.ValueColor" style="white-space: nowrap; display: inline-block; font-size: 30px;">0</span>
                                 </div>
                              </div>
                        </div>
                     </div>
                  </div>

                              </div>
                        </div>
                     </div>


                     <div class="col-sm-4 col-xs-6 col-6 tile " data-tiletype="Text" data-tiletypename="SQL003_Table_Sizes" data-tiletypedetail="TILE_a41a4ea9c75b4138859cfd495f465df2" data-parentfieldpath="" data-tileparameters="{&quot;Number_Of_Tables&quot;:&quot;&quot;}" data-tiledetailavailable="Y" style="position: absolute; left: 284px; top: 5px;" data-boundonce="true">
                        
                              <div class="tile-loading-cover" style="display: none;"><span class="spinner"></span></div>
                        <div>
                              <div class="tile-inner sys-fg-white sys-bg-lighter-blue">
                                 <div class="panel-body text-left sys-wrapper sys-pd-off sys-mg-off">
                     <div class="big-tile row" data-bind="tilecolor: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Title">Top Tables by Size</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.SubTitle"></span>
                                 
                              </div>
                              <div class="tile-bottom-half flex-center">
                                 <div class="mainIconWrapper text-center">
                                    <i class="material-icons text-left tile-icon text-white sys-fg-white main-tile-icon" data-bind="tileicon: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Icon, tileiconcolor: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.IconColor"></i>
                                 </div>
                                 <span class="tile-value-label text-right" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Footer">Top  tables</span>
                                 <div class="valueWrapper text-right metric-only">
                                    <span class="tile-main-value" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Value, tileiconcolor: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.ValueColor" style="white-space: nowrap; display: inline-block;">0 MB</span>
                                 </div>                
                              </div>
                        </div>
                     </div>

                     <div class="wide-tile row" data-bind="tilecolor: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Title">Top Tables by Size</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.SubTitle"></span>
                                 
                              </div>
                              <div class="tile-bottom-half">
                                 <i class="material-icons tile-icon text-left main-tile-icon sys-fg-primary" data-bind="tileicon: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Icon, tileiconcolor: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.IconColor"></i>
                                 <div class="valueWrapper text-right">
                                    <span class="text-right tile-value-label" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Footer">Top  tables</span>
                                    <span class="tile-main-value" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Value, tileiconcolor: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.ValueColor" style="white-space: nowrap; display: inline-block;">0 MB</span>
                                 </div>
                              </div>
                        </div>
                     </div>
                     <div class="small-tile row" data-bind="tilecolor: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title show-more-icon" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Title" style="height: 32px;">Top Tables by Size</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.SubTitle"></span>
                                 
                              </div>
                              <div class="tile-bottom-half">
                                 <div class="mainIconWrapper text-center">
                                    <i class="material-icons text-left tile-icon sys-fg-primary" data-bind="tileicon: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Icon, tileiconcolor: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.IconColor"></i>
                                 </div>
                                 <span class="text-right tile-value-label" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Footer">Top  tables</span>
                                 <div class="valueWrapper text-right metric-only">
                                    <span class="tile-main-value text-right" data-bind="text: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.Value, tileiconcolor: Query.TILE_a41a4ea9c75b4138859cfd495f465df2.ValueColor" style="white-space: nowrap; display: inline-block; font-size: 30px;">0 MB</span>
                                 </div>
                              </div>
                        </div>
                     </div>
                  </div>

                              </div>
                        </div>
                     </div>


                     <div class="col-sm-4 col-xs-6 col-6 tile " data-tiletype="Text" data-tiletypename="WHM004_Missions_by_Pick" data-tiletypedetail="TILE_aedb098175a04be3803a53be736fca66" data-parentfieldpath="Mission" data-tileparameters="{}" data-tiledetailavailable="Y" style="position: absolute; left: 0px; top: 152px;" data-boundonce="true">
                        
                              <div class="tile-loading-cover" style="display: none;"><span class="spinner"></span></div>
                        <div>
                              <div class="tile-inner sys-fg-white sys-bg-lighter-red">
                                 <div class="panel-body text-left sys-wrapper sys-pd-off sys-mg-off">
                     <div class="big-tile row" data-bind="tilecolor: Query.TILE_aedb098175a04be3803a53be736fca66.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.Title">Missions by Pick</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.SubTitle">Mission</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger" data-bind="visible: Query.TILE_aedb098175a04be3803a53be736fca66.ErrorMessage, text: Query.TILE_aedb098175a04be3803a53be736fca66.ErrorMessage" style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.ErrorMessageLong"></span>
                              </div>
                              <div class="tile-bottom-half flex-center">
                                 <div class="mainIconWrapper text-center">
                                    <i class="material-icons text-left tile-icon text-white sys-fg-white main-tile-icon" data-bind="tileicon: Query.TILE_aedb098175a04be3803a53be736fca66.Icon, tileiconcolor: Query.TILE_aedb098175a04be3803a53be736fca66.IconColor"></i>
                                 </div>
                                 <span class="tile-value-label text-right" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.Footer"></span>
                                 <div class="valueWrapper text-right metric-only">
                                    <span class="tile-main-value" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.Value, tileiconcolor: Query.TILE_aedb098175a04be3803a53be736fca66.ValueColor" style="white-space: nowrap; display: inline-block;">0</span>
                                 </div>                
                              </div>
                        </div>
                     </div>

                     <div class="wide-tile row" data-bind="tilecolor: Query.TILE_aedb098175a04be3803a53be736fca66.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.Title">Missions by Pick</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.SubTitle">Mission</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger" data-bind="visible: Query.TILE_aedb098175a04be3803a53be736fca66.ErrorMessage, text: Query.TILE_aedb098175a04be3803a53be736fca66.ErrorMessage" style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.ErrorMessageLong"></span>
                              </div>
                              <div class="tile-bottom-half">
                                 <i class="material-icons tile-icon text-left main-tile-icon sys-fg-primary" data-bind="tileicon: Query.TILE_aedb098175a04be3803a53be736fca66.Icon, tileiconcolor: Query.TILE_aedb098175a04be3803a53be736fca66.IconColor"></i>
                                 <div class="valueWrapper text-right">
                                    <span class="text-right tile-value-label" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.Footer"></span>
                                    <span class="tile-main-value" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.Value, tileiconcolor: Query.TILE_aedb098175a04be3803a53be736fca66.ValueColor" style="white-space: nowrap; display: inline-block;">0</span>
                                 </div>
                              </div>
                        </div>
                     </div>
                     <div class="small-tile row" data-bind="tilecolor: Query.TILE_aedb098175a04be3803a53be736fca66.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <div class="ai-tile-icon-title">
                                    <span class="text-left tile-title">Missions by Pick</span>
                                    <i class="material-icons pull-right text-right sys-txt-sm daVinciDataPopoverTrigger" data-bs-toggle="popover" 
                                    data-bs-custom-class="daVinciPopover"
                                    data-content-id="tile"
                                    data-bs-content="Future data predicted by Da Vinci.">auto_awesome</i>
                                 </div>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.SubTitle">Mission</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger" data-bind="visible: Query.TILE_aedb098175a04be3803a53be736fca66.ErrorMessage, text: Query.TILE_aedb098175a04be3803a53be736fca66.ErrorMessage" style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.ErrorMessageLong"></span>
                              </div>
                              <div class="tile-bottom-half">
                                 <div class="mainIconWrapper text-center">
                                    <i class="material-icons text-left tile-icon sys-fg-primary" data-bind="tileicon: Query.TILE_aedb098175a04be3803a53be736fca66.Icon, tileiconcolor: Query.TILE_aedb098175a04be3803a53be736fca66.IconColor"></i>
                                 </div>
                                 <span class="text-right tile-value-label" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.Footer"></span>
                                 <div class="valueWrapper text-right metric-only">
                                    <span class="tile-main-value text-right" data-bind="text: Query.TILE_aedb098175a04be3803a53be736fca66.Value, tileiconcolor: Query.TILE_aedb098175a04be3803a53be736fca66.ValueColor" style="white-space: nowrap; display: inline-block; font-size: 30px;">0</span>
                                 </div>
                              </div>
                        </div>
                     </div>
                  </div>

                              </div>
                        </div>
                     </div>


                     <div class="col-sm-4 col-xs-6 col-6 tile " data-tiletype="Text" data-tiletypename="WIP960_Wip_At_A_Glance_Lab_Issued" data-tiletypedetail="TILE_f016bb843942492ca41737f24c86bccb" data-parentfieldpath="" data-tileparameters="{&quot;PeriodCP1P2&quot;:&quot;C&quot;}" data-tiledetailavailable="Y" style="position: absolute; left: 142px; top: 152px;" data-boundonce="true">
                        
                              <div class="tile-loading-cover" style="display: none;"><span class="spinner"></span></div>
                        <div>
                              <div class="tile-inner sys-fg-white sys-bg-lighter-red">
                                 <div class="panel-body text-left sys-wrapper sys-pd-off sys-mg-off">
                     <div class="big-tile row" data-bind="tilecolor: Query.TILE_f016bb843942492ca41737f24c86bccb.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.Title">WIP at a glance</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.SubTitle">Labor issued</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger" data-bind="visible: Query.TILE_f016bb843942492ca41737f24c86bccb.ErrorMessage, text: Query.TILE_f016bb843942492ca41737f24c86bccb.ErrorMessage" style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.ErrorMessageLong"></span>
                              </div>
                              <div class="tile-bottom-half flex-center">
                                 <div class="mainIconWrapper text-center">
                                    <i class="material-icons text-left tile-icon text-white sys-fg-white main-tile-icon" data-bind="tileicon: Query.TILE_f016bb843942492ca41737f24c86bccb.Icon, tileiconcolor: Query.TILE_f016bb843942492ca41737f24c86bccb.IconColor"></i>
                                 </div>
                                 <span class="tile-value-label text-right" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.Footer">Period:Current</span>
                                 <div class="valueWrapper text-right metric-only">
                                    <span class="tile-main-value" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.Value, tileiconcolor: Query.TILE_f016bb843942492ca41737f24c86bccb.ValueColor" style="white-space: nowrap; display: inline-block;">38416.05</span>
                                 </div>                
                              </div>
                        </div>
                     </div>

                     <div class="wide-tile row" data-bind="tilecolor: Query.TILE_f016bb843942492ca41737f24c86bccb.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <span class="text-left tile-title" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.Title">WIP at a glance</span>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.SubTitle">Labor issued</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger" data-bind="visible: Query.TILE_f016bb843942492ca41737f24c86bccb.ErrorMessage, text: Query.TILE_f016bb843942492ca41737f24c86bccb.ErrorMessage" style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.ErrorMessageLong"></span>
                              </div>
                              <div class="tile-bottom-half">
                                 <i class="material-icons tile-icon text-left main-tile-icon sys-fg-primary" data-bind="tileicon: Query.TILE_f016bb843942492ca41737f24c86bccb.Icon, tileiconcolor: Query.TILE_f016bb843942492ca41737f24c86bccb.IconColor"></i>
                                 <div class="valueWrapper text-right">
                                    <span class="text-right tile-value-label" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.Footer">Period:Current</span>
                                    <span class="tile-main-value" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.Value, tileiconcolor: Query.TILE_f016bb843942492ca41737f24c86bccb.ValueColor" style="white-space: nowrap; display: inline-block;">38416.05</span>
                                 </div>
                              </div>
                        </div>
                     </div>
                     <div class="small-tile row" data-bind="tilecolor: Query.TILE_f016bb843942492ca41737f24c86bccb.TileColor">
                        <div class="col-xs-12 col-12">
                              <div class="tile-top-half">
                                 <div class="ai-tile-icon-title">
                                    <span class="text-left tile-title">WIP at a glance</span>
                                    <i class="material-icons pull-right text-right sys-txt-sm daVinciDataPopoverTrigger" data-bs-toggle="popover" 
                                    data-bs-custom-class="daVinciPopover"
                                    data-content-id="tile"
                                    data-bs-content="Future data predicted by Da Vinci.">auto_awesome</i>
                                 </div>
                                 <span class="tile-subtitle" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.SubTitle">Labor issued</span>
                                 <span class="tile-subtitle tile-error tile-error-short sys-fg-danger"  style="display: none;"></span>
                              <span class="tile-subtitle tile-error tile-error-long sys-fg-danger" ></span>
                              </div>
                              <div class="tile-bottom-half">
                                 <div class="mainIconWrapper text-center">
                                    <i class="material-icons text-left tile-icon sys-fg-primary" ></i>
                                 </div>
                                 <span class="text-right tile-value-label" data-bind="text: Query.TILE_f016bb843942492ca41737f24c86bccb.Footer">Period:Current</span>
                                 <div class="valueWrapper text-right metric-only">
                                    <span class="tile-main-value text-right" style="white-space: nowrap; display: inline-block; font-size: 26.25px;">38416.05</span>
                                 </div>
                              </div>
                        </div>
                     </div>
                  </div>

                              </div>
                        </div>
                     </div>

                              </div>
                        </div>
                     </div>


                                 </div>
                              </div>
                     </div>

                  </div>
                  <hr class="sys-bd-very-light-gray" />
                  <div class="row widget layout-widget grid-stack-item-content ps" data-guid="a67c49bb-8305-4026-9613-3c76c74e2859" data-subtype="" data-border="Internal" data-displaystyle="Tiles" data-collapsible="False" style="" >
                     <div class="col">
                        <h4><i class="material-icons">queue</i> Purchase Order bulk creation <i 
                           class="material-icons davinciicon-light daVinciAutoPopoverTrigger"
                           data-bs-toggle="popover" 
                           data-bs-custom-class="daVinciPopover"
                           data-content-id="automation"
                           data-bs-content="This is a Da Vinci Vision automated process"
                           data-bs-title="Da Vinci automated process."
                        >auto_awesome</i></h4>   
                        <small>Upload multiple invoices at once, and Da Vinci Vision will automatically create Purchase Orders from them.</small>                  
                        <div class="fileUploadDropZone sys-mg-t-5">
                           <input name="files" id="files" type="file" />
                     </div>
                     </div>
                  </div>
                </div>
              </div>
            </div>            

        </div>
      </div>
      <div class="statusBar sys-bg-inverse" style="display: block;">
        <span class="status-message sys-fg-very-light-gray">The OUTDOORS Company (EDU1)  Your license expires February 1st           TUESDAY 8   JANUARY 2019</span>
      </div>
    </div>

    <button id="davinciButton"><i class="material-icons">auto_awesome</i></button>
    


    <footer id="thefooter" style="background-image: url('../../Samples/UX_IMG_cloud_erp_light_footer.png');">
      <span id="copyrightfooter">© SYSPRO All Rights Reserved. All trademarks are recognized.</span><span id="sysprofooter">Powered by SYSPRO ERP</span>
    </footer>

  </div>

   <div id="daVinciWindow">
      <div id="daVinciChat" style="width: 100%; height: 100%"></div>
   </div>
   <ul id="faves-menu">
      <li>I want to create a new quote</li>
      <li>show me the job card for the "15 Speed Mountain Bike Mens" job</li>
      <li>get me the top 4 customers, ranked by current balance and show it as a pie chart, and format the values as currency ($) not percentage</li>
      <li>which salesperson has the most orders?</li>
      <li>show me the card for product A100</li>
      <li>Can you give me the product code, description, category and warehouse for product codes A100, A200, B100 and B200</li>
      <li>from the warehouses table get the top 5 product codes ranked by quantity sold, and show this as a column chart</li>
      <li>what are the contact details and address (including city and postal code) for customer Bayside Bikes</li>
      <li>what program should I use to look up information about inventory?</li>
      <li>find the top four products by quantity on hand, and then list the product code, description, warehouse and quantity on hand </li>
      <li>find the top four products by quantity on hand, and then list the product code, description, warehouse and quantity on hand for those same four products</li>
      <li>What is A100</li>
  </ul>

  <script src="js/new/UX_JS_bootstrap.min.js"></script>
  <script src="js/UX_JS_forms.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
  <script id="davinciresponse-template" type="text/x-kendo-template">
   <div class="k-card">
      <div class="k-card-header d-flex justify-content-between">
         <div class="">
            #:title#
         </div>
         <div class="">
            <i class="material-icons sys-fg-gray sys-mg-r-10 showmodelcard" data-bs-toggle="tooltip" data-bs-title="Da Vinci Data Prediction">insights</i>
            <span class="conflevel">
            <i class="material-icons sys-fg-warning" data-bs-toggle="tooltip" data-bs-title="Confidence level">data_usage</i>
            <span class="sys-txt-sm sys-fg-gray">61%</span>
            </span>
         </div>
     </div>
     <div class="k-card-body">
       <p>#:content#</p>
     </div>
     <div class="k-card-actions k-card-actions-end">
         <span class="k-card-action">
            <span class="k-button k-button-sm k-rounded-md k-button-flat k-button-flat-base" data-value="Please provide more technical information.">Technical info</span>
         </span>
         <span class="k-card-action">
            <span class="k-button k-button-sm k-rounded-md k-button-flat k-button-flat-base" data-value="There's something wrong with this.">Something's wrong</span>
         </span>
     </div>
   </div>
 </script>
 <script id="davincisumresponse-template" type="text/x-kendo-template">
   <div class="k-card">
      <div class="k-card-header d-flex justify-content-between">
         <div class="">
            #:title#
         </div>
         <div class="">
            <i class="material-icons sys-fg-gray sys-mg-r-10 showmodelcard" data-bs-toggle="tooltip" data-bs-title="Da Vinci Text Generation">edit_note</i>
            <span class="conflevel">
            <i class="material-icons sys-fg-success" data-bs-toggle="tooltip" data-bs-title="Confidence level">data_usage</i>
            <span class="sys-txt-sm sys-fg-gray">84%</span>
            </span>
         </div>
     </div>
     <div class="k-card-body">
       <p>#:content#</p>
     </div>
     <div class="k-card-actions k-card-actions-end">
         <span class="k-card-action">
            <span class="k-button k-button-sm k-rounded-md k-button-flat k-button-flat-base" data-value="Please provide more technical information.">Technical info</span>
         </span>
         <span class="k-card-action">
            <span class="k-button k-button-sm k-rounded-md k-button-flat k-button-flat-base" data-value="There's something wrong with this.">Something's wrong</span>
         </span>
     </div>
   </div>
 </script>

 <script id="davincitileresponse-template" type="text/x-kendo-template">
   <div class="k-card">
      <div class="k-card-header d-flex justify-content-between">
         <div class="">
            #:title#
         </div>
         <div class="">
            <i class="material-icons sys-fg-gray sys-mg-r-10 showmodelcard" data-bs-toggle="tooltip" data-bs-title="Da Vinci Data Prediction">insights</i>
            <span class="conflevel">
            <i class="material-icons sys-fg-warning" data-bs-toggle="tooltip" data-bs-title="Confidence level">data_usage</i>
            <span class="sys-txt-sm sys-fg-gray">65%</span>
            </span>
         </div>
     </div>
     <div class="k-card-body">
       <p>#:content#</p>
     </div>
     <div class="k-card-actions k-card-actions-end">
         <span class="k-card-action">
            <span class="k-button k-button-sm k-rounded-md k-button-flat k-button-flat-base" data-value="Please provide more technical information.">Technical info</span>
         </span>
         <span class="k-card-action">
            <span class="k-button k-button-sm k-rounded-md k-button-flat k-button-flat-base" data-value="There's something wrong with this.">Something's wrong</span>
         </span>
     </div>
   </div>
 </script>

 <script id="davinciautoresponse-template" type="text/x-kendo-template">
   <div class="k-card">
      <div class="k-card-header d-flex justify-content-between">
         <div class="">
            #:title#
         </div>
         <div class="">
            <i class="material-icons sys-fg-gray showmodelcard" data-bs-toggle="tooltip" data-bs-title="Da Vinci Automated Process">smart_toy</i>
         </div>
     </div>
     <div class="k-card-body">
       <p>#:content#</p>
     </div>
     <div class="k-card-actions k-card-actions-end">
         <span class="k-card-action">
            <span class="k-button k-button-sm k-rounded-md k-button-flat k-button-flat-base" data-value="Please provide more technical information.">Technical info</span>
         </span>
         <span class="k-card-action">
            <span class="k-button k-button-sm k-rounded-md k-button-flat k-button-flat-base" data-value="There's something wrong with this.">Something's wrong</span>
         </span>
     </div>
   </div>
 </script>

 <script id="technicalinfo-template" type="text/x-kendo-template">
   <div class="k-card">
      <div class="k-card-header">
         Technical info
     </div>
     <div class="k-card-body">
       <p>#:content#</p>
     </div>
   </div>
 </script>

 <script id="sysprolearn-template" type="text/x-kendo-template">
   <div class="k-card">
      <div class="k-card-header">
         Help on using SYSPRO
     </div>
     <div class="k-card-body">
       <p>#=content#</p>
     </div>
   </div>
 </script>

 <script id="confidence-template" type="text/x-kendo-template">
   <div class="k-card">
      <div class="k-card-header">
         Confidence levels
     </div>
     <div class="k-card-body">
       <p>A description of confidence levels and what they mean.</p>
       <table class="table">
         <tr>
            <td style="width: 5%"><i class="material-icons sys-fg-success">data_usage</i></td>
            <td><b>Over 75%</b></td>
         </tr>
         <tr>
            <td><i class="material-icons sys-fg-warning">data_usage</i></td>
            <td><b>55% - 75%</b></td>
         </tr>
         <tr>
            <td><i class="material-icons sys-fg-danger">data_usage</i></td>
            <td><b>Under 55%</b></td>
         </tr>
       </table>
     </div>
   </div>
 </script>

 <script id="models-template" type="text/x-kendo-template">
   <div class="k-card">
      <div class="k-card-header">
         Confidence levels
     </div>
     <div class="k-card-body">
       <p>Da Vinci has three main tools it uses to help you understand your data, increase efficiency, and to run your operations more easily and speedily. Each type of tool is indicated by an icon that you might see when using SYSPRO.</p>
       <table class="table table-borderless models-table">
         <tr>
            <td><i class="material-icons sys-txt-lg sys-fg-gray">edit_note</i></td>
            <td>
               <h4 class="sys-mg-b-5"><b>Text Generation</b></h4>
               <p>A description of the LLM and natural languange processing capabilities of SYSPRO AI.</p>
            </td>
         </tr>
         <tr>
            <td><i class="material-icons sys-txt-lg sys-fg-gray">insights</i></td>
            <td>
               <h4 class="sys-mg-b-5"><b>Data Insights</b></h4>
               <p>A description of the data prediction and anomaly detection capabilities.</p>
            </td>
         </tr>
         <tr>
            <td><i class="material-icons sys-txt-lg sys-fg-gray">smart_toy</i></td>
            <td>
               <h4 class="sys-mg-b-5"><b>Task Automation</b></h4>
               <p>A description of automation, including OCR capabilities of Da Vinci.</p>
            </td>
         </tr>
       </table>
     </div>
   </div>
 </script>

 <script id="davinciconfirm-template" type="text/x-kendo-template">
   <div class="k-card">
      <div class="k-card-header sys-bg-success sys-fg-white">
         #:title#
     </div>
     <div class="k-card-body">
       <p>#:content#</p>
     </div>
     <div class="k-card-actions k-card-actions-end">
         <span class="k-card-action">
            <span class="k-button k-button-md k-rounded-md k-button-flat k-button-flat-base" data-value="Go ahead">Go ahead</span>
         </span>
         <span class="k-card-action">
            <span class="k-button k-button-md k-rounded-md k-button-flat k-button-flat-base sys-bg-very-light-gray sys-fg-inverse" data-value="There's something wrong with this.">Cancel</span>
         </span>
     </div>
   </div>
   
 </script>

 <script id="olddavinciconfirmed-template" type="text/x-kendo-template">
   <div class="k-card sys-bg-success sys-fg-white">
     <div class="k-card-body">
       <p>#:content#</p>
     </div>
     <div class="k-card-actions k-card-actions-end">
         <span class="k-card-action">
            <span class="k-button k-button-md k-rounded-md k-button-flat k-button-flat-base" data-value="Please provide more technical information.">Go ahead</span>
         </span>
         <span class="k-card-action">
            <span class="k-button k-button-md k-rounded-md k-button-flat k-button-flat-base sys-bg-very-light-gray sys-fg-inverse" data-value="There's something wrong with this.">Cancel</span>
         </span>
     </div>
   </div>
   
 </script>
 <script id="davinciconfirmed-template" type="text/x-kendo-template">
   <p>#= content #</p>
 </script>

 <script id="davincicode-template" type="text/x-kendo-template">
   <pre><code>Imports System.Drawing

' Get the current year's sales total and the previous year's sales total
Dim currentYearSales As Decimal = ARSPEN.SalesTotal
Dim previousYearSales As Decimal = GetPreviousYearSales() ' You should implement this function

' Define your color constants
Dim greenColor As Color = Color.Green
Dim redColor As Color = Color.Red

' Check if the current year's sales total is greater than the previous year's
If currentYearSales > previousYearSales Then
    ' Set the text color to green
    ARSPEN.SalesTotal.ForeColor = greenColor
ElseIf currentYearSales <code previousYearSales Then
    ' Set the text color to red
    ARSPEN.SalesTotal.ForeColor = redColor
Else
    ' You can set a default color (e.g., black) if they are equal or handle this case differently
    ARSPEN.SalesTotal.ForeColor = Color.Black
End If

' Update the text to display the current year's sales total
ARSPEN.SalesTotal.Text = currentYearSales.ToString()

' Implement a function to get the previous year's sales total (replace with your data retrieval logic)
Function GetPreviousYearSales() As Decimal
    ' Replace this with your actual data retrieval logic
    ' For example, you could query a database or calculate it based on your data
    ' For demonstration purposes, we'll return a hardcoded value
    Return 10000.0 ' Replace with your actual value
End Function</code></pre>
 </script>

  <script>

   const systemPrompt = `Never forget that your name is 'Da Vinci', and you are the 'Syspro AI helper'. That is who you should intriduce yourself as, and If someone asks you who you are, then that is what you should answer. You should always use a friendly but professional tone.         

Your main responsibilities are to help people retrieve data from Syspro, to make tasks easier for them, to help them find out how to use Syspro, and to make data easier to digest by summarising it and visualising it in helpful ways.

Often you will have to perform a SQL query in order to respond to a query. Whenever you have to do this, don't mention you are executing a SQL query to me. If you have some problems matching what I ask to SQL table and column names, just make the best match you can, execute a query that will work, and return the results. Don't tell me about what you have changed, and don't tell me if you have having difficulties or misunderstandings, that's not a problem. Just execute the query without me knowing any of the details, and return the best results you can.

When I ask questions which you need to make a SQL query to answer, sometimes I will ask for things that are not the exact name of a table or column. Here are some words I might use, and the tabel or column name you should use:
If I ask to search 'warehouses' then that is the 'warehouses' table or view. But if I ask for the warehouse for a specific product or product code, then you can use the column name 'warehouse_name'. If I ask for 'product', then you can use the column name 'Product_code' which is in both the 'products' table or view, and the 'warehouses' table or view. If I ask for 'post code' or 'zip' or 'zip code' then this is the column 'postal_code' in the 'customers' view or table.

When I ask information about products, or a product, then this can be identified in the SQL databases as 'product_code' as the unique identifier, and is in both the 'warehouses' view and the 'products' view. If I ask about the product description, long decription or category, then you can look up by "product_code" in the "products" table or view. If I ask about quantity on hand, quantity sold, warehouse or cost, then you can look that up by "product_code" in the "warehouses" table or view. If I ask for a combination of those things then you will need to get some data from the 'products' table or view, and some from the 'warehouses' table or view. For example if I ask for the product code, description, warehouse and quantity on hand, you will need to use the "product_code" as the unique identifier to look up that information from both the "products" table or view, and the "warehouses" table or view. To be specific, you should only ever query these following column names from the "products" table or view: "product_code", "Description", "LongDesc", "warehouse_name" and "category" - NEVER query any other column names from the "products" table or view. And you should only ever query these following column names from the "warehouses" table or view: "product_code", "quantity_on_hand", "quantity_sold", "warehouse_name" and "cost" - NEVER query any other column names (e.g. "Description") from the "warehouses" table or view. If you need data from both the "products" table or view, and from the "warehouses" table or view for the same "product_code" then you need to do a SQL JOIN query, or similar.

If I ask about "sales people", "salespeople", "salesmen", "sales staff", "sales person" or "salesperson" then you should query the "Orders" table or view, and the column "Salesperson". In the "Orders" table or view the customer is identified by the "customer_id" column. The only columns in the "Orders" table or view are "order_id", "status", "customer_id", "Salesperson", "order_date", "order_year" and "order_type" - do not aatempt to query any other column names on the "Orders" table or view.

If I ask about jobs, then query the "jobs" table or view. The only columns in the "jobs" table or view are "job_id", "description", "product_id", "product_name", "start_date" and "end_date" - do not aatempt to query any other column names on the "jobs" table or view.

If you have to do more than one step of SQL queries to respond to my question, then do all the steps you need before responding, then just respond to my final question. DO NOT respond with your response to each step.

If your response will include multiple rows from a SQL query, each of which having two or more columns of data, then return a bit of JSON with the data. Right before the JSON and before any of your response that wraps the JSON, include the text 'KendoGrid: Here starts JSON:' (without any other characters), and then include no further text after the JSON. For column titles, always replace underscores (_) with a space. DO NOT return any other kind of table with your own formatting.

Whenever you return HTML or JavaScript as part of an answer, include 'Here starts code:' immediately before the code, and nothing at all after the code.

Here are instructions for returning a chart or graph: 
If you are asked to provide a chart or graph, or to graph or chart or plot some data, then return a JSON object of all the options for a Kendo UI for JQuery chart using the template below. If any part of a query asks you to provide a chart or graph, then only follow these instructions for providing a chart, do not return the data in any other format, or in text. Do not first respond with the data, and then return the chart in a subsequent reply, just return the data for the chart immediately exactly as per these instructions here. Use the following code template below, and ALWAYS include the text "Here starts chart data:" BEFORE the code, and then no text at all after the code:

[{{
    "dataSource": {{
        "data": $data
    }},
    "theme": "material",
    "title": {{
        "align": "center",
        "text": $title
    }},
    "legend": {{
        "visible": true
    }},
    "seriesDefaults": {{
        "type": $type,
        "labels": {{
            "visible": true,
            "background": "transparent"
        }}
    }},
    "series": [{{
        "field": $fieldName,
        "categoryField": $categoryName
    }}],
    "valueAxis": {{
        "majorGridLines": {{
            "visible": false
        }},
        "visible": true
    }},
    "categoryAxis": {{
        "majorGridLines": {{
            "visible": false
        }},
        "line": {{
            "visible": true
        }}
    }}
}}]

Replace the following placeholders with the relevant values: Replace $title with an appropriate title for the chart, considering what data you were asked to show in the chart. Replace $type with whatever type of chart is specified, and if no type is specified, then replace $type with 'column'. Replace $data with an array of the data you got from your SQL query, in the following format, replacing $fieldName with the field name, $categoryName with the category name, and replacing $fieldValue and $categoryValue with the appropriate values:

[
   {{
         $fieldName: $fieldValue,
         $categoryName: $categoryValue
   }},
   {{
         $fieldName: $fieldValue,
         $categoryName: $categoryValue
   }}
]
        
Make sure to only include the real data from your response in there. Don't ever add demo or dummy data, or any data that you did not find from a SQL query. You must remove all comments (lines with '//' at the start) from this data and do not add any. Make sure to keep the square brackets which wrap all the code, so that it is valid JSON. 

If I ask for a Gantt chart, then do exacty the same as above but use the following code template:

[{{
    "dataSource": {{
        "data": $data
    }},
    "theme": "material",
    "title": {{
        "align": "center",
        "text": $title
    }},
    "legend": {{
        "visible": false
    }},
    "series": [{{
      "fromField": $fromField,
      "toField": $toField,
      "categoryField": $categoryField,,
    }}],
    "seriesDefaults": {{         
        "type": "rangeBar",
        "labels": {{
            "visible": true,
            "background": "transparent"
        }}
    }},
    "valueAxis": {{
        "majorGridLines": {{
            "visible": false
        }},
        "visible": true
    }},
    "categoryAxis": {{
        "majorGridLines": {{
            "visible": false
        }},
        "line": {{
            "visible": true
        }}
    }}
}}]

Replace $fromField with the appropriate field from the data (likely to be "start_date", or similar). Replace $toField with the appropriate field from the data (likely to be "end_date", or similar). Replace $cetegoryField with the appropriate field from the data (likely to be "description", or "job_id" or similar). If you are asked for a Gantt or rangebar chart of jobs, then query the "jobs" table to get the jobs requested in my query, and make sure to get the "description", "start_date" and "end_date" columns.

That is the end of instructions for returning charts and graphs.

If your response will include multiple rows from a SQL query, each of which having two or more columns of data, then return a bit of JSON with the data. Right before the JSON and before any of your response that wraps the JSON, include the text 'KendoGrid: Here starts JSON:' (without any other characters), and then include no further text after the JSON. For column titles, always replace underscores (_) with a space. DO NOT return any other kind of table with your own formatting.

If I request any kind of contact or address details (for example a person's contact details, or a company's contact details, or a customer address or customer contact or name and address of a customer) then use the "sql_db_query" tool, and the "sql_db_query_checker" tool. Do NOT use the "search_syspro_web" tool, or the "search_syspro_learning" tool. Use SQL to get this data from the 'customers' table or view. When creating a SQL query, you can try finding the columns 'address', 'city', 'postal_code' and 'customer_name'. DO NOT QUERY OTHER TABLES OR COLUMNS! When you have the contact and address data, return HTML using the following template below, where '$name', '$address', '$city', '$postal_code' should be replaced with the data you are returning. '$name' can be for 'name' or 'customer_name'. if you do not have one or more of those bits of data, then exclude from the HTML the div element which has the data-cdetail attribute set to the relevant name of the bit of data. For example if you could not find the name from column 'customer_name', then exclude from the HTML the element with data-cdetail='name', and any inner HTML of that element. IMMEDIATELY BEFORE the HTML, ALWAYS include the text 'Here starts code:', and then include NO TEXT after the end of the provided HTML. Here is the HTML template to use:

   Here starts code:
   <div class="k-card-body">
      <div data-cdetail="name">
         <b>Name: </b>
         <span>$name</span>
      </div>
      <div data-cdetail="address">
         <b>Address: </b>
         <span>$address</span>, 
         <span>$city</span>, 
         <span>$postal_code</span>
      </div>
   </div>  

If I ask about how to use Syspro, or which syspro program to use to do something, first use the "search_syspro_learning" tool, and if you do not find something there, then use the "search_syspro_web" tool to find an answer.

If I ask for all the information about a single particular stock code, or product code, or product, or to see the stock code card, or prodcut card, for a single particular stock code, product code, or product, then use the following instructions and HTML template below: You will need to use the supplied code to do some SQL queries. the stock code or product code you are given will be the value for the 'product_code' column in the 'products', 'warehouses' and 'price' tables or views. You need to get the following columns, from the following tables or views: 'Description' and 'category' from the 'products' table or view; 'warehouse_name', 'cost', 'quantity_on_hand' and 'quantity_sold' from the 'warehouses' table or view; 'price' from the 'price' table or view. In each case you should use the 'product_code' to look up the other values, and it is VERY IMPORTANT that you do not try to query other column names from other tables or views, other than the specific ones I have instructed here. You need to calculate one value 'GP', by first subtracting the value for 'cost' from the value for 'price', dividing that value by the value for 'price', and multiplying that value by 100 (rounded to 2 decimal places). When you have all that data, then return the following HTML template, but with the placeholders shown by the column name preceded by a '$' replaced by the relevant value. For example replace '$quantity_on_hand' with the value you get for 'quantity_on_hand' from the 'warehouses' table or view. Here is the HTML template to use, and when you return it, ALWAYS first include the string 'Here comes card HTML:' directly before the HTML, and then return no text at all after the HTML:

<div class="panel card sys-widget card-widget">
    <div class="card-bindable panel-body card-body sys-pd-off sys-rd">
        <div class="panel-body card-body text-left sys-wrapper sys-bg-primary sys-fg-white sys-rd-t">
            <div class="row">

                <div class="sys-mg-t-11 col-sm-10 col-xs-10 col-10 sys-fg-white">
                    <a class="card-header-link sys-fg-white" onclick="sysproInterop.showSmartTag(this)">
                        <span
                            class="sys-mg-t-3 sys-txt-lg sys-mg-b-5 text-white sys-fg-white pull-left float-left">$product_code</span>
                    </a>
                    <small class="text-left sys-fg-white sys-txt-md">$Description</small>
                    <small class="text-left sys-fg-white sys-txt-sm sys-mg-b-15 ">$category</small>
                </div>
                <div class="col-xs-2 col-2 col-sm-2 sys-mg-t-10 sys-mg-b-10">
                    <div class="sys-avatar">
                        <img src="http://10.211.55.4/UXTools//api/UXInteropWeb/GetImage?FileName=YzpcUk5EODAwXG1tZWRpYVxBMTAwLkJNUA==.png&amp;t=630772092140000000.638385089022966902.637744850491616784&amp;placeHolder=Rob"
                            alt=""
                            class="img-rounded rounded sys-bd-light-gray sys-bd-darken sys-bd-3x text-center img-responsive img-fluid card-header-image">
                    </div>
                </div>

            </div>
        </div>
        <div class="panel-body card-body text-left sys-wrapper sys-bg-white sys-fg-inverse">
            <h4><i class="material-icons">local_offer</i>Pricing</h4>
            <div class="row sys-pd-t-10 sys-pd-b-10 text-left">
                <div class="col-xs-4 col-4">
                    <span class="sys-500 sys-pd-b-5 sys-mg-off text-left sys-txt-md">
                        <span>$</span><span>$price</span>
                    </span>
                    <small class="text-muted">Selling price</small>
                </div>
                <div class="col-xs-4 col-4 ">
                    <span class="sys-500 sys-pd-b-5 sys-mg-off text-left sys-txt-md">
                        <span>$</span><span>$cost</span>
                    </span>
                    <small class="text-muted">Cost price</small>
                </div>
                <div class="col-xs-4 col-4">
                    <span class="sys-500 sys-pd-b-5 sys-mg-off text-left sys-txt-md">$GP</span>%
                    <small class="text-muted">GP %</small>
                </div>
            </div>
            <hr class="sys-hr-light-gray sys-mg-t-10 sys-mg-b-5">
            <h4><i class="material-icons">store</i>Stock level</h4>
            <div class="row">
                <div class="col-xs-4 col-4 sys-pd-t-15 text-left sys-vcenter">
                    <span class="sys-mg-off sys-txt-md">
                        <span>$quantity_on_hand</span>
                    </span>
                    <small class="text-muted">On hand quantity</small>
                </div>
                <div class="col-xs-4 col-4 sys-pd-t-5 text-left sys-vcenter">
                    <span class="sys-mg-off sys-txt-md">
                        <span>$quantity_sold</span>
                    </span>
                    <small class="text-muted">Quantity sold</small>
                </div>
                <div class="col-xs-4 col-4 sys-pd-t-5 text-left sys-vcenter">
                    <span class="sys-mg-off sys-txt-md">
                        <span>$warehouse_name</span>
                    </span>
                    <small class="text-muted">Warehouse</small>
                </div>
            </div>
        </div>
    </div>
</div>

If I ask for all the information about a single particular job or job code or job id, or to see the job card for a single particular job or job code or job id, then use the following instructions and HTML template below: You will need to use the supplied or returned job code to do a SQL query. You may need to find the job according to some criteria, or you will be given a specific job id. You then need to look up the following columns from the 'jobs' table or view: 'job_id', 'description', 'product_id', 'product_name', 'start_date' and 'end_date', and it is VERY IMPORTANT that you do not try to query other column names from other tables or views, other than the specific ones I have instructed here. When you have all that data, then return the following HTML template, but with the placeholders shown by the column name preceded by a '$' replaced by the relevant value. For example replace '$product_name' with the value you get for 'product_name' from the 'jobs' table or view. Here is the HTML template to use, and when you return it, ALWAYS first include the string 'Here comes card HTML:' directly before the HTML, and then return no text at all after the HTML:

<div class="card-bindable panel-body card-body sys-pd-off sys-rd">
    <div class="panel-body card-body text-left sys-wrapper sys-bg-primary sys-fg-white sys-rd-t d-flex flex-column">
        <a tabindex="0" onclick="sysproInterop.showSmartTag(this)" class="text-left sys-fg-white" data-fieldcaption="job">
            <span class="sys-mg-t-off sys-txt-lg sys-mg-b-5 text-white sys-fg-white pull-left float-left" >$job_id</span>
        </a>
        <small class="sys-txt-md">$description</small>
    </div>
    <div class="panel-body card-body text-left sys-wrapper sys-bg-white sys-fg-inverse">
        <h4><i class="material-icons">info_outline</i>Details</h4>
        <div class="row ">
            <div class="col-12 sys-pd-t-15 text-left d-flex flex-column">
                <a tabindex="0" onclick="sysproInterop.showSmartTag(this)">
                    <span class="sys-mg-off sys-500 sys-txt-md">$product_id</span>
                </a>
                <small class="text-muted" data-bind="htmltext: WipQuery.JobHeader.StockDescription">$product_name</small>
            </div>            
        </div>
        <hr class="sys-hr-light-gray sys-mg-t-15 sys-mg-b-15">
        <h4><i class="material-icons">date_range</i>Dates</h4>
        <div class="row ">
            <div class="col-6 sys-pd-t-5 text-left d-flex flex-column">
                <span class="sys-mg-off sys-500 sys-txt-md"><span>$start_date</span></span>
                <small class="text-muted">Start</small>
            </div>
            <div class="col-6 sys-pd-t-5  text-left d-flex flex-column">
                <span class="sys-mg-off sys-500 sys-txt-md"><span>$end_date</span></span>
                <small class="text-muted">End</small>
            </div>
        </div>
    </div>
</div>

If I ask to: create a quote, say that I want to create a quote, create a purchase order, create a sales order, start a new purchase order, or any rephrasing of these requests, then respond with just the text 'Use the wizard'.

Don't forget, when you are responding with code of any type (e.g. JSON, JavaScript, HTML etc.), you must always include the extra code detailed in my previous instructions.
`;

let session_id, chatActive = false;

fetch("https://syspro-gpt-web-api.vercel.app/get_active_conversation_list", {
   method: "GET",      
   headers: {
      // "Content-type": "application/json",
      "accept": "application/json"
   },      
})
.then((response) => response.json())
.then((json) => {
   if (json.length) {
      json.forEach((item) => {
         console.log(`active session: ${item.session_id}`);
         fetch(`https://syspro-gpt-web-api.vercel.app/delete_session?session_id=${item.session_id}`, {
            method: "DELETE",      
            headers: {
               "accept": "application/json"
            },      
         });
      });
   }

   fetch("https://syspro-gpt-web-api.vercel.app/initialize_conversation", {
      method: "POST",      
      headers: {
         "Content-type": "application/json",
         "accept": "application/json"
      },
      body: JSON.stringify({
         "session_description": "prototype",
         "system_prompt": systemPrompt,    
         "model_to_use": "gpt-3.5-turbo-1106",
         "temperature": 0.2,
         "max_iterations": 1,
         "agent_type": "chat-conversational-react-description",
         // "agent_type": "structured-chat-zero-shot-react-description",         
         "chat_history": [

         ]     
      })
   })
   .then((initResponse) => initResponse.json())
   .then((initJson) => {
      console.log(initJson);
      session_id = initJson.session_id;

      const button = $("#davinciButton").getKendoFloatingActionButton();
      
      button.enable();
      $("#davinciButton").addClass("pulse alive");
   });

});

  

   

   // TODO: create confirmatin notification for the chat, with links to the program or records that have been created, or some error notification
   const davinciresponse_template = kendo.template($('#davinciresponse-template').html());
   kendo.chat.registerTemplate("davinciresponse", davinciresponse_template);

   const davincisumresponse_template = kendo.template($('#davincisumresponse-template').html());
   kendo.chat.registerTemplate("davincisumresponse", davincisumresponse_template);

   const davincitileresponse_template = kendo.template($('#davincitileresponse-template').html());
   kendo.chat.registerTemplate("davincitileresponse", davincitileresponse_template);

   const davinciautoresponse_template = kendo.template($('#davinciautoresponse-template').html());
   kendo.chat.registerTemplate("davinciautoresponse", davinciautoresponse_template);

   const technicalinfo_template = kendo.template($('#technicalinfo-template').html());
   kendo.chat.registerTemplate("technicalinfo", technicalinfo_template);

   const sysprolearn_template = kendo.template($('#sysprolearn-template').html());
   kendo.chat.registerTemplate("sysprolearn", sysprolearn_template);

   const davinciconfirm_template = kendo.template($('#davinciconfirm-template').html());
   kendo.chat.registerTemplate("davinciconfirm", davinciconfirm_template);

   const davinciconfirmed_template = kendo.template($('#davinciconfirmed-template').html());
   kendo.chat.registerTemplate("davinciconfirmed", davinciconfirmed_template);

   const davincicode_template = kendo.template($('#davincicode-template').html());
   kendo.chat.registerTemplate("davincicode", davincicode_template);

   const confidence_template = kendo.template($('#confidence-template').html());
   kendo.chat.registerTemplate("confidence", confidence_template);

   const models_template = kendo.template($('#models-template').html());
   kendo.chat.registerTemplate("models", models_template);

   const daVinciUser = {
      id: 'daVinci',
      name: "da Vinci",
      iconUrl: "img/davinci.png"
   };

   const responses = {
      summary: {
         title: "Da Vinci data summaries",
         content: "To create summaries from your data, Da Vinci learns about the patterns and regularities in your numerical and other data, directly from your database. From its understanding of trends, anomalies, and other things that seem noteworthy, it is able to produce helpful written descriptions that can save hours of traditional data analysis.",
      },
      tile: {
         title: "Da Vinci predictive tiles",
         content: "The data displayed in this tile is based on Da Vinci's trend prediction machine learning model. This model learns from your data, identifies trends, and predicts future values.",
      },
      automation: {
         title: "Da Vinci automated process",
         content: "This process was designed by an admin, and utilises Da Vinci Vision to automatically identify fields and information on invoices, and map them to fields in Syspro.",
      }
   };

   const techInfo = {
      summary: {
         title: "Da Vinci data summaries",
         content: "Here is some technical information about the actual model used, perhaps confidence intervals, and the method (algorithm) of learning, etc.",
      },
      tile: {
         title: "Da Vinci predictive tiles",
         content: "Here is some technical information about the actual model used, perhaps confidence intervals, and the method (algorithm) of learning, etc.",
      },
   };

   $("#davinciButton").kendoFloatingActionButton({
         enabled: false,
       size: "small",
       alignOffset: { x: 20, y: 35 },
       click: function() {
         $("#daVinciWindow").data("kendoWindow").open();
         setTimeout(function() {
               chat.renderUserTypingIndicator(daVinciUser);
               $(".k-typing-indicator-bubble .k-author").text("Da Vinci is thinking");
            }, 250);
         if (!chatActive) {
            console.log('session_id ', session_id);
            fetch("https://syspro-gpt-web-api.vercel.app/run_conversation", {
               method: "POST",      
               headers: {
                  "Content-type": "application/json",
                  "accept": "application/json"
               },
               body: JSON.stringify({
                  "session_id": session_id,
                  "input": "Hello, I'm Joe",  
                  // "dataSource": {},       
               })
            })
            .then((response) => response.json())
            .then((json) => {
               console.log(json);
               chat.renderMessage({
                  type: "text",
                  text: json.output
               }, daVinciUser);
            });
            chatActive = true
         }
         setTimeout(function(){
            $("#daVinciChat .k-message-box input").focus();
         }, 220);
         
       }
   });

   const daVinciWindow = $("#daVinciWindow").kendoWindow({
      actions: ["Heart", "More-Vertical", "Minus", "Plus", "Close"],
      draggable: false,
      resizable: false,
      width: "500px",
      height: "500px",
      // maxHeight: "750px",
      // maxWidth: "1000px",
      title: "Ask Da Vinci",
      visible: false,
      position: {
         top: window.innerHeight - 515,
         left: window.innerWidth - 515,
      },
      animation: { 
         open: { 
            effects: "slideIn:up fadeIn",
            duration: 150
         },
         close: { 
            effects: "slideIn:up fadeIn", 
            reverse: true,
            duration: 150
         } 
      },
      close: function(e) {
         daVinciWindow.setOptions({
            width: "500px",
            height: "500px",
            position: {
               top: window.innerHeight - 515,
               left: window.innerWidth - 515,
            },
         });
      },
      // maximize: function() {
      //    const daVinciWindow = $("#daVinciWindow").data("kendoWindow");
      //    console.log(daVinciWindow);
      //    daVinciWindow.setOptions({
      //       width: "750px",
      //       height: "1000px",
      //       position: {
      //          top: window.innerHeight - 775,
      //          left: window.innerWidth - 1025,
      //       },
      //    })
      // },
      // minimize: function() {
      //    daVinciWindow.setOptions({
      //       position: {
      //          top: window.innerHeight - 525,
      //          left: window.innerWidth - 475,
      //       },
      //    })
      // },
      // close: onClose
   }).data("kendoWindow")

   $(document).on("click", '[aria-labelledby="daVinciWindow_wnd_title"] .k-svg-i-plus', function(e) {
   // $("#daVinciWindow").siblings(".k-window-titlebar").find(".k-svg-i-plus").parent().click(function (e) {
   // daVinciWindow.wrapper.find(".k-svg-i-plus").parent().on("click", function (e) {
      console.log(daVinciWindow);
      daVinciWindow.setOptions({
         width: window.innerWidth - 320,
         height: window.innerHeight - 70,
         position: {
            top: 55,
            left: 305,
         },
      });
      e.preventDefault();
   });

   $(document).on("click", '[aria-labelledby="daVinciWindow_wnd_title"] .k-svg-i-minus', function(e) {
   // $("#daVinciWindow").siblings(".k-window-titlebar").find(".k-svg-i-minus").parent().click(function (e) {
   // daVinciWindow.wrapper.find(".k-svg-i-minus").parent().on("click", function (e) {
      console.log(daVinciWindow);
      daVinciWindow.setOptions({
         width: "500px",
         height: "500px",
         position: {
            top: window.innerHeight - 515,
            left: window.innerWidth - 515,
         },
      });
      e.preventDefault();
   });

   var WizardCardComponent = kendo.chat.Component.extend({
      init: function (options, view) {
         console.log(options);
         kendo.chat.Component.fn.init.call(this, options, view);

         this.element.addClass("k-card").append('<form id="wizard" style="width:100%; margin: 0 auto;" novalidate></form>');
         setTimeout(function() {
            initWizard();
         }, 300);
      }
   });

   kendo.chat.registerComponent("WizardCardComponent", WizardCardComponent);

   var ContactCardComponent = kendo.chat.Component.extend({
      init: function (options, view) {
         console.log(options);
         kendo.chat.Component.fn.init.call(this, options, view);

         this.element.addClass("k-card").append(options.html);
      }
   });

   kendo.chat.registerComponent("ContactCardComponent", ContactCardComponent);

   var GridComponent = kendo.chat.Component.extend({
      init: function (options, view) {
         console.log(options);
         kendo.chat.Component.fn.init.call(this, options, view);

         // Create a <div> from which the Calendar will be initialized.
         var gridElement = $('<div>');

         // Initialize the grid component by passing the provided value.
         gridElement.kendoGrid({
            dataSource: options.dataSource,
         });

         // Place the grid within the Chat card.
         var bodyElement = $('<div>').addClass("k-card-body").append(gridElement);
         this.element.addClass("k-card").append(bodyElement);
      }
   });

   kendo.chat.registerComponent("GridComponent", GridComponent);

   var ChartComponent = kendo.chat.Component.extend({
      init: function (options, view) {
         console.log(options);
         kendo.chat.Component.fn.init.call(this, options, view);

         // Create a <div> from which the Calendar will be initialized.
         var gridElement = $('<div>');
         
         // if ( options.chartData.seriesDefaults && options.chartData.seriesDefaults.type && options.chartData.seriesDefaults.type === "rangeBar" ) {
         //    if ( options.chartData.dataSource?.data && options.chartData.dataSource?.data.length ) {
         //       for (let i = 0; i < options.chartData.dataSource?.data.length; i++) {
         //          console.log(options.chartData.dataSource.data[i]);
         //          if (options.chartData.dataSource.data[i].start_date) {
         //             options.chartData.dataSource.data[i].start_date = new Date(options.chartData.dataSource.data[i].start_date);
         //          }
         //          if (options.chartData.dataSource.data[i].end_date) {
         //             options.chartData.dataSource.data[i].end_date = new Date(options.chartData.dataSource.data[i].end_date);
         //          }
         //       }

         //    }
         // }

         // console.log(options);
         
         // Initialize the grid component by passing the provided value.
         gridElement.kendoChart(options.chartData);

         // Place the grid within the Chat card.
         var bodyElement = $('<div>').addClass("k-card-body").append(gridElement);
         this.element.addClass("k-card").append(bodyElement);
      }
   });

   kendo.chat.registerComponent("ChartComponent", ChartComponent);

   var CodeComponent = kendo.chat.Component.extend({
      init: function (options, view) {
         kendo.chat.Component.fn.init.call(this, options, view);

         // Create a <div> from which the Calendar will be initialized.
         var gridElement = $('<div>');

         // Initialize the grid component by passing the provided value.
         gridElement.kendoGrid({
            dataSource: [ { firstName: "John",
                  lastName: "Smith",
                  email: "john.smith@telerik.com" },
               { firstName: "Jane",
                  lastName: "Smith",
                  email: "jane.smith@telerik.com" },
               { firstName: "Josh",
                  lastName: "Davis",
                  email: "josh.davis@telerik.com" },
               { firstName: "Cindy",
                  lastName: "Jones",
                  email: "cindy.jones@telerik.com" }
            ]
         });

         // Place the grid within the Chat card.
         var bodyElement = $('<div>').addClass("k-card-body").append(gridElement);
         this.element.addClass("k-card").append(bodyElement);
      }
   });

   kendo.chat.registerComponent("CodeComponent", CodeComponent);

   const codeCheck = 'Here starts code:';
   const chartCheck = 'Here starts chart data:';

   var chat = $("#daVinciChat").kendoChat({
         user: {
            id: "sysproUser",
            name: "sysproUser",
            iconUrl: "https://ui-avatars.com/api/?background=027f02&color=fff&name=Joe&length=1"
         },
        post: function (args) {
         console.log(args);

            // React on a user post action.
            setTimeout(function(){
               if (args.from && args.from.name && args.from.name === "sysproUser") {
                  console.log($(".k-message-group[me]").last());
                  $(".k-message-group[me]").last().prepend("<span class='chat-user-msg-actions sys-pd-r-10'><a class='fave-query'><i class='material-icons text-muted'>favorite</i></a></span>");
               }
            }, 500);
            
            if (![
               "Please provide more technical information.",
               "There's something wrong with this.",
               "Sorry to hear that, can you describe the problem?",
               "Who are the top 4 sales staff at Cycle Corp?",
               "Confirmation demo",
               "Go ahead",
               "Write me some script to make the text in field ARSPEN.SalesTotal green if the value is greater than for the same period, previous year, and red if the value is smaller than for the same period, previous year.",
               "List Purchase Orders with issues",
               "List 16 new Purchase Orders"
            ].includes(args.text)) {

               setTimeout(function() {
                  chat.renderUserTypingIndicator(daVinciUser);
                  $(".k-typing-indicator-bubble .k-author").text("Da Vinci is thinking");
               }, 300);

               // fetch("https://syspro-gpt-web-api.vercel.app/chains.conversation_chain_with_tools.conversation/run", {
               //    method: "POST",
               //    body: JSON.stringify({
               //       "input": args.text,
               //       "memory": chatMemory
               //    }),
               //    headers: {
               //       "Content-type": "application/json; charset=UTF-8",
               //       "accept": "application/json"
               //    }
               // })
               // .then((response) => response.json())
               // .then((json) => {
                  

               fetch("https://syspro-gpt-web-api.vercel.app/run_conversation", {
                  method: "POST",      
                  headers: {
                     "Content-type": "application/json",
                     "accept": "application/json"
                  },
                  body: JSON.stringify({
                     "session_id": session_id,
                     "input": args.text,         
                  })
               })
               .then((response) => response.json())
               .then((json) => {
                  console.log(json);
                  if ( json.intermediate_steps.length && json.intermediate_steps[0].length && json.intermediate_steps[0][0].tool && json.intermediate_steps[0][0].tool === "sql_db_query" && json.intermediate_steps[0][1] === "") {
                     chat.renderMessage({
                        type: "text",
                        text: "Sorry, I couldn't find any data in response to that query. Please check the detail of the query to make sure there isn't a mistake, or maybe reformulate your question."
                     }, daVinciUser);
                  } else if (json.output.includes("Use the wizard")) {
                     console.log(json.output);
                     chat.renderAttachments({
                        attachments: [{
                           contentType: "WizardCardComponent",
                           // content: {
                           //    html: code
                           // }
                           // content: {
                           // value: new Date()
                           // }
                        }]
                     }, daVinciUser);
                  } else if (json.output.includes(codeCheck) || json.output.includes("```html")) {
                     console.log('peep');
                     console.log(json.output);
                     let code;
                     if (json.output.includes("```html")) {
                        code = json.output.substring(
                           json.output.indexOf("```html") + 7, 
                           json.output.lastIndexOf("```")
                        ).replace("Here starts code:", "");
                     } else if (json.output.includes("```")) {
                        code = json.output.substring(
                           json.output.indexOf("```") + 3, 
                           json.output.lastIndexOf("```")
                        );
                     } else {
                        console.log(json.output.indexOf(codeCheck));
                        console.log(codeCheck.length);
                        code = json.output.slice(json.output.indexOf(codeCheck) + codeCheck.length);
                     }
                                          
                     console.log(code);

                     chat.renderAttachments({
                        attachments: [{
                           contentType: "ContactCardComponent",
                           content: {
                              html: code
                           }
                           // content: {
                           // value: new Date()
                           // }
                        }]
                     }, daVinciUser);
                  } else if (json.output.includes('KendoGrid')) {
                     console.log('kendo grid');
                     console.log(json.output);
                     let code;
                     if (json.output.includes("```json")) {
                        code = json.output.substring(
                           json.output.indexOf("```json") + 7, 
                           json.output.lastIndexOf("```")
                        ).replace("KendoGrid: Here starts JSON:", "");
                     } else {
                        code = json.output.slice(json.output.indexOf('Here starts JSON:') + 'Here starts JSON:'.length);
                     }
                     
                     chat.renderAttachments({
                        attachments: [{
                           contentType: "GridComponent",
                           content: {
                              dataSource: JSON.parse(code)
                           }
                           // content: {
                           // value: new Date()
                           // }
                        }]
                     }, daVinciUser);

                     console.log(code);
                  } else if (json.output.includes(chartCheck)) {
                     console.log('kendo chart');
                     console.log(json.output);
                     // const code = json.output.slice(json.output.indexOf(chartCheck) + chartCheck.length);
                     
                     let code;
                     if (json.output.includes("```javascript")) {
                        code = json.output.substring(
                           json.output.indexOf("```javascript") + 13, 
                           json.output.lastIndexOf("```")
                        );
                     } else if (json.output.includes("```json")) {
                        code = json.output.substring(
                           json.output.indexOf("```json") + 7, 
                           json.output.lastIndexOf("```")
                        );
                     } else if (json.output.includes("```")) {
                        code = json.output.substring(
                           json.output.indexOf("```") + 3, 
                           json.output.lastIndexOf("```")
                        );
                     } else {
                        console.log(json.output.indexOf(chartCheck));
                        console.log(chartCheck.length);
                        code = json.output.slice(json.output.indexOf(chartCheck) + chartCheck.length);
                     }
                     console.log(code);
                     console.log(JSON.parse(code));
                     chat.renderAttachments({
                        attachments: [{
                           contentType: "ChartComponent",
                           content: {
                              chartData: JSON.parse(code)[0]
                           }
                           // content: {
                           // value: new Date()
                           // }
                        }]
                     }, daVinciUser);

                  } else if ( json.intermediate_steps.length ) {  
                     if ( json.intermediate_steps[0].length && json.intermediate_steps[0][0].tool) {
                        if (json.intermediate_steps[0][0].tool === "search_syspro_learning" || json.intermediate_steps[0][0].tool === "search_syspro_web") {
                           console.log('learning used');
                           chat.renderAttachments({
                              attachments: [{
                                 contentType: "sysprolearn",
                                 content: {
                                    // "title": techInfo["tile"].title,
                                    "content": json.output
                                       .replace("Inventory Query", "<span class='clickable'>Inventory Query</span>")
                                       .replace("Inventory ATP Query", "<span class='clickable'>Inventory ATP Query</span>")
                                       .replace("Inventory at a Glance", "<span class='clickable'>Inventory at a Glance</span>")
                                       .replace("Inventory Forecasting", "<span class='clickable'>Inventory Forecasting</span>")
                                       .replace("Inventory Optimization", "<span class='clickable'>Inventory Optimization</span>"),

                                       
                                    // "content": json.output.replace(/"(.*?)"/|/'(.*?)'/g, function myFunction(x){
                                    //    x = "<span class='clickable'>"+ x +"</span>"
                                    //    return x;
                                    // }),
                                    // "make": "Opel",
                                    // "model": "Astra",
                                    // "worth": "4000",
                                    // "startDate": "2018-10-10"
                                 }
                              }],
                              attachmentLayout: "list"
                           }, daVinciUser);
                        } else {
                           chat.renderMessage({
                              type: "text",
                              text: json.output
                           }, daVinciUser);
                        }
                     }
                  } else {
                     chat.renderMessage({
                        type: "text",
                        text: json.output
                     }, daVinciUser);
                  }

                  chat.renderSuggestedActions([{
                     title: "Ask for a grid",
                     value: "Who are the top 4 sales staff at Cycle Corp?"
                  }, {
                     title: "Show confirmation",
                     value: "Confirmation demo"
                  },
                  {
                     title: "Produce code",
                     value: "Write me some script to make the text in field ARSPEN.SalesTotal green if the value is greater than for the same period, previous year, and red if the value is smaller than for the same period, previous year."
                  }]); 
               });
               // setTimeout(function() {
               //    chat.renderUserTypingIndicator(daVinciUser);
               // }, 400);
               // setTimeout(function() {
               //    chat.renderMessage({
               //       type: "text",
               //       text: "Sorry I'm not sure what you mean 🤪 did you want to do one of these pre-formulated actions?"
               //    }, daVinciUser);
                                
               // }, 1500);
            }
        },
        actionClick: function(e) {
      /* The result can be observed in the DevTools(F12) console of the browser. */
            console.log(this);
            if (e.text === "Please provide more technical information.") {
               setTimeout(function() {
                  chat.renderUserTypingIndicator(daVinciUser);
                  $(".k-typing-indicator-bubble .k-author").text("Da Vinci is thinking");
               }, 400);
               technicalInfo();
            } else if (e.text === "There's something wrong with this.") {
               setTimeout(function() {
                  chat.renderUserTypingIndicator(daVinciUser);
                  $(".k-typing-indicator-bubble .k-author").text("Da Vinci is thinking");
               }, 400);
               setTimeout(function() {
                  chat.renderMessage({
                     type: "text",
                     text: "Sorry to hear that, can you describe the problem?"
                  }, daVinciUser);
               }, 1500);
               
            } else if (e.text === "Who are the top 4 sales staff at Cycle Corp?") {
               setTimeout(function() {
                  chat.renderUserTypingIndicator(daVinciUser);
                  $(".k-typing-indicator-bubble .k-author").text("Da Vinci is thinking");
               }, 400);
               setTimeout(function() {
                  chat.renderAttachments({
                     attachments: [{
                        contentType: "GridComponent",
                        content: {
                           dataSource: [ { firstName: "John",
                              lastName: "Smith",
                              email: "john.smith@telerik.com" },
                           { firstName: "Jane",
                              lastName: "Smith",
                              email: "jane.smith@telerik.com" },
                           { firstName: "Josh",
                              lastName: "Davis",
                              email: "josh.davis@telerik.com" },
                           { firstName: "Cindy",
                              lastName: "Jones",
                              email: "cindy.jones@telerik.com" }
                        ]
                        }
                        // content: {
                        // value: new Date()
                        // }
                     }]
                  }, daVinciUser);
                  chat.renderSuggestedActions([{
                     title: "Show confirmation",
                     value: "Confirmation demo"
                  },
                  {
                     title: "Produce code",
                     value: "Write me some script to make the text in field ARSPEN.SalesTotal green if the value is greater than for the same period, previous year, and red if the value is smaller than for the same period, previous year."
                  }]);

                  initChatCardTooltips($(".k-message-list-content > div:last-child")[0]);
               }, 1500);
            } else if (e.text === "Confirmation demo") {
               setTimeout(function() {
                  chat.renderUserTypingIndicator(daVinciUser);
                  $(".k-typing-indicator-bubble .k-author").text("Da Vinci is thinking");
               }, 400);
               setTimeout(function() {
                  chat.renderAttachments({
                     attachments: [{
                        contentType: "davinciconfirm",
                        content: {
                           "title": "Confirm pending updates",
                           "content": "You have uploaded 16 files, and Da Vinci Vision will create 16 new Purchase Orders from these files. Da Vinci will inform you if any new Purchase Orders are missing required information. Would you like to proceed?",
                        }
                     }]
                  }, daVinciUser);

                  $(".k-message-list-content > div:last-child")[0].scrollIntoView();
                  initChatCardTooltips($(".k-message-list-content > div:last-child")[0]);
                  // chat.renderSuggestedActions([{
                  //    title: "Ask for a grid",
                  //    value: "Who are the top 4 sales staff at Cycle Corp?"
                  // },
                  // {
                  //    title: "Produce code",
                  //    value: "Write me some script to make the text in field ARSPEN.SalesTotal green if the value is greater than for the same period, previous year, and red if the value is smaller than for the same period, previous year."
                  // }]);
               }, 1500);
            } else if (e.text === "Go ahead") {
               setTimeout(function() {
                  chat.renderUserTypingIndicator(daVinciUser);
                  $(".k-typing-indicator-bubble .k-author").text("Da Vinci is thinking");
               }, 400);
               setTimeout(function() {
                  chat.renderMessage({
                     // attachments: [{
                     //    contentType: "davinciconfirmed",
                     //    content: {
                     //       "content": "16 files have been processed, and 16 new Purchase Orders created. 3 have required information missing.",
                     //    }
                     // }]
                     type: "text",
                     text: "16 files have been processed, and 16 new Purchase Orders created. 3 have required information missing."
                  }, daVinciUser);  
                  chat.renderSuggestedActions([{
                     title: "List Purchase Orders with issues",
                     value: "List Purchase Orders with issues"
                  },
                  {
                     title: "List 16 new Purchase Orders",
                     value: "List 16 new Purchase Orders"
                  },
                  {
                     title: "Open PO Query",
                     value: "Open PO Query"
                  }]);                
               }, 1500);
            } else if (e.text === "List 16 new Purchase Orders" || e.text === "List Purchase Orders with issues") {
               setTimeout(function() {
                  chat.renderUserTypingIndicator(daVinciUser);
                  $(".k-typing-indicator-bubble .k-author").text("Da Vinci is thinking");
               }, 400);
               setTimeout(function() {
                  chat.renderAttachments({
                     attachments: [{
                        contentType: "davinciconfirmed",
                        content: {
                           "content": "<ul><li><a>PO B332DX</a></li><li><a>PO B332DX</a></li><li><a>PO B332DX</a></li></ul>",
                        }
                     }]
                  }, daVinciUser);  
                  initChatCardTooltips($(".k-message-list-content > div:last-child")[0]);
                  // chat.renderSuggestedActions([{
                  //    title: "List Purchase Orders with issues",
                  //    value: "List Purchase Orders with issues"
                  // },
                  // {
                  //    title: "List 16 new Purchase Orders",
                  //    value: "List 16 new Purchase Orders"
                  // },
                  // {
                  //    title: "Open PO Query",
                  //    value: "Open PO Query"
                  // }]);                
               }, 1500);
            } else if (e.text === "Write me some script to make the text in field ARSPEN.SalesTotal green if the value is greater than for the same period, previous year, and red if the value is smaller than for the same period, previous year.") { 
               setTimeout(function() {
                  chat.renderUserTypingIndicator(daVinciUser);
                  $(".k-typing-indicator-bubble .k-author").text("Da Vinci is thinking");
               }, 400);
               setTimeout(function() {
                  chat.renderAttachments({
                     attachments: [{
                        contentType: "davincicode",
                        // content: {
                        // value: new Date()
                        // }
                     }]
                  }, daVinciUser);
                  hljs.highlightAll();
                  chat.renderSuggestedActions([{
                     title: "Show confirmation",
                     value: "Confirmation demo"
                  },
                  {
                     title: "Ask for a grid",
                     value: "Who are the top 4 sales staff at Cycle Corp?"
                  }]);
                  initChatCardTooltips($(".k-message-list-content > div:last-child")[0]);
               }, 1500);
            
            } else {
               setTimeout(function() {
                  chat.renderUserTypingIndicator(daVinciUser);
                  $(".k-typing-indicator-bubble .k-author").text("Da Vinci is thinking");
               }, 400);
               setTimeout(function() {
                  chat.renderMessage({
                     type: "text",
                     text: "Sorry I'm not sure what you mean 🤪 - did you want to do one of these pre-formulated actions?"
                  }, daVinciUser);
                  chat.renderSuggestedActions([{
                     title: "Ask for a grid",
                     value: "Who are the top 4 sales staff at Cycle Corp?"
                  }, {
                     title: "Show confirmation",
                     value: "Confirmation demo"
                  },
                  {
                     title: "Produce code",
                     value: "Write me some script to make the text in field ARSPEN.SalesTotal green if the value is greater than for the same period, previous year, and red if the value is smaller than for the same period, previous year."
                  }]);               
               }, 1500);

               
            }
            
            // e.preventDefault();
      }
   }).data("kendoChat");

   // chat.renderSuggestedActions([{
   //      title: "Ask for a grid",
   //      value: "Who are the top 4 sales staff at Cycle Corp?"
   //  }, {
   //    title: "Show confirmation",
   //    value: "Confirmation demo"
   //  },
   //  {
   //    title: "Produce code",
   //    value: "Write me some script to make the text in field ARSPEN.SalesTotal green if the value is greater than for the same period, previous year, and red if the value is smaller than for the same period, previous year."
   //  }]);


   function technicalInfo() {
      
      // const popoverId = $(this).closest(".daVinciPopover").attr("id");
      // const trigger = $(`[aria-describedby="${popoverId}"]`);
      // const contentId = trigger.attr("data-content-id");
      setTimeout(function() {
         chat.clearUserTypingIndicator(daVinciUser);
         chat.renderAttachments({
            attachments: [{
               contentType: "technicalinfo",
               content: {
                  "title": techInfo["tile"].title,
                  "content": techInfo["tile"].content,
                  // "make": "Opel",
                  // "model": "Astra",
                  // "worth": "4000",
                  // "startDate": "2018-10-10"
               }
            }],
            attachmentLayout: "list"
         }, daVinciUser);
         $(".k-message-list-content > div:last-child")[0].scrollIntoView();
         initChatCardTooltips($(".k-message-list-content > div:last-child")[0]);
      }, 3000);
      
      
   };
    
   function initWizard() {
      $("#wizard").kendoWizard({
         pager: true,
         done: function (e) {
            e.originalEvent.preventDefault();
            chat.renderMessage({
               type: "text",
               text: 'Great, the new XXX is now saved and accessible here.'
            }, daVinciUser);
         },
         steps: [
            {
                  title: "Step 1",
                  buttons: ["next"],
                  form: {
                     orientation: "vertical",
                     formData: {
                        One: "Some value",
                        Two: "Another value",
                        Three: "And more value",
                     },
                     items: [
                        { field: "One", label: "Some field:", validation: { required: true } },
                        { field: "Two", label: "Another field:", validation: { required: true } },
                        { field: "Three", label: "And another:", validation: { required: true }, hint: "Hint: enter alphanumeric characters only." }
                     ]
                  }
            },
            {
                  title: "Step 2",
                  buttons: ["previous", "done"],
                  form: {
                     orientation: "vertical",
                     items: [
                        { field: "ConfigName", label: "Config name", validation: { required: true } },
                        {
                              field: "ConfigOptions",
                              label: "Config options:",
                              validation: { required: true },
                              editor: "RadioGroup",
                              editorOptions: {
                                 items: ["One", "Two", "Three"],
                                 layout: "horizontal",
                                 labelPosition: "before"
                              }
                        },
                        { field: "About", label: { text: "About:", optional: true } }
                     ]
                  }
            }]
      });
   }

   var salesData = [
            {
                "country": "United States",
                "year": "2012",
                "value": 30.1
            },
            {
                "country": "United States",
                "year": "2013",
                "value": 35.9
            },
            {
                "country": "United States",
                "year": "2014",
                "value": 43.1
            },
            {
                "country": "United States",
                "year": "2015",
                "value": 49.2
            },
            {
                "country": "United States",
                "year": "2016",
                "value": 59.0
            },
            {
                "country": "United States",
                "year": "2017",
                "value": 61.9
            },
            {
                "country": "United States",
                "year": "2018",
                "value": 65
            },
            {
                "country": "United States",
                "year": "2019",
                "value": 68.3
            },
            {
                "country": "United States",
                "year": "2020",
                "value": 69.2
            },
            {
                "country": "United States",
                "year": "2021",
                "value": 75.3
            },
            {
                "country": "United States",
                "year": "2022",
                "value": 74.2
            },
            
        ];
            const futureSales = [
            {
                "country": "United States",
                "year": "2022",
                "value": 74.2,
               //  "noteText": "Something"
            },
            {
                "country": "United States",
                "year": "2023",
                "value": 71.2
            },
            {
                "country": "United States",
                "year": "2024",
                "value": 74.2
            },
            {
                "country": "United States",
                "year": "2025",
                "value": 78.2,
               //  "noteText": "Something"
            }
         ];
            
      function createChart() {
            $("#chart").kendoChart({
               //  dataSource: {
               //      data: salesData
               //  },
               theme: "material",
                title: {
                    text: "Sales performance"
                },
                legend: {
                    visible: false
                },
                seriesDefaults: {
                    type: "line",
                    labels: {
                        visible: true,
                        format: "${0}m",
                        background: "transparent"
                    }
                },
                seriesClick: function(e) {
                     if (e.series.name === "dvp") {
                        // Disable browser context menu
                        daVinciWindow.open();
                        setTimeout(function(){
                           $("#daVinciChat .k-message-box input").focus();
                        }, 220);
                        chat.renderAttachments({
                           attachments: [{
                              contentType: "davinciresponse",
                              content: {
                                 "title": "Da Vinci trend prediction",
                                 "content": "The data points on the dashed purple line are calculated by Da Vinci's trend prediction model. The model learns from your data, and estimates future values based on identified trends.",
                                 // "make": "Opel",
                                 // "model": "Astra",
                                 // "worth": "4000",
                                 // "startDate": "2018-10-10"
                              }
                           }],
                           attachmentLayout: "list"
                        }, daVinciUser);
                        $(".k-message-list-content > div:last-child")[0].scrollIntoView();
                        initChatCardTooltips($(".k-message-list-content > div:last-child")[0]);
                     }
                  },
                series: [{
                     data: salesData,
                    field: "value",
                    categoryField: "year",
                    name: "United States",
                    highlight: {
                     inactiveOpacity: 0.5
                     }
                },
                {
                     data: futureSales,
                     dashType: "dash",
                    field: "value",
                    categoryField: "year",
                    name: "dvp",
                    color: "#7B1FA2",
                    highlight: {
                     inactiveOpacity: 0.5,
                     visual: function(e) {
                        var group = new kendo.drawing.Group();
                        
                        var center = e.rect.center();
                        var circleGeometry = new kendo.geometry.Circle(center, 10);
                        var circle = new kendo.drawing.Circle(circleGeometry, {
                           fill: {
                              color: "#7B1FA2"
                           },
                           stroke: null,
                           cursor: "pointer"
                        });

                        var src = "img/davinci.png";
                        var image = new kendo.drawing.Image(src, e.rect);
                        image.options.cursor = "pointer";
                        group.options.cursor = "pointer";

                        group.append(circle, image);
                        return group;
                     }
                     }
                  //   noteTextField: "noteText",
                  //    notes: {
                  //       label: {
                  //          // template: "#: value #",
                        
                  //       },
                  //       position: "bottom"
                  //    },
                  //    markers: {
                  //       size: 32,
                  //       visual: function (e) {
                  //           var src = "img/davinci.png";
                  //           var image = new kendo.drawing.Image(src, e.rect);
                  //           return image;
                  //       },
                  //       background: "#000",
                  //   }
                }],
                valueAxis: {
                    labels: {
                        format: "${0}m"
                    },
                    line: {
                        visible: false
                    }
                },
                categoryAxis: {
                    majorGridLines: {
                        visible: false
                    }
                }
            });
        }
        
         const exampleEl = document.getElementById('example')
         $(".daVinciPopoverTrigger").each(function(idx, elem) {
            const title = $(elem).attr("data-bs-title") || "Da Vinci Generated Text";
            const popover = new bootstrap.Popover(elem, {
               html: true,
               title: title,
               trigger: "click focus",
               template: '<div class="popover" role="popover"><div class="popover-arrow"></div><h3 class="popover-header"><i class="material-icons">auto_awesome</i> Da Vinci Generated Text</h3><div class="popover-body"></div><div class="popover-footer sys-bg-very-light-gray"><a data-bs-toggle="tooltip" data-bs-title="Ping" class="showmodelcard" href="#"><i class="material-icons sys-fg-gray sys-txt-sm">edit_note</i></a><a class="conflevel" href="#"><i class="material-icons sys-fg-success sys-txt-sm">data_usage</i><span class="sys-fg-gray sys-txt-sm sys-mg-l-5">84%</span></a><a class="daVinciTellMore" href="#"><i class="sys-txt-sm material-icons sys-fg-primary">question_mark</i></a></div></div>'
            });
         });

         $(".daVinciDataPopoverTrigger").each(function(idx, elem) {
            const title = $(elem).attr("data-bs-title") || "DaVinci insight";
            const popover = new bootstrap.Popover(elem, {
               html: true,
               title: title,
               trigger: "click focus",
               template: '<div class="popover" role="popover"><div class="popover-arrow"></div><h3 class="popover-header"><i class="material-icons">auto_awesome</i> Da Vinci Insight</h3><div class="popover-body"></div><div class="popover-footer sys-bg-very-light-gray"><a data-bs-toggle="tooltip" data-bs-title="Ping" class="showmodelcard" href="#"><i class="material-icons sys-fg-gray sys-txt-sm">insights</i></a><a class="conflevel" href="#"><i class="material-icons sys-fg-warning sys-txt-sm">data_usage</i><span class="sys-fg-gray sys-txt-sm sys-mg-l-5">65%</span></a><a class="daVinciTellMoreData" href="#"><i class="sys-txt-sm material-icons sys-fg-primary">question_mark</i></a></div></div>'
            });
         });

         $(".daVinciAutoPopoverTrigger").each(function(idx, elem) {
            const title = $(elem).attr("data-bs-title") || "Da Vinci Automated Process";
            const popover = new bootstrap.Popover(elem, {
               html: true,
               title: title,
               trigger: "click focus",
               template: '<div class="popover" role="popover"><div class="popover-arrow"></div><h3 class="popover-header"><i class="material-icons">auto_awesome</i> Da Vinci Automated Process</h3><div class="popover-body"></div><div class="popover-footer sys-bg-very-light-gray"><a data-bs-toggle="tooltip" data-bs-title="Ping" class="showmodelcard" href="#"><i class="material-icons sys-fg-gray sys-txt-sm">smart_toy</i></a><a class="daVinciTellMoreAuto" href="#"><i class="sys-txt-sm material-icons sys-fg-primary">question_mark</i></a></div></div>'
            });
         });

         $(".davincifield").each(function(idx, elem) {
            const popover = new bootstrap.Popover(elem, {
               html: true,
               title: "Da Vinci Generated Data",
               trigger: "hover",
               content: "Field value generated by Da Vinci",
               customClass: "daVinciPopover",
               template: '<div class="popover" role="popover"><div class="popover-arrow"></div><h3 class="popover-header"><i class="material-icons">auto_awesome</i> Da Vinci Automated Process</h3><div class="popover-body">Field value generated by Da Vinci</div><div class="popover-footer sys-bg-very-light-gray"><a data-bs-toggle="tooltip" data-bs-title="Ping" class="showmodelcard" href="#"><i class="material-icons sys-fg-gray sys-txt-sm">edit_note</i></a><a class="conflevel" href="#"><i class="material-icons sys-fg-success sys-txt-sm">data_usage</i><span class="sys-fg-gray sys-txt-sm sys-mg-l-5">84%</span></a><a class="daVinciTellMore" href="#"><i class="sys-txt-sm material-icons sys-fg-primary">question_mark</i></a></div></div>'
            });
         });
         
         // $(document).on("click", ".daVinciPopoverTrigger", function(e) {

         // });
         function initChatCardTooltips(elem) {
            $('[data-bs-toggle="tooltip"]', elem).each(function(idx, element) {
               const tooltip = new bootstrap.Tooltip(element);
            });            
         }

         $(document).on("click", ".daVinciTellMore", function(e) {
            const popoverId = $(this).closest(".daVinciPopover").attr("id");
            const trigger = $(`[aria-describedby="${popoverId}"]`);
            const contentId = trigger.attr("data-content-id");
            const popover = bootstrap.Popover.getInstance(trigger[0]);
            popover.hide();
            daVinciWindow.open();
            setTimeout(function(){
               $("#daVinciChat .k-message-box input").focus();
            }, 220);
            // chat.renderMessage({
            //    type: "text",
            //    text: popoverId
            // }, daVinciUser);

            chat.renderAttachments({
               attachments: [{
                  contentType: "davincisumresponse",
                  content: {
                     "title": responses[contentId].title,
                     "content": responses[contentId].content,
                     // "make": "Opel",
                     // "model": "Astra",
                     // "worth": "4000",
                     // "startDate": "2018-10-10"
                  }
               }],
               attachmentLayout: "list"
            }, daVinciUser);

            $(".k-message-list-content > div:last-child")[0].scrollIntoView();
            initChatCardTooltips($(".k-message-list-content > div:last-child")[0]);
            // chat.renderSuggestedActions([{
            //    title: "Tell me more",
            //    value: "more"
            // }]);
         });

         $(document).on("click", ".daVinciTellMoreData", function(e) {
            const popoverId = $(this).closest(".daVinciPopover").attr("id");
            const trigger = $(`[aria-describedby="${popoverId}"]`);
            const contentId = trigger.attr("data-content-id");
            const popover = bootstrap.Popover.getInstance(trigger[0]);
            popover.hide();
            daVinciWindow.open();
            setTimeout(function(){
               $("#daVinciChat .k-message-box input").focus();
            }, 220);

            chat.renderAttachments({
               attachments: [{
                  contentType: "davincitileresponse",
                  content: {
                     "title": responses[contentId].title,
                     "content": responses[contentId].content,
                  }
               }],
               attachmentLayout: "list"
            }, daVinciUser);

            $(".k-message-list-content > div:last-child")[0].scrollIntoView();
            initChatCardTooltips($(".k-message-list-content > div:last-child")[0]);
         });

         $(document).on("click", ".daVinciTellMoreAuto", function(e) {
            const popoverId = $(this).closest(".daVinciPopover").attr("id");
            const trigger = $(`[aria-describedby="${popoverId}"]`);
            const contentId = trigger.attr("data-content-id");
            const popover = bootstrap.Popover.getInstance(trigger[0]);
            popover.hide();
            daVinciWindow.open();
            setTimeout(function(){
               $("#daVinciChat .k-message-box input").focus();
            }, 220);

            chat.renderAttachments({
               attachments: [{
                  contentType: "davinciautoresponse",
                  content: {
                     "title": responses[contentId].title,
                     "content": responses[contentId].content,
                  }
               }],
               attachmentLayout: "list"
            }, daVinciUser);

            $(".k-message-list-content > div:last-child")[0].scrollIntoView();
            initChatCardTooltips($(".k-message-list-content > div:last-child")[0]);
         });

         $(document).on("click", ".conflevel", function(e) {      
            const popoverId = $(this).closest(".daVinciPopover").attr("id");
            const trigger = $(`[aria-describedby="${popoverId}"]`);
            const contentId = trigger.attr("data-content-id");
            const popover = bootstrap.Popover.getInstance(trigger[0]);
            popover?.hide();
            daVinciWindow.open();      
            chat.renderAttachments({
               attachments: [{
                  contentType: "confidence",
                  content: {
                     
                  }
               }],
               attachmentLayout: "list"
            }, daVinciUser);

            $(".k-message-list-content > div:last-child")[0].scrollIntoView();
            // initChatCardTooltips($(".k-message-list-content > div:last-child")[0]);
         });

         $(document).on("click", ".showmodelcard", function(e) {      
            const popoverId = $(this).closest(".daVinciPopover").attr("id");
            const trigger = $(`[aria-describedby="${popoverId}"]`);
            const contentId = trigger.attr("data-content-id");
            const popover = bootstrap.Popover.getInstance(trigger[0]);
            popover?.hide();
            daVinciWindow.open();      
            chat.renderAttachments({
               attachments: [{
                  contentType: "models",
                  content: {
                     
                  }
               }],
               attachmentLayout: "list"
            }, daVinciUser);

            $(".k-message-list-content > div:last-child")[0].scrollIntoView();
            // initChatCardTooltips($(".k-message-list-content > div:last-child")[0]);
         });

         $("#files").kendoUpload({
                    async: {
                        saveUrl: "http://127.0.0.1:5500/UXTools/api/UXFileProviderWeb/UploadDocument",
                        removeUrl: "remove",
                        autoUpload: true,
                    },
                    validation: {
                        allowedExtensions: [".jpg", ".jpeg", ".png", ".bmp", ".gif", ".pdf", ".doc", ".docx", ".xls"],
                    },
                    // template: kendo.template($('#fileTemplate').html()),
                    success: onSuccess,
                    showFileList: true,
                    select: function(e) {
                        var fileInfo = e.files[0];
                        var wrapper = this.wrapper;

                        setTimeout(function(){
                            addPreview(fileInfo, wrapper);
                        });
                    }
                   // dropZone: ".fileUploadDropZone",
                });

                $(".k-dropzone")
                    .find("em")
                    .remove();
                  $(".k-dropzone")
                    .find(".k-dropzone-hint")
                    .remove();
                $(".k-dropzone .k-upload-button")
                    .find("span")
                    .text("Drop file here or click to upload");
                $(".k-dropzone .k-upload-button").prepend(
                    "<h3 class='sys-mg-t-10 sys-mg-r-10'><i class='material-icons text-muted'>cloud_upload</i></h3>"
                );

                function onSuccess(e) {
                    console.log('upload success!');  
                    $(".file-upload-details").show(300);                  
                }
                
                function addPreview(file, wrapper) {
                    var raw = file.rawFile;
                    var reader  = new FileReader();

                    if (raw) {
                    reader.onloadend = function () {
                        var preview = $("<img class='image-preview'>").attr("src", this.result);

                        wrapper.find(".k-file[data-uid='" + file.uid + "'] .k-file-extension-wrapper")
                        .replaceWith(preview);
                    };

                    reader.readAsDataURL(raw);
                    }
                }


        $(document).ready(createChart);

      const confGridData = [
         {
            name: "Bicycle Spokes",
            id: "00HG54",
            date: "09/10/2023",
            daysLate: 7,
            confidence: 0.55,
         },
         {
            name: "Racing Seat",
            id: "00HG52",
            date: "08/10/2023",
            daysLate: 5,
            confidence: 0.23,
         },
         {
            name: "ABS Brakes",
            id: "00TTG54",
            date: "07/10/2023",
            daysLate: 3,
            confidence: 1,
         },
         {
            name: "Racing Handlebar",
            id: "00JG89",
            date: "06/10/2023",
            daysLate: 8,
            confidence: 0.78,
         },
      ];

        $("#confGrid").kendoGrid({
            dataSource: {
               data: confGridData,
               pageSize: 20,
               schema: {
                  model: {
                        id: "id"
                  }
               }
            },
            dataBound: onDataBound,
               columns: [
                  {
                     field: "id",
                     title: "StockCode",
                     // width: 300
                  },
                  {
                     field: "name",
                     title: "Name",
                     // width: 300
                  },
                  {
                     field: "date",
                     title: "Date due",
                     // format: "{dd/MM/yyyy}"
                  },
                  {
                     field: "daysLate",
                     title: "Days late",
                     template: "<span><b>Expected #= daysLate# days late</b></span><span id='chart_#= id#' class='sparkline-chart pull-right'></span>",
                     width: 170,
                     headerTemplate: 'Expected Days Late <i class="material-icons pull-right align-right davinciicon-light sys-txt-sm">auto_awesome</i>'
                     // format: "{0:c}",
                  },

               ]
        });

        function onDataBound(e) {
            var grid = this;
            grid.table.find("tr").each(function () {
                var dataItem = grid.dataItem(this);
               
                $(this).find(".sparkline-chart").kendoSparkline({
                    legend: {
                        visible: false
                    },
                    series: [{
                        data: [{
                           value: dataItem.confidence * 100,
                           color: dataItem.confidence > 0.74 
                              ? "green"
                              : dataItem.confidence > 0.49 && dataItem.confidence < 0.75
                              ? "orange"
                              : "red",
                           
                        },
                        {
                           value: (1 - dataItem.confidence) * 100,
                           color: "#ccc",
                           
                        }                           
                           
                        ],
                        tooltip: {
                           visible: true,
                           background: "#444",
                           color: "#fff",
                           border: {
                              width: 0
                           },
                           template: function() {
                              var adjustConf = Math.round(dataItem.confidence * 100);
                              return adjustConf + "% chance";
                           }
                        }
                     }],
                    
                    type: "donut",
                    chartArea: {
                        margin: 0,
                        width: 30,
                        background: "transparent"
                    },
                    seriesDefaults: {
                     size: 4,
                     tooltip: {
                     visible: false
                    }
                    },
                    
                });

                kendo.bind($(this), dataItem);
            });
        }

        $('#faves-menu').kendoContextMenu({
            target: '[aria-labelledby="daVinciWindow_wnd_title"] .k-window-titlebar-action[aria-label="Heart"]',
            alignToAnchor: true,
            showOn: "click",
            select: function(e) {
               console.log(e.item);
               const query = $(e.item).find(".k-menu-link-text").text();
               chat.postMessage(query);
            }
         });


        $(document).on("click", ".clickable", function() {
         alert("Take the user to the relevant program in Avanti");
        });
   </script>
  
  </body>
</html>