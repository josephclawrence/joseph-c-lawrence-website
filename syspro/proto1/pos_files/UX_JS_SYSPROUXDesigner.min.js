function _readOnlyError(e){throw new Error("\""+e+"\" is read-only")}function ownKeys(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,o)}return a}function _objectSpread(e){for(var t=1,a;t<arguments.length;t++)a=null==arguments[t]?{}:arguments[t],t%2?ownKeys(Object(a),!0).forEach(function(t){_defineProperty(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))});return e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],o=!0,n=!1,d=void 0;try{for(var s=e[Symbol.iterator](),l;!(o=(l=s.next()).done)&&(a.push(l.value),!(t&&a.length===t));o=!0);}catch(e){n=!0,d=e}finally{try{o||null==s["return"]||s["return"]()}finally{if(n)throw d}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}var Dictionary=function(){function Dictionary(e){if(this._keys=[],this._values=[],e)for(var t=0;t<e.length;t++)this[e[t].key]=e[t].value,this._keys.push(e[t].key),this._values.push(e[t].value)}return Dictionary.prototype.add=function(e,t){this[e]=t,this._keys.push(e),this._values.push(t)},Dictionary.prototype.remove=function(e){var t=this._keys.indexOf(e,0);this._keys.splice(t,1),this._values.splice(t,1),delete this[e]},Dictionary.prototype.keys=function(){return this._keys},Dictionary.prototype.values=function(){return this._values},Dictionary.prototype.containsKey=function(e){return"undefined"!=typeof this[e]},Dictionary.prototype.toLookup=function(){return this},Dictionary}(),__extends=this&&this.__extends||function(){var e=function extendStatics(t,a){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},e(t,a)};return function(t,a){function __(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(__.prototype=a.prototype,new __)}}(),TypeAheadParent=function(){return function(){}}(),ProgramListItem=function(){return function(){}}(),FieldValueModel=function(){return function(){}}(),ErrorMessageModel=function(){return function(){}}(),GridInternalEventParameter=function(){return function(){}}(),ToolbarModel=function(e){function ToolbarModel(){return null!==e&&e.apply(this,arguments)||this}return __extends(ToolbarModel,e),ToolbarModel}(ErrorMessageModel),ModalWindowModel=function(){return function(){}}(),ESPQRY_SB_Results=function(){return function(){this.Query=new COMFNDQuery}}(),COMFNDQuery=function(){return function(){this.Search=new Search}}(),Search=function(){return function(){this.GlobalValue="",this.GlobalValue1="",this.GlobalValue2="",this.Columns=new Columns,this.Where=new Where,this.OrderBy=new Columns}}(),Columns=function(){return function(){}}(),Where=function(){return function(){this.Expression=[]}}(),Expression=function(){return function(){}}(),ColumnMetadata=function(){return function(){this.ColumnValues=new ColumnValues}}(),ColumnValues=function(){return function(){this.ColumnValue=[]}}(),ColumnValue=function(){return function(){}}(),Results=function(){return function(){this.HeaderDetails=new HeaderDetails,this.Rows=[]}}(),Row=function(){return function(){}}(),HeaderDetails=function(){return function(){this.Columns=new Columns,this.OrderBy=new Columns,this.ColumnMetadata=new ColumnMetadataColumn}}(),ColumnMetadataColumn=function(){return function(){this.Columns=[]}}(),ESPQSCResult=function(){return function(){this.Query=new ESPQSCQuery}}(),ESPQSCQuery=function(){return function(){this.Item=new ESPQSCItem}}(),ESPQSCItem=function(){return function(){this.Columns=new ESPQSCColumns}}(),ESPQSCColumns=function(){return function(){this.Categories=[]}}(),ESPQSCCategories=function(){return function(){this.Column=[]}}(),ESPQSCColumn=function(){return function(){this.ColumnValues=[]}}(),ESPQSCColumnValue=function(){return function(){this.ColumnValue=[]}}(),ESPQSCColumnValueDetails=function(){return function(){}}(),QueryLayoutUIHelpersClass=function(){var _NumberPOSITIVE_INFINITY=Number.POSITIVE_INFINITY,_Mathfloor=Math.floor;function QueryLayoutUIHelpersClass(){this.offCanvasesCreated=[],this.tilesCreated=[],this.kendoWindowsCreated=[],this.resizeToFunction=null,this.programListTypeahead=[],this.typeParent=new TypeAheadParent,this.kendoWindowsCreatedInContainer=new Dictionary([])}return QueryLayoutUIHelpersClass.prototype.formatLongNumber=function(e,t){return t||(t="n0"),0==e?"0":999>=e?kendo.toString(e,t):1e3<=e&&999999>=e?kendo.toString(e/1e3,t)+"K":1e6<=e&&999999999>=e?kendo.toString(e/1e6,t)+"M":1e9<=e&&999999999999>=e?kendo.toString(e/1e9,t)+"B":kendo.toString(e,t)},QueryLayoutUIHelpersClass.prototype.addWindowToTrackingList=function(e,t){t?this.kendoWindowsCreatedInContainer[t]?this.kendoWindowsCreatedInContainer[t].push(e):this.kendoWindowsCreatedInContainer[t]=[e]:this.kendoWindowsCreated.push(e)},QueryLayoutUIHelpersClass.prototype.disposeOfWindows=function(e){if(!e)for(;0<this.kendoWindowsCreated.length;){var t=this.kendoWindowsCreated.pop();$.each($(".syspro-grid-list",t.element),function(){$(this).data("kendoGrid")&&$(this).data("kendoGrid").destroy()}),t.destroy()}else if(this.kendoWindowsCreatedInContainer[e])for(;0<this.kendoWindowsCreatedInContainer[e].length;){var t=this.kendoWindowsCreatedInContainer[e].pop();$.each($(".syspro-grid-list",t.element),function(){$(this).data("kendoGrid")&&$(this).data("kendoGrid").destroy()}),t.destroy()}},QueryLayoutUIHelpersClass.prototype.initializeIconSelector=function(){sysproInterop.getIconsAvailable(function(e){$("#icontreeview").kendoListView({template:kendo.template($("#icon-treeview-template").html()),dataSource:e,dataBound:function dataBound(){this.initializeTooltips(),$(".icon-item").click(function(){sysproInterop.iconSelected($("#icontreeview").data("kendoListView").dataItem(this))})}})},function(){});var e=function handleTextBox(t){return function(a){("keypress"!=a.type||kendo.keys.ENTER==a.keyCode)&&t(a)}}(function(){var e=$("#filterText").val(),t=$("#icontreeview").data("kendoListView");t.dataSource.filter({field:"Description",operator:"contains",value:e})});$("#filterText").keypress(e)},QueryLayoutUIHelpersClass.prototype.initializeTooltips=function(){0<$("[data-tooltip=\"tooltip\"]").length&&($(":not(.k-grid-toolbar) [data-tooltip=\"tooltip\"]").tooltip(),$("body").tooltip({selector:".k-grid-toolbar [data-tooltip=\u201Ctooltip\u201D]",trigger:"hover",container:"body"}),$("body").off("mouseleave",".k-grid-toolbar [data-tooltip=\"tooltip\"]").on("mouseleave",".k-grid-toolbar [data-tooltip=\"tooltip\"]",function(){$(".k-grid-toolbar [data-tooltip=\"tooltip\"]").tooltip("hide"),$("body > .tooltip").remove()}))},QueryLayoutUIHelpersClass.prototype.initializeDragDrop=function(){var e=this;SYSPRO_VB.initProgramListTileDragging(function(t,a,o,n,d){var s=t,l=t.closest(".layout-widget").data("guid"),r=!1,c=a,p="",u=d;"Tile"===n?(n=d,u=a,r=!0):(c=o,!u&&(u=o),p=a),sysproInterop.getModel(l,function(t){if(t&&t.Rows&&0<t.Rows.length&&t.Rows[0].Columns){var d=0,c=[0,2,7,4,8,1,6,3,9];if(0<t.Rows[0].Columns.length&&t.Rows[0].Columns[0].Widgets&&0<t.Rows[0].Columns[0].Widgets.length){var m=t.Rows[0].Columns[0].Widgets[0].BackgroundColor;d=1<c.indexOf(m)?c[c.indexOf(m)-1]:c.length-1}var g={TileType:n,TileTypeIcon:null,TileTypeIconColor:0,TileTypeDetail:u,TileTypeName:a,ParentFieldPath:p,Details:{Color:9,Size:0,Name:null,Visibility:!1,Alignment:0,Weight:0,Tooltip:null},TileWidth:2,TileParameters:{},SubType:"DragDropRequest",Title:o,PrimaryStyle:0,SecondaryStyle:0,WidgetName:null,Collapsible:!1,IsCollapsibleOpen:!1,Border:0,BackgroundColor:d,TitleBackground:0,TitleForeground:0,Id:sysproInterop.generateUUID(),Index:0,index:0,TypeName:"Tile",HasChildren:!1};sysproInterop.getHtmlFromModel("Widget",g,function(t){$(".tile-width-marker",$(".tile-widget",s)).after(t),e.disposeViewOnly(null),e.initializeViewOnly(null,s,null),sysproInterop.subscribeToFieldEvents(),r&&sysproInterop.bindTiles(sysproInterop.viewModel,$(".tile-widget",s),"",null)},null,null,null,null,function(e){console.log("getHtmlFromModel for tile error - "+e.message)},null),t.Rows[0].Columns.unshift({Widgets:[g]}),sysproInterop.setModel(l,t,function(t){t?(console.log("SetModel performed"),sysproInterop.getModel("",function(e){sysproInterop.triggerModelChanged(e)},null,null)):console.log("SetModel not performed. No Id found.")},function(){})}},null,null)})},QueryLayoutUIHelpersClass.prototype.createTimestamp=function(e){var t=kendo.parseDate(e,"yyyy-MM-dd");return t?t.getTime():0},QueryLayoutUIHelpersClass.prototype.initializeViewOnly=function(e,t,a){var o=this;if($.material&&!e&&$.material.init(),t){var n=$(".container-id-holder",t).data("containerid");n&&(t=$.merge(t,$("*[data-parentwindowid='"+n+"']")))}o.initSliders(t),$(".minimize-column",t).off("click"),$(".minimize-column",t).on("click",function(){var e=$(this).closest(".column-parent");e.hasClass("minimized")?e.removeClass("minimized"):e.addClass("minimized")}),$.each($(".modal-center"),function(){var e=this.id,n=$(this);if(!n.data("kendoWindow")){var d=$(".offcanvas-toggle[data-target=\"#"+e+"\"]",t);d.removeClass("offcanvas-toggle"),d.addClass("in-modal-window"),o.addWindowToTrackingList(SYSPRO_VB.createKendoWindow(e,n.data("modaltitle"),function(){},function(){},["Close"],null,null,!0,!0,!1,null,null),a),d.on("click",function(){if(n.data("kendoWindow"))n.data("kendoWindow").center().open();else{var t=SYSPRO_VB.createKendoWindow(e,n.data("modaltitle"),function(){},function(){},["Close"],null,null,!0,!0,!1,null,null);o.addWindowToTrackingList(t,a),t.center().open()}sysproInterop.gridHelpers.requestGridListsRefresh(n),0<$(".tile-widget",n).length&&sysproInterop.bindTiles(sysproInterop.viewModel,$(".tile-widget",n),"",null)})}}),$("a[data-toggle=\"tab\"]").on("shown.bs.tab",function(e){var t=$(e.target).attr("href");o.hiddenSectionShown($(t)),"PoS"===callLayerInterop.runningMode&&sysproInterop.eventTrigged(e.target.getAttribute("data-tabidentifier"),"","","","tabPageShown",function(){},!1)}),$(document).on("shown.bs.collapse",function(e){o.hiddenSectionShown(e.target)}),$("[data-toggle=\"offcanvas\"]").each(function(){if(!$(this).hasClass("in-modal-window"))if($(this).data("isocinitialized"));else{var e;return $(this).data("isocinitialized","true"),e=new Offcanvas($(this)),e}});var d=function(){var e,t;if(!!$(this).hasClass("js-offcanvas-has-events"))t=$(this).attr("data-target"),e=$(t),sysproInterop.gridHelpers.requestGridListsRefresh(e),0<$(".tile-widget",e).length&&sysproInterop.bindTiles(sysproInterop.viewModel,$(".tile-widget",e),"",null);else if(t=$(this).attr("data-target"),e=$(t),e)return e.removeClass("in"),$("body").removeClass("offcanvas-stop-scrolling"),$("body").css({overflow:"",position:""})};$(".offcanvas-toggle",t).each(function(){$(this).off("click",d),$(this).on("click",d)}),$("*[data-target='#offcanvas-avanti-notifications']").one("click",function(){sysproInterop.bindAvantiNotifications($("#fusion-sidebar-wrapper2"))});var s;s={autoinit:!1},$(".dropdown-select",t).dropdown(s),$(".datetimepicker",t).datetimepicker({sideBySide:!1,showClose:!0,keepOpen:!0,allowInputToggle:!0,format:sysproInterop.dateFormat.toUpperCase()+" HH:mm"}),$(".date",t).datepicker({format:sysproInterop.dateFormat.toLowerCase(),maxViewMode:2,todayBtn:!0,autoclose:!0,todayHighlight:!0,showOnFocus:!1,zIndexOffset:1e6});$(".combobox:not(.combobox-initialized)").combobox({bsVersion:"3",clearIfNoMatch:!1});$(".combobox:not(.combobox-initialized)").addClass("combobox-initialized"),this.initializeTooltips();var l=this;$.each($(".tile-widget",t),function(){var e=$(this).packery({itemSelector:".tile:not(.tile-width-marker)",gutter:0,columnWidth:142,transitionDuration:"0.27s"});e.packery("layout"),l.tilesCreated.push(e)}),$("form",t).on("submit",function(t){return t.preventDefault(),!1}),this.initializeDragDrop(),$(document).ready(function(){$(document).off("click",".disabled, .disabled a"),$(document).on("click",".disabled, .disabled a",function(t){t.stopImmediatePropagation()}),$(window).resize(function(){o.resizeTO&&clearTimeout(o.resizeTO),o.resizeTO=setTimeout(function(){$(this).trigger("resizeEnd")},250)}),$(window).bind("resizeEnd",function(){sysproInterop.sizeTiles(0,null)});var e=Packery.prototype._resetLayout;Packery.prototype._resetLayout=function(){e.call(this);var t=getSize(this.element.parentNode),a=this.columnWidth+this.gutter;this.fitWidth=_Mathfloor((t.innerWidth+this.gutter)/a)*a,this.packer.width=this.fitWidth,this.packer.height=_NumberPOSITIVE_INFINITY,this.packer.reset()},Packery.prototype._getContainerSize=function(){for(var e=0,t=0,a=this.packer.spaces.length,o;t<a;t++)o=this.packer.spaces[t],0===o.y&&o.height===_NumberPOSITIVE_INFINITY&&(e+=o.width);return{width:this.fitWidth-this.gutter-e,height:this.maxY-this.gutter}},Packery.prototype.needsResizeLayout=function(){return!0},sysproInterop.initiateExistingTiles(),sysproInterop.sizeTiles(0,null)})},QueryLayoutUIHelpersClass.prototype.hiddenSectionShown=function(e){0<$(".syspro-grid-list",e).length&&$.each($(".syspro-grid-list",e),function(){var e=$(this);e.data("kendoGrid")&&(e.data("kendoGrid").refresh(),sysproInterop.gridHelpers.requestGridListsRefresh(e.parent()))}),0<$(".tile-widget",e).length&&sysproInterop.bindTiles(sysproInterop.viewModel,$(".tile-widget",e),"",null),sysproInterop.resizeSparklines(e)},QueryLayoutUIHelpersClass.prototype.initSliders=function(containerDiv){var queryLayoutHelper=this,sliders=$(".slider",containerDiv);$.each(sliders,function(index){var sliderCreated=!1,slider=this;slider.noUiSlider&&(sliderCreated=!0);var currValue=[30];this.getAttribute("data-fieldvalue")&&"undefined"!==this.getAttribute("data-fieldvalue")&&(currValue=[parseInt(this.getAttribute("data-fieldvalue"))]);var sliderInput=this,minValue=0,maxValue=100,isNotBound=$(this).hasClass("nonbound-slider"),connectValue;connectValue=[!0,!1];var isDateSlider=$(this).hasClass("avanti-date-slider"),isSentimentSlider=$(this).hasClass("avanti-sentiment-slider"),sliderTooltip=$(this).data("avanti-slider-tooltip-format"),changeEvent=$(this).data("slider-event-change"),stepsIn=null;$(this).data("avanti-slider-steps")&&(stepsIn=parseFloat($(this).data("avanti-slider-steps")));var tooltipsIn=[];if(isNotBound){var startvalueInput=this.getAttribute("data-slider-startvalue");if(isDateSlider){var startValueNumber=0;startvalueInput&&(startValueNumber=queryLayoutHelper.createTimestamp(this.getAttribute("data-slider-startvalue")));var endValueNumber=queryLayoutHelper.createTimestamp(this.getAttribute("data-slider-endvalue"));if(0===startValueNumber||0===endValue)return void this.setAttribute("data-slider-status","disabled");var startValueOut=startValueNumber.toString();startValueOut&&(startValueOut=kendo.toString(new Date(parseFloat(startValueOut)),"yyyy-MM-dd"));var endValueOut=endValueNumber.toString();endValueOut&&(endValueOut=kendo.toString(new Date(parseFloat(endValueOut)),"yyyy-MM-dd")),sliderInput.setAttribute("data-slider-startvalue",startValueOut),sliderInput.setAttribute("data-slider-endvalue",endValueOut),minValue=queryLayoutHelper.createTimestamp(this.getAttribute("data-slider-min")),maxValue=queryLayoutHelper.createTimestamp(this.getAttribute("data-slider-max")),stepsIn=604800000;var formatInput={to:function to(e){return kendo.toString(new Date(e),sysproInterop.dateFormat)},from:function from(e){return kendo.toString(new Date(e),sysproInterop.dateFormat)}};startvalueInput?(currValue=[startValueNumber,endValueNumber],connectValue=[!1,!0,!1],tooltipsIn=[formatInput,formatInput]):(currValue=[endValueNumber],connectValue=!0,tooltipsIn=[formatInput])}else if(isSentimentSlider){var startValue=0;startvalueInput&&(startValue=parseInt(this.getAttribute("data-slider-startvalue")));var tooltipformat={to:function to(e){var t="",a="",o="";switch(!0){case 7<e:t="Very satisfied",o="sentiment_very_satisfied",a="sys-fg-success";break;case 2<e&&6>e:t="Satisfied",o="sentiment_satisfied",a="sys-fg-success";break;case-2<e&&3>e:o="sentiment_neutral",t="Neutral",a="text-info";break;case-5<e&&-1>e:o="sentiment_dissatisfied",t="Dissatisfied",a="sys-fg-warning";break;case-5>e:o="sentiment_very_dissatisfie",t="Very dissatisfied",a="sys-fg-danger";break;default:o="sentiment_very_satisfied",t="Very satisfied";}return setTimeout(function(){$.each($(".noUi-tooltip"),function(){$(this).html($(this).html().replace(t,"<i class=\"avanti-sentiment-image-slider material-icons "+a+"\">"+o+"</i>"))})},200),t},from:function from(e){return queryLayoutHelper.formatLongNumber(e,sliderTooltip)}},endValue=parseInt(this.getAttribute("data-slider-endvalue"));minValue=parseInt(this.getAttribute("data-slider-min")),maxValue=parseInt(this.getAttribute("data-slider-max")),startvalueInput?(currValue=[startValue,endValue],connectValue=[!1,!0,!1],tooltipsIn=[tooltipformat,tooltipformat]):(currValue=[endValue],connectValue=!0,tooltipsIn=[tooltipformat])}else{var startValue=0;startvalueInput&&(startValue=parseInt(this.getAttribute("data-slider-startvalue")));var tooltipformatslider={to:function to(e){return queryLayoutHelper.formatLongNumber(e,sliderTooltip)},from:function from(e){return queryLayoutHelper.formatLongNumber(e,sliderTooltip)}},endValue=parseInt(this.getAttribute("data-slider-endvalue"));minValue=parseInt(this.getAttribute("data-slider-min")),maxValue=parseInt(this.getAttribute("data-slider-max")),startvalueInput?(currValue=[startValue,endValue],connectValue=[!1,!0,!1],tooltipsIn=[tooltipformatslider,tooltipformatslider]):(currValue=[endValue],connectValue=!0,tooltipsIn=[tooltipformatslider])}}else{var tooltipformatslider={to:function to(e){return queryLayoutHelper.formatLongNumber(e,sliderTooltip)},from:function from(e){return queryLayoutHelper.formatLongNumber(e,sliderTooltip)}};this.getAttribute("data-slider-min")&&"undefined"!==this.getAttribute("data-slider-min")&&(minValue=parseInt(this.getAttribute("data-slider-min"))),this.getAttribute("data-slider-max")&&"undefined"!==this.getAttribute("data-slider-max")&&(maxValue=parseInt(this.getAttribute("data-slider-max"))),tooltipsIn=[tooltipformatslider]}minValue===maxValue&&(maxValue=minValue+100);var sliderObject={start:currValue,connect:connectValue,range:{min:minValue,max:maxValue},tooltips:tooltipsIn};stepsIn&&(sliderObject.step=stepsIn),sliderCreated?slider.noUiSlider.updateOptions(sliderObject):noUiSlider.create(slider,sliderObject),slider.noUiSlider.off("change"),slider.noUiSlider.on("change",function(e,e2,e3){if(isNotBound){var startValue=0;var endValue;endValue=0,1<e.length?(startValue=e[0],endValue=e[1]):endValue=e[0],isDateSlider&&(startValue&&(startValue=kendo.toString(new Date(parseFloat(startValue)),"yyyy-MM-dd")),endValue&&(endValue=kendo.toString(new Date(parseFloat(endValue)),"yyyy-MM-dd"))),sliderInput.setAttribute("data-slider-startvalue",startValue),sliderInput.setAttribute("data-slider-endvalue",endValue),changeEvent&&eval(changeEvent)}else{var dataFieldName=sliderInput.getAttribute("data-fieldname"),dataValue=e[0];sysproInterop&&(sysproInterop.viewModel&&sysproInterop.viewModel&&sysproInterop.viewModel.set(dataFieldName+".Value",dataValue),sysproInterop.eventTrigged(dataFieldName,dataValue,"","","fieldChange",function(){},function(){}))}})})},QueryLayoutUIHelpersClass.prototype.toolbarEventHandler=function(){var e=this.getAttribute("data-fieldname");if(!this.disabled)if("FusionInternal.HelpTour"===e){var t="";0<$(this).closest(".modal-window-main").length&&(t="ModalWindow"),sysproInterop.startHelpTourForApplication(t)}else if("Toolbar.NOTES002"===e){var a=kendo.toString(new Date,"yyyy/MM/dd"),o="";sysproInterop.currentUserSession&&(o=sysproInterop.currentUserSession.OperatorName),a=a+" "+o;var n=$("#Fields\\.IMPWEDF0NOTESMAIN");if(0===n.length){n=$("#Fields\\.NOTESMAINRTF");var d=$(this).closest(".avanti-richtextwidget");if(0<d.length&&(n=$(".avanti-richtextwidget-textholder",d)),n.data("kendoEditor")){var s=n.data("kendoEditor");s.focus();var l=s.getSelection(),r=l.focusNode,c=l.focusOffset,p=l.rangeCount-1;s.paste(a,{split:!1})}}else{var u=n.prop("selectionStart"),m=n.prop("selectionEnd"),g=n.val(),h=g.substring(0,u),f=g.substring(m,g.length);n.val(h+a+f);var y=n;y[0].setSelectionRange(m+a.length,m+a.length),y.focus()}}else e&&0===e.indexOf("Toolbar.AVANTICARDBUILDER")?sysproCardBuilder&&sysproCardBuilder.toolbarEvent(e):sysproInterop.eventTrigged(e,"","","","toolbarEvent",function(){},function(){})},QueryLayoutUIHelpersClass.prototype.toolbarChangeEventHandler=function(){if(!(this.classList.contains("combobox")&&"SELECT"===this.tagName)){if(!sysproInterop.ignoreLastToolbarChange){var e=this.getAttribute("data-fieldname");!e&&this.id&&(e=this.id.replace("undefined",""));var t;t=this.value,"checkbox"==this.type&&(t=this.checked),console.log("Toolbar Event: "+t+","+this.getAttribute("data-lastchangevalue")),t===this.getAttribute("data-lastchangevalue")?this.setAttribute("data-lastchangevalue",null):(this.setAttribute("data-lastchangevalue",t),sysproInterop.updateSYSPROKeyDataFromElementChange($(this),t),sysproInterop.eventTrigged(e,t,"","","toolbarEvent",function(){},function(){}))}sysproInterop.ignoreLastToolbarChange=!1}},QueryLayoutUIHelpersClass.prototype.initializeToolbarEvents=function(){$(".syspro-toolbar-widget-button").off("click",this.toolbarEventHandler),$(".syspro-toolbar-widget-button").on("click",this.toolbarEventHandler),$(".syspro-toolbar-widget-change").off("change",this.toolbarChangeEventHandler),$(".syspro-toolbar-widget-change").on("change",this.toolbarChangeEventHandler)},QueryLayoutUIHelpersClass.prototype.disposeVisualDesigner=function(){var e=sysproInterop.generateUUID(),t=sysproInterop.generateUUID();SYSPRO_VB.history=[],SYSPRO_VB.historyIndex=0,SYSPRO_VB.column1Copy={PrimaryStyle:0,ResponsiveStyle:3,Widgets:[],Id:e,Index:1,TypeName:"Column",HasChildren:!1,index:1},SYSPRO_VB.column2Copy={PrimaryStyle:0,ResponsiveStyle:3,Widgets:[],Id:t,Index:2,TypeName:"Column",HasChildren:!1,index:2},$(".disabled, .disabled a").off("click"),$(".menu-toggle").off("click"),$(".menu-toggle-tab").off("click"),$("input[name='column-layout']").parent().off("click"),$("input[name='column-layout']").off("change"),$("#exportTotalJSON").off("click"),$(".block-bg-button").off("shown.bs.popover"),$(document).off("click",".add-row-section"),$(document).off("click",".add-data-section"),$(document).off("click",".remove-section"),$(document).off("click",".remove-row-section"),$(document).off("click",".edit-row-section"),$(document).off("click",".add-toolbar-section"),$(document).off("click",".remove-toolbar-widget"),$(document).off("click",".edit-toolbar-widget"),$(".window-content").off("click"),$(document).off("shown.bs.collapse"),$("#initial-fields-list-data-window.fieldsPanelBar .list-group-item.field-name").off("click"),$("#dataWindow input[name='data-window-off-canvas-type']").off("change"),$(".links-fields-list-data-edit-window .list-group-item").off("click"),$("#dataEditWindow input[name='data-edit-window-off-canvas-type']").off("click"),$("#tiles-list").off("click"),$("#tileWindow input[name='tile_text_colour']").off("change"),$(".clear-color-selections").off("click"),$("#tiles-list").off("click"),$("#toolbar-widgets-list.fieldsPanelBar .list-group-item").off("click"),$("#toolbarWindow input[name='off-canvas-type']").off("change"),$("#initial-fields-list").html(""),$("#initial-fields-list-data-window-wrapper").html("<ul id=\"initial-fields-list-data-window\" class=\"fieldsPanelBar list-group\"></ul>"),$("#initial-fields-list-data-edit-window-wrapper").html("<ul id=\"initial-fields-list-data-edit-window\" class=\"fieldsPanelBar\"></ul>"),$("#toolbar-widget-list-wrapper").html("<ul id=\"toolbar-widgets-list\" class=\"fieldsPanelBar list-group\"></ul>"),$("#toolbar-widget-edit-list-wrapper").html("<ul id=\"edit-toolbar-widgets-list\" class=\"fieldsPanelBar list-group\"></ul>"),$("#tile-widgets-list-wrapper").html("<ul id=\"tiles-list\" class=\"fieldsPanelBar\"></ul>"),$("#tile-widgets-edit-list-wrapper").html("<ul id=\"tiles-edit-list\" class=\"fieldsPanelBar\"></ul>"),$("#quick-add-layout .quick-sortable-list.row").html(""),$("#GridlistWidgets .layout-radio-options").html(""),$("#editGridlistWidgets .layout-radio-options").html(""),$("#NotepadWidgets .layout-radio-options").html(""),$("#TreeviewWidgets .layout-radio-options").html(""),$("#TreelistWidgets .layout-radio-options").html(""),$("#editNotepadWidgets .layout-radio-options").html(""),$("#editTreeviewWidgets .layout-radio-options").html(""),$("#editTreelistWidgets .layout-radio-options").html(""),$("#quick-add-layout .quick-sortable-list.row").html(""),$("#AvailableCards .layout-radio-options").html(""),$("#editCard .layout-radio-options").html(""),$("#quick-add-layout .quick-sortable-list.row").html(""),$("#HarmonyWidgets .layout-radio-options").html(""),$("#EditHarmonyWidgets .layout-radio-options").html(""),$("#tiles-parameters-wrapper").empty(),SYSPRO_VB.tileWindowsReady=!1,$(window).off("resize"),SYSPRO_VB.layoutWidgetSelectOptions&&$.each(SYSPRO_VB.layoutWidgetSelectOptions,function(e,t){$(t).off("click")}),SYSPRO_VB.layoutWidgetSelectPlaceholder&&SYSPRO_VB.layoutWidgetSelectPlaceholder.off("click"),SYSPRO_VB.CleanOffCanvasModels={},SYSPRO_VB.destroyTreeViews&&SYSPRO_VB.destroyTreeViews(),SYSPRO_VB.offCanvasWindows&&$.each(SYSPRO_VB.offCanvasWindows,function(e){SYSPRO_VB.offCanvasWindows[e]&&SYSPRO_VB.offCanvasWindows[e].destroy&&SYSPRO_VB.offCanvasWindows[e].destroy(),$(e).remove()}),SYSPRO_VB.offCanvasWindows={},SYSPRO_VB.fieldsListHTML="",SYSPRO_VB.chartsListHTML="",SYSPRO_VB.toolbarListHTML="",SYSPRO_VB.tilesListHTML="",SYSPRO_VB.tileWidgetFields=[],SYSPRO_VB.tileOptionsHTML=""},QueryLayoutUIHelpersClass.prototype.disposeViewOnly=function(e){$(".tooltip").hide(),this.disposeOfWindows(e);var t=[];if(!e)for($.each(sysproInterop.modalWindowHolder,function(e){this.NotModal||(t.push(e),0===this.ModalType?this.Window.close():(this.Window.close(),this.Window.element.remove()))});0<t.length;){var a=t.pop();sysproInterop.modalWindowHolder.splice(a,1)}if(!e){var o=this;$.each(o.tilesCreated,function(){this.packery("destroy")}),o.tilesCreated=[],$(document).off("shown.bs.collapse"),$(".syspro-field-search-dropdown").remove()}e&&$(".syspro-field-search-dropdown."+e).remove(),$(".k-editor-widget").hide(),$(".tooltip").hide()},QueryLayoutUIHelpersClass.prototype.initialiazeChartData=function(t){var e=t.sender,a=e.element[0].getAttribute("data-dataschemasetup");if(!a){var o=e.element[0].getAttribute("data-fieldnames"),n={};if(o){$.each(o.split(","),function(){this&&(n[this]={type:"number"})});var d=t.sender.dataSource.data(),s=new kendo.data.DataSource({data:d,schema:{model:{fields:n}}});e.element[0].parentElement.getAttribute("data-series1name")&&""!==e.element[0].parentElement.getAttribute("data-series1name")&&"null"!==e.element[0].parentElement.getAttribute("data-series1name")&&(e._sourceSeries[0].name=e.element[0].parentElement.getAttribute("data-series1name")),e.element[0].parentElement.getAttribute("data-series2name")&&""!==e.element[0].parentElement.getAttribute("data-series2name")&&"null"!==e.element[0].parentElement.getAttribute("data-series2name")&&(e._sourceSeries[1].name=e.element[0].parentElement.getAttribute("data-series2name")),e.element[0].parentElement.getAttribute("data-series3name")&&""!==e.element[0].parentElement.getAttribute("data-series3name")&&"null"!==e.element[0].parentElement.getAttribute("data-series3name")&&(e._sourceSeries[2].name=e.element[0].parentElement.getAttribute("data-series3name")),e.element[0].parentElement.getAttribute("data-series3name")&&""!==e.element[0].parentElement.getAttribute("data-series4name")&&"null"!==e.element[0].parentElement.getAttribute("data-series4name")&&(e._sourceSeries[3].name=e.element[0].parentElement.getAttribute("data-series4name")),e.element[0].setAttribute("data-dataschemasetup","SchemaBind"),e.setDataSource(s),sysproInterop.hideShowSparklineSeries($(e.element[0]),null)}}else e.element[0].setAttribute("data-dataschemasetup","")},QueryLayoutUIHelpersClass.prototype.calculateYValueOnNormalCurve=function(e,t,a){var o=Math.sqrt,n=Math.PI,d=Math.exp,s=Math.pow;return d(-s(e-a,2)/(2*s(t,2)))/(t*o(2*n))},QueryLayoutUIHelpersClass.prototype.calculateYValuesOnNormalCurve=function(e,t,a,o,n){t===e&&(t=e+1);for(var d=n/(t-e),s=[],l=0,r;l<=n;++l)r=l/d,s.push(this.calculateYValueOnNormalCurve(l,a,o));return s},QueryLayoutUIHelpersClass.prototype.showProcessingMessage=function(e){e?($("#processingMessage").text(e),$("#processingMessageContainer").animate({top:"0px"},400)):$("#processingMessageContainer").animate({top:"-30px"},400)},QueryLayoutUIHelpersClass.prototype.hideProcessingMessage=function(){$("#processingMessageContainer").animate({top:"-150px"},300)},QueryLayoutUIHelpersClass.prototype.createTreeMenu=function(e,t){t=t||0;var a="",o=$("<ul>",{class:"treeview-menu"}),n,d;for(this.typeParent.current!==e.Description&&"Folder"===e.Type&&(this.typeParent.current=e.Description,1===t&&(this.typeParent.a=e.Description)),a+=this.typeParent.a?this.typeParent.a:"",n=0;n<e.Children.length;n++){var s=e.Children[n].Children,l="<li";s&&(l+=" class=\"treeview\""),l+="><a",s||(l+=" class=\"syspro-program-link\" data-syspromenuitemtype=\""+e.Children[n].Type+"\"  data-syspromenuitemsubtype=\""+e.Children[n].SubType+"\"  data-sysproprogramname=\""+e.Children[n].Name+"\""),l+=" href=\"#\" ",l+="><span class=\"material-icons treeview-menu-icon pull-left sys-mg-r-5\">"+e.Children[n].Icon+"</span>"+e.Children[n].Description,s&&(l+="<span class=\"material-icons treeview-menu-expand-indicator pull-right \">chevron_right</span>"),l+="</a>",e.Children[n].Tooltip&&(l+="<i class=\"material-icons pull-right sys-txt-sm text-muted program-link-help\" data-container=\"body\" data-trigger=\"hover\" data-tooltip=\"tooltip\" data-placement=\"right\" data-original-title=\""+e.Children[n].Tooltip+"\">help_outline</i>"),l+="</li>",d=$(l),s&&d.append(this.createTreeMenu(e.Children[n],t+1)),o.append(d),s||this.programListTypeahead.push({name:e.Children[n].Description,breadcrumb:a,sysproprogramname:e.Children[n].Name,syspromenuitemtype:e.Children[n].Type,syspromenuitemsubtype:e.Children[n].SubType,icon:e.Children[n].Icon})}return o},(QueryLayoutUIHelpersClass.prototype.initializeExpandableCards=function(t){function slideFade(e){e.css({opacity:0,marginLeft:"-200%"})}function slideInFade(e){e.css({opacity:1,marginLeft:"0%"})}function expandFade(e){var t={opacity:1,height:n+"px"};e.css(t)}function shrinkFade(e){e.css({opacity:0,height:"0px"})}var a=0,o=$(t).find(".card-bindable");0===$(t).find(".card-bindable").length&&$(t).hasClass("card-bindable")&&(o=$(t)),a=o.outerHeight();var n=$(t).find(".expandedView").outerHeight();0===a?0<o.data("storedheight")&&(a=o.data("storedheight")):o.data("storedheight",a),0===n?0<$(t).find(".expandedView").data("storedheight")&&(n=$(t).find(".expandedView").data("storedheight")):$(t).find(".expandedView").data("storedheight",n),$(t).data("isinitialized")||($(t).find(".expandedView").css("height","0px"),$(t).find(".expandedView").css("display","block"),o.css("minHeight",a),$(t).data("isinitialized",!0)),$(t).find(".expand-card").off("click").on("click",function(t){t.preventDefault(),slideFade($(this).closest(".miniView"))}),$(t).find(".shrink-card").off("click").on("click",function(t){t.preventDefault(),shrinkFade($(this).closest(".expandedView"))}),$(t).find(".miniView").off("transitionend webkitTransitionEnd oTransitionEnd").on("transitionend webkitTransitionEnd oTransitionEnd",function(t){"opacity"===t.originalEvent.propertyName&&0==parseInt($(this).css("opacity"))&&(expandFade($(this).siblings(".expandedView")),$(this).css("height","0px"))}),$(t).find(".expandedView").off("transitionend webkitTransitionEnd oTransitionEnd").on("transitionend webkitTransitionEnd oTransitionEnd",function(a){"opacity"===a.originalEvent.propertyName&&0==parseInt($(this).css("opacity"))&&($(t).find(".miniView").css("height","auto"),slideInFade($(this).siblings(".miniView")))})},QueryLayoutUIHelpersClass)}(),CallLayerInteropClass=function(){function CallLayerInteropClass(e,t){this.interopType="SYSPRORehostedBrowser",this.runningMode=null,this.standaloneAddress="http://localhost/UXTools/",this.renderMode="mvc",this.connectionId=null,this.sessionId=null,this.menuHtml=null,this.menuDetail=null,this.changeFromKeyPress=!1,this.validationInProgress=!1,this.devMode="",this.serverSessionIdOverride="",this.avantiPluginLoaded="",this.isSecondInstance=!1,this.previousAvantiPlugin="",this.programName="",this.sysproInteropInternal=e,this.queryLayoutInternal=t,this.dataStorage=new Dictionary}return CallLayerInteropClass.prototype.initializeInBrowser=function(e,t){this.runningMode=t,this.interopType="StandaloneBrowser",e&&(this.standaloneAddress=e),this.sysproInteropInternal.activateTheme(),$(".combobox-logon:not(.combobox-initialized)").combobox({newOptionsAllowed:!0}),$(".combobox-logon:not(.combobox-initialized)").addClass("combobox-initialized");var a=this,o=window.location.href;o&&(o=o.replace("??","?"));var n=null,d="",s="",l="";try{n=new URL(o),d=n.searchParams.get("SecondInstance"),s=n.searchParams.get("OpenParameters"),l=n.searchParams.get("StartupParameters")}catch(t){var r=function(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))};d=r("SecondInstance"),s=r("OpenParameters"),l=r("StartupParameters")}a.setMFAToken(""),$(document).on("keydown",function(e){var t=e.keyCode||e.which;return 112!==t||(a.sysproInteropInternal.showHelp(null),e.preventDefault(),!1)}),$("input.syspro-logon-field").on("change",function(t){if(!a.changeFromKeyPress){var e="";t.target&&(e=t.target.id),a.validationInProgress||a.validateCredentials(e)}a.changeFromKeyPress=!1}),$("#logonForm").off("keypress"),$("#logonForm").on("keypress",function(e){var t=e.keyCode||e.which;13!==t||a.validationInProgress||(a.changeFromKeyPress=!0,!$(".logon-button button").is(":focus")&&(console.log("ENTER: Validation not in progress, intializeInteropLayer"),a.intializeInteropLayer("AnyValueSetsFusionOnEnter","",l)))});$("input.syspro-logon-field-combo").on("change",function comboboxChangedHandler(t){a.validationInProgress||!t.currentTarget||a.validateCredentials(t.currentTarget.id)}),$(".change-password-link").off("click"),$(".change-password-link").on("click",function(){$("#logonForm").hide(),$("#changePasswordForm").show(),$("#ChangePasswordForm_operator").val($("#UserName").val()),$("#UserName").val()&&$("#ChangePasswordForm_operator").closest(".form-group").removeClass("is-empty")}),$(".forgot-password-link").off("click"),$(".forgot-password-link").on("click",function(){$("#logonForm").hide(),$("#forgotPasswordForm").show(),$("#ForgotPasswordForm_operator").val($("#UserName").val()),$("#UserName").val()&&$("#ForgotPasswordForm_operator").closest(".form-group").removeClass("is-empty")}),$(".back-to-logon-link").off("click"),$(".back-to-logon-link").on("click",function(){$("#logonForm").show(),$("#forgotPasswordForm").hide(),$("#changePasswordForm").hide(),$("#ChangePasswordForm_operator").val()?($("#UserName").val($("#ChangePasswordForm_operator").val()),$("#UserName").closest(".form-group").removeClass("is-empty")):$("#ForgotPasswordForm_operator").val()&&($("#UserName").val($("#ForgotPasswordForm_operator").val()),$("#UserName").closest(".form-group").removeClass("is-empty"))}),"true"===d?($("#logonForm").hide(),a.isSecondInstance=!0,a.intializeInteropLayer("SecondInstance",s,l)):"debug"===d?($("body").addClass("dev-mode-body"),a.intializeInteropLayer("debug",s,l)):a.getKMSToken()?($("#logonForm").hide(),a.intializeInteropLayer("kmsauth",a.getKMSToken(),l)):$("#UserName").focus(),$(window).on("mousedown",function(){a.sysproInteropInternal.lastActivityDateTime=Date.now()}),$(window).on("keydown",function(){a.sysproInteropInternal.lastActivityDateTime=Date.now()})},CallLayerInteropClass.prototype.validateCredentials=function(e){this.validationInProgress=!0,console.log("validateCredentials"),this.toggleSignInLoading(!0);var t=this.sysproInteropInternal.generateUUID();"UserName"===e&&this.setMFAToken("");var a=$("#UserName").val(),o=$("#UserPwd").val(),n=$("#CompId").val(),d=$("#CompIdundefined").val(),s=n?n:d,l=$("#CompPass").val(),r=$("#UserPin").val(),c=this.getMFAToken();a||(a=""),o||(o=""),s||(s=""),l||(l=""),r||(r=""),c||(c="");var p={SessionId:t,Operator:a,OperatorPassword:o,Company:s,CompanyPassword:l,RunningMode:this.runningMode,OperatorMfaPin:r,MfaEncryptedString:c},u=this;$.ajax({url:u.standaloneAddress+u.renderMode+"/UXInteropWeb/ValidateCredentials",data:p,contentType:"application/json; charset=utf-8"}).done(function(t){u.showValidationOutput(t,e,p),t.MFAToken&&null!==t.MFAToken?u.setMFAToken(t.MFAToken):u.removeMFAToken(),u.toggleSignInLoading(!1),u.validationInProgress=!1}).fail(function(e){var t=e.statusText;"error"===t&&(t="Cannot connect to server: "+u.standaloneAddress),u.sysproInteropInternal.showErrorMessage("Error validating credentials - "+t,"Validate credentials"),u.toggleSignInLoading(!1),u.validationInProgress=!1})},CallLayerInteropClass.prototype.resendPin=function(e){this.validationInProgress=!0,console.log("resendPin"),this.toggleSignInLoading(!0);var t=this.sysproInteropInternal.generateUUID(),a=$("#UserName").val(),o=$("#UserPwd").val(),n=$("#CompId").val(),d=$("#CompPass").val(),s=$("#UserPin").val();a||(a=""),o||(o=""),n||(n=""),d||(d=""),s||(s="");var l={SessionId:t,Operator:a,OperatorPassword:o,Company:n,CompanyPassword:d,RunningMode:this.runningMode,OperatorMfaPin:s},r=this;$.ajax({url:r.standaloneAddress+r.renderMode+"/UXInteropWeb/ValidateCredentials",data:l,contentType:"application/json; charset=utf-8"}).done(function(t){r.showValidationOutput(t,e,l),t.MFAToken&&null!==t.MFAToken?r.setMFAToken(t.MFAToken):r.removeMFAToken(),$("#UserPin").closest(".form-group").addClass("has-info"),$("#UserPin").closest(".form-group").removeClass("has-error"),$("#UserPin").next(".help-block").text("Pin has been resent."),$("#UserPin").next(".help-block").addClass("always-show"),r.toggleSignInLoading(!1),r.validationInProgress=!1}).fail(function(e){var t=e.statusText;"error"===t&&(t="Cannot connect to server: "+r.standaloneAddress),r.sysproInteropInternal.showErrorMessage("Error resending pin - "+t,"Resending pin"),r.toggleSignInLoading(!1),r.validationInProgress=!1})},CallLayerInteropClass.prototype.toggleSignInLoading=function(e){e?($(".logon-button").css("opacity",.3),$("[id=loading-cover]").fadeIn()):($("[id=loading-cover]").fadeOut(),$(".logon-button").css("opacity",1),this.queryLayoutInternal.hideProcessingMessage())},CallLayerInteropClass.prototype.showValidationOutput=function(e,t,a){var o=this;return $(".help-block").removeClass("always-show"),$(".help-block").text(""),$(".form-group").removeClass("has-error"),$(".form-group").removeClass("has-info"),$(".form-group").removeClass("has-information"),$(".form-group").removeClass("has-warning"),e.UserName&&($("#UserName").val(e.UserName),$("#ChangePasswordForm_operator").val(e.UserName),e.UserName&&($("#ChangePasswordForm_operator").closest(".form-group").removeClass("is-empty"),$("#UserName").closest(".form-group").removeClass("is-empty")),$("#CompId").closest(".form-group").removeClass("is-empty")),e.UserNameFull&&($("#UserName").closest(".form-group").addClass("has-information"),$("#UserName").next(".help-block").addClass("always-show"),$("#UserName").next(".help-block").removeClass("error-message"),$("#UserName").next(".help-block").text(e.UserNameFull)),e.CompanyName&&($("#CompId").closest(".form-group").addClass("has-information"),$("#CompId").next(".help-block").addClass("always-show"),$("#CompId").next(".help-block").removeClass("error-message"),$("#CompId").next(".help-block").text(e.CompanyName)),e.CompaniesAvailable&&1<=e.CompaniesAvailable.length&&($("#CompId").html("<option value=''></option>"),$.each(e.CompaniesAvailable,function(){var t="";e.CompanyId===this.value&&(t="selected='selected'"),$("#CompId").append("<option value='"+this.Value+"' "+t+">"+this.Value+" - "+this.Description+"</option>")}),!e.CompanyId&&0<$("#CompId").length&&$("#CompId").data("combobox").refresh()),e.CompanyId&&($("#CompId").closest(".form-group").removeClass("is-empty"),$("#CompId").val(a.Company?a.Company:e.CompanyId),$("#CompId").data("combobox")&&$("#CompId").data("combobox").refresh()),e.MFARequired&&"N"!==e.MFARequired&&" "!==e.MFARequired?($("#MfaPinEntry").show(),"V"===e.MFARequired?($("#UserPin").closest(".form-group").addClass("has-info"),$("#UserPin").next(".help-block").text("Verfied"),$("#UserPin").next(".help-block").addClass("always-show"),o.hideMfaResendButton()):"R"===e.MFARequired?(o.showMfaResendButton(),"UserPwd"===t&&$("#UserPin").focus()):(o.hideMfaResendButton(),"UserPwd"===t&&$("#UserPin").focus())):($("#MfaPinEntry").hide(),$("#UserPin").text("")),!e.ValidationMessage||($("#logonForm").show(),e.ValidationMessage.IsGlobal?this.sysproInteropInternal.showErrorMessage(e.ValidationMessage.Text,"Validating credentials"):"UserName"===t&&("UserPwd"===e.ValidationMessage.FieldName||"CompPass"===e.ValidationMessage.FieldName)||"CompId"===t&&("UserPwd"===e.ValidationMessage.FieldName||"CompPass"===e.ValidationMessage.FieldName)||"UserPwd"===t&&("CompId"===e.ValidationMessage.FieldName||"CompPass"===e.ValidationMessage.FieldName)||"CompId"===e.ValidationMessage.FieldName&&!a.Company||(0<$("#"+e.ValidationMessage.FieldName).length?($("#"+e.ValidationMessage.FieldName).closest(".form-group").addClass(e.ValidationMessage.ValidationClass),$("#"+e.ValidationMessage.FieldName).next(".help-block").addClass("error-message"),$("#"+e.ValidationMessage.FieldName).next(".help-block").html(e.ValidationMessage.Text)):this.sysproInteropInternal.showErrorMessage(e.ValidationMessage.Text,"Validating credentials")),$("#keep_signed_in").prop("checked",!1),this.setKMSToken(""),!1)},CallLayerInteropClass.prototype.changePassword=function(){this.validationInProgress=!0,console.log("changePassword"),$("#loading-cover").fadeIn();var e=$("#ChangePasswordForm_operator").val(),t=$("#ChangePasswordForm_oldpassword").val(),a=$("#ChangePasswordForm_newpassword").val(),o=$("#ChangePasswordForm_confirmnewpassword").val();e||(e=""),t||(t=""),a||(a=""),o||(o="");var n="";"Portal"===this.runningMode&&(n=e);var d={UserName:e,OldPassword:t,NewPassword:a,ConfirmNewPassword:o,EmailAddress:n},s=this;$.ajax({url:s.standaloneAddress+s.renderMode+"/UxInternalWeb/ChangePassword",data:d,type:"POST"}).done(function(e){s.showValidationOutputChangePassword(e,"#changePasswordForm","Password change","Password changed successfully"),$("[id=loading-cover]").fadeOut(),s.validationInProgress=!1}).fail(function(e){var t=e.statusText;"error"===t&&(t="Cannot connect to server: "+s.standaloneAddress),this.sysproInteropInternal.showErrorMessage("Error validating credentials - "+t),$("[id=loading-cover]").fadeOut(),s.validationInProgress=!1})},CallLayerInteropClass.prototype.forgotPassword=function(){this.validationInProgress=!0,console.log("forgotPassword"),$("#loading-cover").fadeIn();var e=$("#ForgotPasswordForm_operator").val();"Portal"===this.runningMode&&(e="{A2F63B01-C144-4101-81AB-8504D0E42ACC}");var t=$("#ForgotPasswordForm_email").val();e||(e=""),t||(t="");var a={UserName:e,EmailAddress:t},o=this;$.ajax({url:o.standaloneAddress+o.renderMode+"/UxInternalWeb/ResetPassword",data:a,type:"POST"}).done(function(e){o.showValidationOutputChangePassword(e,"#forgotPasswordForm","Password reset","Password reset successfully. A new password will be emailed to you."),$("[id=loading-cover]").fadeOut(),o.validationInProgress=!1}).fail(function(e){var t=e.statusText;"error"===t&&(t="Cannot connect to server: "+o.standaloneAddress),this.sysproInteropInternal.showErrorMessage("Error validating credentials - "+t),$("[id=loading-cover]").fadeOut(),o.validationInProgress=!1})},CallLayerInteropClass.prototype.showValidationOutputChangePassword=function(e,t,a,o){return $(".help-block").removeClass("always-show"),$(".help-block").text(""),$(".form-group").removeClass("has-error"),$(".form-group").removeClass("has-information"),$(".form-group").removeClass("has-warning"),!e.ValidationMessage||(e.ValidationMessage.IsGlobal?1==e.ValidationMessage.ValidationStyle?(this.sysproInteropInternal.showCustomTaskDialog("sys-bg-success","sys-fg-white",a,o,"","done"),$("#logonForm").show(),$(t).hide()):this.sysproInteropInternal.showErrorMessage(e.ValidationMessage.Text,"Validating credentials"):0<$("#"+e.ValidationMessage.FieldName).length?($("#"+e.ValidationMessage.FieldName).closest(".form-group").addClass(e.ValidationMessage.ValidationClass),$("#"+e.ValidationMessage.FieldName).next(".help-block").addClass("error-message"),e.ValidationMessage.Text=e.ValidationMessage.Text.replace("\\n\\n"," "),$("#"+e.ValidationMessage.FieldName).next(".help-block").html(e.ValidationMessage.Text)):this.sysproInteropInternal.showErrorMessage(e.ValidationMessage.Text,"Validating credentials"),!1)},CallLayerInteropClass.prototype.decompressString=function(e,t){if(this.sysproInteropInternal.currentUserSession&&this.sysproInteropInternal.currentUserSession.UseCompression&&t){var a=atob(e);var o=a.split("").map(function(t){return t.charCodeAt(0)});var n=new Uint8Array(o),d=pako.inflate(n,{raw:!0}),s="windows-1252";this.sysproInteropInternal.currentUserSession&&this.sysproInteropInternal.currentUserSession.Charset&&(s=this.sysproInteropInternal.currentUserSession.Charset);var l=new TextDecoder(s),r=l.decode(d);return r}return e},CallLayerInteropClass.prototype.intializeInteropLayer=function(e,t,a){console.log("intializeInteropLayer - "+e);var o=this;if("SYSPRORehostedBrowser"===o.interopType)console={log:function log(e){try{o.sysproInteropInternal.logMessage(null,null,null,null,JSON.stringify(e))}catch(e){}}};else if("StandaloneBrowser"===o.interopType&&!o.validationInProgress&&("debug"===e&&(o.devMode=e,o.serverSessionIdOverride=t,e=""),e)){o.devMode&&(e=this.devMode,t=this.serverSessionIdOverride),o.validationInProgress=!0,"kmsauth"===e?o.queryLayoutInternal.showProcessingMessage("Signing you back in..."):o.toggleSignInLoading(!0),$.connection.hub.url=o.standaloneAddress+"signalr/hubs";var n=$.connection.scriptHub;n?n.client.broadcastMessage=function(e,t,a,n,d,s){try{if(o.avantiPluginLoaded&&(o.previousAvantiPlugin=o.avantiPluginLoaded),o.avantiPluginLoaded=s,"ShowError"==e){o.toggleSignInLoading(!1),o.sysproInteropInternal.showErrorMessage(t,a);var l="ERROR: "+t;o.sysproInteropInternal.eventTrigged(l,"","","","invocationCallback",function(){},function(){},!1,!1)}else if("InsertBody"==e||"InsertBodyDesigner"==e){t=o.decompressString(t,d),o.queryLayoutInternal.disposeVisualDesigner(),o.queryLayoutInternal.disposeViewOnly(null);var r=$("#harness-container .sys-widget:not(.card-widget,.harmony-widget,.tile-widget,.tile-inner,.syspro-toolbar,.tiles-parent,.syspro-nonbound)");if(kendo.unbind(r),$.each($(".syspro-grid-list"),function(){$(this).data("kendoGrid")&&$(this).data("kendoGrid").destroy()}),kendo.destroy($("#harness-container")),$("#harness-container").html(""),o.menuHtml||(o.menuHtml=t,o.menuDetail=a),$("#harness-container").html("<div id=\"wrapper\" class=\"toggled\">"+t+"</div>"),$("#harness-container").show(),n){var c=JSON.parse(n);o.sysproInteropInternal.isInEntryScreen=c.ProgramType,o.programName=c.Program;var p=" - "+$("head title").text();$("head title").data("originaltitle")?p=$("head title").data("originaltitle"):$("head title").data("originaltitle",p),$("head title").text(c.Title+p),$(".application-sub-title").text(c.Title),"InsertBody"==e&&c.Program&&c.Title&&"IMPMEN"!==c.Program&&"      "!==c.Program&&o.sysproInteropInternal.addRecentProgram(c.Program,c.Title,"Program",s)}$("body")[0].setAttribute("data-column-layout",a),$("body").data("column-layout",a),o.toggleSignInLoading(!1),$(".fusion-bottom-toolbar").hide(),"InsertBody"==e?(o.sysproInteropInternal.inDesignMode=!1,o.queryLayoutInternal.initializeViewOnly(!1,null,null),o.queryLayoutInternal.initializeToolbarEvents(),$("body").removeClass("body-edit-mode"),$("body").addClass("body-view-mode"),$("body").addClass("avanti-mode"),$("#builder-toolbar").hide(),"Portal"===o.runningMode||o.isSecondInstance?$(".fusion-maininstance-buttons").hide():$(".fusion-maininstance-buttons").show()):(o.sysproInteropInternal.inDesignMode=!0,SYSPRO_VB.init(),o.queryLayoutInternal.initializeToolbarEvents(),$("body").removeClass("body-view-mode"),$("body").addClass("body-edit-mode"),$("body").addClass("avanti-mode"),$("#builder-toolbar").show(),$(".fusion-maininstance-buttons").hide()),o.sysproInteropInternal.viewModel=null,o.sysproInteropInternal.toolbarModel=null,o.sysproInteropInternal.fullBindRequired=null}else if("OpenSearchWindow"==e){t=o.decompressString(t,d);var u=o.sysproInteropInternal.showModalWindow(JSON.parse(t),"SearchWindow"),m=a.split("|")[0],g=a.split("|")[1],h="";2<a.split("|").length&&(h=a.split("|")[2]),AvantiSearchInterop.OpenSearch(m,h,o.sysproInteropInternal.getGlobalValue("SearchLevelId"),o.sysproInteropInternal.getGlobalValue("SearchLevelValue"),"",function(e){o.sysproInteropInternal.browseValueSelected(g,e,m)},$("#"+u))}else if("ExecuteScript"==e){try{t=o.decompressString(t,d);var f=sysproInteropFunction(t);f&&void 0!==f||(f="")}catch(e){f="ERROR: "+e.message,o.sysproInteropInternal.showErrorMessage(e.message,"The instruction from the SYSPRO Server failed")}"True"===n&&setTimeout(function(e){o.sysproInteropInternal.eventTrigged(f,e,"","","invocationCallback",function(){},function(){})},0,a)}else if("SetLogonCredentials"==e){$("body").addClass("light-gradient-background"),$("#logonForm").hide();var y=JSON.parse(t);y&&(o.sysproInteropInternal.currentUserSession=y,$(".fusion-current-account-name").text(o.sysproInteropInternal.currentUserSession.OperatorName),o.sysproInteropInternal.dateFormat=o.sysproInteropInternal.currentUserSession.DateFormat,!o.sysproInteropInternal.currentUserSession.NotificationsCount&&(o.sysproInteropInternal.currentUserSession.NotificationsCount=0),o.sysproInteropInternal.updateNotificationsCount(o.sysproInteropInternal.currentUserSession.NotificationsCount),("PoS"!==o.runningMode||o.isSecondInstance)&&o.sysproInteropInternal.bindProgramList($("#fusion-sidebar-wrapper2"),!0,!0))}else{if("SendNotification"===e)return o.avantiPluginLoaded===s&&(o.avantiPluginLoaded=o.previousAvantiPlugin),o.sysproInteropInternal.sendNotification(JSON.parse(t)),"";if("UpdateInProgress"===e)return $("#avantiUpdateCover").show(),"";if("ExitSYSPRO"==e)return o.sysproInteropInternal.showErrorMessage("The SYSPRO.exe on the server linked to your session has been closed. Please refresh your browser (F5)  and logon again.","SYSPRO server closed."),""}}catch(e){o.sysproInteropInternal.handleError(e.message,"ServerMessage")}}:(o.toggleSignInLoading(!1),o.validationInProgress=!1,this.sysproInteropInternal.showErrorMessage("Cannot connect to the Avanti server '"+o.standaloneAddress+"'. Please check your network settings and try again.","Logon Failed")),this.sysproInteropInternal.reconnectionAttempts=0,$.connection.hub.disconnected&&$.connection.hub.disconnected(function(){console.log("SIGNALR disconnected "+o.connectionId),20>o.sysproInteropInternal.reconnectionAttempts?(o.sysproInteropInternal.showCustomTaskDialog("sys-bg-danger","sys-fg-white","Connection with Avanti server lost","Please wait while Avanti attempts to reconnect.","","portable_wifi_off"),setTimeout(function(){o.sysproInteropInternal.showCustomTaskDialog("sys-bg-primary","sys-fg-white","Connecting to Avanti server","Connection in progress...","","wifi_tethering"),$.connection.hub.start({withCredentials:!1}).done(function(){console.log("SIGNALR reconnected on "+$.connection.hub.id),o.sysproInteropInternal.reconnectionAttempts=0;var e={SessionIdOld:o.connectionId,SessionIdNew:$.connection.hub.id};$.ajax({url:o.standaloneAddress+o.renderMode+"/UXInteropWeb/UpdateScriptSessionId",data:e,contentType:"application/json; charset=utf-8"}).done(function(){o.sysproInteropInternal.showCustomTaskDialog("sys-bg-success","sys-fg-white","Connection successful","You may continue using Avanti.","","wifi"),o.connectionId=$.connection.hub.id})}).fail(function(e){++o.sysproInteropInternal.reconnectionAttempts,console.log("error on reconnect number "+o.sysproInteropInternal.reconnectionAttempts+" - "+e.message);var t=20-o.sysproInteropInternal.reconnectionAttempts;o.sysproInteropInternal.showCustomTaskDialog("sys-bg-danger","sys-fg-white","Connection attempt failed","Please check your connectivity. Avanti will continue to attempt to reconnect "+t+" more times.","","portable_wifi_off")})},5e3)):o.sysproInteropInternal.showCustomTaskDialog("sys-bg-danger","sys-fg-white","Connection with Avanti server lost","20 reconnection attempts failed. Please check connectivity and reload Avanti.","","portable_wifi_off")});var d=!1;$.connection.hub.start({withCredentials:!1}).done(function(){d=!0,o.connectionId=$.connection.hub.id;var n="",s="";"SecondInstance"===e&&t?(n="true",s=t):"debug"===e&&t?(n="debug",s=t):"kmsauth"===e&&t&&(n="kmsauth",s=t);var l=$("#UserName").val(),r=$("#UserPwd").val(),c=$("#CompId").val(),p=$("#CompIdundefined").val(),u=c?c:p,m=$("#CompPass").val(),g=$("#UserPin").val(),h=o.getMFAToken(),f=$("#keep_signed_in").prop("checked");"kmsauth"==n&&(f=!1);var y=o.getDeviceId();l||(l=""),r||(r=""),u||(u=""),m||(m=""),g||(g=""),h||(h="");var b={SessionId:o.connectionId,Operator:l,OperatorPassword:r,Company:u,CompanyPassword:m,ServerAddress:o.standaloneAddress,SecondInstance:n,OpenParameters:s,RunningMode:o.runningMode,KeepMeSignedIn:f,StartupParameters:a,OperatorMfaPin:g,MfaEncryptedString:h};$.ajax({url:o.standaloneAddress+o.renderMode+"/UXInteropWeb/CreateSession",headers:{DeviceId:y},data:b,contentType:"application/json; charset=utf-8"}).done(function(e){o.showValidationOutput(e,null,b)?(f&&e&&e.KMSToken&&o.setKMSToken(e.KMSToken),o.removeMFAToken(),$(".fusion-logon-page-buttons").hide(),$(".fusion-main-page-buttons").show(),$("#fusion-toolbar").addClass("toolbar-loaded"),$("#logonForm").off("keypress"),("true"===n||"Portal"===o.runningMode)&&$(".fusion-maininstance-buttons").hide(),$("a[href^=mailto],a[href^=tel]").click(function(){o.sysproInteropInternal.ignoreUnload=!0}),window.onbeforeunload=function(){if(!o.sysproInteropInternal.ignoreUnload){o.sysproInteropInternal.ignoreUnloadFromBefore=!1,o.sysproInteropInternal.closeSYSPROFusion(null);var e=null;return("ENTRY"===o.sysproInteropInternal.isInEntryScreen||o.sysproInteropInternal.popupDialogOpened)&&(e="Are you sure you want to close SYSPRO Avanti? All unsaved changes will be lost."),e}o.sysproInteropInternal.ignoreUnloadFromBefore=!0,o.sysproInteropInternal.ignoreUnload=!1},window.onunload=function(){o.sysproInteropInternal.ignoreUnloadFromBefore||(o.sessionId=null),o.sysproInteropInternal.ignoreUnloadFromBefore=!1},console.log("Session Created: "+e.DataOut),e.DataOut?o.sessionId=e.DataOut:o.toggleSignInLoading(!1)):o.toggleSignInLoading(!1),console.log("Create Session complete")}).fail(function(e){console.log("Create Session failed"),o.toggleSignInLoading(!1),console.log("error - "+e.responseText);var t=e.responseText;t||(t="Creation of the users session fail. Server not found at: "+o.standaloneAddress),o.sysproInteropInternal.showErrorMessage(t,"Session creation")}).always(function(){console.log("Create Session always"),o.validationInProgress=!1})}).always(function(){d||(o.validationInProgress=!1,o.toggleSignInLoading(!1),o.sysproInteropInternal.showErrorMessage("Server sockets connection failed.","Connection failed."),console.log("Connect Finished: validationInProgress false"))})}},CallLayerInteropClass.prototype.callLayerWithData=function(e,t){if(void 0===t&&(t=!1),"SYSPRORehostedBrowser"===this.interopType){var a=JSON.stringify(e);try{window.external.callFromScript(a)}catch(e){console.log("SYSPRORehostedBrowser window.external.callFromScript: "+e.message)}}else if("StandaloneBrowser"===this.interopType)if("logMessage"===e.Operation);else{e.KeyFieldValue||(e.KeyFieldValue=""),e.AdditionalField1||(e.AdditionalField1="");var o="";"eventTrigged"===e.Operation&&"invocationCallback"!==e.AdditionalField1&&"popupDialogButtonClicked"!==e.AdditionalField1&&0!==e.AdditionalField1.indexOf("PLUGIN|")&&(o=this.avantiPluginLoaded),e.AdditionalField2||(e.AdditionalField2=""),e.AdditionalField3||(e.AdditionalField3=""),e.AdditionalField4||(e.AdditionalField4="");var n=!0;if(t&&(n=!1),"closeBrowser"===e.AdditionalField1&&navigator.sendBeacon){e.AdditionalField4=this.sessionId;try{var d=this.getDeviceId();e.KeyField||(d="");var s=navigator.sendBeacon(this.standaloneAddress+"api/UXAdminWeb/CloseSYSPROCalled?SessionId="+this.sessionId+"&AvantiPlugin="+o+"&DeviceId="+d);console.log("CloseSuccess - "+s)}catch(t){console.log(t.message)}}else{var l=this;$.ajax({url:l.standaloneAddress+l.renderMode+"/UXInteropWeb/CallFromScript",type:"POST",headers:{SessionId:l.sessionId,AvantiPlugin:o,DeviceId:l.getDeviceId()},data:e,async:n}).done(function(e){l.sysproInteropInternal.callFromSYSPRO(e.MethodName,e.DataOut)}).fail(function(e){console.log("CallFromScript error - "+e)}).always(function(){})}}},CallLayerInteropClass.prototype.calledFromNative=function(e,t){this.sysproInteropInternal.callFromSYSPRO(e,t)},CallLayerInteropClass.prototype.selectFile=function(t,a,o){if("SYSPRORehostedBrowser"===this.interopType)this.sysproInteropInternal.genericCall("selectFile",o,"","","","","","",t,a);else if("StandaloneBrowser"===this.interopType)try{var n=null,d=!1,s=null,l=-1!=navigator.userAgent.indexOf("Firefox");l?(d=!0,$("#invisibleNodes").append("<div id='filedialog'></div>"),s=$("#filedialog").kendoDialog({title:"Please select a file",content:"<input class=\"file-browser-input\" type=\"file\"></input>",visible:!1,width:"200px",modal:!0,actions:[{text:"Cancel",action:function action(){return a({FilePath:"",FileExt:"",FileBase64:"",ErrorMessage:"No file selected."}),!0}}]}).data("kendoDialog"),s.open(),n=$(".file-browser-input")[0]):(n=document.createElement("input"),n.setAttribute("type","file"));var r="";"Images"===o?r="image/*":"Documents"===o?r=".pdf, .docx, .doc, .xls, .xlsx":o&&(r=o),n.setAttribute("accept",r),$(n).on("change",function(a){d&&(s.close(),s.destroy(),$("#filedialog").html(""));var e=a.target.files;$.each(e,function(){var e=new FileReader,a=this;e.onload=function(o){var e=o.target.result;console.log("File  Loaded:  "+e);var n=e.substring(e.indexOf(";base64,")+8);console.log("File  name:  "+a.name);var d=a.name.substr(a.name.lastIndexOf("."));console.log("File  type:  "+d);var s={FilePath:a.name,FileExt:d,FileBase64:n,ErrorMessage:""};t(s)},e.readAsDataURL(this)})}),l||n.click()}catch(e){a(e)}},CallLayerInteropClass.prototype.openFile=function(e,t,a,o,n){if("SYSPRORehostedBrowser"===this.interopType)this.sysproInteropInternal.genericCall("openFile",a,o,"","","","","",e,t);else if("StandaloneBrowser"===this.interopType)try{var d=this.standaloneAddress+"api/UXFileProviderWeb/GetUploadedFile?SessionId="+this.sessionId+"&FileId="+a,s=window.open(d,o);n&&s&&(s.focus(),s.print())}catch(e){t(e)}},CallLayerInteropClass.prototype.callFusionService=function(e,t,a,o,n){$.ajax({url:this.standaloneAddress+e,type:a,headers:{SessionId:this.sessionId,AvantiPlugin:this.avantiPluginLoaded},data:t,crossDomain:!0}).done(function(e){o&&o(e)}).fail(function(e,t,a){n&&n(a)})},CallLayerInteropClass.prototype.getDeviceId=function(){var e=localStorage.getItem("AVT_DEVICEID");return e||(e=this.sysproInteropInternal.generateUUID(),localStorage.setItem("AVT_DEVICEID",e)),e},CallLayerInteropClass.prototype.setKMSToken=function(e){localStorage.setItem("AVT_KMSTOKEN",e)},CallLayerInteropClass.prototype.getKMSToken=function(){return localStorage.getItem("AVT_KMSTOKEN")},CallLayerInteropClass.prototype.setMFAToken=function(e){localStorage.setItem("AVT_MFATOKEN",e)},CallLayerInteropClass.prototype.getMFAToken=function(){return localStorage.getItem("AVT_MFATOKEN")},CallLayerInteropClass.prototype.removeMFAToken=function(){return localStorage.removeItem("AVT_MFATOKEN")},CallLayerInteropClass.prototype.storeData=function(e,t){return"SYSPRORehostedBrowser"===this.interopType?window.external.dataOperation("storeData",e,t):this.dataStorage[e]=t},CallLayerInteropClass.prototype.retrieveData=function(e){return"SYSPRORehostedBrowser"===this.interopType?window.external.dataOperation("retrieveData",e,""):this.dataStorage[e]},CallLayerInteropClass.prototype.hideMfaResendButton=function(){$("#MfaPinEntryDiv").removeClass("col-xs-8"),$("#MfaPinEntryDiv").addClass("col-xs-11"),$("#MfaPinResendBtnDiv").hide()},CallLayerInteropClass.prototype.showMfaResendButton=function(){$("#MfaPinEntryDiv").removeClass("col-xs-11"),$("#MfaPinEntryDiv").addClass("col-xs-8"),$("#MfaPinResendBtnDiv").show()},CallLayerInteropClass}(),SYSPROInteropClass=function(){var _Mathfloor2=Math.floor;function SYSPROInteropClass(){var t=this;this.undockOffcanvas=function(a){console.log($(a).data("syspromodalid")),t.eventTrigged($(a).data("syspromodalid"),"","","","undockOffcanvas",function(){},function(){}),t.closeModalWindow($(a).data("syspromodalid"))},this.dockWindow=function(a){var e=$(a.currentTarget).closest(".k-window").find(".modal-window-main").data("syspromodalid");console.log(e),t.eventTrigged(e,"","","","dockWindow",function(){},function(){}),t.closeModalWindow(e)},this.version="807",this.threadedCallbackIndexToUse=0,this.threadedCallbacksLookup=new Dictionary,this.viewModel=null,this.toolbarModel=null,this.isInAppBuilder=!1,this.errorHandler="Internal",this.internalHistoryIndex=0,this.internalHistoryChange=0,this.decimalCharacter=".",this.thousandSeperator=";",this.numericMasking="",this.inputMaskEscapeChar="",this.dateFormat="yyyy-MM-dd",this.harmonyEnabled=!1,this.harmonyAddress="",this.ignoreLastToolbarChange=!1,this.predictiveSearchCache={},this.cursorX=0,this.cursorY=0,this.cursorContextMenuOpenedX=0,this.cursorContextMenuOpenedY=0,this.taskDialogContentShown="",this.typingInterval=null,this.typingElement=null,this.typingOperation=null,this.predictiveSearchActive=!1,this.fullBindRequired=null,this.modalWindowStack=[],this.bindOnCurrentDivPerformed=!1,this.bindOnCurrentToolbarPerformed=!1,this.currentUserSession=null,this.reconnectionAttempts=0,this.autoDateChange=!1,this.isInEntryScreen="",this.recentProgramList=[],this.currentContextMenu=null,this.currentContextMenuUnhealthyClose=null,this.isProgramaticClose=!1,this.popupDialogOpened=!1,this.manualButtonDialogClosed=!1,this.logDataSource=null,this.inDesignMode=!1,this.lastActivityDateTime=Date.now(),this.modalWindowHolder=[],this.manualSignOff=!1,this.isTouchDevice=!1,this.gridHelpers=new AvantiGridsClass(this),this.callLayerInterop=new CallLayerInteropClass(this,queryLayoutUIHelpers)}return SYSPROInteropClass.prototype.generateUUID=function(){var e=new Date().getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var a=0|(e+16*Math.random())%16;return e=_Mathfloor2(e/16),("x"==t?a:8|7&a).toString(16)});return t},SYSPROInteropClass.prototype.showSmartTag=function(e){try{var t=e.getAttribute("data-fieldvalue"),a=e.getAttribute("data-fieldcaption"),o=e.getAttribute("data-fieldname");o||(o=a),this.eventTrigged("",a,t,o,"showSmartTag",function(){},function(){})}catch(e){this.handleError(e.message,"showSmartTag")}},SYSPROInteropClass.prototype.hyperlinkClicked=function(e){try{var t=e.getAttribute("data-fieldvalue"),a=e.getAttribute("data-fieldcaption"),o=e.getAttribute("data-fieldname");o||(o=a),this.eventTrigged("",a,t,o,"hyperlinkClicked",function(){},function(){})}catch(e){this.handleError(e.message,"hyperlinkClicked")}},SYSPROInteropClass.prototype.openLink=function(e){try{if(!e.classList.contains("disabled")){var t=e.getAttribute("data-fieldvalue"),a=e.getAttribute("data-keyaction");this.eventTrigged("",a,t,"","openLink",function(){},function(){})}}catch(e){this.handleError(e.message,"openLink")}},SYSPROInteropClass.prototype.getData=function(e,t,a,o,n,d){try{var s={Operation:"getData",Application:e,KeyField:t,KeyFieldValue:a,FinalParameter:o,AdditionalField1:"",AdditionalField2:"",AdditionalField3:"",CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"sysproInterop.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:n,Error:d};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;this.callLayerInterop.callLayerWithData(s)}catch(e){this.handleError(e.message,"getData")}},SYSPROInteropClass.prototype.eventTrigged=function(e,t,a,o,n,d,s,l,r){void 0===l&&(l=!1),void 0===r&&(r=!1);try{var c=null;r&&(c="AWAITCALLBACK");var p={Operation:"eventTrigged",Application:e,KeyField:t,KeyFieldValue:a,FinalParameter:o,AdditionalField1:n,AdditionalField2:"",AdditionalField3:"",AdditionalField4:c,CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"sysproInterop.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:d,Error:s};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;this.callLayerInterop.callLayerWithData(p,l)}catch(e){this.handleError(e.message,"eventTrigged")}},SYSPROInteropClass.prototype.genericCall=function(e,t,a,o,n,d,s,l,r,c){try{var p={Operation:e,Application:t,KeyField:a,KeyFieldValue:o,FinalParameter:n,AdditionalField1:d,AdditionalField2:s,AdditionalField3:l,CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"sysproInterop.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:r,Error:c};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;this.callLayerInterop.callLayerWithData(p)}catch(t){this.handleError(t.message,"genericCall - "+e)}},SYSPROInteropClass.prototype.logMessage=function(e,t,a,o,n){this.callLayerInterop.callLayerWithData({Operation:"logMessage",Application:e,KeyField:t,KeyFieldValue:a,FinalParameter:o,AdditionalField1:n,AdditionalField2:"",AdditionalField3:"",CallbackIndex:"",CallbackMethod:""})},SYSPROInteropClass.prototype.getModel=function(e,t,a,o){try{o||(o="");var n={Operation:"getModel",Application:o,KeyField:e,KeyFieldValue:"",FinalParameter:"",AdditionalField1:"",AdditionalField2:"",AdditionalField3:"",CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"this.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:t,Error:a};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;this.callLayerInterop.callLayerWithData(n)}catch(e){this.handleError(e.message,"getModel")}},SYSPROInteropClass.prototype.setModel=function(e,t,a,o){try{var n={Operation:"setModel",Application:"",KeyField:e,KeyFieldValue:JSON.stringify(t),FinalParameter:"",AdditionalField1:"",AdditionalField2:"",AdditionalField3:"",CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"this.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:a,Error:o};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;this.callLayerInterop.callLayerWithData(n)}catch(e){this.handleError(e.message,"getModel")}},SYSPROInteropClass.prototype.getNotificationsContent=function(e,t){try{var a={Operation:"getNotificationsContent",Application:"",KeyField:"",KeyFieldValue:"",FinalParameter:"",AdditionalField1:"",AdditionalField2:"",AdditionalField3:"",CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"this.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:e,Error:t};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;this.callLayerInterop.callLayerWithData(a)}catch(e){this.handleError(e.message,"getNotificationsContent")}},SYSPROInteropClass.prototype.triggerModelChanged=function(e){try{this.eventTrigged(JSON.stringify(e),"","","","modelChanged",function(){},function(){})}catch(e){this.handleError(e.message,"triggerModelChanged")}},SYSPROInteropClass.prototype.performPredictiveSearch=function(e,t,a,o,n){try{0===e.indexOf("Conversion")&&(e=e.replace("Conversion","")),n||(n="0");var d="";this.viewModel&&this.viewModel.Fields&&this.viewModel.Fields.SYSPROKeyData&&(d=this.viewModel.Fields.SYSPROKeyData);var s={Operation:"performPredictiveSearch",Application:n,KeyField:e,KeyFieldValue:t,FinalParameter:JSON.stringify(d),AdditionalField1:"",AdditionalField2:"",AdditionalField3:"",CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"this.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:a,Error:o};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;this.callLayerInterop.callLayerWithData(s)}catch(e){this.handleError(e.message,"performPredictiveSearch")}},SYSPROInteropClass.prototype.getFileFromServer=function(e,t,a){this.genericCall("getFileFromServer",e,"","","","","","",t,a)},SYSPROInteropClass.prototype.getHtmlFromModel=function(e,t,a,o,n,d,s,l,r){try{var c={Operation:"getHtmlFromModel",Application:"",KeyField:e,KeyFieldValue:JSON.stringify(r),FinalParameter:JSON.stringify(t),AdditionalField1:JSON.stringify(o),AdditionalField2:JSON.stringify(n),AdditionalField3:JSON.stringify(d),AdditionalField4:JSON.stringify(s),CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"this.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:a,Error:l};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;callLayerInterop.callLayerWithData(c)}catch(e){this.handleError(e.message,"getHtmlFromModel")}},SYSPROInteropClass.prototype.setAvailableFieldsInternal=function(){this.handleError("setAvailableFieldsInternal has been deprecated in Avanti.","setAvailableFieldsInternal")},SYSPROInteropClass.prototype.getVisualBuilderLayout=function(){try{console.log("getVisualBuilderLayout"),SYSPRO_VB&&(this.internalHistoryIndex=SYSPRO_VB.historyIndex,this.internalHistoryChange=0);var e={};$.each(window.viewModel.OffCanvasLayouts,function(t,a){if(a.Id){var o=a.Columns.data();$.each(o,function(){var e=this.Widgets;e&&$.each(e,function(){this.Tabs&&(this.Tabs=this.Tabs.data())})}),e["offcanvas-"+a.Id]={Id:a.Id,OffCanvas:a.OffCanvas,Title:a.Title,Columns:a.Columns.data(),MainToolbar:{IsToolbarVisible:a.MainToolbar.IsToolbarVisible,Columns:a.MainToolbar.Columns.data()}}}});var t=window.viewModel.dataSource.data();$.each(t,function(){var e=this.Widgets;e&&$.each(e,function(){this.Tabs&&(this.Tabs=this.Tabs.data())})});var a={MainToolbar:{Columns:window.viewModel.toolbar.data()},Columns:t,OffCanvasLayouts:e};return JSON.stringify(a)}catch(e){this.handleError(e.message,"getVisualBuilderLayout")}},SYSPROInteropClass.prototype.setVisualBuilderLayout=function(e){try{console.log("setVisualBuilderLayout"),window.viewModel.dataSource.data(e)}catch(e){this.handleError(e.message,"setVisualBuilderLayout")}},SYSPROInteropClass.prototype.getToolbarValues=function(){try{return console.log("getToolbarValues"),this.toolbarModel?JSON.stringify(this.toolbarModel.toJSON()):"{}"}catch(e){this.handleError(e.message,"getToolbarValues")}},SYSPROInteropClass.prototype.getFormValues=function(){try{return console.log("getFormValues"),this.viewModel?JSON.stringify(this.viewModel.toJSON()):"{}"}catch(e){this.handleError(e.message,"getFormValues")}},SYSPROInteropClass.prototype.getInactivityTime=function(){return Date.now()-this.lastActivityDateTime},SYSPROInteropClass.prototype.getUnsavedChanges=function(){try{console.log("getUnsavedChanges");var e="false";return(SYSPRO_VB&&SYSPRO_VB.historyIndex!==this.internalHistoryIndex||0!==this.internalHistoryChange)&&(e="true"),e}catch(e){this.handleError(e.message,"getUnsavedChanges")}},SYSPROInteropClass.prototype.setFocus=function(e){try{for(var t=null,a=!1,o=null,n=this.modalWindowHolder.length-1;0<=n;n--)if(!1===this.modalWindowHolder[n].NotModal){this.modalWindowHolder[n].Window&&this.modalWindowHolder[n].Window.element&&(t=this.modalWindowHolder[n].Window.element);break}if(!e||" "===e){var d=null,s=$(".syspro-focusable:not([disabled]):visible",t).first();$.each($(".syspro-focusable:not([disabled]):visible",t),function(){$(this).offset()&&(!d||$(this).offset().top+$(this).offset().left<=d)&&(s=$(this),d=s.offset().top+s.offset().left)}),s.focus()}else{if(0<e.indexOf("|NEXT")){if(e=e.replace("|NEXT",""),$("#"+e.replace(".","\\."),t).offset()){var l=$("#"+e.replace(".","\\."),t).offset().top+$("#"+e.replace(".","\\."),t).offset().left,r=1e5;$.each($(".syspro-focusable:not([disabled]):visible",t),function(){if(this.id!==e){var t=$(this).offset().top+$(this).offset().left-l;0<=t&&t<r&&(o=$(this),r=t)}})}else console.log("SetFocus Failed  - Field not found "+e);o&&console.log("Set focus next item found to be: "+o.attr("id"))}else if(0===e.indexOf("Tab.")){var c=e.replace("Tab.",""),p=$("*[data-tabidentifier=\""+c+"\"]");a=!0,$.each($(".avanti-tab-link",p.closest(".avanti-tab-links-holder")),function(){$(this).removeClass("active"),$(this).closest(".nav-item").removeClass("active")}),p.addClass("active"),p.closest(".nav-item").addClass("active");var u=p.attr("href"),m=$(u);$.each($(".avanti-tab-pane",m.closest(".tab-content")),function(){$(this).removeClass("active"),$(this).removeClass("in")}),m.addClass("active"),m.addClass("in")}else o=$("#"+e.replace(".","\\."));o&&!a&&(o.hasClass("combobox")&&(o=$("input.combobox",o.closest(".form-group"))),o.focus())}}catch(e){this.handleError(e.message,"setFocus")}},SYSPROInteropClass.prototype.setFieldValue=function(e){try{if("Toolbar"!==e.ParentName)this.viewModel?this.viewModel[e.ParentName]&&this.viewModel[e.ParentName][e.FieldName]&&this.viewModel[e.ParentName][e.FieldName]&&this.viewModel[e.ParentName][e.FieldName].set(e.PropertyName,e.Value):this.handleError("At least one full bind of the fields must be performed before the setting an individual field  can be performed.","setFieldValue");else if("Caption"===e.PropertyName&&$(".avanti-toolbar-button-caption",$("#"+e.ParentName+"\\."+e.FieldName)).html(e.Value),!this.toolbarModel)this.handleError("At least one full bind of the fields must be performed before the setting an individual field  can be performed.","setFieldValue");else if(this.toolbarModel[e.ParentName]&&this.toolbarModel[e.ParentName][e.FieldName]&&this.toolbarModel[e.ParentName][e.FieldName]){this.toolbarModel[e.ParentName][e.FieldName].set(e.PropertyName,e.Value),this.ignoreLastToolbarChange=!0;var t=$("#"+e.ParentName+"\\."+e.FieldName+".dropdown-select");0<t.length&&0<t.find("option").length&&(1!==t.find("option").length||""!==t.find("option")[0].innerHTML)&&t.trigger("change"),0<$("#"+e.ParentName+"\\."+e.FieldName+".combobox").length&&$("#"+e.ParentName+"\\."+e.FieldName+".combobox.combobox-initialized").combobox("refresh")}}catch(e){this.handleError(e.message,"setFieldValue")}},SYSPROInteropClass.prototype.logSYSPROMessage=function(e){var t=e.split("|")[0],a=e.split("|")[1],o=e.split("|")[2];this.logDataSource&&this.logDataSource.add({EventClass:a,EventDate:new Date,EventType:t,Message:o})},SYSPROInteropClass.prototype.setEnabled=function(e){try{var t=this,a=e.Enable;$.each(e.FieldNames,function(){if(0===this.indexOf("Links.")){var e=this.substr(6),o=$("*[data-keyaction='"+e+"']");a?o.removeClass("disabled"):o.addClass("disabled")}else{var n=$("#"+this.replace(".","\\."));0===this.indexOf("Toolbar.")&&(t.ignoreLastToolbarChange=!!(0<n.length&&"INPUT"===n[0].tagName&&n.is(":focus")&&"checkbox"!==n[0].type),0===n.length&&(n=$("#"+this.replace("Toolbar.","Fields\\.TOOLBAR\\:")))),n.hasClass("syspro-file-browse-input")||n.prop("disabled",!a),n.hasClass("syspro-toolbar-widget-button")&&(a?n.closest("li").removeClass("disabled"):n.closest("li").addClass("disabled")),(n.hasClass("gridButton")||n.data("keyaction"))&&(a?n.removeClass("disabled"):n.addClass("disabled")),0<$(".syspro-browse-button-container",n.closest(".form-group")).length&&(a?$(".syspro-browse-button",$(".syspro-browse-button-container",n.closest(".form-group"))).removeClass("disabled"):$(".syspro-browse-button",$(".syspro-browse-button-container",n.closest(".form-group"))).addClass("disabled")),n.hasClass("date-input")&&(a?n.siblings(".input-group-addon").removeClass("disabled"):n.siblings(".input-group-addon").addClass("disabled")),n.hasClass("syspro-browse-input")&&(a?n.siblings(".input-group-btn").removeClass("disabled"):n.siblings(".input-group-btn").addClass("disabled")),a?$(".syspro-hyperlink-button",n.closest(".syspro-entry-content")).removeClass("disabled"):$(".syspro-hyperlink-button",n.closest(".syspro-entry-content")).addClass("disabled"),a?n.closest(".form-group").removeClass("disabled"):n.closest(".form-group").addClass("disabled")}})}catch(e){this.handleError(e.message,"setEnabled")}},SYSPROInteropClass.prototype.setChecked=function(e){try{var t=e.Enable;$.each(e.FieldNames,function(){var e=$("#"+this.replace(".","\\."));t?(e.addClass("avanti-checked"),e.attr("checked","true")):(e.removeClass("avanti-checked"),e.attr("checked",null))})}catch(e){this.handleError(e.message,"setChecked")}},SYSPROInteropClass.prototype.getWidgetVisible=function(e){try{var t="";return $.each(e.FieldNames,function(){var e=$("#"+this.replace(".","\\."));0===e.length&&(e=$("*[data-sysprogridfieldname=\""+this+"\"]")),t&&(t+=",");var a="false";0<e.filter(":visible").length&&(a="true"),t+=a}),t}catch(e){this.handleError(e.message,"getWidgetVisible")}},SYSPROInteropClass.prototype.getGlobalValue=function(e){try{if(this.currentUserSession&&this.currentUserSession[e])return this.currentUserSession[e];if(this.viewModel.Fields&&this.viewModel.Fields.SYSPROKeyData){var t=this.viewModel.Fields.SYSPROKeyData.get(e);if(t)return t.Value}return""}catch(e){return""}},SYSPROInteropClass.prototype.setFieldVisible=function(e){try{var t=e.Enable;$.each(e.FieldNames,function(){var e=this,a;if(0===e.indexOf("Grid.")){var o=e.replace("Grid.","");a=$("*[data-sysprogridfieldname=\""+o+"\"]"),0<a.length&&(a=a.closest(".noBorderTable"))}else if(0===e.indexOf("Tab.")){var n=e.replace("Tab.","");a=$("*[data-tabidentifier=\""+n+"\"]");var d=a.attr("href"),s=$(d),l=$(".avanti-tab-pane",s.closest(".tab-content"));t||(l.removeClass("active"),l.removeClass("in"))}else a=$("#"+e.replace(".","\\.")),0<a.length&&("INPUT"===a[0].tagName||"TEXTAREA"===a[0].tagName||"SELECT"===a[0].tagName||a.hasClass("syspro-databound-radiobutton")||a.hasClass("slider"))&&(a=a.closest(".form-group"));t?a.show():a.hide()})}catch(e){this.handleError(e.message,"setFieldVisible")}},SYSPROInteropClass.prototype.createButtonOnEntryField=function(e){try{$.each(e.FieldNames,function(){var e=this,t=e.replace(".","\\."),a=e,o=!1,n="",d=!1,s=!1;0<e.indexOf("|")&&(o=!0,t=e.split("|")[0].replace(".","\\."),a=e.split("|")[0],n=e.split("|")[1],2<e.split("|").length&&(d=!0),"HIDE"===n&&(s=!0));var l=$("#"+t),r=l.val(),c=null;r||(0<$(".form-data-widget",l).length?(c=$(".form-data-widget",l),r=c.text()):0<$(".data-field-value",l).length?(c=$(".data-field-value",l),r=c.text()):r="NOTFOUND");var p=a;if(0<l.length)if(!o){var u=null;if(l.hasClass("syspro-button-created"))"NOTFOUND"!==r&&($("a",l).html(r),0<$("a",l).length&&$("a",l)[0]&&($("a",l)[0].setAttribute("data-fieldcaption",p),$("a",l)[0].setAttribute("data-fieldvalue",r),$("a",l)[0].setAttribute("data-fieldname",e)));else{"NOTFOUND"===r&&(r="");var m="<a ref='#' onclick='sysproInterop.hyperlinkClicked(this)' class='syspro-hyperlink-button' data-fieldname='"+a+"' data-fieldcaption: '"+p+"' data-fieldvalue='"+r+"' data-bind='html: "+a+".Value'>"+r+"</a>",g=l.closest(".syspro-entry-content");0===g.length?0<$(".data-field-value",l).length?($(".data-field-value",l).after(m),u=$(".syspro-hyperlink-button",l),$(".data-field-value",l).hide()):0<$(".form-data-widget",l).length&&($(".form-data-widget",l).after(m),u=$(".syspro-hyperlink-button",l),$(".form-data-widget",l).hide()):($(".help-block",g).hide(),l.hide(),$(".input-group-btn",g).hide(),u=g.append(m)),l.addClass("syspro-button-created"),c&&(l=c),l[0].kendoBindingTarget&&kendo.bind(u,l[0].kendoBindingTarget.source)}}else if(l.hasClass("syspro-button-created"))$.each(l,function(){var e=$(this);s?0<e.siblings("a.btn-block").length?e.siblings("a.btn-block").hide():$("a.btn-block",e.closest(".syspro-entry-content")).hide():0<e.siblings("a.btn-block").length?e.siblings("a.btn-block").show():$("a.btn-block",e.closest(".syspro-entry-content")).show()});else{l.closest(".syspro-entry-content").addClass("additional-input-button"),"NOTFOUND"===r&&(r="");var h="<a class=\"btn btn-default btn-block btn-sm\" ref=\"#\" onclick=\"sysproInterop.hyperlinkClicked(this)\" data-fieldname=\""+a+"\" data-fieldcaption: \""+p+"\" data-fieldvalue=\""+r+"\">"+n+"</a>";$.each(l,function(){var e=$(this);0===e.siblings(".help-block").length?0<e.closest(".input-group").length?e.closest(".input-group").after(h):0<e.closest(".checkbox").length?e.closest(".checkbox").after(h):e.parent().append(h):e.siblings(".help-block").first().before(h)}),d&&$("input",l.closest(".syspro-entry-content")).hide(),l.addClass("syspro-button-created"),SYSPRO_VB.sizeAddonButtons()}})}catch(e){this.handleError(e.message,"createButtonOnEntryField")}},SYSPROInteropClass.prototype.showModalWindow=function(t,a){try{var o=t.ModalId,n=t.SYSPROId,d=t.Maximize,s="",l=null,r=null,c=this;if(!c.callLayerInterop.avantiPluginLoaded&&n&&t.Title&&"IMPPAS"!==n.trimRight()&&"IMPMEN"!==n&&"      "!==n&&"IMPTIM"!==n.trimRight()&&6===n.trimRight().length&&(c.addRecentProgram(n.trimRight(),t.Title,"Program",null),c.callLayerInterop.programName=n.trimRight()),0===t.ModalType){s="<div id=\""+o+"\" data-syspromodalid=\""+n+"\" class=\"modal-window-main\"><div class=\"window-container\"><div class=\"window-content\">",s=s+t.HtmlContent+"</div></div><div class=\"statusBar sys-bg-inverse\"><span class=\"status-message sys-fg-very-light-gray\">This is a status message</span></div></div>",$("#offCanvasContainer").append($(s)),c.modalWindowId=o;var p=null;t.NotModal?(p=["Minimize","Maximize","Close"],t.NoClose&&(p=["Minimize","Maximize"])):(p=["Close"],t.NoClose&&(p=[])),t.IncludePin&&(p?p.unshift("Pin"):p=["Pin"]),r=SYSPRO_VB.createKendoWindow(o,t.Title,function(){1===$(".special-text-notes",this.wrapper).length&&$(this.wrapper).addClass("modal-with-special-text-notes"),this.wrapper&&this.wrapper.find(".k-i-pin").parent().click(function(t){c.dockWindow(t),t.preventDefault()})},function(o){var e=$(o.sender.element),n=e.data("kendoWindow").options,d=n.position.top,s=n.position.left,l=n.width,r=n.height;isNaN(s)&&("50%"===s?s="":s=s.replace("px","")),isNaN(d)&&("50%"===d?d="":d=d.replace("px","")),isNaN(l)&&(l=l.replace("px","")),isNaN(r)&&(r=r.replace("px",""));var p=!0,u=s+";"+d+";"+l+";"+r;if(o.userTriggered&&(c.isProgramaticClose=!1,c.modalWindowClosed(e.data("syspromodalid"),u)),!t.NotModal&&o.userTriggered&&(p=!1,o.preventDefault()),p&&o.userTriggered){var m=-1;$.each(c.modalWindowHolder,function(t){this.Id==e.data("syspromodalid")&&(m=t)}),-1<m?c.modalWindowHolder.splice(m,1):c.modalWindowHolder.pop()}p&&"SearchWindow"!==a&&(c.fullBindRequired=null),$(".tooltip").hide(),$("[id=loading-cover]").fadeOut()},p,t.Width,t.Height,t.NotModal,!0,!0,t.Left,t.Top);var u=null;u=t.Left||t.Top?r.open():r.center().open(),d&&u.maximize(),l=r.element,"SearchWindow"!==a&&(c.fullBindRequired=$("#"+o))}else{var m="navbar-offcanvas-right";2===t.ModalType&&(m="navbar-offcanvas-bottom"),s="<div class=\""+m+" navbar-offcanvas navbar-offcanvas-touch is-open\" id=\"offcanvas-"+o+"\"><header class=\"offcanvas-header\">",s=s+"<h4 class=\"pull-left sys-mg-t-10 sys-mg-b-5\">"+t.Title+"</h4>",t.NoClose||(s=s+"<span class=\"pull-right offcanvas-toggle sys-pd-t-10\" data-toggle=\"offcanvas\" data-target=\"#offcanvas-"+o+"\" onclick=\"sysproInterop.isProgramaticClose = false;\">",s+="<i class=\"material-icons\">close</i></span>",s=s+"<span class=\"pull-right offcanvas-toggle sys-pd-t-10\" data-syspromodalid=\""+n+"\" onclick=\"sysproInterop.undockOffcanvas(this);\" data-tooltip=\"tooltip\" data-placement=\"bottom\" data-original-title=\"Undock window\">",s+="<i class=\"material-icons\">eject</i></span>"),s+="</header>",s+=t.HtmlContent,s+="</div>",$("#offCanvasContainer").append($(s)),l=$("#offcanvas-"+o+" [data-toggle=\"offcanvas\"]"),r=new Offcanvas($("#offcanvas-"+o+" [data-toggle=\"offcanvas\"]"));var g=t.Width,h=t.Height;$("#offcanvas-"+o).on("hide.bs.offcanvas",function(a){if(!c.isProgramaticClose){var e="0;0;"+g+";"+h;c.modalWindowClosed(n,e)}var d=!0;if(!t.NotModal&&!c.isProgramaticClose)return d=!1,a.preventDefault();if(d&&!c.isProgramaticClose){var s=-1;$.each(c.modalWindowHolder,function(e){this.Id==n&&(s=e)}),-1<s?c.modalWindowHolder.splice(s,1):c.modalWindowHolder.pop(),queryLayoutUIHelpers.disposeViewOnly(o)}d&&(c.fullBindRequired=null),c.isProgramaticClose=!1}),$("#offcanvas-"+o+" .offcanvas-toggle").addClass("is-open"),$("#offcanvas-"+o).addClass("in");1==t.ModalType?(g&&(!isNaN(g)&&(g+="px"),$("#offcanvas-"+o).css("right","-"+g),$("#offcanvas-"+o).css("max-width",g)),$("#offcanvas-"+o).css("height","100%")):(!isNaN(h)&&(h+="px"),$("#offcanvas-"+o).css("bottom","-"+g),$("#offcanvas-"+o).css("max-height",g)),"SearchWindow"!==a&&(c.fullBindRequired=$("#offcanvas-"+o))}return c.modalWindowHolder.push({Id:n,Window:r,NotModal:t.NotModal,ModalType:t.ModalType}),"SearchWindow"!==a&&(c.bindOnCurrentDivPerformed=!1,c.bindOnCurrentToolbarPerformed=!1),queryLayoutUIHelpers.initializeViewOnly(null,l,o),queryLayoutUIHelpers.initializeToolbarEvents(),$("[id=loading-cover]").fadeOut(),o}catch(e){c.handleError(e.message,"showModalWindow")}},SYSPROInteropClass.prototype.openNewSYSPROInstance=function(e){try{window.open(window.location.href.replace("#","")+"?SecondInstance=true&OpenParameters="+e,"_blank")}catch(e){this.handleError(e.message,"openNewSYSPROInstance")}},SYSPROInteropClass.prototype.undoCalled=function(){try{console.log("undoCalled"),++this.internalHistoryChange}catch(e){this.handleError(e.message,"undoCalled")}},SYSPROInteropClass.prototype.redoCalled=function(){try{console.log("redoCalled"),--this.internalHistoryChange}catch(e){this.handleError(e.message,"redoCalled")}},SYSPROInteropClass.prototype.getAvailableFields=function(e,t,a){try{a?!0===a&&(a="true"):a="false";var o={Operation:"getAvailableFields",Application:"",KeyField:a,KeyFieldValue:"",FinalParameter:"",AdditionalField1:"",AdditionalField2:"",AdditionalField3:"",CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"this.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:e,Error:t};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;this.callLayerInterop.callLayerWithData(o)}catch(e){this.handleError(e.message,"getAvailableFields")}},SYSPROInteropClass.prototype.queryForCard=function(e,t,a,o,n,d){try{var s={Operation:"queryForCard",Application:o,KeyField:e,KeyFieldValue:JSON.stringify(a),FinalParameter:t,AdditionalField1:"",AdditionalField2:"",AdditionalField3:"",CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"this.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:n,Error:d};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;this.callLayerInterop.callLayerWithData(s)}catch(e){this.handleError(e.message,"queryForCard")}},SYSPROInteropClass.prototype.interopCallbackReceived=function(t){try{var e=new ErrorMessageModel;try{e=JSON.parse(t.OutputData)}catch(t){e.ErrorMessage=t.message}this.threadedCallbacksLookup[t.CallbackIndex]&&(!e&&(e=new ErrorMessageModel,e.ErrorMessage="A blank reply was received from the call."),e.ErrorMessage?(console.log("interopCallbackReceived ERROR MESSAGE- "+e.ErrorMessage),this.threadedCallbacksLookup[t.CallbackIndex].Error&&this.threadedCallbacksLookup[t.CallbackIndex].Error(e)):this.threadedCallbacksLookup[t.CallbackIndex].Success&&this.threadedCallbacksLookup[t.CallbackIndex].Success(e),this.threadedCallbacksLookup[t.CallbackIndex]=null,this.threadedCallbackIndexToUse=t.CallbackIndex)}catch(e){console.log(e),console.log("interopCallbackReceivedERROR - "+JSON.stringify(this.threadedCallbacksLookup[t.CallbackIndex])),this.handleError(e.message,"interopCallbackReceived")}},SYSPROInteropClass.prototype.getStructureForBO=function(e,t,a,o,n){try{var d={Operation:"getStructureForBO",Application:"",KeyField:"",KeyFieldValue:"",FinalParameter:"",AdditionalField1:e,AdditionalField2:t,AdditionalField3:a,CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"this.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:o,Error:n};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;this.callLayerInterop.callLayerWithData(d)}catch(e){this.handleError(e.message,"getStructureForBO")}},SYSPROInteropClass.prototype.getIconsAvailable=function(e,t){try{this.genericCall("getIconsAvailable","","","","","","","",e,t)}catch(e){this.handleError(e.message,"getIconsAvailable")}},SYSPROInteropClass.prototype.queryForTiles=function(e,t,a,o,n,d,s){try{this.genericCall("queryForTiles",JSON.stringify(e),a,JSON.stringify(t),JSON.stringify(o),JSON.stringify(n),"","",d,s)}catch(e){this.handleError(e.message,"queryForTiles")}},SYSPROInteropClass.prototype.callHarmonyService=function(e,t,a,o,n){try{var d="GET"===e?$.param(a):JSON.stringify(a);var s="";this.viewModel&&this.viewModel.Fields&&this.viewModel.Fields.SYSPROKeyData&&(s=JSON.stringify(this.viewModel.Fields.SYSPROKeyData)),this.genericCall("callHarmonyService","",e,t,d,s,"","",o,n)}catch(e){this.handleError(e.message,"callHarmonyService")}},SYSPROInteropClass.prototype.selectImage=function(e,t){try{this.genericCall("selectImage","","","","","","","",e,t)}catch(e){this.handleError(e.message,"selectImage")}},SYSPROInteropClass.prototype.selectFile=function(e,t,a){try{this.callLayerInterop.selectFile(e,t,a)}catch(e){this.handleError(e.message,"selectFile")}},SYSPROInteropClass.prototype.openFile=function(e,t,a,o,n){try{this.callLayerInterop.openFile(e,t,a,o,n)}catch(e){this.handleError(e.message,"openFile")}},SYSPROInteropClass.prototype.showDatePicker=function(t){try{var a=this,o=a.generateUUID(),n=t.LocationX;n||(n=a.cursorX);var d=t.LocationY;d||(d=a.cursorY);var s=$("#harness-container");0<a.modalWindowHolder.length&&(s=a.modalWindowHolder[0].Window.element,d=parseInt(d)-s.offset().top,n=parseInt(n)-s.offset().left),d=parseInt(d)+250,s.append("<input id='testpickertemp"+o+"' style='position: absolute; left: "+n+"px; top: "+d+"px; z-index=10000; opacity: 0;'></input>"),$("#testpickertemp"+o).datepicker("show").on("changeDate",function(n){var e=kendo.toString(n.date,"yyyy-MM-dd");a.eventTrigged(t.FieldName,e,"","","fieldChange",function(){},function(){}),$("#testpickertemp"+o).datepicker("destroy"),$("#testpickertemp"+o).remove()})}catch(e){this.handleError(e.message,"showDatePicker")}},SYSPROInteropClass.prototype.callFromSYSPRO=function(callType,dataIn){try{switch(callType){case"bindDataTo":this.bindDataTo(JSON.parse(dataIn));break;case"bindToolbar":this.bindToolbar(JSON.parse(dataIn),!1,!1);break;case"setAvailableFields":this.setAvailableFieldsInternal(JSON.parse(dataIn));break;case"getVisualBuilderLayout":return this.getVisualBuilderLayout();case"setVisualBuilderLayout":this.setVisualBuilderLayout(JSON.parse(dataIn));break;case"getUnsavedChanges":return this.getUnsavedChanges(null);case"setFocus":return this.setFocus(dataIn);case"setFieldValue":return this.setFieldValue(JSON.parse(dataIn));case"logSYSPROMessage":return this.logSYSPROMessage(dataIn);case"showModalWindow":return this.showModalWindow(JSON.parse(dataIn),null);case"openNewSYSPROInstance":return this.openNewSYSPROInstance(dataIn);case"setEnabled":return this.setEnabled(JSON.parse(dataIn));case"showDatePicker":return this.showDatePicker(JSON.parse(dataIn));case"setChecked":return this.setChecked(JSON.parse(dataIn));case"setFieldVisible":return this.setFieldVisible(JSON.parse(dataIn));case"createButtonOnEntryField":return this.createButtonOnEntryField(JSON.parse(dataIn));case"createGridList":return this.gridHelpers.createGridList(JSON.parse(dataIn));case"refreshGridList":return this.gridHelpers.refreshGridList(JSON.parse(dataIn));case"gridRequestInternalEvent":return this.gridHelpers.gridRequestInternalEvent(JSON.parse(dataIn));case"createTreeList":return this.gridHelpers.createTreeList(JSON.parse(dataIn));case"refreshTreeList":return this.gridHelpers.refreshTreeList(JSON.parse(dataIn));case"treeRequestInternalEvent":return this.gridHelpers.treeRequestInternalEvent(JSON.parse(dataIn));case"createTreeView":return this.gridHelpers.createTreeView(JSON.parse(dataIn));case"treeViewRequestInternalEvent":return this.gridHelpers.treeViewRequestInternalEvent(JSON.parse(dataIn));case"showPopupDialog":return this.showPopupDialog(JSON.parse(dataIn));case"closeModalWindow":return this.closeModalWindow(dataIn);case"setModalWindowTitle":return this.setModalWindowTitle(dataIn);case"showTaskDialog":return this.showTaskDialog(JSON.parse(dataIn));case"showContextMenu":return this.showContextMenu(JSON.parse(dataIn));case"toggleLoadingScreen":return this.toggleLoadingScreen(JSON.parse(dataIn));case"setStatusMessage":return this.setStatusMessage(JSON.parse(dataIn));case"getFormValues":return this.getFormValues();case"getToolbarValues":return this.getToolbarValues();case"getInactivityTime":return this.getInactivityTime();case"showError":var message=dataIn.split("|")[0],title=dataIn.split("|")[1];return this.showErrorMessage(message,title);case"openFile":return this.openFile(null,function(e){this.handleError(e.message,"openFile")},JSON.parse(dataIn),JSON.parse(dataIn),!1);case"printFile":return this.openFile(null,function(e){this.handleError(e.message,"openFile")},JSON.parse(dataIn),JSON.parse(dataIn),!0);case"getWidgetVisible":return this.getWidgetVisible(JSON.parse(dataIn));case"signOutAvanti":return this.closeSYSPROFusion(!0);case"selectFile":return this.selectFileInternal(dataIn);case"clearPluginLoaded":this.callLayerInterop.previousAvantiPlugin=this.callLayerInterop.avantiPluginLoaded,this.callLayerInterop.avantiPluginLoaded="";break;case"closeBrowserTab":return this.closeBrowserTab();case"sendNotification":this.sendNotification(JSON.parse(dataIn));break;case"generateAndInsertHtml":this.generateAndInsertHtml(JSON.parse(dataIn));break;case"executeScript":eval(dataIn);break;default:}}catch(e){console.log("callFromSYSPRO Error - "+e.message),this.handleError(e.message,"callFromSYSPRO")}},SYSPROInteropClass.prototype.generateAndInsertHtml=function(e){console.log("generateAndInsertHtml - "+e.DynamicDivId),$("#"+e.DynamicDivId).html(e.HtmlContent),this.bindOnCurrentDivPerformed=!1,queryLayoutUIHelpers.initializeViewOnly(!1,$("#"+e.DynamicDivId),"")},SYSPROInteropClass.prototype.showPopup=function(e){alert(e)},SYSPROInteropClass.prototype.handleError=function(e,t){if("Popup"===this.errorHandler)this.showPopup("Error: "+t+" - "+e);else if("Log"===this.errorHandler)console.log("Error: "+t+" - "+e);else if("Internal"===this.errorHandler){var a="Sorry, something has gone wrong when trying to  '"+t+"'. The technical error message is:";"CleanError"===t&&(e&&0==e.indexOf("ERROR: ")&&(e=e.substring(7)),a=e,e=""),this.showErrorMessage(e,a)}},SYSPROInteropClass.prototype.bindingStarted=function(){},SYSPROInteropClass.prototype.bindingCompleted=function(){},SYSPROInteropClass.prototype.bindDataTo=function(e){try{this.hideErrorMessage(),this.bindingStarted&&this.bindingStarted(e);var t=new ErrorMessageModel;try{e.DataIn=e.DataIn.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\f/g,"\\f"),t=JSON.parse(e.DataIn)}catch(e){t.ErrorMessage=e.message}var a=!1;this.bindOnCurrentDivPerformed||(a=!0),this.performBind(t,a,null,this.fullBindRequired,null,null),this.bindingCompleted&&this.bindingCompleted(t)}catch(e){this.handleError(e.message,"bindDataTo")}},SYSPROInteropClass.prototype.performBind=function(e,t,a,o,n,d){try{var s=this;a||(a=""),kendo&&kendo.culture()&&(kendo.culture().numberFormat["."]=s.decimalCharacter,kendo.culture().numberFormat[","]=s.thousandSeperator);var l=e;if(l&&!l.ErrorMessage){if(o){var r=$(".container-id-holder",o).data("containerid");r&&(o=$.merge(o,$("*[data-parentwindowid='"+r+"']")))}var c=$(a+" .sys-widget:not(.card-widget,.harmony-widget,.tile-widget,.tile-inner,.syspro-toolbar,.tiles-parent,.syspro-nonbound)",o);s.viewModel?l.Fields?($.each(l.Fields,function(e){if("SYSPROKeyData"!==e&&(s.viewModel.Fields.set&&s.viewModel.Fields.set(e,this),0<$(".syspro-trackfield-change#Fields\\."+e).length&&$(".syspro-trackfield-change#Fields\\."+e)[0].setAttribute("data-fieldlastvalue",this),$("#Fields\\."+e).hasClass("dropdown-select"))){var t=$("input.fakeinput",$("#Fields\\."+e).next(".dropdownjs"));this&&""===this.Value?(!t.data("backupcolor")&&t.data("backupcolor",t.css("color")),t.css("color","white")):t.data("backupcolor")&&t.css("color",t.data("backupcolor"))}}),l.Fields.SYSPROKeyData&&(!s.viewModel.Fields.SYSPROKeyData&&s.viewModel.Fields.set&&s.viewModel.Fields.set("SYSPROKeyData",{}),$.each(l.Fields.SYSPROKeyData,function(e,t){s.viewModel.Fields.SYSPROKeyData.set&&s.viewModel.Fields.SYSPROKeyData.set(e,t)}))):$.each(l,function(e){s.viewModel.set&&s.viewModel.set(e,this)}):(t=!0,d=!0),t&&(d&&(s.viewModel=kendo.observable(l)),jQuery.contains(document.documentElement,c[0])&&(kendo.bind(c,s.viewModel),l.Fields&&$.each(l.Fields,function(e){if($("#Fields\\."+e).hasClass("dropdown-select")){s.viewModel.Fields.set&&s.viewModel.Fields.set(e,this);var t=$("input.fakeinput",$("#Fields\\."+e).next(".dropdownjs"));this&&""===this.Value?(!t.data("backupcolor")&&t.data("backupcolor",t.css("color")),t.css("color","white")):t.data("backupcolor")&&t.css("color",t.data("backupcolor"))}}),sysproInterop.resizeSparklines(c),t=!0,s.bindOnCurrentDivPerformed=!0)),(l.SYSPROKeyData||l.Fields&&(l.Fields.SYSPROKeyData||""===l.Fields.SYSPROKeyData))&&($.each($(a+" .card-bindable:not(.harmony-widget,.tile-widget)"),function(){s.bindGenericCard($(this),l.Fields.SYSPROKeyData)}),s.harmonyEnabled&&$.each($(a+" .harmony-widget",o),function(){HarmonyInterop.bindWidget($(this),l.Fields.SYSPROKeyData)}),s.bindTiles(l,o,a,t))}else l&&s.handleError(l.ErrorMessage,"performBind");s.subscribeToFieldEvents(),queryLayoutUIHelpers.initSliders(c),n&&n(!0,"Bind performed successfully.")}catch(e){console.log(e)}},SYSPROInteropClass.prototype.bindToolbar=function(e,t,a){try{var o=this,n=new ToolbarModel;try{n=JSON.parse(e.DataIn)}catch(e){n.ErrorMessage=e.message}try{$.each(n.Toolbar,function(e,t){t.Items.Item=Array.isArray(t.Items.Item)?t.Items.Item:[t.Items.Item]})}catch(e){}var d=$(".syspro-toolbar");d=o.fullBindRequired?$(".syspro-toolbar",o.fullBindRequired):$(".syspro-toolbar"),o.bindOnCurrentToolbarPerformed||(t=!0),o.toolbarModel&&o.toolbarModel.Toolbar?n.Toolbar?$.each(n.Toolbar,function(e){o.toolbarModel.Toolbar.set(e,this)}):(alert("This  is  legacy and should  not  happen"),$.each(n,function(e){o.toolbarModel.set(e,this)})):(t=!0,a=!0),t&&(a&&(o.toolbarModel=kendo.observable(n)),jQuery.contains(document.documentElement,d[0])&&kendo.bind(d,o.toolbarModel),o.bindOnCurrentToolbarPerformed=!0),$("select.combobox.combobox-initialized").combobox("refresh"),o.subscribeToFieldEvents()}catch(e){this.handleError(e.message,"bindToolbar")}},SYSPROInteropClass.prototype.bindGenericCard=function(e,t){try{var a=this,o=e.closest(".card-widget"),n=o.data("cardtype"),d=o.data("cardtypedetail"),s=o.data("parentfieldpath"),l=o.data("bindfunctionname"),r=o.data("afterbindfunctionname"),c=o.data("businessobject"),p=d,u="";if(s){var m=a.viewModel.toJSON(),g=s.split("."),h=p;$.each(g,function(){var e=this+"";m&&(m[e]?(m=m[e],p=h):m=null),h=e}),u=m}if(t[p]&&(l&&window[l]&&window[l](n,d,u,e),(u||!s||-1<s.indexOf("Insights")||-1<s.indexOf("Internal"))&&c)){var f="";a.viewModel&&a.viewModel.Fields&&a.viewModel.Fields.SYSPROKeyData&&(f=JSON.stringify(a.viewModel.Fields.SYSPROKeyData)),a.queryForCard(n,d,u,f,function(t){try{if(jQuery.contains(document.documentElement,e[0])){var o=kendo.observable(t);kendo.bind(e,o),queryLayoutUIHelpers.initializeExpandableCards(e[0]),r&&window[r]&&window[r](n,d,u,t,e)}}catch(e){a.handleError(e.message,"bindGenericCard binding callback")}},function(e){try{a.handleError(e.ErrorMessage,"CleanError")}catch(e){a.handleError(e.message,"Displaying Error")}})}}catch(e){this.handleError(e.message,"bindGenericCard ")}},SYSPROInteropClass.prototype.bindTiles=function(e,t,a,o){var n=[],d={},s={},l=[],r={},c={},p=!1;$.each($(a+" .tile:visible",t),function(){var t=this.getAttribute("data-tiletypename"),a=this.getAttribute("data-tiletypedetail"),u=this.getAttribute("data-parentfieldpath"),m=this.getAttribute("data-tiletype");p=!0;var g=this.getAttribute("data-tileparameters"),h=null;if("Program"!==m&&a&&-1===n.indexOf(a)&&(u&&(h=e.Fields.SYSPROKeyData[u]),h||""===h||!u||o||!h&&u&&g&&-1<g.indexOf("\""+u+"\""))){var f=!0;if(!h&&u&&g&&-1<g.indexOf("\""+u+"\"")){try{var y=JSON.parse(g);y[u]||(f=!1)}catch(t){f=!1}this.getAttribute("data-boundonce")||(f=!0)}!u&&this.getAttribute("data-boundonce")&&(f=!1),m&&0===m.indexOf("ML")&&$.each(e.Fields.SYSPROKeyData,function(e){e&&g&&-1<g.indexOf("\""+e+"\"")&&(f=!0)}),this.setAttribute("data-boundonce","true"),f&&(m&&0===m.indexOf("ML")?(l.push(a),c[a]=t,r[a]=g):(n.push(a),s[a]=t,d[a]=g),$(".tile-loading-cover",$(this)).show())}});var u=this.performTileDataBind(n,e,d,s,"COMQTL",a,t),m=this.performTileDataBind(l,e,r,c,"SYSPROML",a,t);u||m||!p||this.sizeTiles(0,null)},SYSPROInteropClass.prototype.performTileDataBind=function(e,t,a,o,n,d,s){var l=this;if(0<e.length){var r={};return l.viewModel&&l.viewModel.Fields&&l.viewModel.Fields.SYSPROKeyData&&(r=l.viewModel.Fields.SYSPROKeyData.toJSON()),l.queryForTiles(e,r,n,a,o,function(t){t.Query&&$.each(t.Query,function(){"Chart_Bullet"!==this.Type||$.isArray(this.Value)||(this.Value=[this.Value]),0===this.Type.indexOf("Chart")&&void 0===this.Value&&(this.Value=[0])});var a=kendo.observable(t);$.each($(d+" .tile:visible",s),function(){0<=e.indexOf(this.getAttribute("data-tiletypedetail"))&&(jQuery.contains(document.documentElement,this)&&kendo.bind($(this),a),$(".tile-loading-cover",$(this)).hide())}),console.log("---------------------------------------------------------------------resizeSparklines Tiles"),l.resizeSparklines($(d+" .tile:visible",s)),l.sizeTiles(0,null)},function(t){try{$.each($(d+" .tile:visible",s),function(){0<=e.indexOf(this.getAttribute("data-tiletypedetail"))&&($(".tile-loading-cover",$(this)).hide(),$(".tile-title:contains(\"Loading...\")",$(this)).text("Load failed"))}),l.handleError(t.ErrorMessage,"CleanError")}catch(e){l.handleError(e.message,"Displaying Error")}}),!0}return!1},SYSPROInteropClass.prototype.sizeTiles=function(){function sizeTileTitles(e,t){$(e).css("height",t+"px"),$(e).addClass("show-more-icon"),$(e).hover(function(){$(e).removeClass("show-more-icon"),$(e).animate({height:$(e).get(0).scrollHeight},120)},function(){$(e).animate({height:t},60),$(e).addClass("show-more-icon")})}this;queryLayoutUIHelpers.tilesCreated.forEach(function(e){e.packery("layout")}),$(".tile-widget").each(function(){var e=$(this);e.parents(".tile-widget-wrapper").find(".tile-loading-cover").hide()}),fitty(".small-tile .valueIconWrapper .tile-main-value",{minSize:16,maxSize:20.5,multiLine:!1}),fitty(".small-tile .metric-only .tile-main-value",{minSize:16,maxSize:30,multiLine:!0}),fitty(".wide-tile .tile-main-value, .big-tile .tile-main-value",{minSize:22,maxSize:56,multiLine:!0}),$(".small-tile .tile-title:visible").each(function(){var e=this;33<$(e).get(0).scrollHeight&&(0<$(e).siblings(".tile-subtitle").text().length||0<$(e).closest(".ai-tile-icon-title").siblings(".tile-subtitle").text().length)?sizeTileTitles(e,32):46<$(e).get(0).scrollHeight&&(0===$(e).siblings(".tile-subtitle").text().length||0===$(e).closest(".ai-tile-icon-title").siblings(".tile-subtitle").text().length)&&sizeTileTitles(e,45)}),$(".wide-tile .tile-title:visible").each(function(){var e=this;40<$(e).get(0).scrollHeight&&(0<$(e).siblings(".tile-subtitle").text().length||0<$(e).closest(".ai-tile-icon-title").siblings(".tile-subtitle").text().length)?sizeTileTitles(e,39):40<$(e).get(0).scrollHeight&&(0===$(e).siblings(".tile-subtitle").text().length||0===$(e).closest(".ai-tile-icon-title").siblings(".tile-subtitle").text().length)&&sizeTileTitles(e,39)})},SYSPROInteropClass.prototype.sizeTilesCallback=function(e,t){e?this.sizeTiles(null,null):this.showErrorMessage(t,"sizeTilesCallback")},SYSPROInteropClass.prototype.setTheme=function(t){if(t&&$(t).data("themename")&&!$(t).hasClass("sys-fg-success")){var e=$(t).data("themename");this.selectedThemeChecked(e),localStorage.setItem("avanticurrentuserthemename",e),this.activateTheme()}},SYSPROInteropClass.prototype.selectedThemeChecked=function(e){var t=$(".avant-theme-switch[data-themename='"+e+"']");$("i",t).removeClass("sys-fg-white"),$("i",t).addClass("sys-fg-success"),$.each($(t).closest("li").siblings(),function(){$("i",this).removeClass("sys-fg-success"),$("i",this).removeClass("sys-fg-white").addClass("sys-fg-white")})},SYSPROInteropClass.prototype.activateTheme=function(){if(localStorage.getItem("avanticurrentuserthemename")){var e=localStorage.getItem("avanticurrentuserthemename");$("body").attr("data-theme",e),this.selectedThemeChecked(e)}},SYSPROInteropClass.prototype.initiateExistingTiles=function(){$(".tile-widget").each(function(){$(this).parents(".layout-widget").find(".data-section").removeClass("data-section"),$(this).parents(".layout-widget").children(".col-sm-12").addClass("tile-widget-wrapper"),$(this).parents(".layout-widget").find(".panel-body").first().prepend("<div class=\"tile-loading-cover\"><div class=\"loader\"><div class=\"square\" ></div><div class=\"square\"></div><div class=\"square last\"></div><div class=\"square clear\"></div><div class=\"square\"></div><div class=\"square last\"></div><div class=\"square clear\"></div><div class=\"square \"></div><div class=\"square last\"></div></div></div>")})},SYSPROInteropClass.prototype.resizeSparklines=function(e){try{var t=this;$.each($(".sparkline-widget-chart:visible",e),function(){var e=$(this);if(e.data("kendoChart")){var a=e.data("kendoChart"),o=e.parent().width(),n=1;80>=o?n=8:160>=o?n=4:320>=o&&(n=2),a.setOptions({categoryAxis:{labels:{step:n}}}),console.log("-------------------------------hideShowSparklineSeries from resizeSparklines"),t.hideShowSparklineSeries(e,a)}})}catch(e){this.handleError(e.message,"resizeSparklines")}},SYSPROInteropClass.prototype.rgbToHex=function(e){if(e=""+e,!e||0>e.indexOf("rgb"))return e;if("#"==e.charAt(0))return e;var t=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(e),a=parseInt(t[2],10).toString(16),o=parseInt(t[3],10).toString(16),n=parseInt(t[4],10).toString(16);return"#"+((1==a.length?"0"+a:a)+(1==o.length?"0"+o:o)+(1==n.length?"0"+n:n))},SYSPROInteropClass.prototype.lightenDarkenColour=function(e,t){e=this.rgbToHex(e);var a=!1;"#"==e[0]&&(e=e.slice(1),a=!0);var o=parseInt(e,16),n=(o>>16)+t;255<n?n=255:0>n&&(n=0);var d=(255&o>>8)+t;255<d?d=255:0>d&&(d=0);var s=(255&o)+t;return 255<s?s=255:0>s&&(s=0),(a?"#":"")+(s|d<<8|n<<16).toString(16)},SYSPROInteropClass.prototype.hideShowSparklineSeries=function(e,t){try{var a=!0;if(e&&0<e.length&&(t||(a=!1,t=e.data("kendoChart")),t||(kendo.bind(e.closest(".layout-widget"),this.viewModel),t=e.data("kendoChart")),t)){if(0<e.closest(".sparkline-widget").length){var o=e.closest(".sparkline-widget")[0],n="true"===o.getAttribute("data-series1visible"),d="true"===o.getAttribute("data-series2visible"),s="true"===o.getAttribute("data-series3visible"),l="true"===o.getAttribute("data-series4visible"),r=o.getAttribute("data-series1name"),c=o.getAttribute("data-series2name"),p=o.getAttribute("data-series3name"),u=o.getAttribute("data-series4name");if(t.options.series[0]&&(t.options.series[0].visible=n,t.options.series[0].visibleInLegend=n),t.options.series[1]&&(t.options.series[1].visible=d,t.options.series[1].visibleInLegend=d),t.options.series[2]&&(t.options.series[2].visible=s,t.options.series[2].visibleInLegend=s),t.options.series[3]&&(t.options.series[3].visible=l,t.options.series[3].visibleInLegend=l),"rangeBar"===t.options.series[0].type){var m=10;$.each(t.dataSource.data(),function(){this&&(parseFloat(this.Series1Value)>m&&(m=parseFloat(this.Series1Value)),parseFloat(this.Series1ValueTo)>m&&(m=parseFloat(this.Series1ValueTo)),parseFloat(this.Series2Value)>m&&(m=parseFloat(this.Series2Value)),parseFloat(this.Series2ValueTo)>m&&(m=parseFloat(this.Series2ValueTo)),parseFloat(this.Series3Value)>m&&(m=parseFloat(this.Series3Value)),parseFloat(this.Series3ValueTo)>m&&(m=parseFloat(this.Series3ValueTo)),parseFloat(this.Series4Value)>m&&(m=parseFloat(this.Series4Value)),parseFloat(this.Series4ValueTo)>m&&(m=parseFloat(this.Series4ValueTo)))}),t.options.valueAxis.max=m}r&&void 0!==r&&"null"!==r&&"undefined"!==r&&t.options.series[0]&&(t.options.series[0].caption=r),c&&void 0!==c&&"null"!==c&&"undefined"!==c&&t.options.series[1]&&(t.options.series[1].caption=c),p&&void 0!==p&&"null"!==p&&"undefined"!==p&&t.options.series[2]&&(t.options.series[2].caption=p),u&&void 0!==u&&"null"!==u&&"undefined"!==u&&t.options.series[3]&&(t.options.series[3].caption=u),t.options.title.visible="true"===o.getAttribute("data-charttitlevisible"),t.options.title.text=o.getAttribute("data-charttitletext"),o.getAttribute("data-chartxaxistitle")&&"null"!==o.getAttribute("data-chartxaxistitle")&&"undefined"!==o.getAttribute("data-chartxaxistitle")&&(t.options.categoryAxis.title.text=o.getAttribute("data-chartxaxistitle")),o.getAttribute("data-chartyaxistitle")&&"null"!==o.getAttribute("data-chartyaxistitle")&&"undefined"!==o.getAttribute("data-chartyaxistitle")&&(t.options.valueAxis.title.text=o.getAttribute("data-chartyaxistitle"))}var g=e.closest(".tile-sparkline");if(0<g.length){var h=g.height();0<g.parents(".small-tile").length&&(h=g.closest(".tile-bottom-half").height()-g.siblings(".valueIconWrapper").height()),t.options.chartArea.height=h}var f=e.closest(".tile-inner");if(0<f.length){var y=f.css("background-color");t.options.chartArea.background=y;var b=this.lightenDarkenColour(y,50);y=f.css("color"),t.options.seriesColors=[y],t.options.series[0]&&(t.options.series[0].color=y),t.options.categoryAxis&&(t.options.categoryAxis.color=b,t.options.categoryAxis.line&&(t.options.categoryAxis.line.color=b),t.options.categoryAxis.labels&&(t.options.categoryAxis.labels.color=b)),t.options.valueAxis&&(t.options.valueAxis.color=b,t.options.valueAxis.line&&(t.options.valueAxis.line.color=b),t.options.valueAxis.labels&&(t.options.valueAxis.labels.color=b)),t.options.legend&&(t.options.legend.labels.color=y)}if("dark"===$("body").attr("data-theme")&&!e.data("themesetup")){e.data("themesetup",!0);var v=t.options,w=$(".fusion-main-page-buttons").css("color"),C=$(".column-parent>.panel").css("background-color");v.chartArea.background=C,v.axisDefaults.color=w,v.valueAxis.color=w,v.categoryAxis.color=w,v.categoryAxis.labels.color=w,v.valueAxis.labels.color=w,v.valueAxis.line.color=w,v.categoryAxis.line.color=w,v.valueAxis.title.color=w,v.categoryAxis.title.color=w,t.setOptions(v)}a?t.refresh():t.redraw()}}catch(e){console.log("hideShowSparklineSeries error - "+e.message)}},SYSPROInteropClass.prototype.sparklineSeriesClick=function(t){try{this.eventTrigged(t.series.name,t.series.data.indexOf(t.dataItem),t.value,"","sparklineSeriesClick",function(){},function(){})}catch(e){this.handleError(e.message,"sparklineSeriesClick")}},SYSPROInteropClass.prototype.iconSelected=function(t){try{this.eventTrigged(t.Name,t.Description,"","","iconSelected",function(){},function(){})}catch(e){this.handleError(e.message,"iconSelected")}},SYSPROInteropClass.prototype.clipboardCommandCalled=function(e){try{this.eventTrigged(e,"","","","clipboardCommandCalled",function(){},function(){})}catch(e){this.handleError(e.message,"clipboardCommandCalled")}},SYSPROInteropClass.prototype.createKendoBinders=function(){var e=this;kendo.data.binders.tilecolor=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.tilecolor.get();if(t){$(e.element).closest(".tile-inner")[0].style.backgroundColor=t;var a="";$.each($(e.element).closest(".tile-inner")[0].classList,function(){0===this.indexOf("sys-bg-")&&(a=this)}),a&&($(e.element).closest(".tile-inner")[0].classList.remove(a),$(e.element).closest(".tile-inner")[0].setAttribute("data-previoustilecolor",a))}else $(e.element).closest(".tile-inner")[0].getAttribute("data-previoustilecolor")&&$(e.element).closest(".tile-inner")[0].classList.add($(e.element).closest(".tile-inner")[0].getAttribute("data-previoustilecolor"))}}),kendo.data.binders.tileiconcolor=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.tileiconcolor.get();if(t)e.element.getAttribute("previoustileiconcolor")||e.element.setAttribute("previoustileiconcolor",$(e.element).css("color")),$(e.element).css("color",t);else{var a=e.element.getAttribute("previoustileiconcolor");a&&$(e.element).css("color",a)}}}),kendo.data.binders.tileicon=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.tileicon.get();if(t)e.element.getAttribute("previoustileicon")||e.element.setAttribute("previoustileicon",$(e.element).html()),$(e.element).html(t);else{var a=e.element.getAttribute("previoustileicon");a&&$(e.element).html(a)}}}),kendo.data.binders.htmltextnonull=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.htmltextnonull.get();t&&$(e.element).html(t)}}),kendo.data.binders.htmltext=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.htmltext.get();if(t||(t=""),$(e.element).hasClass("syspro-entryfield-description")&&(""===t.trim()?$(e.element).removeClass("always-show"):($(e.element).addClass("always-show"),$(e.element).prev(".syspro-entryfield-tooltip").remove())),$(e.element).hasClass("syspro-help-block")){var a=$(e.element);0===t.trim().length?(a.addClass("disabled-help-block"),a.removeClass("always-show")):(a.removeClass("disabled-help-block"),a.addClass("always-show"))}if($(e.element).hasClass("avanti-email-smarttag")){var o=$(e.element).closest("a.avanti-email-smarttag");0<o.length&&(o[0].href="mailto:"+t,o[0].onclick=function(){sysproInterop.ignoreUnload=!0})}$(e.element).html(t)}}),kendo.data.binders.inputmask=kendo.data.Binder.extend({refresh:function refresh(){var t=this,a=t.bindings.inputmask.get();a||(a=""),$(t.element).hasClass("syspro-numeric-input")?a?(t.element.getAttribute("data-inputmask")&&!e.numericMasking&&(e.numericMasking=t.element.getAttribute("data-inputmask")),t.element.setAttribute("data-inputmask",""),t.element.setAttribute("data-inputmask-mask",a),t.element.setAttribute("data-inputmask-greedy","false"),t.element.setAttribute("data-inputmask-insertmode","false"),t.element.setAttribute("data-inputmask-allowminus","true"),t.element.setAttribute("data-inputmask-escapechar",e.inputMaskEscapeChar)):!t.element.getAttribute("data-inputmask")&&(t.element.setAttribute("data-inputmask",e.numericMasking),t.element.removeAttribute("data-inputmask-mask"),t.element.removeAttribute("data-inputmask-greedy"),t.element.removeAttribute("data-inputmask-insertmode"),t.element.removeAttribute("data-inputmask-allowminus"),t.element.removeAttribute("data-inputmask-escapechar")):t.element.setAttribute("data-inputmask-mask",a),$(t.element).inputmask&&$(t.element).inputmask("remove"),(a||$(t.element).hasClass("syspro-numeric-input"))&&(Inputmask().mask(t.element),$(t.element).focus(function(){setTimeout(function(){$(t.element).select()},10)}))}}),kendo.data.binders.entryfieldevents=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.entryfieldevents.get();t||(t=""),e.element.setAttribute("data-entryfieldevents",t),e.element.classList.contains("avanti-data-bound-div")&&0<$(e.element).siblings(".avanti-data-bound-target").length&&$(e.element).siblings(".avanti-data-bound-target")[0].setAttribute("data-entryfieldevents",t)}}),kendo.data.binders.linelength=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.linelength.get();if(t){var a=parseInt(t);e.element.getAttribute("linelengthset")||(e.element.setAttribute("linelengthset",a),$(e.element).on("input focus keydown keyup",function(){for(var e=$(this).val(),t=e.split("\n"),o=[],n=0;n<t.length;n++){for(;t[n].length>a;){var d=t[n].substring(0,a);o.push(d),t[n]=t[n].substring(a)}o.push(t[n])}$(this).val(o.join("\n"))}))}}}),kendo.data.binders.decimals=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.decimals.get();t&&0!==t&&"0"!==t?(e.element.setAttribute("data-inputmask-digits",t),e.element.setAttribute("data-inputmask-digitsOptional",!1)):e.element.setAttribute("data-inputmask-digitsOptional",!0)}}),kendo.data.binders.datevalue=kendo.data.Binder.extend({refresh:function refresh(){var t=this,a=t.bindings.datevalue.get();if(a){var o=kendo.parseDate(a,"yyyy-MM-dd");e.autoDateChange=!0,$(t.element).closest(".date").datepicker("setDate",o)}}}),kendo.data.binders.ignorethousandseperators=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.ignorethousandseperators.get();t?e.element.setAttribute("data-inputmask-groupSeparator",""):e.element.setAttribute("data-inputmask-groupSeparator",e.element.getAttribute("data-groupseparator"))}}),kendo.data.binders.predictivesearch=kendo.data.Binder.extend({refresh:function refresh(){var t=this,a=t.bindings.predictivesearch.get();a&&"ignore"!==a&&e.initializePredictiveSearch($(t.element),a)}}),kendo.data.binders.comboboxvalue=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.comboboxvalue.get();if(!t)$("input.combobox",$(e.element).closest(".form-group")).val("");else if(e.element&&e.element.classList.contains("syspro-combobox-inform")){var a=!1;if(e.element.options)for(var o=0;o<e.element.options.length;o++)if(e.element.options[o].value===t){a=!0;break}a||$("input.combobox",$(e.element).closest(".form-group")).val(t)}}}),kendo.data.binders.entryvalue=kendo.data.Binder.extend({init:function init(e,t,a){kendo.data.Binder.fn.init.call(this,e,t,a);var o=this;$(o.element).on("change",function(){o.change()})},refresh:function refresh(){var e=this,t=e.bindings.entryvalue.get();if(t){var a=$("<textarea/>").html(t).text();e.element.value=a}else e.element.value=""},change:function change(){var e=this.element.value;this.bindings.entryvalue.set(e)}}),kendo.data.binders.includebuttons=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.includebuttons.get(),a=$(e.element);void 0!==t&&(t&&-1<t.indexOf("save")?$(".syspro-richtext-save-button",a).show():$(".syspro-richtext-save-button",a).hide(),t&&-1<t.indexOf("refresh")?$(".syspro-richtext-refresh-button",a).show():$(".syspro-richtext-refresh-button",a).hide())}}),kendo.data.binders.isreadonlyrichtext=kendo.data.Binder.extend({refresh:function refresh(){var e=this,t=e.bindings.isreadonlyrichtext.get();if(void 0!==t){t&&"false"!==t||(t=null);var a=$(e.element);t?$(".avanti-richtextwidget-textholder",a).data("kendoEditor")?($(".avanti-richtextwidget-textholder",a).attr("disabled","disabled"),$(".avanti-richtextwidget-textholder",a).attr("contenteditable","false"),$(".syspro-richtext-insertdate-button",a).addClass("disabled"),$(".syspro-richtext-refresh-button",a).addClass("disabled"),$(".syspro-richtext-save-button",a).addClass("disabled")):$(".avanti-richtextwidget-textholder",a).data("disableoninitialize","true"):($(".avanti-richtextwidget-textholder",a).removeAttr("disabled"),$(".avanti-richtextwidget-textholder",a).attr("contenteditable","true"),$(".syspro-richtext-insertdate-button",a).removeClass("disabled"),$(".syspro-richtext-refresh-button",a).removeClass("disabled"),$(".syspro-richtext-save-button",a).removeClass("disabled"))}}})},SYSPROInteropClass.prototype.updateSYSPROKeyDataFromElementChange=function(e,t){if(e.hasClass("predictive-search-initialized")){var a=e.data("predictivesearch");a&&t&&this.viewModel&&this.viewModel.Fields&&(0===a.indexOf("Conversion")&&(a=a.replace("Conversion","")),!this.viewModel.Fields.SYSPROKeyData[a]&&(this.viewModel.Fields.SYSPROKeyData[a]={}),this.viewModel.Fields.SYSPROKeyData[a].Value=t)}},SYSPROInteropClass.prototype.initializePredictiveSearch=function(t,a){try{var o=this;t.data("predictivesearch",a);var n=t;if(!t.hasClass("predictive-search-initialized")){var d="";$(".syspro-browse-button-container",$(t).closest(".form-group")).show(),0<t.closest(".modal-window-main").length&&(d=t.closest(".modal-window-main").attr("id")),t.addClass("predictive-search-initialized"),t.textcomplete([{match:/(.+)$/,search:function search(e,d){if(t.siblings(".spinner").show(),!e||e&&""===e.trim())return d([]),void t.siblings(".spinner").hide();o.predictiveSearchCache[e]&&(d(o.predictiveSearchCache[e]),t.siblings(".spinner").hide()),console.log("search performed: "+e),o.typingElement!==n&&(console.log("Setting sysproInterop.typingOperation new typing ele false"),o.typingOperation=!1,console.log("TP: "+o.typingOperation)),o.typingElement=n;var s=0;n&&0<n.length&&(s=n[0].selectionStart),console.log("Index in Predictive Search: "+n[0].selectionStart),o.performPredictiveSearch(a,e,function(a){o.predictiveSearchCache[e]=a,console.log("Showing results: "+o.typingOperation),(o.typingElement&&!o.typingElement.is(":focus")||sysproInterop.typingOperation)&&(a=[]),t&&0<t.length&&document.contains(t[0])?(d(a),t.siblings(".spinner").hide()):t&&(d([]),t.siblings(".spinner").hide())},function(a){o.typingInterval=!1,o.showErrorMessage(a.ErrorMessage,"Error performing predictive search"),d([]),t.siblings(".spinner").hide()},s)},index:1,template:function template(e,t){setTimeout(function(){var e=function(){o.predictiveSearchActive=!0},t=function(){o.predictiveSearchActive=!1};$(".syspro-predictivesearch-container").off("mouseenter",e),$(".syspro-predictivesearch-container").on("mouseenter",e),$(".syspro-predictivesearch-container").off("mouseleave",t),$(".syspro-predictivesearch-container").on("mouseleave",t)},500);var a=WebView_Predictive_Search_Template(e,t);return a},replace:function replace(e){return o.predictiveSearchActive||o.isTouchDevice?e.Id:void 0}}],{cache:!0,height:200,maxCount:200,debounce:200,zIndex:1000004,dropdownClassName:"dropdown-menu textcomplete-dropdown syspro-field-search-dropdown "+d,onKeydown:function onKeydown(t,e){if(console.log("predictive Search onKeydown: "+t.keyCode),38===t.keyCode||40===t.keyCode)console.log("predictive search active"),o.predictiveSearchActive=!0;else{if(9===t.keyCode)return console.log("Setting sysproInterop.typingOperation e.keyCode === 9"),o.typingOperation=!0,console.log("TP: "+o.typingOperation),e.KEY_ENTER;13===t.keyCode&&(console.log("Setting sysproInterop.typingOperation e.keyCode === 13"),o.typingOperation=!0,console.log("TP: "+o.typingOperation))}}}),t.on("keydown",function(t){var e=t.keyCode||t.which;9===e||13===e?(console.log("Setting sysproInterop.typingOperation keydown 913"),o.typingOperation=!0,console.log("TP: "+o.typingOperation)):(console.log("predictive search inactive"),o.predictiveSearchActive=!1,console.log("Setting sysproInterop.typingOperation typing other"),o.typingOperation=!1,console.log("TP: "+o.typingOperation))}),"SYSPRORehostedBrowser"===o.callLayerInterop.interopType&&t.on("input",function(){var e=$(this).data("textComplete");setTimeout(function(){e.trigger()},100)})}}catch(e){this.handleError(e.message,"initializePredictiveSearch")}},SYSPROInteropClass.prototype.showPopupDialog=function(e){var t=this;t.manualButtonDialogClosed=!1;var a=[];$.each(e.Buttons,function(){var o=this.ButtonId,n={text:this.Caption,primary:this.IsDefault,action:function action(a){t.popupDialogButtonClicked(a,o)}};a.push(n)});var o=$("#dialog").kendoDialog({width:"400px",title:e.Title,closable:!0,modal:!0,content:e.HtmlContent,actions:a,open:function open(){$.material.init()},close:function close(){if(!t.manualButtonDialogClosed){t.popupDialogOpened=!1;var e=$("#dialog"),a={DialogId:$(".dialog-wrapper",e).attr("id"),ButtonIdClicked:"CANCEL",OptionIdSelected:"",CheckBoxChecked:!1};t.eventTrigged(JSON.stringify(a),"","","","popupDialogButtonClicked",function(){},function(){})}}});t.popupDialogOpened=!0,o.data("kendoDialog").open()},SYSPROInteropClass.prototype.popupDialogButtonClicked=function(t,e){var a=null,o=null,n=!1;e&&(this.manualButtonDialogClosed=!0),!e&&$(t).hasClass("dialoglink")?(a=$("#dialog"),o=a.data("kendoDialog"),e=$(t).data("buttonid"),n=!0):(o=t.sender,a=o.element);var d="";0<$("input.dialog-option-radio:checked",a).length&&(d=$("input.dialog-option-radio:checked",a).val());var s=!1;0<$("input.dialog-option-checkbox:checked",a).length&&(s=!0);var l="";0<$("input.dialog-option-text",a).length&&(l=$("input.dialog-option-text",a).val());var r={DialogId:$(".dialog-wrapper",a).attr("id"),ButtonIdClicked:e,OptionIdSelected:d,CheckBoxChecked:s,TextEntered:l};this.eventTrigged(JSON.stringify(r),"","","","popupDialogButtonClicked",function(){},function(){}),n&&(this.manualButtonDialogClosed=!0,o.close()),this.popupDialogOpened=!1},SYSPROInteropClass.prototype.selectFileInternal=function(e){try{var t=this;t.selectFile(function(a){t.eventTrigged(JSON.stringify(a),"","","","fileSelectedInternal",function(){},function(){})},function(e){t.handleError(e.message,"selectFileInternal");var a={ErrorMessage:e.message};t.eventTrigged(JSON.stringify(a),"","","","fileSelectedInternal",function(){},function(){})},e)}catch(e){this.handleError(e.message,"selectFileInternal")}},SYSPROInteropClass.prototype.closeBrowserTab=function(){try{this.ignoreUnload=!0,window.close()}catch(e){this.handleError(e.message,"closeBrowserTab")}},SYSPROInteropClass.prototype.closeModalWindow=function(e){try{this.isProgramaticClose=!0,console.log("closeModalWindow "+e);var t=-1;if(e&&$.each(this.modalWindowHolder,function(a){this.Id==e&&(t=a,0===this.ModalType?this.Window&&this.Window.close&&this.Window.close():this.Window&&this.Window._close&&this.Window._close({preventDefault:function preventDefault(){}}),$.each($(".syspro-grid-list",this.Window.element),function(){$(this).data("kendoGrid")&&$(this).data("kendoGrid").destroy()}),this.Window.element.remove())}),-1<t)this.modalWindowHolder.splice(t,1);else{var a=this.modalWindowHolder.pop();a?a.Window&&a.Window.close&&(a.Window.close(),$.each($(".syspro-grid-list",a.Window.element),function(){$(this).data("kendoGrid")&&$(this).data("kendoGrid").destroy()}),a.Window.element.remove()):console.log("closeModalWindow for "+e+" failed because the window was not opened or has already been closed.")}return e&&"IMPTIM"===e.trim()&&(this.callLayerInterop.avantiPluginLoaded=this.callLayerInterop.previousAvantiPlugin,this.callLayerInterop.previousAvantiPlugin=""),this.bindOnCurrentDivPerformed=!1,""}catch(e){this.handleError(e.message,"closeModalWindow")}},SYSPROInteropClass.prototype.setModalWindowTitle=function(e){try{var t=-1;if(e){var a=e.split("|")[0],o=e.split("|")[1];if(0===a.indexOf("PANELTITLE-")){var n=$("[data-guid=\""+a.replace("PANELTITLE-","")+"\"]");return 0<n.length&&$(".panel-heading",n).text(o),""}$.each(this.modalWindowHolder,function(e){this.Id==a&&(t=e,0===this.ModalType?this.Window.title(o):$("h4",$(this.Window.element).closest(".offcanvas-header")).html(o))})}if(-1===t){var d=this.modalWindowHolder[this.modalWindowHolder.length-1];d&&(0===d.ModalType?d.Window.title(o):$("h4",$(d.Window.element).closest(".offcanvas-header")).html(o))}return""}catch(e){this.handleError(e.message,"setModalWindowTitle")}},SYSPROInteropClass.prototype.modalWindowClosed=function(e,t){try{return e&&0!==e.indexOf("SearchWindowMain")&&this.eventTrigged(e,t,"","","modalWindowClosed",function(){},function(){}),this.fullBindRequired=null,""}catch(e){this.handleError(e.message,"closePopupDialog")}},SYSPROInteropClass.prototype.backToMenu=function(){try{return this.eventTrigged("","","","","backToMenu",function(){},function(){}),""}catch(e){this.handleError(e.message,"closePopupDialog")}},SYSPROInteropClass.prototype.showTaskDialog=function(e){var t=JSON.parse(e.HtmlContent),a=this;a.taskDialogContentShown===t.MainInstruction&&a.notificationHolder&&a.notificationHolder.hide(),a.taskDialogContentShown=t.MainInstruction;var o=4e3;t.Footer&&(o=8e3),a.notificationHolder||(a.notificationHolder=$("#taskdialognotification").kendoNotification({position:{pinned:!0,top:60,right:30},autoHideAfter:4e3,stacking:"down",templates:[{type:"info",template:$("#taskDialogTemplate").html()}],show:function show(t){t.element.parent().css({zIndex:99999}),$(".task-dialog-hyperlink",t.element).on("click",function(){a.eventTrigged($(this).data("hyperlinkid"),null,null,null,"taskDialogLinkClicked",null,null)})}}).data("kendoNotification")),a.notificationHolder.show(t,null)},SYSPROInteropClass.prototype.showCustomTaskDialog=function(e,t,a,o,n,d){var s={HtmlContent:JSON.stringify({BackgroundColor:e,IconColor:t,Title:a,MainInstruction:o,Content:n,Icon:d,Hyperlink:"",HyperlinkId:""})};this.showTaskDialog(s)},SYSPROInteropClass.prototype.hideTaskDialogs=function(){this.notificationHolder&&this.notificationHolder.hide()},SYSPROInteropClass.prototype.fieldChangedHandler=function(t){var e=t.currentTarget,a=this,o=e.getAttribute("data-fieldname"),n;if(n=e.value,"checkbox"==e.type&&(n=e.checked),e.classList.contains("syspro-radiobutton-option")&&e.checked){var d=$(e).closest(".syspro-databound-radiobutton");0<d.length?(o=d[0].getAttribute("data-fieldname"),e=$(e).closest(".syspro-databound-radiobutton")[0]):o=e.name,n=e.value}if(!o&&e.classList.contains("syspro-combobox-inform")&&0<$("select",$(e).closest(".form-group")).length&&(o=$("select",$(e).closest(".form-group"))[0].getAttribute("data-fieldname")),!(e.classList.contains("combobox")&&("INPUT"===e.tagName&&!e.classList.contains("syspro-combobox-inform")||"SELECT"===e.tagName&&e.classList.contains("syspro-combobox-inform")))){if(e.classList.contains("dropdown-select")){var s=$("input.fakeinput",$(e).next(".dropdownjs"));s.data("backupcolor")&&s.css("color",s.data("backupcolor"))}if(e.classList.contains("datetimepicker")&&(n=$(e).closest(".datetimepicker").val(),n=kendo.toString(n,sysproInterop.dateFormat.toUpperCase()+" HH:mm"),sysproInterop.viewModel&&o)){var l=o.split("."),r=sysproInterop.viewModel;l.forEach(function(e){r[e]&&(r=r[e])}),r&&r.set("Value",n)}if(e.classList.contains("date-input")&&(n=kendo.toString($(e).closest(".date").datepicker("getDate"),"yyyy-MM-dd"),sysproInterop.viewModel&&o)){var l=o.split("."),r=sysproInterop.viewModel;l.forEach(function(e){r[e]&&(r=r[e])}),r&&r.set("Value",n)}if(e.classList.contains("predictive-search-initialized")&&sysproInterop.updateSYSPROKeyDataFromElementChange($(e),n),e.getAttribute("data-fieldlastvalue")!==n&&(e.setAttribute("data-fieldlastvalue",n),sysproInterop.eventTrigged(o,n,"","","fieldChange",function(){},function(){}),e.classList.contains(".syspro-field-search-dropdown"))){var c=e.getAttribute("data-entryfieldevents");-1<c.indexOf("Tab")&&sysproInterop.eventTrigged(o,9,n,"","keyDown",function(){},function(){})}}},SYSPROInteropClass.prototype.subscribeToFieldEvents=function(){try{var t=this;if($(".syspro-trackfield-keydown:not(.syspro-field-search-dropdown)").off("keydown",t.keyDownTracking),$(".syspro-trackfield-keydown:not(.syspro-field-search-dropdown)").on("keydown",t.keyDownTracking),$(".syspro-trackfield-keydown:not(.syspro-field-search-dropdown)").off("focus",t.focusTracking),$(".syspro-trackfield-keydown:not(.syspro-field-search-dropdown)").on("focus",t.focusTracking),$(".syspro-trackfield-keydown:not(.syspro-field-search-dropdown)").off("blur",t.lostFocusTracking),$(".syspro-trackfield-keydown:not(.syspro-field-search-dropdown)").on("blur",t.lostFocusTracking),$(".syspro-trackfield-keydown:not(.syspro-field-search-dropdown)").off("mousedown",t.mouseDown),$(".syspro-trackfield-keydown:not(.syspro-field-search-dropdown)").on("mousedown",t.mouseDown),$("html").on("mousemove",t.mouseMove),$(".syspro-trackfield-change").off("change",t.fieldChangedHandler),$(".syspro-trackfield-change").on("change",t.fieldChangedHandler),$("input.datetimepicker").off("dp.change",t.fieldChangedHandler),$("input.datetimepicker").on("dp.change",t.fieldChangedHandler),!$(".syspro-trackfield-change-richtext").data("kendoEditor")){$(".syspro-trackfield-change-richtext").html("");var a,o;o=["bold","italic","underline","justifyLeft","justifyCenter","justifyRight","justifyFull","insertUnorderedList","insertOrderedList","indent","outdent","createLink","unlink","insertImage","subscript","superscript","tableWizard","createTable","addRowAbove","addRowBelow","addColumnLeft","addColumnRight","deleteRow","deleteColumn","cleanFormatting","fontName","fontSize","foreColor","backColor"],a={resizable:{content:!0},tools:o,change:function change(){console.log("RTF Changed!");var e=this.body.getAttribute("data-fieldname"),t="#RTFIN#";e&&e.endsWith("Html")&&(t="");var a=t+this.value();sysproInterop.eventTrigged(e,a,"","","fieldChange",function(){},function(){})}},$(".syspro-trackfield-change-richtext").kendoEditor(a);var n=$(".syspro-trackfield-change-richtext");0<n.length&&n.data("kendoEditor")&&(n.data("kendoEditor").toolbar.window.bind("open",function(t){var e=n.offset(),a=e.top+n.outerHeight()+5;if(0<n.closest(".modal-window-main").length){var o=n.closest(".modal-window-main").offset();a=o.top+n.closest(".modal-window-main").outerHeight()+5}t.sender.setOptions({position:{top:a,left:e.left}})}),"true"===n.data("disableoninitialize")&&($(".avanti-richtextwidget-textholder",n.closest(".avanti-richtextwidget")).attr("disabled","disabled"),$(".avanti-richtextwidget-textholder",n.closest(".avanti-richtextwidget")).attr("contenteditable","false"),$(".syspro-richtext-insertdate-button",n.closest(".avanti-richtextwidget")).addClass("disabled"),$(".syspro-richtext-refresh-button",n.closest(".avanti-richtextwidget")).addClass("disabled"),$(".syspro-richtext-save-button",n.closest(".avanti-richtextwidget")).addClass("disabled")))}$(".syspro-browse-button").off("click"),$(".syspro-browse-button").on("click",function(){var e=this.getAttribute("data-predictivesearchfield"),a=this.getAttribute("data-fieldname"),o;if(o=this.getAttribute("data-fieldvalue"),"manual"===e){var n=a.split(":"),d=parseInt(n[2]);++d,t.eventTrigged(n[1],d+"|"+n[3]+"|","","","manualSearchSelected",function(){},function(){})}else"#GRIDVALUE#"===o&&(o=$(this).siblings("input").val()),t.openBrowse(a,o,e,a)}),$(".syspro-file-browse-button").off("click"),$(".syspro-file-browse-button").on("click",function(){var a=this.getAttribute("data-fieldname"),o=this.getAttribute("data-filetypes");t.selectFile(function(o){$("#"+a.replace(".","\\.")).val(o.FilePath),t.eventTrigged(JSON.stringify(o),a,"","","fileSelected",function(){},function(){})},function(){},o)}),t.isInAppBuilder||($(".tile").off("click"),$(".tile:not(.tile-disabled)").on("click",function(){var e=this.getAttribute("data-parentfieldpath"),a=this.getAttribute("data-tileparameters"),o=this.getAttribute("data-tiletypename"),n=this.getAttribute("data-tiletype"),d=$(".tile-title",this).first().text();if(o&&0===o.indexOf("Plugin|")||0===o.indexOf("Link|"))t.runProgramInSYSPRO(e,n,d,o);else{"Program"===n&&(a=n,$("[id=loading-cover]").fadeIn()),("MLText"===n||"MLGauge"===n)&&(o=n+"|"+o);var s=null;t.viewModel&&t.viewModel.Fields&&(s=JSON.stringify(t.viewModel.Fields.SYSPROKeyData)),t.eventTrigged(e,a,o,s,"tileClicked",function(){},function(e){e.ErrorMessage&&t.handleError(e.ErrorMessage,"tileClicked")})}})),$("select.combobox.combobox-initialized").combobox("refresh")}catch(e){console.log("Silent Bind Error (Don't panic!) - "+e.message)}},SYSPROInteropClass.prototype.openBrowse=function(e,t,a,o){if("StandaloneBrowser"===this.callLayerInterop.interopType&&a&&"ignore"!==a&&"undefined"!==a&&void 0!==a){this.callLayerInterop.callFusionService(this.callLayerInterop.renderMode+"/UXSearchWeb/OpenSearchWindow",{SearchType:a,SearchField:o,SearchValue:t},"GET",function(){},function(e){this.handleError(e.ErrorMessage,"openBrowse")})}else this.eventTrigged(e,t,"","","fieldBrowse",function(){},function(){})},SYSPROInteropClass.prototype.browseValueSelected=function(e,t,a){if(this.closeModalWindow("SearchWindowMain"+a),0<=e.indexOf("grid:")){var o=e.split(":"),n="",d="",s="",l=0,r="";if(3<o.length){n=o[1],s=o[2],d=o[3],r=o[4],l=parseInt(s),++l;var c={FieldName:n,InternalEvent:"SetCellValueKeepDirty",InternalEventParameter:l.toString()+"|"+d+"|"+t+"|"+r};this.gridHelpers.gridRequestInternalEvent(c)}else console.log("browseValueSelected Error - Parameters given on browse for grid had too few parameters.")}else{$("#"+e.replace(".","\\.")).val(t);var p=this.viewModel;0===e.indexOf("Toolbar")&&(p=this.toolbarModel);for(var u=e.split("."),m=0;m<u.length;m++)u[m]&&p[u[m]]&&(p=p[u[m]]);p&&p.set("Value",t),this.updateSYSPROKeyDataFromElementChange($("#"+e.replace(".","\\.")),t),this.eventTrigged(e,t,"","","fieldChange",function(){$("#"+e.replace(".","\\.")).focus()},function(){});$("#"+e.replace(".","\\."))[0].getAttribute("data-entryfieldevents");$("#"+e.replace(".","\\.")).hasClass("syspro-toolbar-widget")&&this.eventTrigged(e,9,t,"","keyDown",function(){},function(){})}},SYSPROInteropClass.prototype.keyDownTracking=function(t){var e=t.currentTarget;if(9!==t.which&&e.setAttribute("data-ignoretabs",""),13===t.which||9===t.which){var a=e.getAttribute("data-fieldname");!a&&e.classList.contains("combobox")&&0<$("select.combobox-initialized",$(e).closest(".form-group")).length&&(a=$("select.combobox-initialized",$(e).closest(".form-group"))[0].getAttribute("data-fieldname"));var o=e.value,n=e.getAttribute("data-entryfieldevents");if((13===t.which&&(!e.classList.contains("syspro-trackfield-change-richtext")||n&&-1<n.indexOf("Enter"))||a&&0===a.indexOf("Toolbar.")||n&&-1<n.indexOf("Tab"))&&(e.getAttribute("data-ignoretabs")?console.log("Tab Ignored for Wait call."):sysproInterop.eventTrigged(a,t.which,o,"","keyDown",function(){},function(){})),9===t.keyCode&&(n&&-1<n.indexOf("Wait")||a&&0===a.indexOf("Toolbar."))){var d=e;d.setAttribute("data-ignoretabs","true"),$(d).on("blur",function(){d.setAttribute("data-ignoretabs",""),$(d).off("blur")}),t.preventDefault()}}},SYSPROInteropClass.prototype.callPlugin=function(e,t,a,o,n,d,s,l){void 0===n&&(n=null),void 0===d&&(d=null),void 0===s&&(s=null),void 0===l&&(l=null);try{return this.eventTrigged(a,o,"","","PLUGIN|"+e+"|"+t,function(t){n&&n(t)},function(t){n&&d(t)},s,l),""}catch(e){this.handleError(e.message,"callPlugin")}},SYSPROInteropClass.prototype.focusTracking=function(t){var e=t.currentTarget,a=e.getAttribute("data-entryfieldevents");if(a&&-1<a.indexOf("Focus")){var o=$(e),n=o.data("mdown");if(o.removeData("mdown"),!o.hasClass("syspro-toolbar-widget")||n){var d=e.getAttribute("data-fieldname");sysproInterop.eventTrigged(d,"","","","focus",function(){},function(){})}}},SYSPROInteropClass.prototype.lostFocusTracking=function(t){var e=t.currentTarget,a=e.getAttribute("data-entryfieldevents");if(a&&-1<a.indexOf("Blur")){var o=$(e),n=e.getAttribute("data-fieldname"),d=e.value;sysproInterop.eventTrigged(n,d,"","","blur",function(){},function(){})}if(e.classList.contains("predictive-search-initialized")){var s=$(e).data("textComplete");s&&s.dropdown&&s.dropdown.deactivate()}},SYSPROInteropClass.prototype.statusBarClicked=function(t){var e=t.currentTarget,a=$(e),o=a.data("statusbarmodalid");sysproInterop.eventTrigged(o,"","","","statusBarClicked",function(){},function(){})},SYSPROInteropClass.prototype.mouseDown=function(){var e=$(this);e.is(":focus")||e.data("mdown",!0)},SYSPROInteropClass.prototype.mouseMove=function(t){sysproInterop.cursorX=t.pageX,sysproInterop.cursorY=t.pageY},SYSPROInteropClass.prototype.startHelpTourForApplication=function(isModal){try{var interopHelper_1=this;console.log("startHelpTourForApplication"),this.getModel("",function(data){if(console.log("Model found!"),"undefined"==typeof hopscotch)interopHelper_1.showErrorMessage("The helptour package has not been loaded. This indicates a version mismatch between BaseSamples and Managed Assemblies.","Loading help tour");else if(hopscotch)try{console.log("data.HelpTourContent - "+data.HelpTourContent);var parsedTour=eval(data.HelpTourContent),tourCurrent={id:"helptour_"+data.Id,steps:parsedTour};console.log("parsedTour - "+parsedTour.length),hopscotch.startTour(tourCurrent,0)}catch(e){interopHelper_1.handleError(e.message,"startHelpTourForApplicationLoaded")}},function(){},isModal)}catch(e){this.handleError(e.message,"startHelpTourForApplication")}},SYSPROInteropClass.prototype.addRecentProgram=function(e,t,a,o){if(!this.recentProgramList.length){var n=$("#programListMenu > .sidebar-menu");0<n.length&&0===$(".recent-programs-list",n).length&&n.prepend("<li class=\"treeview recent-programs-list\"><a href=\"#\"><span class=\"material-icons treeview-menu-icon pull-left sys-mg-r-5\">access_time</span>Recent programs <span class=\"material-icons treeview-menu-expand-indicator pull-right\">chevron_right</span></a><ul class=\"treeview-menu\"></ul></li>")}var d=!1;if($.each(this.recentProgramList,function(){this.name==e&&(d=!0)}),!d){var s="";o&&(s="Plugin|"+o),this.recentProgramList.push({name:e,description:t,menutype:a,submenuitemtype:s});var l=this;$(".recent-programs-list .treeview-menu").append("<li><a href=\"#\" class=\"syspro-program-link\" data-sysproprogramname=\""+e+"\" data-syspromenuitemtype=\""+a+"\" data-syspromenuitemsubtype=\""+s+"\" data-tooltip=\"tooltip\" data-placement=\"bottom\" data-original-title=\""+t+"\"><span class=\"material-icons treeview-menu-icon pull-left sys-mg-r-5\">exit_to_app</span>"+t+"</a></li>"),$(".syspro-program-link").off("click"),$(".syspro-program-link").on("click",function(){var e=this.getAttribute("data-sysproprogramname"),t=this.getAttribute("data-syspromenuitemtype"),a=this.getAttribute("data-syspromenuitemsubtype"),o=$(this).clone();o.children().remove();var n=o.text();l.runProgramInSYSPRO(e,t,n,a)})}},SYSPROInteropClass.prototype.bindAvantiNotifications=function(e){if(void 0===e&&(e=null),!$("#offcanvas-avanti-notifications").data("isopened")){var t=this;$("#offcanvas-avanti-notifications").data("isopened","true"),$("#offcanvas-avanti-notifications .tab-content").html(""),t.getNotificationsContent(function(e){$("#offcanvas-avanti-notifications .tab-content").html(e),$("#offcanvas-avanti-notifications a[href='#alertsByType']").closest("li").hasClass("active")?($("#offcanvas-avanti-notifications #alertsByDate").removeClass("in"),$("#offcanvas-avanti-notifications #alertsByDate").removeClass("active"),$("#offcanvas-avanti-notifications #alertsByType").addClass("in"),$("#offcanvas-avanti-notifications #alertsByType").addClass("active")):($("#offcanvas-avanti-notifications #alertsByType").removeClass("in"),$("#offcanvas-avanti-notifications #alertsByType").removeClass("active"),$("#offcanvas-avanti-notifications #alertsByDate").addClass("in"),$("#offcanvas-avanti-notifications #alertsByDate").addClass("active")),$("#offcanvas-avanti-notifications .dismiss-notification").on("click",function(a){$(this).closest(".avanti-notification-item").data("avantinotificationid")&&t.dismissNotification($(this).closest(".avanti-notification-item").data("avantinotificationid")),a.stopPropagation()}),$("#offcanvas-avanti-notifications .avanti-notification-withaction").on("click",function(){this.getAttribute("data-avantinotificationeventtype")&&t.actionNotification($(this).closest(".avanti-notification-item").data("avantinotificationid"),this.getAttribute("data-avantinotificationeventtype"),this.getAttribute("data-avantinotificationeventmetadata1"),this.getAttribute("data-avantinotificationeventmetadata2"))})},function(e){t.handleError(e.ErrorMessage,"Getting notifications")})}else $("#offcanvas-avanti-notifications").data("isopened","")},SYSPROInteropClass.prototype.dismissNotification=function(e){var t=this;$("#offcanvas-avanti-notifications").data("isopened",""),t.callBusinessObject("post","SWSTMG",JSON.stringify({PostMessages:{Message:{MessageKey:e}}}),JSON.stringify({PostMessages:{Parameters:{ActionType:"D"}}}),function(e){t.bindAvantiNotifications(),e&&e.postmessages&&e.postmessages.Message&&e.postmessages.Message.TotatMessagesInInbox&&t.updateNotificationsCount(e.postmessages.Message.TotatMessagesInInbox)},function(e){t.handleError(e.ErrorMessage,"Dismiss notification")})},SYSPROInteropClass.prototype.actionNotification=function(e,t,a,o){var n=this;n.callLayerInterop.avantiPluginLoaded="";var d=n.runProgramInSYSPRO(a,t,null,o);if("IMPTSK"!==a&&d){$("#offcanvas-avanti-notifications").data("isopened",""),n.callBusinessObject("post","SWSTMG",JSON.stringify({PostMessages:{Message:{MessageKey:e,Status:"99"}}}),JSON.stringify({PostMessages:{Parameters:{ActionType:"U"}}}),function(e){n.bindAvantiNotifications(null),e&&e.postmessages&&e.postmessages.Message&&e.postmessages.Message.TotatMessagesInInbox&&n.updateNotificationsCount(e.postmessages.Message.TotatMessagesInInbox)},function(e){n.handleError(e.ErrorMessage,"Action notification")})}},SYSPROInteropClass.prototype.sendNotification=function(e){try{var t=JSON.parse(e.NotificationBlob);console.log("Notification Received - "+t.Title),this.showCustomTaskDialog("sys-bg-primary","sys-fg-white",t.Title,t.SubTitle,"",t.Icon),this.updateNotificationsCount(e.NotificationsCount)}catch(e){this.handleError(e.message,"sendNotification")}},SYSPROInteropClass.prototype.updateNotificationsCount=function(e){e&&0<e?($(".avanti-notifications-count").show(),$(".avanti-notifications-count").text(e)):$(".avanti-notifications-count").hide()},SYSPROInteropClass.prototype.bindProgramList=function(e,t,a){void 0===a&&(a=!1);try{var o=this;if($("#harness-container").data("dismissprogramlistinitialized")||($("#harness-container").on("click",function(){$("#fusion-sidebar-wrapper2").removeClass("in")}),$("#harness-container").data("dismissprogramlistinitialized","true")),$(".typeahead-program-list",e).val(""),!$(".program-list-search-wrapper",e).data("treeviewinitialized")||a){var n="";o.viewModel&&o.viewModel.Fields&&o.viewModel.Fields.SYSPROKeyData&&(n=JSON.stringify(o.viewModel.Fields.SYSPROKeyData));var d="";o.currentUserSession&&o.currentUserSession.OperatorRoleCode&&(d="<RoleId>"+o.currentUserSession.OperatorRoleCode+"</RoleId>"),o.callBusinessObject("query","PROGRAMLIST","<Query><Key><Filetype>MF</Filetype><SRSOutput>Y</SRSOutput>"+d+"</Key></Query>","",function(t){$("#programListMenu",e).html(queryLayoutUIHelpers.createTreeMenu(t,null)[0].outerHTML),$("#programListMenu > .treeview-menu",e).removeClass("treeview-menu").addClass("sidebar-menu").tree(),$("[data-tooltip=\"tooltip\"]",e).tooltip(),$(".typeahead-program-list",e).typeahead&&$(".typeahead-program-list",e).typeahead("destroy");var a;a={source:queryLayoutUIHelpers.programListTypeahead,autoSelect:!0,programList:!0,fitToElement:!0,highlighter:function highlighter(e){var t=this.query;if(""===t)return e;var a=e.match(/(>)([^<]*)(<)/g),o=[],n=[],d;if(a&&a.length)for(d=0;d<a.length;++d)2<a[d].length&&o.push(a[d]);else o=[],o.push(e);t=t.replace(/[\(\)\/\.\*\+\?\[\]]/g,function(e){return"\\"+e});var s=new RegExp(t,"gi"),l;for(d=0;d<o.length;++d)l=o[d].match(s),l&&0<l.length&&n.push(o[d]);for(d=0;d<n.length;++d)n[d].includes("_")||(e=e.replace(n[d],n[d].replace(s,"<strong>$&</strong>")));return e},displayText:function displayText(e){return"undefined"!=typeof e&&"undefined"!=typeof e.name?"<div class=\"row\"><div class=\"col-xs-1\"><span class=\"material-icons treeview-menu-icon pull-left sys-mg-r-5\">"+e.icon+"</span></div><div class=\"col-xs-9 typeahead-value-wrapper\">"+(""==e.breadcrumb?"":"<div class=\"row typeahead-breadcrumb-wrapper\"><div class=\"col-xs-12 sys-pd-l-10\"><span class=\"typeahead-breadcrumb\">"+e.breadcrumb+"</span></div></div>")+"<div class=\"row\"><div class=\"col-xs-12 sys-pd-l-10\">"+e.name+"</div></div></div><div class=\"col-xs-2\"><span class=\"material-icons treeview-menu-expand-indicator pull-right \">chevron_right</span></div></div>":"<div class=\"row\"><div class=\"col-xs-1\"><span class=\"material-icons treeview-menu-icon pull-left sys-mg-r-5\">"+e.icon+"</span></div><div class=\"col-xs-9 typeahead-value-wrapper\">"+(""==e.breadcrumb?"":"<div class=\"row typeahead-breadcrumb-wrapper\"><div class=\"col-xs-12 sys-pd-l-10\"><span class=\"typeahead-breadcrumb\">"+e.breadcrumb+"</span></div></div>")+"<div class=\"row\"><div class=\"col-xs-12 sys-pd-l-10\">"+e+"</div></div></div><div class=\"col-xs-2\"><span class=\"material-icons treeview-menu-expand-indicator pull-right \">chevron_right</span></div></div>"},afterSelect:function afterSelect(t){o.callLayerInterop.avantiPluginLoaded="",o.runProgramInSYSPRO(t.sysproprogramname,t.syspromenuitemtype,t.name,t.syspromenuitemsubtype)}},$(".typeahead-program-list",e).typeahead(a,null);var n=$("#programListMenu > .sidebar-menu");0<n.length&&0===$(".recent-programs-list",n).length&&n.prepend("<li class=\"treeview recent-programs-list\"><a href=\"#\"><span class=\"material-icons treeview-menu-icon pull-left sys-mg-r-5\">access_time</span>Recent programs <span class=\"material-icons treeview-menu-expand-indicator pull-right\">chevron_right</span></a><ul class=\"treeview-menu\"></ul></li>"),$.each(sysproInterop.recentProgramList,function(){$(".recent-programs-list .treeview-menu").append("<li><a href=\"#\" class=\"syspro-program-link\" data-sysproprogramname=\""+this.name+"\" data-syspromenuitemtype=\""+this.menutype+"\" data-syspromenuitemsubtype=\""+this.submenuitemtype+"\" data-tooltip=\"tooltip\" data-placement=\"bottom\" data-original-title=\""+this.description+"\"><span class=\"material-icons treeview-menu-icon pull-left sys-mg-r-5\">exit_to_app</span>"+this.description+"</a></li>")}),$(".syspro-program-link").off("click"),$(".syspro-program-link").on("click",function(){var e=this.getAttribute("data-sysproprogramname"),t=this.getAttribute("data-syspromenuitemtype"),a=this.getAttribute("data-syspromenuitemsubtype"),n=$(this).clone();n.children().remove();var d=n.text();o.callLayerInterop.avantiPluginLoaded="",o.runProgramInSYSPRO(e,t,d,a)}),queryLayoutUIHelpers.initializeDragDrop(),$(".program-list-search-wrapper",e).data("treeviewinitialized","true"),$(".program-list-search-wrapper").css("opacity",1)},function(e){t||o.handleError(e.ErrorMessage,"bindProgramList")},!0,!1,n)}}catch(e){this.handleError(e.message,"bindProgramList")}},SYSPROInteropClass.prototype.searchProgramList=function(e,t){for(var a=!1,o=e instanceof kendo.data.HierarchicalDataSource&&e.data(),n=0;n<o.length;n++){var d=o[n],s=d.Description.toLowerCase(),l;l=null!=d.Name&&"undefined"!=typeof d.Name?d.Name.toLowerCase():"";var r=!0===t||""===t||0<=s.indexOf(t)||0<=l.indexOf(t),c=this.searchProgramList(d.children,r||t);a=a||c||r,d.hidden=!r&&!c}return o&&e.filter({field:"hidden",operator:"neq",value:!0}),a},SYSPROInteropClass.prototype.runProgramInSYSPRO=function(e,t,a,o){var n=!1;if(t){if(o&&0===o.indexOf("Link|")){var d=o.split("|"),s="",l="",r="",c=e;1<d.length&&(s=d[1]),2<d.length&&(l=d[2]),3<d.length&&(r=d[3]),t="ThirdPartyLink",e=l}if("Program"===t){if(o&&0===o.indexOf("Plugin|")){var d=o.split("|"),s="",l="",r="",c=e;1<d.length&&(s=d[1]),2<d.length&&(l=d[2]),3<d.length&&(r=d[3]),"SRSMAIN"===s&&"LoadReportForm"===l&&(r=a),l||(l=e),$("#fusion-sidebar-wrapper2").removeClass("in"),$("body").removeClass("offcanvas-stop-scrolling"),this.callPlugin(s,l,r,c),n=!0}else if(o&&0===o.indexOf("Plugin|"));else e&&($("#fusion-sidebar-wrapper2").removeClass("in"),$("body").removeClass("offcanvas-stop-scrolling"),$("[id=loading-cover]").fadeIn(),this.eventTrigged(e,"Program",null,null,"tileClicked",function(){},function(e){e.ErrorMessage&&this.handleError(e.ErrorMessage,"Running program")}),n=!0);}else if("Tile"===t){var p=null;this.viewModel&&this.viewModel.Fields&&(p=JSON.stringify(this.viewModel.Fields.SYSPROKeyData)),this.eventTrigged("","",e,p,"tileClicked",function(){},function(e){e.ErrorMessage&&this.handleError(e.ErrorMessage,"tileClicked")}),n=!0}else"Flowgraph"===t?loadDiagramByName&&loadDiagramByName(e,a,!1):"ThirdPartyLink"===t&&this.openThirdPartyUrl(l)}return n},SYSPROInteropClass.prototype.openThirdPartyUrl=function(e){window.open(e,"_blank")},SYSPROInteropClass.prototype.hideErrorMessage=function(){try{"undefined"!=typeof SYSPRO_VB&&SYSPRO_VB&&void 0!==SYSPRO_VB&&SYSPRO_VB.hideErrorMessage()}catch(e){}},SYSPROInteropClass.prototype.showErrorMessage=function(e,t){try{console.log("showErrorMessage - "+e),console.log(e),"undefined"!=typeof SYSPRO_VB&&SYSPRO_VB&&void 0!==SYSPRO_VB?SYSPRO_VB.showErrorMessage(e,t):alert("Error thrown before initialization of framework: "+e)}catch(e){console.log("showErrorMessage unhandled: "+e.message)}},SYSPROInteropClass.prototype.showHelp=function(e){try{var t=this.currentUserSession.FullHelpUrl;if(e&&""!==e.trim()||(e=callLayerInterop.programName),e&&""!==e.trim()){var a=e.substring(0,3);t=t.split("$3$").join(a),t=t.split("$prog$").join(e)}else t=this.currentUserSession.HomeHelpUrl;t&&window.open(t,"_blank")}catch(e){this.handleError(e.message,"showHelp")}},SYSPROInteropClass.prototype.toggleLoadingScreen=function(e){try{"true"==e.Show?"Processing"===e.Type?queryLayoutUIHelpers.showProcessingMessage(e.Text):$("[id=loading-cover]").fadeIn():(queryLayoutUIHelpers.hideProcessingMessage(),$("[id=loading-cover]").fadeOut())}catch(e){this.handleError(e.message,"toggleLoadingScreen")}},SYSPROInteropClass.prototype.setStatusMessage=function(e){try{var t=this,a=null;e.ModalId?(a=$("*[data-syspromodalid='"+e.ModalId+"'] .statusBar"),0===a.length&&(a=$("#fusion-wrapper .statusBar")),a.data("statusbarmodalid",e.ModalId)):(a=$("#fusion-wrapper .statusBar"),a.data("statusbarmodalid","")),$(".status-message",a).text(e.Text),a.show(),a.off("click",t.statusBarClicked),a.on("click",t.statusBarClicked)}catch(e){this.handleError(e.message,"setStatusMessage")}},SYSPROInteropClass.prototype.showContextMenu=function(e){try{var t=this,a=e.HtmlContent,o=e.LocationX,n=e.LocationY;0<$("#syspro-context-menu-generic #context-menu-list").length&&$("#syspro-context-menu-generic #context-menu-list").data("kendoContextMenu")&&$("#syspro-context-menu-generic #context-menu-list").data("kendoContextMenu").destroy(),t.currentContextMenu&&(t.currentContextMenu.data("kendoContextMenu")&&t.currentContextMenu.data("kendoContextMenu").destroy(),t.currentContextMenu.remove(),t.currentContextMenu=null),$("#syspro-context-menu-generic").html(""),$("#syspro-context-menu-generic").html(a),t.currentContextMenuUnhealthyClose=!1,t.currentContextMenu=$("#syspro-context-menu-generic #context-menu-list").kendoContextMenu({showOn:"",select:function select(a){var e=$(a.item).data("contextmenuaction");e&&(console.log("Context menu clicked: "+e),t.eventTrigged(e,"","","","contextMenuItemClicked",function(){},function(){})),a.sender.destroy()},animation:{close:{duration:0}},open:function open(){t.currentContextMenuUnhealthyClose=!0,setTimeout(function(){$(".k-context-menu").closest(".k-animation-container").css("z-index","1000000")},100)},close:function close(){t.currentContextMenuUnhealthyClose=!1}}),0===parseInt(o)&&0===parseInt(n)?(t.cursorContextMenuOpenedX=t.cursorX,t.cursorContextMenuOpenedY=t.cursorY,t.currentContextMenu.data("kendoContextMenu").open(t.cursorX,t.cursorY)):t.currentContextMenu.data("kendoContextMenu").open(o,n)}catch(e){this.handleError(e.message,"showContextMenu")}},SYSPROInteropClass.prototype.callBusinessObject=function(e,t,a,o,n,d,s,l,r){void 0===s&&(s=null),void 0===l&&(l=null),void 0===r&&(r=null);try{s=s?"true":"false",l=l?"true":"false",r||(r="");var c={Operation:"callBusinessObject",Application:e,KeyField:t,KeyFieldValue:a,FinalParameter:o,AdditionalField1:s,AdditionalField2:l,AdditionalField3:r,CallbackIndex:this.threadedCallbackIndexToUse,CallbackMethod:"this.interopCallbackReceived"};for(this.threadedCallbacksLookup[this.threadedCallbackIndexToUse]={Success:n,Error:d};this.threadedCallbacksLookup[this.threadedCallbackIndexToUse];)this.threadedCallbackIndexToUse++;this.callLayerInterop.callLayerWithData(c)}catch(e){this.handleError(e.message,"callBusinessObject")}},SYSPROInteropClass.prototype.closeSYSPROFusion=function(e){if(console.log("closeSYSPROFusion"),e)this.callLayerInterop.setKMSToken(""),this.manualSignOff=!0,this.callLayerInterop.isSecondInstance?window.close():window.location.reload();else try{var t="";$.each(this.modalWindowHolder,function(){if(this.NotModal){var e=this.Window,a=this.Id,o=e.options,n=o.position.top,d=o.position.left,s=o.width,l=o.height;isNaN(d)&&("50%"===d?d="":d=d.replace("px","")),isNaN(n)&&("50%"===n?n="":n=n.replace("px","")),isNaN(s)&&(s=s.replace("px","")),isNaN(l)&&(l=l.replace("px",""));var r=a+";"+d+";"+n+";"+s+";"+l;t=t?t+"|"+r:r}}),this.eventTrigged(t,this.manualSignOff,"","","closeBrowser",function(){},function(e){alert("Error on close SYSPRO - "+e.message)},!0)}catch(e){alert("Error on close SYSPRO - "+e.message)}},SYSPROInteropClass.prototype.storeData=function(e,t){this.callLayerInterop.storeData(e,t)},SYSPROInteropClass.prototype.retrieveData=function(e){return this.callLayerInterop.retrieveData(e)},SYSPROInteropClass.prototype.storeDataServer=function(e,t){this.callLayerInterop.storeData(e,t)},SYSPROInteropClass.prototype.retrieveDataServer=function(e){return this.callLayerInterop.retrieveData(e)},SYSPROInteropClass.prototype.getLastProgramCalled=function(){return this.recentProgramList&&0<this.recentProgramList.length&&this.recentProgramList[this.recentProgramList.length-1].name?this.recentProgramList[this.recentProgramList.length-1].name.trim():""},SYSPROInteropClass}(),AvantiGridsClass=function(){function AvantiGridsClass(e){var t=this;this.smallGridHeight=230,this.mediumGridHeight=460,this.largeGridHeight=690,this.resizeGridClicked=function(a){var e=t,o=$(".syspro-grid-list",$(a.currentTarget).closest(".panel-body")),n=o.data("sysprogridheight"),d=e.mediumGridHeight,s=0;$(a.currentTarget).hasClass("up-arrow")?n===e.mediumGridHeight&&(d=e.smallGridHeight,s=1):$(a.currentTarget).hasClass("down-arrow")&&n===e.mediumGridHeight&&(d=e.largeGridHeight,s=2),o.data("sysprogridheight",d);var l=o.data("kendoGrid"),r=l.getOptions();r.height=d,l.setOptions(r),e.applyGridHeight(o),e.interopInternal.eventTrigged(o.data("sysprogridfieldname"),s,"","","gridSizeChanged",function(){},null)},this.gridEditableKeyDown=function(a){try{var e=t.interopInternal,o=t,n=!1;if($($(a.target).closest(".k-edit-cell"))[0])n=!0;else if($($(a.target).closest(".k-edit-cell"))){var d=$($(a.target).closest(".k-edit-cell"));d&&d.context&&"form-control dropdown-select"==d.context.className&&(n=!0)}if(a.keyCode===kendo.keys.TAB&&!0==n){a.preventDefault();var s=$(a.target).closest("[data-role=grid]").data("kendoGrid"),l=null,r=$(a.target).closest("tr"),c=$(a.target).closest("td"),p=r.index(),u=c.index();s.dataSource.group()&&(u-=s.dataSource.group().length);var m=s.dataItem($(a.target).closest("tr")),g=s.columns[u].field,h,f;if(!$(a.target).hasClass("k-dropdown")){var y=$(a.target).val();if("date"===s.columns[u].type){var b=$(s.element).data("dateformatout"),v=kendo.parseDate(y,b);m.set(g,v)}else m.set(g,y)}if(s.closeCell(c),a.shiftKey)f=c.prevAll(".editable-cell:visible"),f[0]?(u=f[0].cellIndex,l=f[0]):(r=r.prev(),0<r.length&&(p=r.index(),c=r.children(".editable-cell:visible:last"),u=c[0].cellIndex,l=c[0],s.select("tr:eq("+p+")")));else if(f=c.nextAll(".editable-cell:visible"),0<f.length){var w=m.colDisabled;if(!w||"undefined"===w)u=f[0].cellIndex,l=f[0];else{"|"!==w[w.length-1]&&(w+="|");for(var C=!1,k=0;k<f.length;k++){u=f[k].cellIndex,l=f[k];var x=u,S=s.getOptions().columns[x].field;if(!w.includes(S)){C=!0;break}}if(!1===C)if(h=r,r=r.next(),0<r.length)p=r.index(),c=r.children(".editable-cell:visible:first"),u=c[0].cellIndex,l=c[0],r.data("sysignorerowselectedevent",!0),s.select("tr:eq("+p+")");else{var T=$(s.element).data("sysprogridfieldname"),W=s.dataSource.indexOf(m)+1+"|",D=m.toJSON(),I=null;$.each(D,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){var a=!1,n=!1,d=!1;for(k=0;k<s.columns.length;k++){if(s.columns[k].field===e&&"date"===s.columns[k].type){a=!0;break}if(s.columns[k].field===e&&s.columns[k].isCombbox){n=!0;break}if(s.columns[k].field===e&&("combo"===s.columns[k].type||"radio"===s.columns[k].type)){d=!0;break}}W=a?W+o.convertDateForGridOutput(t)+"|":n?W+t.key+"|":d?W+t.value+"|":W+t+"|"}else 0<e.indexOf("systag")&&(I=I+e+"='"+t+"';")}),I&&(W=W+"{{"+I+"}}"),e.eventTrigged(T,"true|"+W,"","","gridCanAddNewRow",function(){},function(){})}}}else if(h=r,r=r.next(),0<r.length)p=r.index(),c=r.children(".editable-cell:visible:first"),u=c[0].cellIndex,l=c[0],r.data("sysignorerowselectedevent",!0),s.select("tr:eq("+p+")");else{var T=$(s.element).data("sysprogridfieldname"),W=s.dataSource.indexOf(m)+1+"|",D=m.toJSON(),I=null;$.each(D,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){var a=!1,n=!1,d=!1;for(k=0;k<s.columns.length;k++){if(s.columns[k].field===e&&"date"===s.columns[k].type){a=!0;break}if(s.columns[k].field===e&&s.columns[k].isCombbox){n=!0;break}if(s.columns[k].field===e&&("combo"===s.columns[k].type||"radio"===s.columns[k].type)){d=!0;break}}W=a?W+o.convertDateForGridOutput(t)+"|":n?W+t.key+"|":d?W+t.value+"|":W+t+"|"}else 0<e.indexOf("systag")&&(I=I+e+"='"+t+"';")}),I&&(W=W+"{{"+I+"}}"),e.eventTrigged(T,"true|"+W,"","","gridCanAddNewRow",function(){},function(){})}var O=s.columns[u].type;O?"combo"==O?l&&f[0].childNodes[0]&&f[0].childNodes[0].focus():setTimeout(function(){s.editCell(s.tbody.find("tr:eq("+p+") td:eq("+u+")"))}):setTimeout(function(){s.editCell(s.tbody.find("tr:eq("+p+") td:eq("+u+")"))})}}catch(e){t.interopInternal.handleError(e.message,"gridKeyDownEvent")}},this.gridRowSelected=function(a){var e=t.interopInternal,o=a.sender,n=a.sender.element,d=n.data("sysprogridfieldname"),s=o.select(),l=n.data("sysprolastgridselection"),r=a.sender.select().attr("data-uid");if(l!=r){l=r,n.data("sysprolastgridselection",l);var c="";if(null!==o){var p=o.dataItem(o.select());if(null!==p){c=o.dataSource.indexOf(p)+1+"|";var u=p.toJSON(),m=null;$.each(u,function(e,a){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var n=!1,d=!1,s=!1,l=0;l<o.columns.length;l++){if(o.columns[l].field===e&&"date"===o.columns[l].type){n=!0;break}if(o.columns[l].field===e&&o.columns[l].isCombbox){d=!0;break}if(o.columns[l].field===e&&("combo"===o.columns[l].type||"radio"===o.columns[l].type)){s=!0;break}}c=n?c+t.convertDateForGridOutput(a)+"|":d?c+a.key+"|":s?c+a.value+"|":c+a+"|"}else 0<e.indexOf("systag")&&(m=m+e+"='"+a+"';")}),m&&(c=c+"{{"+m+"}}"),!0===s.data("sysignorerowselectedevent")?s.data("sysignorerowselectedevent",!1):e.eventTrigged(d,c,"","","gridRowSelected",function(){},function(){})}}}},this.interopInternal=e}return AvantiGridsClass.prototype.convertDateForGridOutput=function(e){return e instanceof Date?kendo.toString(e,"yyyyMMdd"):kendo.toString(kendo.parseDate(e),"yyyyMMdd")},AvantiGridsClass.prototype.initializeComments=function(e){var t=this.interopInternal,a=this,o=e.closest(".noBorderTable");$(".comment",o).each(function(){$(this).siblings(".truncatedComment").text(a.truncateWithEllipses($(this).text().trim()))});var n;n={trigger:"click",placement:"auto",html:"true",title:"Add a comment",container:"body",content:"<textarea class=\"popover-textarea\"></textarea>",template:"<div class=\"popover textarea-popover\"><div class=\"arrow\"></div><h3 class=\"popover-title\"></h3><div class=\"popover-content popover-textarea-content\">xxx</div><div class=\"popover-footer\"><button type=\"button\" class=\"btn btn-sm btn-default popover-cancel\"><i class=\"material-icons\">cancel</i></button>&nbsp;<button type=\"button\" class=\"btn btn-primary btn-sm popover-submit pull-right\"><i class=\"material-icons\">check</i></button></div></div>"},$(".comment-click-activation",o).popover(n).on("shown.bs.popover",function(o){var e=$(this),n=$(o.target).data("bs.popover").$tip;$(".textarea-popover").not(n).popover("hide"),$(".textarea-popover").not(n).data("bs.popover")&&($(".textarea-popover").not(n).data("bs.popover").inState.click=!1);var d=e.parent().find(".comment"),s=n.find(".popover-textarea");s.val(d.text().trim()).focus(),$(".popover-cancel").off("click"),$(".popover-cancel").on("click",function(){e.popover("hide"),e.data("bs.popover").inState.click=!1}),$(".popover-submit").off("click"),$(".popover-submit").on("click",function(){if(d.text(s.val().trim()),e.parent().find(".truncatedComment").text(a.truncateWithEllipses(d.text().trim())),d){var o=d[0].getAttribute("data-columnname"),n=d[0].getAttribute("data-columnuid"),l=e.closest(".syspro-grid-list");if(l){var r=l.data("sysprogridfieldname"),c=l.data("kendoGrid");if(c){var p=c.dataSource.getByUid(n.trim());if(p){p[o]=s.val().trim();var u=l.data("kendoGrid").select(),m;m=0===u.length?c.dataSource.total():u.index()+1;var g=!1;u.index()+1==c.dataSource.total()&&(g=!0);var h=c.dataItem(u);!0==l.data("sysprohashiddenrows")&&(m=c.dataSource.indexOf(h)+1);var f=m+"|"+g+"|"+o+"|"+s.val().trim()+"|";if(null!==h){var y=h.toJSON(),b=null;$.each(y,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var o=!1,n=!1,d=!1,s=0;s<c.columns.length;s++){if(c.columns[s].field===e&&"date"===c.columns[s].type){o=!0;break}if(c.columns[s].field===e&&c.columns[s].isCombbox){n=!0;break}if(c.columns[s].field===e&&("combo"===c.columns[s].type||"radio"===c.columns[s].type)){d=!0;break}}f=o?f+a.convertDateForGridOutput(t)+"|":n?f+t.key+"|":d?f+t.value+"|":f+t+"|"}else 0<e.indexOf("systag")&&(b=b+e+"='"+t+"';")}),b&&(f=f+"{{"+b+"}}")}null!==f&&t.eventTrigged(r,f,"","","gridCellChanged",function(){},function(){})}}}}e.popover("hide"),e.data("bs.popover").inState.click=!1})})},AvantiGridsClass.prototype.truncateWithEllipses=function(e){return e.substr(0,2e3)+(2001<e.length?"...":"")},AvantiGridsClass.prototype.createGridList=function(e){try{var t=this.interopInternal,a=this,o=$("*[data-sysprogridfieldname=\""+e.FieldName+"\"]"),n={},d={},s=[],l=[],r=[],c=[],p=[],u=!1,m={virtual:!0};$.each(o,function(){var o=$(this);if(o.data("kendoGrid")){o.data("kendoGrid").destroy();var g=$(o.closest(".noBorderTable").data("blanktable")),h=o.closest(".noBorderTable");h.empty().append(g),o=h.find(".syspro-grid-list")}else{var f=o.closest(".noBorderTable").html();o.closest(".noBorderTable").data("blanktable",f)}var y=JSON.parse(e.GridData).lv,b=[],v;if(null!==y){!0===y.prop.editable&&(v={},v={mode:"incell",createAt:"bottom",update:!0});for(var w="#= !data.{0} ? '"+y.prop.sysprotranNone+"' : kendo.toString(data.{1},'"+y.prop.sysproDateFormatOut+"') #",C=0;C<y.cs.c.length;C++)"date"===y.cs.c[C].type&&(y.cs.c[C].template=w.replace("{1}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{0}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{2}",y.cs.c[C].field),y.cs.c[C].format="{0:"+y.prop.sysproDateFormatOut+"}",b.push(y.cs.c[C].field)),"boolean"===y.cs.c[C].type&&(y.cs.c[C].editable||"false"===y.cs.c[C].editable||!1===y.cs.c[C].editable?"false"===y.cs.c[C].editable?(y.cs.c[C].template="<input type='checkbox' # if({0}){ # checked #} # # if ((typeof {1}sysdisabled !== 'undefined') && {2}sysdisabled){# disabled #} # />".replace("{0}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{1}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{2}",y.cs.c[C].field)):y.cs.c[C].template="<input type='checkbox' # if({0}){ # checked #} # disabled />".replace("{0}",y.cs.c[C].field):(y.cs.c[C].template="<input type=\"checkbox\" #= {0} ? 'checked=\"checked\"' : \"\" #  # if ((typeof {1}sysdisabled !== \"undefined\") && {2}sysdisabled){# disabled #} # class=\"sysEditGridCheckBox\" />".replace("{0}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{1}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{2}",y.cs.c[C].field)),y.cs.c[C].showInCheckBoxHeader&&!0===y.cs.c[C].showInCheckBoxHeader&&(y.cs.c[C].headerTemplate="<input type='checkbox' data-columnname='{0}' class='header-checkbox'></input><label style='margin-bottom: 0px; font-weight: normal;' for='header-chb'>{1}</label>".replace("{0}",y.cs.c[C].field),y.cs.c[C].headerTemplate=y.cs.c[C].headerTemplate.replace("{1}",y.cs.c[C].title))),"number"===y.cs.c[C].type&&(y.cs.c[C].template="#= !data.{3} && data.{4} !== 0 ? '' : (kendo.toString(data.{0}, 'n' + (data.{1}sysdec==null?'p':data.{2}sysdec))) #".replace("{0}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{1}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{2}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{3}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{4}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{5}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{6}",y.cs.c[C].field),y.cs.c[C].template=y.cs.c[C].template.replace("{7}",y.cs.c[C].field)),"combo"===y.cs.c[C].type&&(y.cs.c[C].template="<select class='form-control dropdown-select' data-columnname='{0}'  data-template='selectTemplate' data-bind='source: {0}.items, value: {0}.value'  # if ((typeof {1}sysdisabled !== 'undefined') && {1}sysdisabled){# disabled #} # ></select>".replace("{0}",y.cs.c[C].field).replace("{0}",y.cs.c[C].field).replace("{0}",y.cs.c[C].field).replace("{1}",y.cs.c[C].field).replace("{1}",y.cs.c[C].field)),"radio"===y.cs.c[C].type&&(y.cs.c[C].template="<form data-template='radiobuttonGridTemplate' data-bind='source: {0}.items'></form>".replace("{0}",y.cs.c[C].field).replace("{0}",y.cs.c[C].field).replace("{0}",y.cs.c[C].field)),y.cs.c[C].attributes={style:"background-color: #=data."+y.cs.c[C].field+"sysbgcolor#; color: #=data."+y.cs.c[C].field+"syscolor#;"},y.prop.editable?y.cs.c[C].editable||"false"===y.cs.c[C].editable||!1===y.cs.c[C].editable||"boolean"===y.cs.c[C].type?y.cs.c[C].type?"string"===y.cs.c[C].type?n[y.cs.c[C].field]={editable:!1}:"number"===y.cs.c[C].type?n[y.cs.c[C].field]={editable:!1,type:"number"}:"boolean"===y.cs.c[C].type?n[y.cs.c[C].field]={editable:!1,type:"boolean"}:"date"===y.cs.c[C].type&&(n[y.cs.c[C].field]={editable:!1,type:"date"}):n[y.cs.c[C].field]={editable:!1}:(y.cs.c[C].attributes["class"]="editable-cell","date"===y.cs.c[C].type?n[y.cs.c[C].field]={editable:!0,type:"date"}:(y.cs.c[C].type?"string"===y.cs.c[C].type?n[y.cs.c[C].field]={editable:!0}:"number"===y.cs.c[C].type?n[y.cs.c[C].field]={editable:!0,type:"number"}:"boolean"===y.cs.c[C].type?n[y.cs.c[C].field]={editable:!0,type:"boolean"}:"radio"===y.cs.c[C].type?n[y.cs.c[C].field]={editable:!1,type:"radio"}:"combo"===y.cs.c[C].type&&(n[y.cs.c[C].field]={editable:!1,type:"combo"}):n[y.cs.c[C].field]={editable:!0},y.cs.c[C].search&&(y.cs.c[C].editor=function(e,a){var o=$(e).closest(".syspro-grid-list"),n=o.data("kendoGrid"),d="grid:"+o.data("sysprogridfieldname"),s=$(e).closest("tr").index();d=d+":"+s+":"+a.field+":"+e[0].cellIndex;var l=$("<input type=\"text\" class=\"k-input k-textbox\" style=\"width: 80%\" name=\""+a.field+"\" />");l.appendTo(e);var r="";for(C=0;C<n.columns.length;C++)if(n.columns[C].field===a.field){r=n.columns[C].search;break}var c=$("<a class=\"syspro-browse-button\" href=\"#\" data-fieldname=\""+d+"\" data-fieldvalue=\"#GRIDVALUE#\" data-predictivesearchfield=\""+r+"\"  style=\"color: white\"><i class=\"material-icons\">search</i></a>");c.appendTo(e),"manual"!==r&&t.initializePredictiveSearch(l,r),t.subscribeToFieldEvents()}))):y.cs.c[C].type?"string"===y.cs.c[C].type?n[y.cs.c[C].field]={editable:!1,type:"string"}:"number"===y.cs.c[C].type?n[y.cs.c[C].field]={editable:!1,type:"number"}:"boolean"===y.cs.c[C].type?n[y.cs.c[C].field]={editable:!1,type:"boolean"}:"date"===y.cs.c[C].type&&(n[y.cs.c[C].field]={editable:!1,type:"date"}):n[y.cs.c[C].field]={editable:!1,type:"string"},y.cs.c[C].image&&(y.cs.c[C].headerTemplate="<div><span class='k-icon {0}'/> <a class='k-link' href='#' tabindex='-1'>{1}</a></div>".replace("{0}",y.cs.c[C].image),y.cs.c[C].headerTemplate=y.cs.c[C].headerTemplate.replace("{1}",y.cs.c[C].title));if(!0===y.prop.includeEditCommand||!0===y.prop.includeDeleteCommand||!0===y.prop.includeSelectCommand){u=!0;var k={command:[{name:"sysdummybutton",visible:function visible(){return!1}},{name:"sysselectbutton",className:"btn btn-default btn-select",iconClass:"k-icon k-i-button",text:"",title:"Select",click:function click(t){a.gridCommandSelectClicked(t)}}],width:60},x={command:[{name:"sysdummybutton",visible:function visible(){return!1}},{name:"syseditbutton",className:"btn btn-default btn-edit",iconClass:"k-icon k-i-edit",text:"",title:"Edit",click:function click(t){a.gridCommandEditClicked(t)}}],width:60},S={command:[{name:"sysdummybutton",visible:function visible(){return!1}},{name:"sysdeletebutton",className:"btn btn-default btn-delete",iconClass:"k-icon k-i-delete",text:"",title:"Delete",click:function click(t){a.gridCommandDeleteClicked(t)}}],width:60},T={command:[{name:"syseditbutton",className:"btn btn-default btn-edit",iconClass:"k-icon k-i-edit",text:"",title:"Edit",click:function click(t){a.gridCommandEditClicked(t)}},{name:"sysdeletebutton",className:"btn btn-default btn-delete",iconClass:"k-icon k-i-delete",text:"",title:"Delete",click:function click(t){a.gridCommandDeleteClicked(t)}}],width:180},W={command:[{name:"sysselectbutton",className:"btn btn-default btn-select",iconClass:"k-icon k-i-button",text:"",title:"Select",click:function click(t){a.gridCommandSelectClicked(t)}},{name:"sysdeletebutton",className:"btn btn-default btn-delete",iconClass:"k-icon k-i-delete",text:"",title:"Delete",click:function click(t){a.gridCommandDeleteClicked(t)}}],width:120},D={command:[{name:"sysselectbutton",className:"btn btn-default btn-select",iconClass:"k-icon k-i-button",text:"",title:"Select",click:function click(t){a.gridCommandSelectClicked(t)}},{name:"syseditbutton",className:"btn btn-default btn-edit",iconClass:"k-icon k-i-edit",text:"",title:"Edit",click:function click(t){a.gridCommandEditClicked(t)}}],width:120},I={command:[{name:"sysselectbutton",className:"btn btn-default btn-select",iconClass:"k-icon k-i-button",text:"",title:"Select",click:function click(t){a.gridCommandSelectClicked(t)}},{name:"syseditbutton",className:"btn btn-default btn-edit",iconClass:"k-icon k-i-edit",text:"",title:"Edit",click:function click(t){a.gridCommandEditClicked(t)}},{name:"sysdeletebutton",className:"btn btn-default btn-delete",iconClass:"k-icon k-i-delete",text:"",title:"Delete",click:function click(t){a.gridCommandDeleteClicked(t)}}],width:180};!0===y.prop.includeEditCommand&&!0===y.prop.includeDeleteCommand&&!0===y.prop.includeSelectCommand?y.cs.c.unshift(I):!0===y.prop.includeEditCommand&&!0===y.prop.includeDeleteCommand?y.cs.c.unshift(T):!0===y.prop.includeSelectCommand&&!0===y.prop.includeDeleteCommand?y.cs.c.unshift(W):!0===y.prop.includeSelectCommand&&!0===y.prop.includeEditCommand?y.cs.c.unshift(D):(!0===y.prop.includeSelectCommand&&y.cs.c.unshift(k),!0===y.prop.includeEditCommand&&y.cs.c.unshift(x),!0===y.prop.includeDeleteCommand&&y.cs.c.unshift(S))}}if(0<o.length){if(y.prop.pageable.pageSize=500,0<o.closest(".compact-window").length){$(".window-content",o.closest(".compact-window")).height();y.prop.height=460}if(o.data("sysprogridheight")){var O=o.data("sysprogridheight");y.prop.height=O}var _="";if(y.tbs&&y.tbs.tb){var P=kendo.template($("#gridToolbarTemplate").html()),E=y.tbs.tb;$.each(E,function(){_+=P(this)})}y.grps&&(r=y.grps.grp,0<r.length&&(m={endless:!0})),y.sort&&(p=y.sort),y.aggregate&&(c=y.aggregate);var F=o.data("grid-pageable-messages-empty"),A=o.data("grid-pageable-messages-of"),N=o.data("grid-pageable-messages-page"),M=o.data("grid-groupable-messages-empty"),L=o.data("grid-columnmenu-messages"),B=o.data("grid-filterable-messages"),R=o.data("grid-operators-string"),V=y.prop.columnMenu,H=y.prop.filterable;y.prop.columnMenu&&L&&(V={messages:L}),y.prop.filterable&&B&&(H={messages:B,operators:{string:R}});o.kendoGrid({dataSource:{data:[],group:r,sort:p,pageSize:y.prop.pageable.pageSize,aggregate:c,batch:!0,schema:{parse:function parse(e){return $.each(e,function(e,t){$.each(b,function(){t[this]=kendo.parseDate(t[this],y.prop.sysproDateFormatIn)})}),e},model:{fields:n}}},pdf:{allPages:!0},excel:{allPages:!0},height:y.prop.height,change:function change(t){if(a.gridRowSelected(t),o.data("sysproscrolltoselection")){if(!0===o.data("sysproscrolltoselection")){var e=o.data("sysproscrolltoselectionvalue");if(0!==e){var n=o.data("kendoGrid");n.content.scrollTop(e)}else{var d=this.element.find("tbody").offset().top,s=this.select().offset().top;this.element.find(".k-grid-content").animate({scrollTop:s-d},400)}}o.data("sysproscrolltoselection",!1),o.data("sysproscrolltoselectionvalue",0)}},sortable:y.prop.sortable,filterable:H,groupable:{messages:{empty:M},enabled:y.prop.groupable},columnMenu:V,resizable:!0,reorderable:!0,selectable:!0,navigatable:!0,editable:v,beforeEdit:function beforeEdit(t){!0===o.data("sysproentrygriddisabled")&&t.preventDefault();var e=o.data("kendoGrid");if(t.model&&t.model.colDisabled&&this.current()){var a=this.current().index(),n=e.getOptions().columns[a].field;t.model.colDisabled.includes(n)&&t.preventDefault(),t.model.commentCell===n&&t.preventDefault()}},edit:function edit(t){!0===o.data("sysproentrygriddisabled")&&this.closeCell();var e=o.data("kendoGrid");if(t.model)if(t.model.colDisabled){var a=t.container.index(),n=e.getOptions().columns[a].field,d=e.getOptions().columns[a].type;t.model.colDisabled.includes(n)?this.closeCell():d?"number"===d&&t.container.find("input").bind("focus",function(){if("none"!=this.style.display){var e=this;setTimeout(function(){e.select&&e.select()})}}):$(t.container).find("input[type=text]").select()}else{var a=t.container.index(),d=e.getOptions().columns[a].type,n=e.getOptions().columns[a].field;if(!d)$(t.container).find("input[type=text]").select();else if("number"===d){var s=o.data("kendoGrid").select();if(s){var l=e.dataItem(s),r=l[n],c=n+"sysdec";l[c]&&(r=kendo.toString(r,"n"+l[c]),t.container.find("input")&&(t.container.find("input")[0]&&t.container.find("input")[0].value!==r&&(t.container.find("input")[0].value=r),t.container.find("input")[1]&&(t.container.find("input")[1].value=r)))}t.container.find("input").bind("focus",function(){if("none"!=this.style.display){var e=this;setTimeout(function(){e.select&&e.select()})}})}}},cellClose:function cellClose(n){var e=0;if(!0===n.model.dirty){var d="",s=o.data("kendoGrid"),l=o.data("sysprogridfieldname"),r=o.data("sysprogriddates"),c=o.data("kendoGrid").select();e=0===c.length?s.dataSource.total():c.index()+1;var p=!1;c.index()+1==s.dataSource.total()&&(p=!0);var u=s.dataItem(c);!0==o.data("sysprohashiddenrows")&&(e=s.dataSource.indexOf(u)+1);var d=e+"|"+p+"|";if($.each(n.model.dirtyFields,function(e){if(d=d+e+"|",n.model[e]&&n.model[e].key)d=d+n.model[e].key+"|";else{var t=n.model[e];-1<r.indexOf(e)&&(n.model[e]?t=a.convertDateForGridOutput(n.model[e]):t=""),d=d+t+"|",null===t&&(d=null,u=null)}}),null!==d&&null===u&&(u=n.model),null!==u){var m=u.toJSON(),g=null;$.each(m,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){var o=!1,n=!1,l=!1;for(C=0;C<s.columns.length;C++){if(s.columns[C].field===e&&"date"===s.columns[C].type){o=!0;break}if(s.columns[C].field===e&&s.columns[C].isCombbox){n=!0;break}if(s.columns[C].field===e&&("combo"===s.columns[C].type||"radio"===s.columns[C].type)){l=!0;break}}o?d=d+a.convertDateForGridOutput(t)+"|":n?d=d+t.key+"|":l?d=d+t.value+"|":d+=t+"|"}else 0<e.indexOf("systag")&&(g=g+e+"='"+t+"';")}),g&&(d=d+"{{"+g+"}}")}null!==d&&t.eventTrigged(l,d,"","","gridCellChanged",function(){},function(){}),n.model.dirtyFields={},n.model.dirty=!1;var h=o.data("sysprogridchangedrows");--e,0<=e&&-1===h.indexOf(e)&&(h.push(e),o.data("sysprogridchangedrows",h))}o.data("sysprolastcellcloseselector",o.data("kendoGrid").select().index()+"|"+n.container.index())},noRecords:{template:y.prop.sysprotranNoItemText},scrollable:m,pageable:{messages:{display:"Showing {2} item(s)"},numeric:!1,previousNext:!1},toolbar:_,columns:y.cs.c,dataBinding:function dataBinding(){var e=this.element.find("div.k-grid-content").scrollTop();o.data("sysproscrolltop",e)},dataBound:function dataBound(){if(this.element.find("div.k-grid-content").scrollTop(o.data("sysproscrolltop")),$(".syspro-grid-row-hyperlink",o).off("click"),$(".syspro-grid-row-hyperlink",o).on("click",function(t){a.sysCellClick(t.target)}),!y.prop.editable||!1===y.prop.editable){var n=[37,38,39,40];o.data("kendoGrid").table.off("keydown"),o.data("kendoGrid").table.on("keydown",function(t){0<=n.indexOf(t.keyCode)&&setTimeout(function(){o.data("kendoGrid").select(o.data("kendoGrid").current().closest("tr"))},1)})}$(".dropdown-select",o.closest(".noBorderTable")).off("keydown"),$(".dropdown-select",o.closest(".noBorderTable")).on("keydown",a.gridEditableKeyDown),$(".dropdown-select",o.closest(".noBorderTable")).off("change"),$(".dropdown-select",o.closest(".noBorderTable")).on("change",function(t){return a.gridCellComboboxChange(t.target)}),$(".gridSearchTextBox",o.closest(".noBorderTable")).off("input"),$(".gridSearchTextBox",o.closest(".noBorderTable")).on("input",function(t){var e=o.data("kendoGrid"),n=e.columns,d=t.target.value;if(d=d.trim(),""===d){var s=o.data("sysprohashiddenrows");if(s){var l={logic:"and",filters:[]};l.filters.push({field:"syshidden",operator:"neq",value:!0}),e.dataSource.filter(l)}else e.dataSource.filter([])}else{var r=[{logic:"or",filters:[]}];n.forEach(function(o){if(o.field){var n=o.type;if(!o.isCombbox)if(n||(n="string"),"string"===n)r[0].filters.push({field:o.field,operator:"contains",value:t.target.value});else if("number"==n)a.isNumeric(t.target.value)&&r[0].filters.push({field:o.field,operator:"eq",value:t.target.value});else if("date"==n)for(var d=e.dataSource.data(),s=0,l;s<d.length;s++)l=kendo.format(o.format,d[s][o.field]),0===l.indexOf(t.target.value)&&r[0].filters.push({field:o.field,operator:"eq",value:d[s][o.field]});else if("boolean"==n&&null!==a.getBoolean(t.target.value)){var c=a.getBoolean(t.target.value);r[0].filters.push({field:o.field,operator:"eq",value:c})}}});var s=o.data("sysprohashiddenrows");if(s){var l={logic:"and",filters:[]};l.filters.push({field:"syshidden",operator:"neq",value:!0}),r.push(l)}e.dataSource.filter(r)}}),$(".gridLabelTextBox",o.closest(".noBorderTable")).off("keydown blur"),$(".gridLabelTextBox",o.closest(".noBorderTable")).on("keydown blur",function(a){if("blur"===a.type){var e=a.currentTarget.getAttribute("data-gridbuttoneventid"),o=a.target.value;t.eventTrigged(o,e,"","","gridToolBarTextChanged",function(){},function(){})}if("keydown"===a.type&&(9===a.keyCode||13===a.keyCode)){var e=a.currentTarget.getAttribute("data-gridbuttoneventid"),o=a.target.value;t.eventTrigged(o,e,"","","gridToolBarTextChanged",function(){},function(){})}}),$(".grid-resize-menu",o.closest(".panel-body")).show(),$(".grid-resize-menu",o.closest(".panel-body")).kendoMenu(),$(".grid-resize-toolbar",o.closest(".panel-body")).off("click"),$(".grid-resize-toolbar",o.closest(".panel-body")).on("click",a.resizeGridClicked),a.applyGridHeight(o),$(".gridButton",o.closest(".noBorderTable")).off("click"),$(".gridButton",o.closest(".noBorderTable")).on("click",function(o){var n=o.currentTarget.getAttribute("data-gridbuttoneventid");if(n){var d={InternalEvent:"",FieldName:e.FieldName,InternalEventParameter:"{}"};switch(n){case"":break;case"excelexport":d.InternalEvent="ExcelExport",a.gridRequestInternalEvent(d);break;case"pdfexport":d.InternalEvent="PDFExport",a.gridRequestInternalEvent(d);break;case"expandall":d.InternalEvent="ExpandAll",a.gridRequestInternalEvent(d);break;case"collapseall":d.InternalEvent="CollapseAll",a.gridRequestInternalEvent(d);break;default:t.eventTrigged(e.FieldName,n,"","","gridButtonClicked",function(){},function(){});}}$(".tooltip").hide()}),a.applyCheckBoxContentChangeEvent(o),queryLayoutUIHelpers.initializeTooltips(),o.data("kendoGrid").tbody.find("tr").each(function(){kendo.bind(this,o.data("kendoGrid").dataItem(this))}),a.addCommentMessageToGrid(this,o)},sort:function sort(){o.data("sysprosettingschanged",!0)},columnHide:function columnHide(){o.data("sysprosettingschanged",!0)},columnShow:function columnShow(){o.data("sysprosettingschanged",!0)},columnReorder:function columnReorder(){o.data("sysprosettingschanged",!0)},columnResize:function columnResize(){o.data("sysprosettingschanged",!0)},group:function group(){o.data("sysprosettingschanged",!0)}});o.data("syspropagesize",y.prop.pageable.pageSize),o.data("sysprogridmodel",n),o.data("sysprogridchangedrows",l),o.data("sysprogridcustomsearchrows",null),o.data("sysprolastgridselection",""),o.data("sysproentrygriddisabled",!1),o.data("sysprocomboboxes",d),o.data("sysprohascommandcolumn",u),o.data("sysproinitialgrouping",r),o.data("sysproinitialsorting",p),o.data("sysproinitialaggregates",c),o.data("dateformatin",y.prop.sysproDateFormatIn),o.data("dateformatout",y.prop.sysproDateFormatOut),o.data("sysprogriddates",b),o.data("sysprogroupfooters",s),o.data("sysprolastcellcloseselector",""),o.data("sysprohashiddenrows",!1),o.data("sysprosettingschanged",!1);var U=o.data("kendoGrid");if(!0==u){var q=U.getOptions();5>q.columns.length&&1==q.columns[0].command.length&&"Delete"===q.columns[0].command[0].title&&(q.columns[0].width=10,U.setOptions(q))}}else t.showErrorMessage("No list view with the field name '"+e.FieldName+"' exists in the current webview and it could not be created.","Create Grid List")})}catch(e){this.interopInternal.handleError(e.message,"createGridList")}},AvantiGridsClass.prototype.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},AvantiGridsClass.prototype.getBoolean=function(e){return 0==="true".indexOf(e)||0!=="false".indexOf(e)&&null},AvantiGridsClass.prototype.applyGridHeight=function(e){e.data("sysprogridheight")===this.largeGridHeight?($(".grid-resize-toolbar.up-arrow",e.closest(".panel-body")).removeClass("disabled"),$(".grid-resize-toolbar.down-arrow",e.closest(".panel-body")).addClass("disabled")):e.data("sysprogridheight")===this.mediumGridHeight?($(".grid-resize-toolbar.up-arrow",e.closest(".panel-body")).removeClass("disabled"),$(".grid-resize-toolbar.down-arrow",e.closest(".panel-body")).removeClass("disabled")):e.data("sysprogridheight")===this.smallGridHeight&&($(".grid-resize-toolbar.up-arrow",e.closest(".panel-body")).addClass("disabled"),$(".grid-resize-toolbar.down-arrow",e.closest(".panel-body")).removeClass("disabled"))},AvantiGridsClass.prototype.gridCellRadioChange=function(t){try{var e=this.interopInternal,a=this,o=$(t.closest("tr")),n=$(t.closest(".syspro-grid-list")),d=n.data("kendoGrid"),s=n.data("sysprogridfieldname");if(o&&d){var l=$("tr",d.tbody).index(o);d.select("tr:eq("+l+")");var r=d.dataItem(o),c=!1;l++,l==d.dataSource.total()&&(c=!0),l=d.dataSource.indexOf(r)+1;var p=t.getAttribute("data-columnname"),u=l+"|"+c+"|"+p+"|"+t.value+"|";if(null!==r){var m=r.toJSON(),g=null;$.each(m,function(e,o){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var n=!1,s=!1,l=!1,r=0;r<d.columns.length;r++){if(d.columns[r].field===e&&"date"===d.columns[r].type){n=!0;break}if(d.columns[r].field===e&&d.columns[r].isCombbox){s=!0;break}if(d.columns[r].field===e&&("combo"===d.columns[r].type||"radio"===d.columns[r].type)){l=!0;break}}u=n?u+a.convertDateForGridOutput(o)+"|":s?u+o.key+"|":l?u+t.value+"|":u+o+"|"}else 0<e.indexOf("systag")&&(g=g+e+"='"+o+"';")}),g&&(u=u+"{{"+g+"}}")}var s=n.data("sysprogridfieldname");e.eventTrigged(s,u,"","","gridCellChanged",function(){},!1)}}catch(e){this.interopInternal.handleError(e.message,"gridCellRadioChange")}},AvantiGridsClass.prototype.gridCellRadioClick=function(t){try{var e=$(t.target.closest(".syspro-grid-list")),a=e.data("kendoGrid"),o=e.data("sysprogridfieldname");!0===e.data("sysproentrygriddisabled")&&t.preventDefault()}catch(e){this.interopInternal.handleError(e.message,"gridCellRadioClick")}},AvantiGridsClass.prototype.gridCellComboboxChange=function(t){try{var e=this.interopInternal,a=this,o=$(t.closest("tr")),n=$(t.closest(".syspro-grid-list")),d=n.data("kendoGrid"),s=n.data("sysprogridfieldname");if(o&&d){var l=$("tr",d.tbody).index(o);d.select("tr:eq("+l+")");var r=d.dataItem(o),c=!1;l++,l==d.dataSource.total()&&(c=!0);var p=t.getAttribute("data-columnname");l=d.dataSource.indexOf(r)+1;var u=l+"|"+c+"|"+p+"|"+t.value+"|";if(r[p].value=t.value,null!==r){var m=r.toJSON(),g=null;$.each(m,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var o=!1,n=!1,s=!1,l=0;l<d.columns.length;l++){if(d.columns[l].field===e&&"date"===d.columns[l].type){o=!0;break}if(d.columns[l].field===e&&d.columns[l].isCombbox){n=!0;break}if(d.columns[l].field===e&&("combo"===d.columns[l].type||"radio"===d.columns[l].type)){s=!0;break}}u=o?u+a.convertDateForGridOutput(t)+"|":n?u+t.key+"|":s?u+t.value+"|":u+t+"|"}else 0<e.indexOf("systag")&&(g=g+e+"='"+t+"';")}),g&&(u=u+"{{"+g+"}}")}var s=n.data("sysprogridfieldname");e.eventTrigged(s,u,"","","gridCellChanged",function(){},!1)}}catch(e){this.interopInternal.handleError(e.message,"gridCellComboboxChange")}},AvantiGridsClass.prototype.gridCommandSelectClicked=function(t){try{var e=this.interopInternal,a=this;t.preventDefault();var o="",n=$(t.target).closest("tr"),d=n.closest("[data-role=grid]"),s=d.data("kendoGrid"),l=d.data("sysprogridfieldname");if(s){setTimeout(function(){n.data("sysignorerowselectedevent",!0),s.select(n)});var r=s.dataItem(n);if(null!==r){o=s.dataSource.indexOf(r)+1+"|";var c=r.toJSON(),p=null;$.each(c,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var n=!1,d=!1,l=!1,r=0;r<s.columns.length;r++){if(s.columns[r].field===e&&"date"===s.columns[r].type){n=!0;break}if(s.columns[r].field===e&&s.columns[r].isCombbox){d=!0;break}if(s.columns[r].field===e&&("combo"===s.columns[r].type||"radio"===s.columns[r].type)){l=!0;break}}o=n?o+a.convertDateForGridOutput(t)+"|":d?o+t.key+"|":l?o+t.value+"|":o+t+"|"}else 0<e.indexOf("systag")&&(p=p+e+"='"+t+"';")}),p&&(o=o+"{{"+p+"}}"),e.eventTrigged(l,o,"","","gridCommandSelectClicked",function(){},function(){})}}}catch(e){this.interopInternal.handleError(e.message,"gridCommandSelectClicked")}},AvantiGridsClass.prototype.gridCommandEditClicked=function(t){try{var e=this;t.preventDefault();var a="",o=$(t.target).closest("tr"),n=o.closest("[data-role=grid]"),d=n.data("kendoGrid"),s=n.data("sysprogridfieldname");if(d){setTimeout(function(){o.data("sysignorerowselectedevent",!0),d.select(o)});var l=d.dataItem(o);if(null!==l){a=d.dataSource.indexOf(l)+1+"|";var r=l.toJSON(),c=null;$.each(r,function(t,o){if(-1===t.indexOf("syscolor")&&-1===t.indexOf("sysbgcolor")&&-1===t.indexOf("sysdisabled")&&-1===t.indexOf("systag")&&-1===t.indexOf("sysdec")){for(var n=!1,s=!1,l=!1,r=0;r<d.columns.length;r++){if(d.columns[r].field===t&&"date"===d.columns[r].type){n=!0;break}if(d.columns[r].field===t&&d.columns[r].isCombbox){s=!0;break}if(d.columns[r].field===t&&("combo"===d.columns[r].type||"radio"===d.columns[r].type)){l=!0;break}}a=n?a+e.convertDateForGridOutput(o)+"|":s?a+o.key+"|":l?a+o.value+"|":a+o+"|"}else 0<t.indexOf("systag")&&(c=c+t+"='"+o+"';")}),c&&(a=a+"{{"+c+"}}"),e.interopInternal.eventTrigged(s,a,"","","gridCommandEditClicked",function(){},function(){})}}}catch(e){this.interopInternal.handleError(e.message,"gridCommandEditClicked")}},AvantiGridsClass.prototype.gridCommandDeleteClicked=function(t){try{var e=this.interopInternal,a=this;t.preventDefault();var o="",n=$(t.target).closest("tr"),d=n.closest("[data-role=grid]"),s=d.data("kendoGrid"),l=d.data("sysprogridfieldname");if(s){setTimeout(function(){n.data("sysignorerowselectedevent",!0),s.select(n)});var r=s.dataItem(n);if(null!==r){o=s.dataSource.indexOf(r)+1+"|";var c=r.toJSON(),p=null;$.each(c,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var n=!1,d=!1,l=!1,r=0;r<s.columns.length;r++){if(s.columns[r].field===e&&"date"===s.columns[r].type){n=!0;break}if(s.columns[r].field===e&&s.columns[r].isCombbox){d=!0;break}if(s.columns[r].field===e&&("combo"===s.columns[r].type||"radio"===s.columns[r].type)){l=!0;break}}o=n?o+a.convertDateForGridOutput(t)+"|":d?o+t.key+"|":l?o+t.value+"|":o+t+"|"}else 0<e.indexOf("systag")&&(p=p+e+"='"+t+"';")}),p&&(o=o+"{{"+p+"}}"),e.eventTrigged(l,o,"","","gridCommandDeleteClicked",function(){},function(){})}}}catch(e){this.interopInternal.handleError(e.message,"gridCommandDeleteClicked")}},AvantiGridsClass.prototype.refreshGridList=function(e){try{var t=this.interopInternal,a=this,o=JSON.parse(e.GridData),n=$("*[data-sysprogridfieldname=\""+e.FieldName+"\"]"),d=0;return $.each(n,function(){var t=$(this),n=t.data("syspropagesize"),s=t.data("sysprogridmodel"),l=t.data("sysprogriddates"),r=function(e){return $.each(e,function(e,a){$.each(l,function(){a[this]=kendo.parseDate(a[this],t.data("dateformatin"))})}),e},c=t.data("sysproinitialgrouping"),p=t.data("sysproinitialsorting"),u=t.data("sysproinitialaggregates"),m=new kendo.data.DataSource({data:o.lv.rs.r,group:c,sort:p,aggregate:u,change:function change(t){t.field&&"itemchange"==t.action},pageSize:n,schema:{parse:function parse(e){return r(e)},model:{fields:s}}}),g=t.data("kendoGrid"),h;if(g){var f=g.getOptions(),y=$(".k-grid-toolbar",t.closest(".noBorderTable")).html();if(h=g.dataSource.sort(),o.lv.cls&&o.lv.cls.cl){for(T=0;T<o.lv.cls.cl.length;T++)for(var b=o.lv.cls.cl[T].col,v=o.lv.cls.cl[T].event,w=0;w<f.columns.length;w++)if(b===f.columns[w].field){if("boolean"===f.columns[w].type||"date"===f.columns[w].type)break;var C="#="+b+"#";f.columns[w].template&&0>f.columns[w].template.indexOf("syspro-grid-row-hyperlink")&&(C=f.columns[w].template),f.columns[w].template="<div class=\"syspro-grid-row-hyperlink\" data-eventnum=\""+f.columns[w].field+"|"+v+"\">"+C+"</div>";break}f.toolbar=y,g.setOptions(f)}if(!0===e.IsAppend){var k=g.dataSource.data().toJSON(),x=k.concat(o.lv.rs.r);m=new kendo.data.DataSource({data:x,group:c,sort:p,aggregate:u,pageSize:n,schema:{parse:function parse(e){return r(e)},model:{fields:s}}});var S=t.data("sysprocommentrows");if(!S)t.data("sysprocommentrows",o.lv.mss);else if(o.lv.mss){for(var T=0;T<o.lv.mss.ms.length;T++)S.ms.push(o.lv.mss.ms[T]);t.data("sysprocommentrows",S)}}else m=new kendo.data.DataSource({data:o.lv.rs.r,group:c,sort:p,aggregate:u,pageSize:n,change:function change(){},schema:{parse:function parse(e){return r(e)},model:{fields:s}}}),o.lv.mss?t.data("sysprocommentrows",o.lv.mss):t.data("sysprocommentrows",{ms:[]});if(g.setDataSource(m),!0===e.IsAppend&&"bottom"===g.options.editable.createAt){var W=g.tbody.children().last();if(W&&W.length){var D=$(".editable-cell",W[0]).index();if(0<=D&&(W.data("sysignorerowselectedevent",!0),0<=W.index())){g.select(W);try{g.editCell(g.tbody.find("tr:eq("+W.index()+") td:eq("+D+")"))}catch(t){}}}}d=g.dataSource.total(),"bottom"===g.options.editable.createAt&&(t.closest(".noBorderTable").find("table").off("keydown"),t.closest(".noBorderTable").find("table").on("keydown",a.gridEditableKeyDown))}var I=t.data("sysprohashiddenrows");if(I){var O={logic:"and",filters:[]};O.filters.push({field:"syshidden",operator:"neq",value:!0}),g.dataSource.filter(O)}}),d}catch(e){this.interopInternal.handleError(e.message,"refreshGridList")}},AvantiGridsClass.prototype.addCommentMessageToGrid=function(e,t){try{var a=this,o=t.data("sysprocommentrows");if(o&&o.ms){for(var n=0;n<o.ms.length;n++){for(var d=o.ms[n],s=d.row-1,l=d.col,r=0,c=0;c<e.columns.length;c++)if(e.columns[c].field===l){r=c;break}var p=e.dataSource.data()[s];if(p){var u=e.table.find("tr[data-uid='"+p.uid+"']"),m=u.find("td:eq("+r+")");m.removeClass("editable-cell");var g="<span class=\"gridlist-cell-comment\" tabindex=\"0\" ></span><span class=\"truncatedComment\"></span><span class=\"comment\" data-columnuid=\""+p.uid+" \"data-columnname=\""+l+"\">"+p[l]+"</span>";m.html(g),m.addClass("comment-click-activation");var h=p.colDisabled;h&&"undefined"!==h||(p.colDisabled=""),h=p.colDisabled,"|"!==h[h.length-1]&&(h+="|"),h.includes(l)&&(h=h.replace("|"+l,"")),"|"===h.slice(-1)?h+=l:h=h+"|"+l,p.colDisabled=h}}a.initializeComments(t)}}catch(e){this.interopInternal.handleError(e.message,"addCommentMessageToGrid")}},AvantiGridsClass.prototype.applyCheckBoxContentChangeEvent=function(t){try{var a=this.interopInternal,o=this;$(t.closest(".noBorderTable")).off("change","input.sysEditGridCheckBox"),$(t.closest(".noBorderTable")).on("change","input.sysEditGridCheckBox",function(n){var e=t.data("kendoGrid");if(!0!==t.data("sysproentrygriddisabled")){var d=$(n.target).closest("tr");d.data("sysignorerowselectedevent",!0);var s=e.dataItem($(n.target).closest("tr"));e.select(s);var l=e.dataSource.indexOf(s),r=$("tr",e.tbody).index(d),c=$("td",d).index(n.target.parentElement);!0===e._group&&--c;var p=e.columns[c].field;s[p]=this.checked,e.select("tr:eq("+r+")"),s=e.dataSource.data()[l];var u=t.data("sysprogridchangedrows");0<=l&&-1===u.indexOf(l)&&(u.push(l),t.data("sysprogridchangedrows",u)),l++,r++;var m=!1;r==e.dataSource.total()&&(m=!0);var g=l+"|"+m+"|"+p+"|"+this.checked+"|";if(null!==s){var h=s.toJSON(),f=null;$.each(h,function(t,a){if(-1===t.indexOf("syscolor")&&-1===t.indexOf("sysbgcolor")&&-1===t.indexOf("sysdisabled")&&-1===t.indexOf("systag")&&-1===t.indexOf("sysdec")){for(var n=!1,d=!1,s=!1,l=0;l<e.columns.length;l++){if(e.columns[l].field===t&&"date"===e.columns[l].type){n=!0;break}if(e.columns[l].field===t&&e.columns[l].isCombbox){d=!0;break}if(e.columns[l].field===t&&("combo"===e.columns[l].type||"radio"===e.columns[l].type)){s=!0;break}}g=n?g+o.convertDateForGridOutput(a)+"|":d?g+a.key+"|":s?g+a.value+"|":g+a+"|"}else 0<t.indexOf("systag")&&(f=f+t+"='"+a+"';")}),f&&(g=g+"{{"+f+"}}")}var y=t.data("sysprogridfieldname");a.eventTrigged(y,g,"","","gridCellChanged",function(){},!1),o.gridAutoCheckGridColumnHeader(t)}else{var b=n.target.checked;b=!b,n.target.checked=b}}),$(".header-checkbox",t.closest(".noBorderTable")).off("click"),$(".header-checkbox",t.closest(".noBorderTable")).on("click",function(e){e.stopPropagation();var o=e.target.getAttribute("data-columnname"),n=e.target.checked;if(!0!==t.data("sysproentrygriddisabled")){var d=t.data("kendoGrid"),s=t.data("sysprogridchangedrows");$.each(d.dataSource.data(),function(e){var t=d.dataSource.at(e);0<=e&&-1===s.indexOf(e)&&s.push(e),"incell"===d.options.editable.mode?t[o]=n:t.set(o,n)}),t.data("sysprogridchangedrows",s),d.refresh();var l=t.data("sysprogridfieldname");a.eventTrigged(l,o+"|"+n,"","","gridHeaderChecked",function(){},!1),setTimeout(function(){e.target.checked=e.target.checked})}else{var r=e.target.checked;r=!r,e.target.checked=r}}),o.gridAutoCheckGridColumnHeader(t)}catch(e){this.interopInternal.handleError(e.message,"applyContentChangeEvent")}},AvantiGridsClass.prototype.gridAutoCheckGridColumnHeader=function(e){if(e){var t=e.data("kendoGrid");if(t){var a=t.columns,o=$.grep(a,function(e){return!0===e.showInCheckBoxHeader});if(o&&0<o.length)for(var n=0,d;n<o.length;n++)if(d=$("input[data-columnname='"+o[n].field+"']",e.closest(".noBorderTable")),d&&d[0]){var s=t.dataSource.data();if(0<s.length){var l=$.grep(s,function(e){return!1===e[o[n].field]});l&&(0==l.length?d[0].checked=!0:d[0].checked=!1)}else d[0].checked=!1}}}},AvantiGridsClass.prototype.requestGridListsRefresh=function(e){var t=this.interopInternal;0<$(".syspro-grid-list",e).length&&$.each($(".syspro-grid-list",e),function(){$(this).data("kendoGrid").setOptions($(this).data("kendoGrid").getOptions());var e=$(this).data("sysprogridfieldname");t.eventTrigged(e,"","","","requestGridListRefresh",function(){},!1)})},AvantiGridsClass.prototype.sysCellClick=function(e){var t=this,a=this.interopInternal,o=$(e).data("eventnum");if("syspro-grid-row-hyperlink"===e.className){var n=$(e).closest(".syspro-grid-list"),d=n.data("kendoGrid"),s=n.data("sysprogridfieldname"),l=d.dataItem($(e).closest("tr")),r=$(e).closest("tr");r.data("sysignorerowselectedevent",!0);var c=l.toJSON(),p=d.dataSource.indexOf(l),u=p+1+"|",m=null;null!==l&&($.each(c,function(e,a){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var o=!1,n=!1,s=!1,l=0;l<d.columns.length;l++){if(d.columns[l].field===e&&"date"===d.columns[l].type){o=!0;break}if(d.columns[l].field===e&&d.columns[l].isCombbox){n=!0;break}if(d.columns[l].field===e&&("combo"===d.columns[l].type||"radio"===d.columns[l].type)){s=!0;break}}u=o?u+t.convertDateForGridOutput(a)+"|":n?u+a.key+"|":s?u+a.value+"|":u+a+"|"}else 0<e.indexOf("systag")&&(m=m+e+"='"+a+"';")}),m&&(u=u+"{{"+m+"}}"),a.eventTrigged(s,u,"","","gridRowSelected",function(){var e=o+"|",n=null;$.each(c,function(a,o){if(-1===a.indexOf("syscolor")&&-1===a.indexOf("sysbgcolor")&&-1===a.indexOf("sysdisabled")&&-1===a.indexOf("systag")&&-1===a.indexOf("sysdec")){for(var s=!1,l=!1,r=!1,c=0;c<d.columns.length;c++){if(d.columns[c].field===a&&"date"===d.columns[c].type){s=!0;break}if(d.columns[c].field===a&&d.columns[c].isCombbox){l=!0;break}if(d.columns[c].field===a&&("combo"===d.columns[c].type||"radio"===d.columns[c].type)){r=!0;break}}e=s?e+t.convertDateForGridOutput(o)+"|":l?e+o.key+"|":r?e+o.value+"|":e+o+"|"}else 0<a.indexOf("systag")&&(n=n+a+"='"+o+"';")}),n&&(e=e+"{{"+n+"}}"),a.eventTrigged(s,e,"","","gridHyperlinkClicked",function(){},function(){}),d.select(l)},function(){}))}},AvantiGridsClass.prototype.gridRequestInternalEvent=function(e){try{var t=this.interopInternal,a=this,o=$("*[data-sysprogridfieldname=\""+e.FieldName+"\"]:visible");0===o.length&&(o=$("*[data-sysprogridfieldname=\""+e.FieldName+"\"]"));var n="",d,s;if(0<o.length||"GetGridLayoutsChanged"===e.InternalEvent){var l=o.data("kendoGrid");if(l||"GetGridLayoutsChanged"===e.InternalEvent)switch(e.InternalEvent){case"GetSelectedRow":if(n="false",null!==l.dataItem){var r=l.dataItem(l.select());if(null!==r){n=l.dataSource.indexOf(r)+1+"|";var c=r.toJSON(),p=null;$.each(c,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){var o=!1,d=!1,s=!1;for(q=0;q<l.columns.length;q++){if(l.columns[q].field===e&&"date"===l.columns[q].type){o=!0;break}if(l.columns[q].field===e&&l.columns[q].isCombbox){d=!0;break}if(l.columns[q].field===e&&("combo"===l.columns[q].type||"radio"===l.columns[q].type)){s=!0;break}}n=o?n+a.convertDateForGridOutput(t)+"|":d?n+t.key+"|":s?n+t.value+"|":n+t+"|"}else 0<e.indexOf("systag")&&(p=p+e+"='"+t+"';")}),p&&(n=n+"{{"+p+"}}")}}break;case"RefreshGrid":$.each(o,function(){var e=$(this);l=e.data("kendoGrid"),l.refresh();var t=e.data("sysproinitialaggregates");t&&l.dataSource.fetch()});break;case"Size":n=l.dataSource.total()+"|";break;case"SetCheckMarkOnColumnMatch":$.each(o,function(){var t=$(this);l=t.data("kendoGrid"),s=e.InternalEventParameter.split("|");var a=l.dataItem(l.select()),o;o="true"===s[1];var n=!1,d=0;for(R=0;R<l.columns.length;R++)if(l.columns[R].field===s[0]){d=R,"boolean"===l.columns[R].type&&(n=!0);break}if(n){var r=s[2],c=s[3],p=l.dataSource.data(),u=$.grep(p,function(e){return e[r]===c}),m=t.data("sysprogridchangedrows");if(u&&0<u.length){for(var g=0,h;g<u.length;g++)h=l.dataSource.indexOf(u[g]),0<=h&&-1===m.indexOf(h)&&m.push(h),u[g].set(s[0],o),"incell"===l.options.editable.mode&&(u[g][s[0]]=o);t.data("sysprogridchangedrows",m);var f=l.content.scrollTop();t.data("sysproscrolltoselectionvalue",f),l.refresh(),t.data("sysproscrolltoselection",!0),l.select("tr[data-uid='"+a.uid+"']")}}});break;case"SetSelectedCheckMark":$.each(o,function(){var t=$(this);l=t.data("kendoGrid"),s=e.InternalEventParameter.split("|");var a="true"===s[1];var o=!1,n=0;for(R=0;R<l.columns.length;R++)if(l.columns[R].field===s[0]){n=R,"boolean"===l.columns[R].type&&(o=!0);break}if(o){var d=l.dataItem(l.select());if(d){var r=l.dataSource.indexOf(d);d.set(s[0],a),d.dirtyFields={},d.dirty=!1,!0===o&&"incell"===l.options.editable.mode&&(d[s[0]]=a);var c=t.data("sysprogridchangedrows");0<=r&&-1===c.indexOf(r)&&(c.push(r),t.data("sysprogridchangedrows",c));var p=l.content.scrollTop();t.data("sysproscrolltoselectionvalue",p),l.refresh(),t.data("sysproscrolltoselection",!0),l.select("tr[data-uid='"+d.uid+"']")}}});break;case"GetCellValue":s=e.InternalEventParameter.split("|"),d=l.dataSource.data()[s[0]],null!==d&&(n=d.get(s[1])+"|");break;case"SetCellValue":$.each(o,function(){var t=$(this);l=t.data("kendoGrid"),s=e.InternalEventParameter.split("|");var a=s[0]-1,o;if(l&&(d=l.dataSource.data()[a],null!==d)){o="true"===s[2]||"false"!==s[2]&&s[2],d.set(s[1],o),d.dirtyFields={},d.dirty=!1;var n=0,r=!1,c=!0;for(R=0;R<l.columns.length;R++)if(l.columns[R].field===s[1]){n=R,"boolean"===l.columns[R].type&&(r=!0),!1===l.columns[R].editable&&(c=!1);break}!0===r&&"incell"===l.options.editable.mode&&(d[s[1]]=o),!1==c&&(d[s[1]]=o);var p=t.data("sysprogridchangedrows");0<=a&&-1===p.indexOf(a)&&(p.push(a),t.data("sysprogridchangedrows",p));var u=l.dataSource.data()[a],m=l.table.find("tr[data-uid='"+u.uid+"']"),g=m.find("td:eq("+n+")");g.hasClass("k-dirty-cell")&&(g.removeClass("k-dirty-cell"),g[0].childNodes[0]&&"k-dirty"===g[0].childNodes[0].className&&g[0].childNodes[0].remove()),2<s.length&&"true"===s[3]&&(l.editCell(l.tbody.find("tr:eq("+a+") td:eq("+n+")")),l.select(),m.addClass("k-state-selected"))}var h=l.content.scrollTop();if(t.data("sysproscrolltoselectionvalue",h),l.refresh(),t.data("sysproscrolltoselection",!0),l.select("tr[data-uid='"+d.uid+"']"),!1===r){var f=t.data("sysproinitialaggregates");f&&l.dataSource.fetch()}});break;case"SetCellValueKeepDirty":$.each(o,function(){var t=$(this);if(l=t.data("kendoGrid"),l){s=e.InternalEventParameter.split("|");var a=s[0]-1;d=l.dataSource.data()[a],null!==d&&d.set(s[1],s[2]);var o=s[0],n=s[3];setTimeout(function(){l.editCell(l.tbody.find("tr:eq("+a+") td:eq("+n+")"));var e=l.table.find("tr[data-uid='"+d.uid+"']");e.addClass("k-state-selected")})}});break;case"SetHeaders":var u=JSON.parse(e.InternalEventParameter);$.each(o,function(){var e=$(this);if(l=e.data("kendoGrid"),l){var t=l.getOptions();t&&($.each(u.lv.cs.c,function(e){var a=u.lv.cs.c[e].field,o=u.lv.cs.c[e].title,n=null;for(u.lv.cs.c[e].search&&(n=u.lv.cs.c[e].search),R=0;R<t.columns.length;R++)if(t.columns[R].field===a){""===o&&(o="  "),t.columns[R].title=o,n&&(t.columns[R].search=n);break}}),l.setOptions(t))}});break;case"FilterColumns":var m=JSON.parse(e.InternalEventParameter);$.each(o,function(){var e=$(this);l=e.data("kendoGrid"),l&&l.dataSource.filter(m)});break;case"GetGridRow":var g=e.InternalEventParameter;--g;var h=l.dataSource.at(g);if(h){n=e.InternalEventParameter+"|";var p=null;$.each(h,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var o=!1,d=!1,s=!1,r=!1,c=0;c<l.columns.length;c++)if(l.columns[c].field===e){if(o=!0,"date"===l.columns[c].type){d=!0;break}if(l.columns[c].isCombbox){s=!0;break}if("combo"===l.columns[c].type||"radio"===l.columns[c].type){r=!0;break}}}else 0<e.indexOf("systag")&&(p=p+e+"='"+t+"';");!0===o?!0===d?n=n+a.convertDateForGridOutput(t)+"|":s?n=n+t.key+"|":r?n=n+t.value+"|":n+=t+"|":"syshidden"===e&&(n+="syshidden|")}),p&&(n=n+"{{"+p+"}}")}""===n&&(n="false");break;case"GetAllGridRows":var f="",y="";$.each(l.dataSource.data(),function(e){var t=l.dataSource.at(e);y=e+1+"|";var o=null;$.each(t,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var n=!1,d=!1,s=!1,r=!1,c=0;c<l.columns.length;c++)if(l.columns[c].field===e){if(n=!0,"date"===l.columns[c].type){d=!0;break}if(l.columns[c].isCombbox){s=!0;break}if("combo"===l.columns[c].type||"radio"===l.columns[c].type){r=!0;break}}}else 0<e.indexOf("systag")&&(o=o+e+"='"+t+"';");!0===n?!0===d?y=y+a.convertDateForGridOutput(t)+"|":s?y=y+t.key+"|":r?y=y+t.value+"|":y+=t+"|":"syshidden"===e&&(y+="syshidden|")}),o&&(y=y+"{{"+o+"}}"),f=f+y+"\r\n"}),n=f,""===n&&(n="false");break;case"GetAllChangedGridRows":var f="",y="",b=o.data("sysprogridchangedrows");b&&($.each(b,function(){var e=l.dataSource.at(this),t=this+1;y=t+"|";var o=null;$.each(e,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var n=!1,d=!1,s=!1,r=!1,c=0;c<l.columns.length;c++)if(l.columns[c].field===e){if(n=!0,"date"===l.columns[c].type){d=!0;break}if(l.columns[c].isCombbox){s=!0;break}if("combo"===l.columns[c].type||"radio"===l.columns[c].type){r=!0;break}}}else 0<e.indexOf("systag")&&(o=o+e+"='"+t+"';");!0===n?!0===d?y=y+a.convertDateForGridOutput(t)+"|":s?y=y+t.key+"|":r?y=y+t.value+"|":y+=t+"|":"syshidden"===e&&(y+="syshidden|")}),o&&(y=y+"{{"+o+"}}"),f=f+y+"\r\n"}),n=f),""===n&&(n="false");break;case"GetAllVisibleGridRows":var f="",y="",v=l.dataSource,w=v.filter(),C=v.data(),x=new kendo.data.Query(C),S=x.filter(w).data;$.each(S,function(e){var t=S[e];y=+e+1+"|";var o=null;$.each(t,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var n=!1,d=!1,s=!1,r=!1,c=0;c<l.columns.length;c++)if(l.columns[c].field===e){if(n=!0,"date"===l.columns[c].type){d=!0;break}if(l.columns[c].isCombbox){s=!0;break}if("combo"===l.columns[c].type||"radio"===l.columns[c].type){r=!0;break}}}else 0<e.indexOf("systag")&&(o=o+e+"='"+t+"';");!0===n?!0===d?y=y+a.convertDateForGridOutput(t)+"|":s?y+=t.key+"|":r?y+=t.value+"|":y+=t+"|":"syshidden"===e&&(y+="syshidden|")}),o&&(y+="{{"+o+"}}"),f=f+y+"\r\n"}),n=f,""===n&&(n="false");break;case"UpdateGridRow":var T=JSON.parse(e.InternalEventParameter),g=T.updateinfo.row;--g;var W=!1;$.each(o,function(){var e=$(this);l=e.data("kendoGrid"),l.closeCell();var t=l.dataSource.data()[g],a=e.data("sysprocommentrows");a||(a={ms:[]});var o=!1;if(t){$.each(T.lv.r,function(n,d){if(d.key&&d.val)(t[n].key!==d.key||t[n].value!==d.val)&&(t[n].key=d.key,t[n].value=d.val,t[n].val=d.val,W=!0);else{if("commentCell"==n){var s={row:"{0}",col:"{1}"};s.row=g+1+"",s.col=d,a.ms.push(s),o=!0,W=!0}else for(var r=!1,c=0;c<l.columns.length;c++)if(l.columns[c].field===n&&"date"===l.columns[c].type){r=!0;break}if(!0===r){var p=kendo.parseDate(d,e.data("dateformatin"));d=p}t[n]!==d&&(t[n]=d,W=!0)}}),o&&e.data("sysprocommentrows",a),W&&l.refresh();var n=e.data("sysproinitialaggregates");n&&l.dataSource.fetch()}if(!0==e.data("sysprohashiddenrows")&&(g=l.dataSource.indexOf(t)),l.select("tr:eq("+g+")"),""!==e.data("sysprolastcellcloseselector")){var d=e.data("sysprolastcellcloseselector").split("|");l.editCell(l.tbody.find("tr:eq("+d[0]+") td:eq("+d[1]+")")),e.data("sysprolastcellcloseselector","")}var s=e.data("sysprogridchangedrows");0<=g&&-1===s.indexOf(g)&&(s.push(g),e.data("sysprogridchangedrows",s))});break;case"BeginEditAt":s=e.InternalEventParameter.split("|"),$.each(o,function(){var e=s[0]-1,t=s[1],a=$(this);if(l=a.data("kendoGrid"),l.select("tr:eq("+e+")"),!0==a.data("sysprohashiddenrows")&&0>e){var o=l.dataItem(l.select());e=l.dataSource.indexOf(o)}for(var n=l.getOptions().columns,d=0;d<n.length;d++)if(n[d].field==t){O=d;break}setTimeout(function(){l.editCell(l.tbody.find("tr:eq("+e+") td:eq("+O+")"))})});break;case"DeleteCurrentRow":var r=l.dataItem(l.select());if(r){var y=l.select().index()+1+"";y+="|";var c=r.toJSON(),p=null;$.each(c,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var o=!1,n=!1,d=!1,s=0;s<l.columns.length;s++){if(l.columns[s].field===e&&"date"===l.columns[s].type){o=!0;break}if(l.columns[s].field===e&&l.columns[s].isCombbox){n=!0;break}if(l.columns[s].field===e&&("combo"===l.columns[s].type||"radio"===l.columns[s].type)){d=!0;break}}o?y=y+a.convertDateForGridOutput(t)+"|":n?y=y+t.key+"|":d?y=y+t.value+"|":y+=t+"|"}else 0<e.indexOf("systag")&&(p=p+e+"='"+t+"';")}),p&&(y+="{{"+p+"}}"),n=y,l.dataSource.remove(r)}break;case"HideRowAt":var g=e.InternalEventParameter;--g,$.each(o,function(){var e=$(this),t=e.data("kendoGrid"),a=e.data("sysprohashiddenrows");e.data("sysprohashiddenrows",!0);var o=t.dataSource.at(g);o&&(o.syshidden=!0);var n={logic:"and",filters:[]};n.filters.push({field:"syshidden",operator:"neq",value:!0}),t.dataSource.filter(n);var d=e.data("sysprogridchangedrows");0<=g&&-1===d.indexOf(g)&&(d.push(g),e.data("sysprogridchangedrows",d))});break;case"HideCurrentRow":$.each(o,function(){var e=$(this),t=e.data("kendoGrid"),a=e.data("sysprohashiddenrows");e.data("sysprohashiddenrows",!0);var o=t.dataItem(t.select()),n=t.select().index();o&&(o.syshidden=!0);var d={logic:"and",filters:[]};d.filters.push({field:"syshidden",operator:"neq",value:!0}),t.dataSource.filter(d);var s=e.data("sysprogridchangedrows");0<=n&&-1===s.indexOf(n)&&(s.push(n),e.data("sysprogridchangedrows",s))});break;case"DeleteRowAt":var g=e.InternalEventParameter;n=g+"|",--g;var r=l.dataSource.at(g);if(r){var c=r.toJSON(),p=null;$.each(c,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){for(var o=!1,d=!1,s=!1,r=0;r<l.columns.length;r++){if(l.columns[r].field===e&&"date"===l.columns[r].type){o=!0;break}if(l.columns[r].field===e&&l.columns[r].isCombbox){d=!0;break}if(l.columns[r].field===e&&("combo"===l.columns[r].type||"radio"===l.columns[r].type)){s=!0;break}}o?n=n+a.convertDateForGridOutput(t)+"|":d?n=n+t.key+"|":s?n=n+t.value+"|":n+=t+"|"}else 0<e.indexOf("systag")&&(p=p+e+"='"+t+"';")}),p&&(n+="{{"+p+"}}"),l.dataSource.remove(r)}break;case"SelectRowAt":var g=e.InternalEventParameter;--g,$.each(o,function(){var e=$(this);if(e){e.data("sysproscrolltoselection",!0);var t=e.data("kendoGrid");t&&t.select("tr:not(.k-grouping-row):eq("+g+")")}});break;case"DisableEntryGrid":$.each(o,function(){var e=$(this);e.data("sysproentrygriddisabled",!0),e.closest(".panel-body")[0]&&e.closest(".panel-body")[0].className&&(e.closest(".panel-body")[0].className="panel-body widget-sysprodisabled")});break;case"EnableEntryGrid":$.each(o,function(){var e=$(this);e.data("sysproentrygriddisabled",!1),e.closest(".panel-body")[0]&&e.closest(".panel-body")[0].className&&(e.closest(".panel-body")[0].className="panel-body")});break;case"ApplyComboBox":var D=JSON.parse(e.InternalEventParameter),I=l.select();if(0<D.lv.cbos.cbo.length&&($.each(o,function(){var e=$(this),t=e.data("kendoGrid"),o=e.data("sysprocomboboxes");if(t){var n=t.getOptions();if(n){for(var d=0;d<D.lv.cbos.cbo.length;d++){var s=D.lv.cbos.cbo[d].col,l=D.lv.cbos.cbo[d].values;for(o[s]=l,R=0;R<n.columns.length;R++)if(n.columns[R].field===s){n.columns[R].editor=a.sysproDropDownEditor,n.columns[R].template="#="+s+".val #",n.columns[R].isCombbox=!0;break}}e.data("sysprocomboboxes",o),t.setOptions({columns:n.columns})}}a.applyCheckBoxContentChangeEvent(e),a.addCommentMessageToGrid(t,e),"bottom"===t.options.editable.createAt&&(e.closest(".noBorderTable").find("table").off("keydown"),e.closest(".noBorderTable").find("table").on("keydown",a.gridEditableKeyDown))}),"bottom"===l.options.editable.createAt&&I)){var O=$(".editable-cell",I[0]).index();0<=O&&(I.data("sysignorerowselectedevent",!0),l.select(I),0<=I.index()&&(l.editCell(l.tbody.find("tr:eq("+I.index()+") td:eq("+O+")")),l.select("tr:eq("+I.index()+")")))}break;case"ShowGridCellMessage":var _=JSON.parse(e.InternalEventParameter);0<_.lv.mss.ms.length&&$.each(o,function(){var e=$(this);$(".gridlist-cell-note",e).remove();var t=e.data("kendoGrid");if(t){var a=t.content.scrollTop();e.data("sysproscrolltoselectionvalue",a);for(var o=0;o<_.lv.mss.ms.length;o++){var n=_.lv.mss.ms[o],d=n.row-1,s=n.col,l=n.val,r=n.sysDisabled,c=!1,p=!0,u=!1,m=!1,g;for(R=0;R<t.columns.length;R++)if(t.columns[R].field===s){"boolean"===t.columns[R].type&&(c=!0),"number"===t.columns[R].type&&(u=!0),"combo"===t.columns[R].type&&(m=!0),!1===t.columns[R].editable&&(p=!1);break}if(l){var h=t.dataSource.data()[d];if(h)if(l.key&&l.val)h[s].key=l.key,h[s].value=l.val,h[s].val=l.val,!0===m&&(h[s].value=l.key,h[s].val=l.key),m=!0;else{g="true"===l||"false"!==l&&l,!1==p?!0==u?h[s]=kendo.parseFloat(g.trim()):h[s]=g:h.set(s,g),h.dirtyFields={},h.dirty=!1,!0===c&&"incell"===t.options.editable.mode&&(h[s]=g);var f=e.data("sysprogridchangedrows");0<=d&&-1===f.indexOf(d)&&(f.push(d),e.data("sysprogridchangedrows",f))}}if(r){var y;if(y=t.dataSource.data()[d],y){var b=y.colDisabled;if(b&&"undefined"!==b||(y.colDisabled=""),b=y.colDisabled,"|"!==b[b.length-1]&&(b+="|"),b.includes(s)&&(b=b.replace(s+"|","")),"true"===r&&("|"===b.slice(-1)?b+=s:b+="|"+s),!1==s.includes("sysdisabled")&&(s+="sysdisabled"),b&&""!==s)if(!1==s.includes("sysdisabled")){var v=s+"|";b.includes(v)&&(b=b.replace(v,"")),"true"===r&&("|"===b.slice(-1)?b+=v:b+="|"+v)}else(!0===c||!0===m)&&("true"===r?y[s]=!0:y[s]=!1);y.colDisabled=b}}var w=t.dataSource.data()[0]}t.refresh(),e.data("sysproscrolltoselection",!0),$(".gridlist-cell-note",e.closest(".noBorderTable")).popover("destroy"),$(".gridlist-cell-note",e.closest(".noBorderTable")).remove();for(var o=0;o<_.lv.mss.ms.length;o++){var n=_.lv.mss.ms[o],d=n.row-1,s=n.col,v="0",C=n.msg,c=!1,g;for(R=0;R<t.columns.length;R++)if(t.columns[R].field===s){v=R+"","boolean"===t.columns[R].type&&(c=!0);break}var w=t.dataSource.data()[d];if(w){var k=t.table.find("tr[data-uid='"+w.uid+"']"),x=k.find("td:eq("+v+")");if(C)if(""===C||"undefined"===C)x[0]&&x[0].remove("span.gridlist-cell-note");else{x.append("<a href=\"#\" class=\"gridlist-cell-note\" tabindex=\"0\" data-container=\"body\" data-toggle=\"popover\" data-placement=\"bottom\" data-content=\""+C+"\" data-trigger=\"focus\" data-original-title=\"\" title=\"\"></a>")}}}$(".gridlist-cell-note",e.closest(".noBorderTable")).popover()}});break;case"UpdateRowsByIndex":var T=JSON.parse(e.InternalEventParameter);$.each(o,function(){var e=$(this),t=e.data("kendoGrid"),a=t.dataSource.data(),o=T.updateinfo.col;if(o){for(var n=0,d;n<T.lv.r.length;n++)if(d=T.lv.r[n],d){var s=d.value,l=$.grep(a,function(e){return e[o]===s});if(l&&0<l.length){var r=t.dataSource.getByUid(l[0].uid);$.each(d,function(e,t){"value"!==e&&(r[e]=t)})}}t.refresh()}});break;case"FindRow":n="false",s=e.InternalEventParameter.split("|");var P=s[0],E=s[1],F=l.dataSource.data();"true"===E?E=!0:"false"===E&&(E=!1);var A=$.grep(F,function(e){return e[P]===E});if(A&&0<A.length){var d=l.dataSource.getByUid(A[0].uid),N=l.tbody.find("tr[data-uid='"+d.uid+"']");if(N){var g=N[0].rowIndex;g++,n=g}}break;case"FindAndSelect":n="false",s=e.InternalEventParameter.split("|");var P=s[0],E=s[1],F=l.dataSource.data(),A=$.grep(F,function(e){return e[P]===E});if(A&&0<A.length){var r=l.dataSource.getByUid(A[0].uid),N=l.tbody.find("tr[data-uid='"+r.uid+"']");if(N&&0<N.length&&N[0]){var g=N[0].rowIndex;$.each(o,function(){var e=$(this),t=e.data("kendoGrid");e.data("sysproscrolltoselection",!0),t.select("tr:not(.k-grouping-row):eq("+g+")")}),g++,n=g+"|";var c=r.toJSON(),p=null;$.each(c,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){var o=!1,d=!1,s=!1;for(q=0;q<l.columns.length;q++){if(l.columns[q].field===e&&"date"===l.columns[q].type){o=!0;break}if(l.columns[q].field===e&&l.columns[q].isCombbox){d=!0;break}if(l.columns[q].field===e&&("combo"===l.columns[q].type||"radio"===l.columns[q].type)){s=!0;break}}o?n=n+a.convertDateForGridOutput(t)+"|":d?n=n+t.key+"|":s?n=n+t.value+"|":n+=t+"|"}else 0<e.indexOf("systag")&&(p=p+e+"='"+t+"';")}),p&&(n+="{{"+p+"}}")}}break;case"FindAndDelete":n="false",s=e.InternalEventParameter.split("|");var P=s[0],E=s[1];"true"===E?E=!0:"false"===E&&(E=!1);var F=l.dataSource.data(),A=$.grep(F,function(e){return e[P]===E});if(A&&0<A.length){n="true";for(var M=0,r;M<A.length;M++)r=l.dataSource.getByUid(A[M].uid),l.dataSource.remove(r)}break;case"DisableGridCells":s=e.InternalEventParameter.split("|"),$.each(o,function(){var e=$(this),t=e.data("kendoGrid"),a=s[0],o=+s[1];--o;var n=t.dataSource.data()[o];if(n){var d=n.colDisabled;d&&"undefined"!==d||(n.colDisabled=""),d=n.colDisabled,"|"!==d[d.length-1]&&(d+="|");var l=!1;if(d){for(var r=2;r<s.length;r++)if(""!==s[r])if(!1==s[r].includes("sysdisabled")){var c=s[r]+"|";d.includes(c)&&(d=d.replace(c,"")),"true"===a&&("|"===d.slice(-1)?d+=c:d=d+"|"+c)}else{var p=s[r];l=!0,n[p]="true"===a}n.colDisabled=d,l&&t.refresh()}}});break;case"DisableCellHyperlink":s=e.InternalEventParameter.split("|"),$.each(o,function(){var e=$(this);if(l=e.data("kendoGrid"),l){var t=s[0]-1,o=l.dataSource.data()[t],n=l.table.find("tr[data-uid='"+o.uid+"']"),d=0;d=parseInt(s[1]),d--;var r=e.data("sysprohascommandcolumn");!0===r&&++d;var c=l.columns[d].field,p=l.columns[d].template,u=n.find("td:eq("+d+")");if(!p&&s[3]){var m=l.select().index(),g=$(".k-edit-cell",e),h=-1;g&&g[0]&&(h=g[0].cellIndex);var f=l.getOptions();f.columns[d].template="<div class=\"syspro-grid-row-hyperlink\" data-eventnum=\""+c+"|"+s[3]+"\">"+("#="+c+"#")+"</div>",l.setOptions(f),a.applyCheckBoxContentChangeEvent(e),"bottom"===l.options.editable.createAt&&(e.closest(".noBorderTable").find("table").off("keydown"),e.closest(".noBorderTable").find("table").on("keydown",a.gridEditableKeyDown)),l.select("tr:eq("+m+")"),0<=h&&setTimeout(function(){l.editCell(l.tbody.find("tr:eq("+m+") td:eq("+h+")"))})}var u=n.find("td:eq("+d+")");u[0]&&u[0].childNodes[0]&&("true"===s[2]?u[0].childNodes[0].className&&"syspro-grid-row-hyperlink"===u[0].childNodes[0].className&&(u[0].childNodes[0].className=""):u[0].childNodes[0].className="syspro-grid-row-hyperlink")}});break;case"CheckAllCheckBoxes":s=e.InternalEventParameter.split("|"),$.each(o,function(){var e=$(this),t=s[0]+"sysdisabled";if(l=e.data("kendoGrid"),l){var a=!0;"false"===s[1]&&(a=!1);for(var o=l.dataSource.data(),n=!0,d=0,r;d<o.length;d++)r=o[d],r[t]?n=!1:r[s[0]]=a;l.refresh()}if(n){var c=$("input[data-columnname='"+s[0]+"']",e.closest(".noBorderTable"));c&&c[0]&&(c[0].checked=a)}});break;case"SetColumnBlank":$.each(o,function(){var t=$(this);if(l=t.data("kendoGrid"),l){for(var a=l.dataSource.data(),o=0,n;o<a.length;o++)n=a[o],n[e.InternalEventParameter]="";l.refresh()}});break;case"SetFooter":var L=e.InternalEventParameter.split(";");if(l){for(var B=l.getOptions(),R=0;R<L.length;R++){var V=L[R].split("|"),H=V[0],U=V[1];if(B)for(var q=0;q<B.columns.length;q++)if(B.columns[q].field===H){B.columns[q].footerTemplate=U;break}$.each(o,function(){var e=$(this),t=e.data("sysprogroupfooters");t[H]=U,e.data("sysprogroupfooters",t)})}l.setOptions(B)}break;case"GetFooter":var H=e.InternalEventParameter;n="false",$.each(o,function(){var e=$(this),t=e.data("sysprogroupfooters"),a=t[H];a&&(n=a)});break;case"GetAutoFooterValue":s=e.InternalEventParameter.split("|");var H=s[0],G=s[1],z=s[2];l&&("sum"===G?n=kendo.toString(l.dataSource.aggregates()[H].sum,z):"count"===G?n=kendo.toString(l.dataSource.aggregates()[H].count,z):n="");break;case"SumColumn":for(var Y=e.InternalEventParameter,F=l.dataSource.data(),K=0,q=0;q<F.length;q++)K+=F[q][Y];n=K+"";break;case"GetAllMatchedRows":var y="false";n="false",$.each(o,function(){var t=$(this);l=t.data("kendoGrid"),s=e.InternalEventParameter.split("|");var o=s[0],n=s[1];"true"===n&&(n=!0),"false"===n&&(n=!1);var r="",c="",p=l.dataSource.data(),u;if(2<s.length?(r=s[2],c=s[3],u=$.grep(p,function(e){return e[o]===n&&e[r]===c})):u=$.grep(p,function(e){return e[o]===n}),u&&0<u.length){y="";for(var m=0;m<u.length;m++){var d=l.dataSource.getByUid(u[m].uid),g=l.tbody.find("tr[data-uid='"+d.uid+"']");if(g){var h=g[0].rowIndex;h++,y=y+h+"|";var f=d.toJSON(),b=null;$.each(f,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("systag")&&-1===e.indexOf("sysdec")){var o=!1,n=!1,d=!1,s=!1;for(q=0;q<l.columns.length;q++){if(l.columns[q].field===e){"date"===l.columns[q].type&&(o=!0),s=!0;break}if(l.columns[q].field===e&&l.columns[q].isCombbox){n=!0,s=!0;break}if(l.columns[q].field===e&&("combo"===l.columns[q].type||"radio"===l.columns[q].type)){d=!0,s=!0;break}}s?o?y=y+a.convertDateForGridOutput(t)+"|":n?y+=t.key+"|":d?y+=t.value+"|":y+=t+"|":0<e.indexOf("systag")&&(b=b+e+"='"+t+"';")}}),b&&(y+="{{"+b+"}}"),y+="\r\n"}}}}),n=y;break;case"CheckForCellDuplicates":n="false",s=e.InternalEventParameter.split("|");var P=s[0],E=s[1],F=l.dataSource.data(),A;A=$.grep(F,function(e){return e[P]===E}),A&&1<A.length&&(n="true");break;case"GetSettings":var B=l.getOptions(),J={};J.columns=B.columns,J.group=B.dataSource.group,J.sort=B.dataSource.sort,n=JSON.stringify(J);break;case"SetSettings":var Q=JSON.parse(e.InternalEventParameter);if(Q){for(var B=l.getOptions(),q=0,X,Z,ee,te,ae;q<B.columns.length;q++)if(B.columns[q].command){if(0<B.columns[q].command.length)for(var R=0;R<B.columns[q].command.length;R++)0==R&&(X=B.columns[q].command[R].click,B.columns[q].command[R].visible&&(ae=B.columns[q].command[R].visible)),1==R&&(Z=B.columns[q].command[R].click),2==R&&(ee=B.columns[q].command[R].click),3==R&&(te=B.columns[q].command[R].click);break}B.dataSource.columns=Q.columns,B.dataSource.group=Q.group,B.dataSource.sort=Q.sort,B.columns=Q.columns;for(var q=0;q<B.columns.length;q++)if(B.columns[q].command){if(0<B.columns[q].command.length)for(var R=0;R<B.columns[q].command.length;R++)0==R&&(B.columns[q].command[R].click=X,ae&&(B.columns[q].command[R].visible=ae)),1==R&&(B.columns[q].command[R].click=Z),2==R&&(B.columns[q].command[R].click=ee),3==R&&(B.columns[q].command[R].click=te);break}l.setOptions(B)}break;case"HideColumns":$.each(o,function(){var t=$(this);if(l=t.data("kendoGrid"),s=e.InternalEventParameter.split("|"),l)if("true"===s[0])for(var a=1;a<s.length;a++)l.hideColumn(s[a]);else for(var a=1;a<s.length;a++)l.showColumn(s[a])});break;case"GetGridLayoutsChanged":var oe=e.InternalEventParameter,ie=$(".syspro-grid-list");$.each(ie,function(){var e=$(this);if(e&&e[0]&&e[0].attributes["data-sysprogridfieldname"]){var t=e[0].attributes["data-sysprogridfieldname"].value;0===t.indexOf(oe)&&e.data("sysprosettingschanged")&&(n=n+t+",")}}),n||(n="false");break;case"ExcelExport":l&&l.saveAsExcel();break;case"PDFExport":l&&l.saveAsPDF();break;case"ExpandAll":l&&l.table.find(".k-grouping-row").each(function(){l.expandGroup(this)});break;case"CollapseAll":l&&l.table.find(".k-grouping-row").each(function(){l.collapseGroup(this)});}}return n}catch(e){this.interopInternal.handleError(e,"gridRequestInternalEvent")}},AvantiGridsClass.prototype.applyColumnTemplate=function(e,t){var a=t.split("|"),o=0;for(o=0;o<a.length;o++)if(a[o]){var n="%"+o+"%";e=e.replace(new RegExp(n,"g"),a[o])}return e},AvantiGridsClass.prototype.sysproDropDownEditor=function(e,t){var a=$(e).closest(".syspro-grid-list"),o=a.data("sysprocomboboxes");$("<input required name=\""+t.field+"\"/>").appendTo(e).kendoDropDownList({dataSource:o[t.field],dataValueField:"key",dataTextField:"val"})},AvantiGridsClass.prototype.createTreeList=function(e){try{var t=this.interopInternal,a=this,o=$("*[data-sysprotreefieldname=\""+e.FieldName+"\"]");$.each(o,function(){var t=$(this);t.data("kendoTreeList")&&(t.data("kendoTreeList").destroy(),t.empty());var a=JSON.parse(e.GridData).tl;if(t.data("sysprotreeheight")){var o=t.data("sysprotreeheight");a.prop.height=o}t.data("sysproentrygriddisabled",!1),t.data("sysprotreelistinfo",a);var n=!1;if(0<t.length){!0===a.prop.editable&&(n=!0,0<a.cs.c.length&&(!a.cs.c[0].command||1!==a.cs.c[0].command.length)&&(a.cs.c.unshift({title:" ",command:[{name:"edit"}],width:100}),a.cs.c[1].expandable=!0));var d="";if(a.tbs&&a.tbs.tb){var s=kendo.template($("#gridToolbarTemplate").html()),l=a.tbs.tb;$.each(l,function(){d+=s(this)})}t.kendoTreeList({dataSource:{data:[]},height:a.prop.height,sortable:a.prop.sortable,filterable:a.prop.filterable,groupable:a.prop.groupable,columnMenu:a.prop.columnMenu,resizable:!0,reorderable:!0,selectable:!0,navigatable:!0,editable:n,toolbar:d,messages:{noRows:a.prop.sysprotranNoItemText},columns:a.cs.c,edit:function edit(){$(".k-grid-update",t).contents().filter(function(){return 3==this.nodeType}).remove(),$(".k-grid-cancel",t).contents().filter(function(){return 3==this.nodeType}).remove()}})}})}catch(e){this.interopInternal.handleError(e.message,"createTreeList")}},AvantiGridsClass.prototype.refreshTreeList=function(e){try{var t=this.interopInternal,a=this,o=null;e.FromRequestInternal||(o=JSON.parse(e.GridData).tl);var n=$("*[data-sysprotreefieldname=\""+e.FieldName+"\"]");$.each(n,function(){var n=$(this),d=n.data("sysprotreelistinfo"),s=n.data("sysproentrygriddisabled"),l={},r=[],c;n.data("kendoTreeList")&&(e.FromRequestInternal&&(c=n.data("kendoTreeList").dataSource,o=n.data("sysprohyperlinks")),n.data("kendoTreeList").destroy(),n.empty(),n.data("sysproentrygriddisabled",s));if(d){var p="#= !data.{0} ? '' : kendo.toString(data.{1},'"+d.prop.sysproDateFormatOut+"') #",u="<div><span class='k-icon {0}'/></div>";for(O=0;O<d.cs.c.length;O++){if("date"===d.cs.c[O].type){d.cs.c[O].template=p.replace("{1}",d.cs.c[O].field),d.cs.c[O].template=d.cs.c[O].template.replace("{0}",d.cs.c[O].field),d.cs.c[O].template=d.cs.c[O].template.replace("{2}",d.cs.c[O].field),d.cs.c[O].format="{0:"+d.prop.sysproDateFormatOut+"}",r.push(d.cs.c[O].field);var m=d.cs.c[O].template;d.cs.c[O].template="<span style='background-color: #=data."+d.cs.c[O].field+"sysbgcolor#; color: #=data."+d.cs.c[O].field+"syscolor#; '>"+m+"</span>"}else if("boolean"===d.cs.c[O].type)d.cs.c[O].template="<input class='sysEditTreeCheckBox' type='checkbox' # if({0}){ # checked #} # # if (((typeof {1}sysdisabled !== 'undefined')) && {2}sysdisabled){# disabled #} # # if (((typeof {3}sysVisible !== 'undefined')) && {4}sysVisible === false){# style='display:none;' #} #  />".replace("{0}",d.cs.c[O].field),d.cs.c[O].template=d.cs.c[O].template.replace("{1}",d.cs.c[O].field),d.cs.c[O].template=d.cs.c[O].template.replace("{2}",d.cs.c[O].field),d.cs.c[O].template=d.cs.c[O].template.replace("{3}",d.cs.c[O].field),d.cs.c[O].template=d.cs.c[O].template.replace("{4}",d.cs.c[O].field),d.cs.c[O].showInCheckBoxHeader&&!0===d.cs.c[O].showInCheckBoxHeader&&(d.cs.c[O].headerTemplate="<input type='checkbox' data-columnname='{0}' class='header-checkbox'></input><label style='margin-bottom: 0px;font-weight: normal; for='header-chb'>{1}</label>".replace("{0}",d.cs.c[O].field),d.cs.c[O].headerTemplate=d.cs.c[O].headerTemplate.replace("{1}",d.cs.c[O].title));else if("number"===d.cs.c[O].type){d.cs.c[O].template="#= (kendo.toString(data.{0}, 'n' + (data.{1}sysdec==null?'':data.{2}sysdec))) #".replace("{0}",d.cs.c[O].field),d.cs.c[O].template=d.cs.c[O].template.replace("{1}",d.cs.c[O].field),d.cs.c[O].template=d.cs.c[O].template.replace("{2}",d.cs.c[O].field);var g=d.cs.c[O].template;d.cs.c[O].template="<span style='background-color: #=data."+d.cs.c[O].field+"sysbgcolor#; color: #=data."+d.cs.c[O].field+"syscolor#; '>"+g+"</span>"}else d.cs.c[O].template="<span style='background-color: #=data."+d.cs.c[O].field+"sysbgcolor#; color: #=data."+d.cs.c[O].field+"syscolor#; '>#=data."+d.cs.c[O].field+"#</span>";d.prop.editable&&(d.cs.c[O].editable||"false"===d.cs.c[O].editable||!1===d.cs.c[O].editable||"boolean"===d.cs.c[O].type?l[d.cs.c[O].field]={editable:!1}:(d.cs.c[O].attributes={class:"editable-cell"},"date"===d.cs.c[O].type?l[d.cs.c[O].field]={editable:!0,type:"date"}:(l[d.cs.c[O].field]={editable:!0},d.cs.c[O].search&&(d.cs.c[O].editor=function(e,a){var o=$(e).closest(".syspro-tree-list"),n=o.data("kendoTreeList"),d="grid:"+o.data("sysprotreefieldname"),s=$(e).closest("tr").index();d=d+":"+s+":"+a.field+":"+e[0].cellIndex;var l=$("<input type=\"text\" class=\"k-input k-textbox\" style=\"width: 80%\" name=\""+a.field+"\" />");l.appendTo(e);var r="";for(O=0;O<n.columns.length;O++)if(n.columns[O].field===a.field){r=n.columns[O].search;break}var c=$("<a class=\"syspro-browse-button\" href=\"#\" data-fieldname=\""+d+"\" data-fieldvalue=\"\" data-predictivesearchfield=\""+r+"\"  style=\"color: white\"><i class=\"material-icons\">search</i></a>");c.appendTo(e),"manual"!==r&&t.initializePredictiveSearch(l,r),t.subscribeToFieldEvents()}))),d.cs.c[O].image&&(d.cs.c[O].headerTemplate=u,d.cs.c[O].headerTemplate=u.replace("{0}",d.cs.c[O].image)))}if(o&&o.cls&&o.cls.cl){for(O=0;O<o.cls.cl.length;O++)for(var h=o.cls.cl[O].col,f=o.cls.cl[O].event,y=0;y<d.cs.c.length;y++)if(h===d.cs.c[y].field){if("boolean"===d.cs.c[y].type||"date"===d.cs.c[y].type)break;var b="#="+h+"#";d.cs.c[y].template&&0>d.cs.c[y].template.indexOf("syspro-grid-row-hyperlink")&&(b=d.cs.c[y].template),d.cs.c[y].template="<span class=\"syspro-grid-row-hyperlink\" data-eventnum=\""+d.cs.c[y].field+"|"+f+"\">"+b+"</span>";break}n.data("sysprohyperlinks",o)}}var v=[];if(d.aggregate&&(v=d.aggregate),!e.FromRequestInternal)if(!0==e.IsAppend){var w=tree.dataSource.data().toJSON(),C=w.concat(o.rs.r);c=new kendo.data.TreeListDataSource({data:C,aggregate:v,schema:{parse:function parse(e){return $.each(e,function(e,t){$.each(r,function(){t&&t[this]&&(t[this]=kendo.parseDate(t[this],d.prop.sysproDateFormatIn))})}),e},model:{fields:l}}})}else{c=new kendo.data.TreeListDataSource({data:o.rs.r,aggregate:v,schema:{parse:function parse(e){return $.each(e,function(e,t){$.each(r,function(){try{t&&t[this]&&(t[this]=kendo.parseDate(t[this],d.prop.sysproDateFormatIn))}catch(e){}})}),e},model:{fields:l}}});n.data("sysprogridchangedrows",[]),n.data("sysprogriddates",r)}var k=!1;if(0<n.length){!0===d.prop.editable&&(k=!0,0<d.cs.c.length&&(!d.cs.c[0].command||1!==d.cs.c[0].command.length)&&(d.cs.c.unshift({title:" ",command:[{name:"edit",text:{edit:" ",update:" ",cancel:" "}}],width:150}),d.cs.c[1].expandable=!0));var x="";if(d.tbs&&d.tbs.tb){var S=kendo.template($("#gridToolbarTemplate").html()),T=d.tbs.tb;$.each(T,function(){x+=S(this)})}var W=!0;W=!0!==s,n.kendoTreeList({dataSource:c,height:d.prop.height,sortable:d.prop.sortable,filterable:d.prop.filterable,groupable:d.prop.groupable,columnMenu:d.prop.columnMenu,resizable:!0,reorderable:!0,selectable:W,navigatable:!0,editable:k,messages:{noRows:d.prop.sysprotranNoItemText},toolbar:x,columns:d.cs.c,edit:function edit(){$(".k-grid-update",n).css("min-width","10px"),$(".k-grid-cancel",n).css("min-width","10px"),$(".k-grid-update",n).contents().filter(function(){return 3==this.nodeType}).remove(),$(".k-grid-cancel",n).contents().filter(function(){return 3==this.nodeType}).remove()},save:function save(o){if(!0===o.model.dirty){var e=n.data("kendoTreeList"),d=n.data("sysprotreefieldname"),s=n.data("kendoTreeList").select();if(s){var l=e.dataSource.getByUid(o.model.uid),r=e.dataSource.indexOf(l),c=r+1,p="";$.each(o.model.dirtyFields,function(e){return p=e,!1});var u=!1;c==e.dataSource.total()&&(u=!0);var m=c+"|"+u+"|"+p+"|"+_[p]+"|";if(null!==l){var g=l.toJSON();$.each(g,function(t,o){if(-1===t.indexOf("syscolor")&&-1===t.indexOf("sysbgcolor")&&-1===t.indexOf("sysdisabled")&&-1===t.indexOf("sysexpanded")&&-1===t.indexOf("sysdec")){for(var n=!1,d=!1,s=0;s<e.columns.length;s++){if(e.columns[s].field===t&&"date"===e.columns[s].type){n=!0;break}if(e.columns[s].field===t&&e.columns[s].isCombbox){d=!0;break}}m=n?m+a.convertDateForGridOutput(o)+"|":d?m+o.key+"|":m+o+"|"}})}var h=n.data("sysprogridchangedrows");--c,0<=c&&-1===h.indexOf(c)&&(h.push(c),n.data("sysprogridchangedrows",h)),t.eventTrigged(d,m,"","","gridCellChanged",function(){},!1)}}},dataBound:function dataBound(){$(".k-grid-edit",n).css("min-width","10px"),$(".k-grid-edit",n).contents().filter(function(){return 3==this.nodeType}).remove(),$(".syspro-grid-row-hyperlink",n).off("click"),$(".syspro-grid-row-hyperlink",n).on("click",function(t){!1===n.data("sysproentrygriddisabled")&&a.sysTreeListCellClick(t.target)}),$(".k-grid-edit",n).each(function(){$(this).closest("tr").hasClass("k-treelist-group")&&$(this).hide()}),$(".gridSearchTextBox",n).off("input"),$(".gridSearchTextBox",n).on("input",function(t){var e=n.data("kendoTreeList"),o=e.columns,d=t.target.value;if(d=d.trim(),""===d)e.dataSource.filter([]);else{var s=[{logic:"or",filters:[]}];o.forEach(function(e){if(e.field){var o=e.type;if(!e.isCombbox)if(o||(o="string"),"string"===o)s[0].filters.push({field:e.field,operator:"contains",value:t.target.value});else if("number"==o)a.isNumeric(t.target.value)&&s[0].filters.push({field:e.field,operator:"eq",value:t.target.value});else if("date"==o)for(var n=grid.dataSource.data(),d=0,l;d<n.length;d++)l=kendo.format(e.format,n[d][e.field]),0===l.indexOf(t.target.value)&&s[0].filters.push({field:e.field,operator:"eq",value:n[d][e.field]});else if("boolean"==o&&null!==a.getBoolean(t.target.value)){var r=a.getBoolean(t.target.value);s[0].filters.push({field:e.field,operator:"eq",value:r})}}}),e.dataSource.filter(s)}}),$(".gridLabelTextBox",n).off("keydown"),$(".gridLabelTextBox",n).on("keydown",function(a){if(9===a.keyCode||13===a.keyCode){var e=a.currentTarget.getAttribute("data-gridbuttoneventid"),o=a.target.value;t.eventTrigged(o,e,"","","gridToolBarTextChanged",function(){},function(){})}}),$(".gridButton",n).off("click"),$(".gridButton",n).on("click",function(o){var n=o.currentTarget.getAttribute("data-gridbuttoneventid");if(n){var d={FieldName:e.FieldName,InternalEventParameter:"{}"};switch(n){case"":break;case"excelexport":d.InternalEvent="ExcelExport",a.treeRequestInternalEvent(d);break;case"pdfexport":d.InternalEvent="PDFExport",a.treeRequestInternalEvent(d);break;case"expandall":d.InternalEvent="ExpandAll",a.treeRequestInternalEvent(d);break;case"collapseall":d.InternalEvent="CollapseAll",a.treeRequestInternalEvent(d);break;default:t.eventTrigged(e.FieldName,n,"","","gridButtonClicked",function(){},function(){});}}}),queryLayoutUIHelpers.initializeTooltips(),n.data("kendoTreeList").tbody.find("tr").each(function(){kendo.bind(this,n.data("kendoTreeList").dataItem(this))}),n.find(".k-grid-content > table").addClass("table-hover table-striped table-condensed table-noborder")}})}var D=n.data("kendoTreeList");!0===d.prop.sysproRowSelection&&D.bind("change",a.treeRowSelected);var I=$.grep(D.dataSource.data(),function(e){return!0===e.sysexpanded});if(I&&0<I.length)for(var O=0,_;O<I.length;O++)if(_=D.dataSource.getByUid(I[O].uid),_){var P=D.tbody.find("tr[data-uid='"+_.uid+"']");P&&D.expand(P)}a.applyCheckBoxTreeContentChangeEvent(n)})}catch(e){this.interopInternal.handleError(e.message,"refreshTreeList")}},AvantiGridsClass.prototype.applyCheckBoxTreeContentChangeEvent=function(t){try{var a=this.interopInternal,o=this;$(".k-grid-content",t).off("change","input.sysEditTreeCheckBox"),$(".k-grid-content",t).on("change","input.sysEditTreeCheckBox",function(n){var e=t.data("kendoTreeList"),d=e.dataItem($(n.target).closest("tr")),s=e.tbody.find("tr[data-uid='"+d.uid+"']");e.select(s);var l=$(n.target).closest("tr"),r=$("tr",e.tbody).index(l),c=$("td",l).index(n.target.parentElement);!0===e._group&&--c;var p=e.columns[c].field;d[p]=this.checked,d=e.dataSource.data()[r],r++;var u=!1;r==e.dataSource.total()&&(u=!0);var m=r+"|"+u+"|"+p+"|"+this.checked+"|";if(null!==d){var g=d.toJSON();if($.each(g,function(t,a){if(-1===t.indexOf("syscolor")&&-1===t.indexOf("sysbgcolor")&&-1===t.indexOf("sysdisabled")&&-1===t.indexOf("sysexpanded")&&-1===t.indexOf("sysdec")){for(var n=!1,d=!1,s=0;s<e.columns.length;s++){if(e.columns[s].field===t&&"date"===e.columns[s].type){n=!0;break}if(e.columns[s].field===t&&e.columns[s].isCombbox){d=!0;break}}m=n?m+o.convertDateForGridOutput(a)+"|":d?m+a.key+"|":m+a+"|"}}),d){var h=t.data("sysprogridchangedrows");--r,0<=r&&-1===h.indexOf(r)&&(h.push(r),t.data("sysprogridchangedrows",h))}}var f=t.data("sysprotreefieldname");a.eventTrigged(f,m,"","","gridCellChanged",function(){},!1),o.gridAutoCheckTreeColumnHeader(t)}),$(".header-checkbox",t).off("click"),$(".header-checkbox",t).on("click",function(e){e.stopPropagation();var o=e.target.getAttribute("data-columnname"),n=e.target.checked,d=t.data("kendoTreeList"),s=t.data("sysprogridchangedrows");$.each(d.dataSource.data(),function(e){var t=d.dataSource.at(e);t[o]=n,0<=e&&-1===s.indexOf(e)&&s.push(e)}),t.data("sysprogridchangedrows",s),d.refresh(),setTimeout(function(){e.target.checked=e.target.checked});var l=t.data("sysprotreefieldname");a.eventTrigged(l,o+"|"+n,"","","gridHeaderChecked",function(){},!1)}),o.gridAutoCheckTreeColumnHeader(t)}catch(e){this.interopInternal.handleError(e.message,"applyContentTreeChangeEvent")}},AvantiGridsClass.prototype.gridAutoCheckTreeColumnHeader=function(e){this.interopInternal;if(e){var t=e.data("kendoTreeList");if(t){var a=t.columns,o=$.grep(a,function(e){return!0===e.showInCheckBoxHeader});if(o&&0<o.length)for(var n=0,d;n<o.length;n++)if(d=$("input[data-columnname='"+o[n].field+"']",e),d&&d[0]){var s=t.dataSource.data();if(s=$.grep(s,function(e){return null!==e.parentId}),0<s.length){var l=$.grep(s,function(e){return!1===e[o[n].field]});l&&(0==l.length?d[0].checked=!0:d[0].checked=!1)}else d[0].checked=!1}}}},AvantiGridsClass.prototype.sysTreeListCellClick=function(e){var t=this.interopInternal,a=this,o="";if($(e).data("eventnum"))o=$(e).data("eventnum");else{var n=e.parentNode;o=$(n).data("eventnum")}var d=$(e).closest(".syspro-tree-list"),s=d.data("kendoTreeList"),l=d.data("sysprotreefieldname"),r=s.dataItem($(e).closest("tr")),c=$(e).closest("tr");c.data("sysignorerowselectedevent",!0);var p=s.dataItem(r),u=c.index()+"|";if(null!==p){var m=p.toJSON();$.each(m,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("sysexpanded")&&-1===e.indexOf("sysdec")){for(var o=!1,n=0;n<s.columns.length;n++)s.columns[n].field===e&&"date"===s.columns[n].type&&(o=!0);u=o?u+a.convertDateForGridOutput(t)+"|":u+t+"|"}}),t.eventTrigged(l,u,"","","treeRowSelected",function(){},function(){})}var g=o+"|";$.each(m,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("sysexpanded")&&-1===e.indexOf("sysdec")){for(var o=!1,n=!1,d=0;d<s.columns.length;d++){if(s.columns[d].field===e&&"date"===s.columns[d].type){o=!0;break}if(s.columns[d].field===e&&s.columns[d].isCombbox){n=!0;break}}g=o?g+a.convertDateForGridOutput(t)+"|":n?g+t.key+"|":g+t+"|"}}),t.eventTrigged(l,g,"","","treeHyperlinkClicked",function(){},function(){})},AvantiGridsClass.prototype.treeRequestInternalEvent=function(e){try{var t=this.interopInternal,a=this,o=$("*[data-sysprotreefieldname=\""+e.FieldName+"\"]"),n="",d,s;if(0<o.length){var l=o.data("kendoTreeList");if(null!==l)switch(e.InternalEvent){case"GetSelectedRow":n="false";var r=l.select(),c=l.dataItem(l.select());if(c){n=r.index()+"|";var p=c.toJSON();$.each(p,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("sysexpanded")&&-1===e.indexOf("sysdec")){for(var o=!1,d=0;d<l.columns.length;d++)l.columns[d].field===e&&"date"===l.columns[d].type&&(o=!0);n=o?n+a.convertDateForGridOutput(t)+"|":n+t+"|"}})}break;case"SetSelectedRow":s=e.InternalEventParameter.split("|");var u=s[0],m=s[1],d=l.dataSource.at(u);if(d){var g=l.tbody.find("tr[data-uid='"+d.uid+"']");if(l.select(g),"true"===m){var p=d.toJSON();$.each(p,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("sysexpanded")&&-1===e.indexOf("sysdec")){for(var o=!1,d=0;d<l.columns.length;d++)l.columns[d].field===e&&"date"===l.columns[d].type&&(o=!0);n=o?n+a.convertDateForGridOutput(t)+"|":n+t+"|"}}),t.eventTrigged(e.FieldName,n,"","","treeRowSelected",function(){},function(){})}}n="";break;case"SetCellValue":var l=o.data("kendoTreeList");s=e.InternalEventParameter.split("|");var h=s[0]-1,f;if(l&&(d=l.dataSource.data()[h],null!==d)){f="true"===s[2]||"false"!==s[2]&&s[2],d.set(s[1],f),d.dirtyFields={},d.dirty=!1;for(var y=0,b=!1,v=0;v<l.columns.length;v++)if(l.columns[v].field===s[1]){y=v,"boolean"===l.columns[v].type&&(b=!0);break}if(b){var g=l.tbody.find("tr[data-uid='"+d.uid+"']");if(g){var w=$("input",$("td",g)[y])[0];w&&(w.checked=f)}}}break;case"DisableEntryGrid":$.each(o,function(){var e=$(this);e.data("sysproentrygriddisabled",!0);var t=e.data("sysprotreefieldname"),o={};o.FieldName=t,o.GridData=e.data("sysprotreelistinfo"),o.FromRequestInternal=!0,a.refreshTreeList(o),e[0]&&e[0].parentElement&&(e[0].parentElement.className="panel-body widget-sysprodisabled")});break;case"EnableEntryGrid":$.each(o,function(){var e=$(this);e.data("sysproentrygriddisabled",!1);var t=e.data("sysprotreefieldname"),o={};o.FieldName=t,o.GridData=e.data("sysprotreelistinfo"),o.FromRequestInternal=!0,a.refreshTreeList(o),e[0]&&e[0].parentElement&&(e[0].parentElement.className="panel-body")});break;case"SetHeaders":var C=JSON.parse(e.InternalEventParameter);$.each(o,function(){var e=$(this),t=e.data("sysprotreefieldname"),o=e.data("sysprotreelistinfo");if(e&&o){$.each(C.lv.cs.c,function(e){var t=C.lv.cs.c[e].field,a=C.lv.cs.c[e].title,n=null;for(C.lv.cs.c[e].search&&(n=C.lv.cs.c[e].search),v=0;v<o.cs.c.length;v++)if(o.cs.c[v].field===t){""===a&&(a="  "),o.cs.c[v].title=a,n&&(o.cs.c[v].search=n);break}}),e.data("sysprotreelistinfo",o);var n={};n.FieldName=t,n.GridData=e.data("sysprotreelistinfo"),n.FromRequestInternal=!0,a.refreshTreeList(n)}});break;case"FindRow":n="false",s=e.InternalEventParameter.split("|");var x=s[0],S=s[1];"true"===S?S=!0:"false"===S&&(S=!1);var T=l.dataSource.data(),W=$.grep(T,function(e){return e[x]===S});if(W&&0<W.length){var d=l.dataSource.getByUid(W[0].uid),g=l.tbody.find("tr[data-uid='"+d.uid+"']");if(g){var D=g[0].rowIndex;D++,n=D}}break;case"GetAllMatchedRows":s=e.InternalEventParameter.split("|");var x=s[0],S=s[1];"true"===S&&(S=!0),"false"===S&&(S=!1),"parentId"===x&&(S=parseInt(S,10));var I="",O="",T=l.dataSource.data(),W;if(2<s.length?(I=s[2],O=s[3],W=$.grep(T,function(e){return e[x]===S&&e[I]===O})):W=$.grep(T,function(e){return e[x]===S}),n="false",W&&0<W.length){n="";for(var _=0;_<W.length;_++){var P=l.dataSource.getByUid(W[_].uid),g=l.tbody.find("tr[data-uid='"+P.uid+"']");if(g){var D=g[0].rowIndex;D++,n=n+D+"|";var p=P.toJSON();$.each(p,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("sysexpanded")&&-1===e.indexOf("sysdec")){for(var o=!1,d=!1,s=!1,r=0;r<l.columns.length&&"id"!==e&&"parentId"!==e;r++){if(l.columns[r].field===e){"date"===l.columns[r].type&&(o=!0),s=!0;break}if(l.columns[r].field===e&&l.columns[r].isCombbox){d=!0,s=!0;break}l.columns[r].field===e&&(s=!0)}s&&(o?n=n+a.convertDateForGridOutput(t)+"|":d?n=n+t.key+"|":n=n+t+"|")}}),n+="\r\n"}}}break;case"GetAllChangedGridRows":n="false",$.each(o,function(){var e=$(this),t=e.data("kendoTreeList"),o=e.data("sysprogridchangedrows");o&&0<o.length&&(n="",$.each(o,function(){var e=t.dataSource.at(this),o=this+1;n=n+o+"|";var d=e.toJSON();$.each(d,function(e,o){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("sysexpanded")&&-1===e.indexOf("sysdec")){for(var d=!1,s=!1,l=!1,r=0;r<t.columns.length&&"id"!==e&&"parentId"!==e;r++){if(t.columns[r].field===e){"date"===t.columns[r].type&&(d=!0),l=!0;break}if(t.columns[r].field===e&&t.columns[r].isCombbox){s=!0,l=!0;break}t.columns[r].field===e&&(l=!0)}l&&(d?n=n+a.convertDateForGridOutput(o)+"|":s?n=n+o.key+"|":n=n+o+"|")}}),n+="\r\n"}))});break;case"DeleteCurrentRow":n="false";var r=l.select(),c=l.dataItem(l.select());if(c){n=r.index()+"|";var p=c.toJSON();$.each(p,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("sysexpanded")&&-1===e.indexOf("sysdec")){for(var o=!1,d=0;d<l.columns.length;d++)l.columns[d].field===e&&"date"===l.columns[d].type&&(o=!0);n=o?n+a.convertDateForGridOutput(t)+"|":n+t+"|"}}),l.dataSource.pushDestroy(c)}break;case"SelectRowAt":var u=+e.InternalEventParameter;--u;var d=l.dataSource.at(u);if(d){var g=l.tbody.find("tr[data-uid='"+d.uid+"']");l.select(g)}break;case"AddChildRow":var E=JSON.parse(e.InternalEventParameter);l.dataSource.pushCreate(E);break;case"RemoveChildRow":var F=JSON.parse(e.InternalEventParameter);l.dataSource.pushDestroy(F);break;case"GetChildRows":var u=+e.InternalEventParameter;--u;var d=l.dataSource.at(u);if(d&&d.hasChildren){var A=l.dataSource.childNodes(d);n="";for(var _=0;_<A.length;_++){var P=l.dataSource.getByUid(A[_].uid),g=l.tbody.find("tr[data-uid='"+P.uid+"']");if(g){var D=g[0].rowIndex;D++,n=n+D+"|";var p=P.toJSON();$.each(p,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("sysexpanded")&&-1===e.indexOf("sysdec")){for(var o=!1,d=!1,s=0;s<l.columns.length;s++){if(l.columns[s].field===e&&"date"===l.columns[s].type){o=!0;break}if(l.columns[s].field===e&&l.columns[s].isCombbox){d=!0;break}}n=o?n+a.convertDateForGridOutput(t)+"|":d?n+t.key+"|":n+t+"|"}}),n+="\r\n"}}}break;case"Size":n=l.dataSource.total()+"|";break;case"ExpandAll":var N=$("tr.k-treelist-group",l.tbody);N&&$.each(N,function(e,t){l.expand(t)});break;case"CollapseAll":var N=$("tr.k-treelist-group",l.tbody);N&&$.each(N,function(e,t){l.collapse(t)});break;case"ExcelExport":l&&l.saveAsExcel();break;case"PDFExport":l&&l.saveAsPDF();break;case"GetAllGridRows":var M="";n="false",$.each(l.dataSource.data(),function(e){var t=l.dataSource.at(e);n=e+1+"|",$.each(t,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("sysexpanded")&&-1===e.indexOf("sysdec"))for(var o=!1,d=!1,s=!1,r=0;r<l.columns.length;r++)if(l.columns[r].field===e){if(o=!0,"date"===l.columns[r].type){d=!0;break}if(l.columns[r].isCombbox){s=!0;break}}!0===o?!0===d?n=n+a.convertDateForGridOutput(t)+"|":s?n=n+t.key+"|":n=n+t+"|":"syshidden"===e&&(n+="syshidden|")}),M=M+n+"\r\n"}),n=M;break;case"ShowGridCellMessage":var L=JSON.parse(e.InternalEventParameter);0<L.lv.mss.ms.length&&$.each(o,function(){var e=$(this);$(".gridlist-cell-note",e).remove();var t=e.data("kendoTreeList");if(t){for(var a=0;a<L.lv.mss.ms.length;a++){var o=L.lv.mss.ms[a],n=o.row-1,d=o.col,s=0,l=o.val,r=o.sysDisabled,c=!1,p=!0,u;for(v=0;v<t.columns.length;v++)if(t.columns[v].field===d){s=v,"boolean"===t.columns[v].type&&(c=!0),!1===t.columns[v].editable&&(p=!1);break}if(l){var m=t.dataSource.data()[n];m&&(u="true"===l||"false"!==l&&l,!1==p?m[d]=u:m.set(d,u),m.dirtyFields={},m.dirty=!1,!0===c&&(m[s]=u))}if(r){var g;if(g=t.dataSource.data()[n],g){var h=g.colDisabled;h&&"undefined"!==h||(g.colDisabled=""),h=g.colDisabled,"|"!==h[h.length-1]&&(h+="|");var f=!1;if(h){if(""!==d)if(!1==d.includes("sysdisabled")){var s=d+"|";h.includes(s)&&(h=h.replace(s,"")),"true"===r&&("|"===h.slice(-1)?h+=s:h=h+"|"+s)}else f=!0,g[d]="true"===r;g.colDisabled=h}}}}t.refresh(),$(".gridlist-cell-note",e).popover("destroy"),$(".gridlist-cell-note",e).remove();for(var a=0;a<L.lv.mss.ms.length;a++){var o=L.lv.mss.ms[a],n=o.row-1,d=o.col,s=0,y=o.msg,c=!1,u;for(v=0;v<t.columns.length;v++)if(t.columns[v].field===d){s=v,"boolean"===t.columns[v].type&&(c=!0);break}var b=t.dataSource.data()[n];if(b){var w=t.table.find("tr[data-uid='"+b.uid+"']"),C=w.find("td:eq("+s+")");if(y)if(""===y||"undefined"===y)C[0]&&C[0].remove("span.gridlist-cell-note");else{C.append("<a href=\"#\" class=\"gridlist-cell-note\" tabindex=\"0\" data-container=\"body\" data-toggle=\"popover\" data-placement=\"bottom\" data-content=\""+y+"\" data-trigger=\"focus\" data-original-title=\"\" title=\"\"></a>")}}}$(".gridlist-cell-note",e).popover()}});}}return n}catch(e){this.interopInternal.handleError(e.message,"treeRequestInternalEvent")}},AvantiGridsClass.prototype.treeRowSelected=function(t){try{var e=this,a=t.sender,o=t.sender.element,n=o.data("sysprotreefieldname"),d=e.select(),s=d.index()+"|";if(null!==a){var l=a.dataItem(e.select());if(null!==l){var r=l.toJSON();$.each(r,function(e,t){if(-1===e.indexOf("syscolor")&&-1===e.indexOf("sysbgcolor")&&-1===e.indexOf("sysdisabled")&&-1===e.indexOf("sysexpanded")&&-1===e.indexOf("sysdec")){for(var o=!1,n=0;n<a.columns.length;n++)a.columns[n].field===e&&"date"===a.columns[n].type&&(o=!0);s=o?s+sysproInterop.gridHelpers.convertDateForGridOutput(t)+"|":s+t+"|"}}),!0===d.data("sysignorerowselectedevent")?d.data("sysignorerowselectedevent",!1):sysproInterop.eventTrigged(n,s,"","","treeRowSelected",function(){},function(){})}}}catch(e){sysproInterop.handleError(e.message,"treeRowSelected")}},AvantiGridsClass.prototype.createTreeView=function(e){try{var t=this.interopInternal,a=$("*[data-sysprotreeviewfieldname=\""+e.FieldName+"\"]");$.each(a,function(){var a=$(this);a.data("kendoTreeView")&&(a.data("kendoTreeView").destroy(),a.empty());var o=JSON.parse(e.GridData).tnds,n=new kendo.data.HierarchicalDataSource({data:o});0<a.length&&a.kendoTreeView({loadOnDemand:!0,dataSource:n,expand:function(a){var o=a.sender.dataItem(a.node);if(o&&!1===o._loaded){var n=o.level();++n;var d=o.parentNode();d?t.eventTrigged(e.FieldName,o.id+"|"+o.text+"|"+o.tag+"|"+n+"|"+d.text,"","","treeViewNodeExpanded",function(){},function(){}):t.eventTrigged(e.FieldName,o.id+"|"+o.text+"|"+o.tag+"|"+n+"|","","","treeViewNodeExpanded",function(){},function(){})}},select:function(a){var o=a.sender.dataItem(a.node);if(o){var n=o.level();++n;var d=o.parentNode();d?t.eventTrigged(e.FieldName,o.id+"|"+o.text+"|"+o.tag+"|"+n+"|"+d.text,"","","treeViewNodeSelected",function(){},function(){}):t.eventTrigged(e.FieldName,o.id+"|"+o.text+"|"+o.tag+"|"+n+"|","","","treeViewNodeSelected",function(){},function(){})}}})})}catch(e){this.interopInternal.handleError(e.message,"createTreeView")}},AvantiGridsClass.prototype.treeViewRequestInternalEvent=function(e){try{var t=this.interopInternal,a=$("*[data-sysprotreeviewfieldname=\""+e.FieldName+"\"]"),o="",n,d;if(0<a.length){var s=a.data("kendoTreeView");if(null!==s)switch(e.InternalEvent){case"AddItems":var l=JSON.parse(e.InternalEventParameter),r=l.updateinfo.id,n=s.dataSource.get(r);n&&s.append(l.items,s.findByUid(n.uid));break;case"DeleteNode":var r=e.InternalEventParameter,n=s.dataSource.get(r);n&&s.remove(s.findByUid(n.uid));break;case"CollapseAll":s.collapse(".k-item");break;case"ExpandAll":s.expand(".k-item");break;case"ExpandNode":var r=e.InternalEventParameter,n=s.dataSource.get(r);n&&s.expand(s.findByUid(n.uid));break;case"GetParentNode":var r=e.InternalEventParameter,n=s.dataSource.get(r);if(n){var c=n.parentNode();if(c){var p=c.level();++p;var u=c.parentNode();o=u?c.id+"|"+c.text+"|"+c.tag+"|"+p+"|"+u.text:c.id+"|"+c.text+"|"+c.tag+"|"+p}}break;case"GetNode":var r=e.InternalEventParameter,n=s.dataSource.get(r);n&&(o=n.id+"|"+n.text+"|"+n.tag);break;case"HasChildren":var r=e.InternalEventParameter,n=s.dataSource.get(r);n&&(!0===n.hasChildren?o="true":o="false");break;case"SetHasChildren":d=e.InternalEventParameter.split("|");var r=d[0],m=d[1],n=s.dataSource.get(r);if(n&&(n.hasChildren=m,!1===m||"false"===m))for(var g=n.children.data(),h=0,f=g.length,y;h<f;h++)y=s.findByUid(g[0].uid),s.remove(y);break;case"NumChildren":var r=e.InternalEventParameter,n=s.dataSource.get(r);n&&(n.items?o=n.items.length:o="0");break;case"SetSelected":var r=e.InternalEventParameter,n=s.dataSource.get(r);if(n){var b=s.findByUid(n.uid);if(b){s.select(b);var p=n.level();++p;var c=n.parentNode();c?t.eventTrigged(e.FieldName,n.id+"|"+n.text+"|"+n.tag+"|"+p+"|"+c.text,"","","treeViewNodeSelected",function(){},function(){}):t.eventTrigged(e.FieldName,n.id+"|"+n.text+"|"+n.tag+"|"+p,"","","treeViewNodeSelected",function(){},function(){})}}break;case"GetSelected":var v=s.select(),n=s.dataItem(v);if(n){var p=n.level();++p;var c=n.parentNode();o=n.id+"|"+n.text+"|"+n.tag+"|"+p+"|"+c.text}break;case"UpdateItem":d=e.InternalEventParameter.split("|");var r=d[0],w=d[1],C=d[2],n=s.dataSource.get(r);n&&(n.text=w,n.tag=C),s.refresh();}}return o}catch(e){this.interopInternal.handleError(e.message,"treeViewRequestInternalEvent")}},AvantiGridsClass}(),AvantiSearchClass=function(){var e=Math.min,t=Math.max,a=Math.round;function AvantiSearchClass(e){this.version="8.0.0.1",this.interopHelper=e,this.CustomSearch=!1,this.ApplySearchFilter=!0,this.FilterCategoryNum=0,this.$floaty=$(".floaty"),this.SearchCallBackClicked=!1;var t=this;this.$floaty.on("mouseover click",function(a){t.$floaty.addClass("is-active"),a.stopPropagation()}),this.$floaty.on("mouseout",function(){t.$floaty.removeClass("is-active")}),$(".container").on("click",function(){t.$floaty.removeClass("is-active")})}return AvantiSearchClass.prototype.OpenSearch=function(e,t,a,o,n,d,s){var l=this;try{console.log("00 - OpenSearch"),e=l.CheckForKeyfieldChange(e),l.CallBackMethod=d,l.KeyField=e,l.ParentDiv=s;var r="";a&&o&&(r="<LevelId>"+a+"</LevelId><LevelValue>"+o+"</LevelValue>"),l.interopHelper.callBusinessObject("query","ESPQSC-CAT","<Query><Key>"+r+"<KeyField>"+e+"</KeyField></Key></Query>","",function(t){var a=JSON.stringify(t);if(console.log(a),!t.Query.Item.PrimaryTable)l.KeyFieldDesc=l.CamelCaseToSentence(e),l.interopHelper.setModalWindowTitle(s+"|Search "+l.KeyFieldDesc),l.CustomSearch=!0,l.BindSearchListInCard(1e3,!0);else{l.CustomSearch=!1;var o=a.split("+").join("Plus");console.log(o),t.Query.Item&&t.Query.Item.KeyFieldDesc&&(l.KeyFieldDesc=t.Query.Item.KeyFieldDesc,l.interopHelper.setModalWindowTitle(s+"|Search "+l.KeyFieldDesc)),l.FilterUIData=t=JSON.parse(o),l.BindFiltersToCard(t,!0),$(".avanti-base-class").css("overflow-y","auto")}},function(t){console.log("error:"+t.ErrorMessage),l.interopHelper.handleError(t.ErrorMessage,"Load Search Filters")},!0,!1)}catch(t){l.interopHelper.handleError(t.message,"Avanti Open Search")}},AvantiSearchClass.prototype.BindSearchListInCard=function(e,t){var a=this;try{if(console.log("00 Reached binding method"),e&&0!=e||(e=50),$(".search-loading-cover",a.ParentDiv).show(),t){$("#avanti-search-count-slider",a.ParentDiv).attr("data-slider-max",e);var o=50;o>e&&(o=e),$("#avanti-search-count-slider",a.ParentDiv).attr("data-slider-endvalue",o),$("#avanti-search-count-slider-button",a.ParentDiv).text(e);var n=$(".avanti-search-count-slider")[0],d={start:+e,range:{min:0,max:+e}};n.noUiSlider.updateOptions(d)}a.KeyField&&(t?a.GetSearchAndPerform():a.ApplyFilter()),console.log("99 Finished binding method")}catch(e){a.interopHelper.handleError(e.message,"Initializing Avanti Search")}},AvantiSearchClass.prototype.GetSearchAndPerform=function(){var t=this;if(t.CustomSearch){t.ShowHideDefaulttext(!0),$("#avanti-search-count-slider").hide();var a;$(".avanti-search-text-input",t.ParentDiv).off("input"),$(".avanti-search-text-input",t.ParentDiv).on("input",function(){a&&clearTimeout(a),a=setTimeout(function(){t.PerformSearch(null,"","")},250)}),$(".avanti-search-button",t.ParentDiv).off("click"),$(".avanti-search-button",t.ParentDiv).on("click",function(){t.PerformSearch(null,"","")}),t.PerformSearch(null,"","")}else t.interopHelper.callBusinessObject("query","ESPQRY","<Query><Key><FileType>SB</FileType><FileName>"+t.KeyField+"</FileName></Key></Query>","",function(a){var o=[];console.log(a);var n=new COMFNDQuery;a&&a.Query&&a.Query.Search&&a.Query.Search.ReturnRows&&$("#avanti-search-count-slider",t.ParentDiv)&&0<$("#avanti-search-count-slider",t.ParentDiv).length&&$("#avanti-search-count-slider",t.ParentDiv)[0].noUiSlider.set(a.Query.Search.ReturnRows);var d="GlobalValue";if(-1==JSON.stringify(a.Query.Search).indexOf("{2}")?-1==JSON.stringify(a.Query.Search).indexOf("{1}")?(n.Search.GlobalValue="**",d="GlobalValue"):(n.Search.GlobalValue="**",n.Search.GlobalValue1="**",d="GlobalValue1",a.Query.Search.Where&&$.each(a.Query.Search.Where.Expression,function(){"{0}"===this.Value&&"EQ"===this.Condition.toUpperCase()?t.interopHelper.getGlobalValue(this.Column)?(n.Search.GlobalValue=t.interopHelper.getGlobalValue(this.Column),o.push({key:this.Column,value:n.Search.GlobalValue})):"Branch"==this.Column?t.interopHelper.getGlobalValue("SABranch")?(n.Search.GlobalValue=t.interopHelper.getGlobalValue("SABranch"),o.push({key:this.Column,value:n.Search.GlobalValue})):t.interopHelper.getGlobalValue("AssetBranch")?(n.Search.GlobalValue=t.interopHelper.getGlobalValue("AssetBranch"),o.push({key:this.Column,value:n.Search.GlobalValue})):this.Condition="LIKE":this.Condition="LIKE":"{1}"===this.Value&&"EQ"===this.Condition.toUpperCase()&&(d="GlobalValue",t.interopHelper.getGlobalValue(this.Column)?(n.Search.GlobalValue1=t.interopHelper.getGlobalValue(this.Column),o.push({key:this.Column,value:n.Search.GlobalValue1})):"Branch"==this.Column?t.interopHelper.getGlobalValue("SABranch")?(n.Search.GlobalValue1=t.interopHelper.getGlobalValue("SABranch"),o.push({key:this.Column,value:n.Search.GlobalValue1})):t.interopHelper.getGlobalValue("AssetBranch")?(n.Search.GlobalValue1=t.interopHelper.getGlobalValue("AssetBranch"),o.push({key:this.Column,value:n.Search.GlobalValue1})):this.Condition="LIKE":this.Condition="LIKE")})):(n.Search.GlobalValue="**",n.Search.GlobalValue1="**",n.Search.GlobalValue2="**",d="GlobalValue2",a.Query.Search.Where&&$.each(a.Query.Search.Where.Expression,function(){"{0}"===this.Value&&"EQ"===this.Condition.toUpperCase()&&(t.interopHelper.getGlobalValue(this.Column)?(n.Search.GlobalValue=t.interopHelper.getGlobalValue(this.Column),o.push({key:this.Column,value:n.Search.GlobalValue})):"Branch"==this.Column?t.interopHelper.getGlobalValue("SABranch")?(n.Search.GlobalValue=t.interopHelper.getGlobalValue("SABranch"),o.push({key:this.Column,value:n.Search.GlobalValue})):t.interopHelper.getGlobalValue("AssetBranch")?(n.Search.GlobalValue=t.interopHelper.getGlobalValue("AssetBranch"),o.push({key:this.Column,value:n.Search.GlobalValue})):this.Condition="LIKE":this.Condition="LIKE"),"{1}"===this.Value&&"EQ"===this.Condition.toUpperCase()&&(t.interopHelper.getGlobalValue(this.Column)?(n.Search.GlobalValue1=t.interopHelper.getGlobalValue(this.Column),o.push({key:this.Column,value:n.Search.GlobalValue1})):"Branch"==this.Column?t.interopHelper.getGlobalValue("SABranch")?(n.Search.GlobalValue1=t.interopHelper.getGlobalValue("SABranch"),o.push({key:this.Column,value:n.Search.GlobalValue1})):t.interopHelper.getGlobalValue("AssetBranch")?(n.Search.GlobalValue1=t.interopHelper.getGlobalValue("AssetBranch"),o.push({key:this.Column,value:n.Search.GlobalValue1})):this.Condition="LIKE":this.Condition="LIKE"),"{2}"===this.Value&&"EQ"===this.Condition.toUpperCase()&&(t.interopHelper.getGlobalValue(this.Column)?(n.Search.GlobalValue2=t.interopHelper.getGlobalValue(this.Column),o.push({key:this.Column,value:n.Search.GlobalValue2})):"Branch"==this.Column?t.interopHelper.getGlobalValue("SABranch")?(n.Search.GlobalValue2=t.interopHelper.getGlobalValue("SABranch"),o.push({key:this.Column,value:n.Search.GlobalValue2})):t.interopHelper.getGlobalValue("AssetBranch")?(n.Search.GlobalValue2=t.interopHelper.getGlobalValue("AssetBranch"),o.push({key:this.Column,value:n.Search.GlobalValue2})):this.Condition="LIKE":this.Condition="LIKE")})),0<o.length){for(var s=t.ParentDiv+"|Search "+t.KeyFieldDesc+" ",l="",r=0;r<o.length;r++)l=l+o[r].key+": "+o[r].value+" ";l&&(l=" ("+l+")"),t.interopHelper.setModalWindowTitle(s+l)}for(var c in t.AvantiSearchCOMFNDEnteredTextPossition=d,a.Query.Search)n.Search[c]=a.Query.Search[c];var p=a.Query.Search.TableName,u;if($(".avanti-search-text-input",t.ParentDiv).off("input"),$(".avanti-search-text-input",t.ParentDiv).on("input",function(){u&&clearTimeout(u),u=setTimeout(function(){t.ApplyFilter()},250)}),$(".avanti-search-button",t.ParentDiv).off("click"),$(".avanti-search-button",t.ParentDiv).on("click",function(){t.ApplyFilter()}),!n.Search.Where.Expression)n.Search.Where.Expression=[];else if(!n.Search.Where.Expression.length){var m=n.Search.Where.Expression;n.Search.Where.Expression=Array(m)}"("==n.Search.Where.Expression[0].OpenBracket&&")"==n.Search.Where.Expression[n.Search.Where.Expression.length-1].CloseBracket?(n.Search.Where.Expression[0].OpenBracket="((",n.Search.Where.Expression[n.Search.Where.Expression.length-1].CloseBracket="))"):!n.Search.Where.Expression[0].OpenBracket&&!n.Search.Where.Expression[n.Search.Where.Expression.length-1].CloseBracket&&(n.Search.Where.Expression[0].OpenBracket="(",n.Search.Where.Expression[n.Search.Where.Expression.length-1].CloseBracket=")"),console.log("-----NEW COMFND -----"+JSON.stringify(n)),t.AvantiSearchCOMFNDPlainXML=n,t.ApplyFilter(),$(".search-loading-cover",t.ParentDiv).hide()},function(a){t.interopHelper.handleError(a.ErrorMessage,"Getting Default Avanti Search")},!0,!1)},AvantiSearchClass.prototype.ApplyGivenSearchFilter=function(e){var t=this;console.log("ApplyGivenSearchFilter");var a=JSON.parse(JSON.stringify(t.AvantiSearchCOMFNDPlainXML)),o=e.length,n=1,d=t.AvantiSearchCOMFNDPlainXML.Search.TableName;e.forEach(function(e){if(e.Value&&""!=e.Value)switch(e.TableName!=d&&(e.Column=e.TableName+"."+e.Column),e.Type){case"0":var t=new Expression;t.AndOr="and",t.OpenBracket=1==n?"(":"(",t.Column=e.Column,t.Condition="LIKE",t.Value="%"+e.Value+"%",t.CloseBracket=n==o?")":")",a.Search.Where.Expression?a.Search.Where.Expression.push(t):a.Search.Where.push({Expression:t});break;case"1":var t=new Expression;t.AndOr="and",t.OpenBracket=1==n?"(":"(",t.Column=e.Column,t.Condition="EQ",t.Value=e.Value,t.CloseBracket=n==o?")":")",a.Search.Where.Expression?a.Search.Where.Expression.push(t):a.Search.Where.push({Expression:t});break;case"2":case"3":case"4":case"8":var t=new Expression;t.AndOr="and",t.OpenBracket=1==n?"(":"(",t.Column=e.Column,t.Condition="EQ",t.Value=e.Value,t.CloseBracket=n==o?")":")",a.Search.Where.Expression?a.Search.Where.Expression.push(t):a.Search.Where.push({Expression:t});break;case"5":var t=new Expression,s=e.Value.split(",");t.AndOr="and",t.OpenBracket=1==n?"(":"(",t.Column=e.Column,t.Condition="GE",t.Value=s[0],t.CloseBracket=")",a.Search.Where.Expression?a.Search.Where.Expression.push(t):a.Search.Where.push({Expression:t}),t=new Expression,t.AndOr="and",t.OpenBracket="(",t.Column=e.Column,t.Condition="LE",t.Value=s[1],t.CloseBracket=n==o?")":")",a.Search.Where.Expression?a.Search.Where.Expression.push(t):a.Search.Where.push({Expression:t});break;case"7":var s=e.Value.split(","),l=1,r=s.length;s.forEach(function(t){t=t.trim();var o=new Expression;1==l?(o.AndOr="and",o.OpenBracket="(("):(o.AndOr="or",o.OpenBracket="("),o.Column=e.Column,o.Condition="EQ",o.Value=t,o.CloseBracket=l==r?"))":")",a.Search.Where.Expression?a.Search.Where.Expression.push(o):a.Search.Where.push({Expression:o}),l++});break;case"9":var t=new Expression,s=e.Value.split(",");t.AndOr="and",t.OpenBracket="((",t.Column=e.Column,t.Condition="GE",t.Value=s[0],t.CloseBracket=")",a.Search.Where.Expression?a.Search.Where.Expression.push(t):a.Search.Where.push({Expression:t}),t=new Expression,t.AndOr="and",t.OpenBracket="(",t.Column=e.Column,t.Condition="LE",t.Value=s[1],t.CloseBracket=")",a.Search.Where.Expression?a.Search.Where.Expression.push(t):a.Search.Where.push({Expression:t}),t=new Expression,t.AndOr="or",t.OpenBracket="(",t.Column=e.Column,t.Condition="EQ",t.Value="0000-00-00",t.CloseBracket="))",a.Search.Where.Expression?a.Search.Where.Expression.push(t):a.Search.Where.push({Expression:t});break;case"6":default:}n++}),t.PerformSearch(a,d,t.AvantiSearchCOMFNDEnteredTextPossition)},AvantiSearchClass.prototype.PerformSearch=function(e,t,o){var n=this;try{console.log("00 Perform Search"),$(".search-loading-cover",n.ParentDiv).show();var d=performance.now(),s="COMFND",l="",r=$(".avanti-search-text-input",n.ParentDiv).val();if(!1==n.CustomSearch){var c=e;r?c.Search[o]="*"+r+"*":(r="**",c.Search[o]=r),c.Search.IgnoreDuplicates="Y",c.Search.IgnoreMissingKeys="Y",c.Search.IncludeColumnMetadata="Y",c.Search.EspressoSearch="Y",c.Search.Columns=c.Search.Columns,c.Search.Where=c.Search.Where,c.Search.OrderBy=c.Search.OrderBy;var p=50;$("#avanti-search-count-slider",n.ParentDiv)&&0<$("#avanti-search-count-slider",n.ParentDiv).length&&(p=+$("#avanti-search-count-slider")[0].noUiSlider.get(),(!p||0===p)&&(p=+$("#avanti-search-count-slider")[0].getAttribute("data-slider-startvalue"))),c.Search.ReturnRows=a(p),l=JSON.stringify(c)}else s="ESPQRY",l="{\"Query\": {\"Key\": {\"FileType\": \"SS\",\"FileName\": \""+n.KeyField+"\",\"SearchValue\": \"**\"  } } }";n.interopHelper.callBusinessObject("query",s,l,"{}",function(e){var a=performance.now();""===t&&(t=n.KeyField),n.CustomSearch&&(e=e.Query);var o=[];0!==e[t].RowsReturned&&(1==e[t].RowsReturned?o.push(e[t].Row):o=e[t].Row),n.colvalueslookup=[],e[t].HeaderDetails&&e[t].HeaderDetails.ColumnMetadata&&$.each(e[t].HeaderDetails.ColumnMetadata.Column,function(){var e=this;"FlagYes"===this.ColumnDataType?(n.colvalueslookup[e.Name]=[],n.colvalueslookup[e.Name].Y="&#x2714;",n.colvalueslookup[e.Name].N=""):this.ColumnValues&&this.ColumnValues.ColumnValue&&(n.colvalueslookup[e.Name]=[],$.each(this.ColumnValues.ColumnValue,function(){n.colvalueslookup[e.Name][this.Value]=this.Text}))}),e[t].HeaderDetails.Columns&&!Array.isArray(e[t].HeaderDetails.Columns.Column)&&(e[t].HeaderDetails.Columns.Column=[e[t].HeaderDetails.Columns.Column]);var s=null;e[t].HeaderDetails.ColumnMetadata&&(s=e[t].HeaderDetails.ColumnMetadata.Column),s||(s=e[t].HeaderDetails.Columns.Column),Array.isArray(s)||(s=[s]);var l=[],c="";$.each(s,function(e,t){var a={field:t.Name,title:n.FormatLinkedColumns(t.Description),encoded:!1,width:0,template:null};if(t.Name){t=t;var a={field:t.Name,title:n.FormatLinkedColumns(t.Description),encoded:!1,width:140,template:null}}else c=t,0==e?c="Id":1==e?c="Description":3==e?c="AdditionalField1":4==e?c="AdditionalField2":5==e?c="DisplayField1":6==e?c="DisplayField2":7==e?c="DisplayField3":8==e?c="DisplayField4":9==e&&(c="DisplayField5"),a={field:c,title:n.CamelCaseToSentence(t),encoded:!1,width:140,template:null};if(n.colvalueslookup[t.Name]){var o="#= AvantiSearchInterop.colvalueslookup['"+t.Name+"']["+t.Name+"] || AvantiSearchInterop.colvalueslookup['"+t.Name+"']["+t.Name+"] === '' ? AvantiSearchInterop.colvalueslookup['"+t.Name+"']["+t.Name+"] : "+t.Name+" ? "+t.Name+" : '' #";a.template=o}n.CustomSearch?2!=e&&l.push(a):l.push(a)}),n.KeyFieldColumn=n.CustomSearch?"Id":e[t].HeaderDetails.Columns.Column[0];l.push({field:"Actions",template:function template(e){return" <a onclick=\"sysproInterop.showSmartTag(this)\" data-fieldcaption=\"ESPRESSOKEYFIELD:"+kendo.htmlEncode(n.KeyFieldColumn)+"\" data-fieldvalue=\""+kendo.htmlEncode(e[n.KeyFieldColumn])+"\">"+"<span class=\"text-primary sys-fg-primary\">"+"Actions"+"</span>"+"</a>"},width:90});var p=l.length-1,u=$(".avanti-search-results-grid",n.ParentDiv).data("kendoGrid");if(!u)$(".avanti-search-results-grid",n.ParentDiv).kendoGrid({dataSource:{data:o,pageSize:500,batch:!0},selectable:"single",height:400,change:function change(){},sortable:!0,filterable:!0,scrollable:{virtual:!0},resizable:!0,pageable:{messages:{display:"Showing {2} item(s)"},numeric:!1,previousNext:!1},columns:l}).on("click","tbody td",function(a){var e=$(".avanti-search-results-grid").data("kendoGrid"),o=$(a.currentTarget),d=o[0].cellIndex;if(e.columns.length!=d+1){var s=e.dataItem(o.closest("tr")),l=s[n.KeyFieldColumn];if("SRSMain"===callLayerInterop.avantiPluginLoaded&&"EccRevHistory"===t&&(l+="/"+s.get("Release")),console.log("Selected: "+l),n.CallBackMethod){!1===n.SearchCallBackClicked&&(n.SearchCallBackClicked=!0,n.CallBackMethod(l));setTimeout(function(){n.SearchCallBackClicked=!1},200)}}else e.clearSelection()});else{var m=new kendo.data.DataSource({data:o,pageSize:20});u.setDataSource(m)}if(n.CustomSearch){var g=n.ParentDiv;n.interopHelper.performPredictiveSearch(n.KeyField,r,function(e){o=e;var t=new kendo.data.DataSource({data:o,pageSize:20}),a=$(".avanti-search-results-grid",g).data("kendoGrid");a.setDataSource(t);var n=performance.now(),s=0;s=+((n-d)/1e3).toFixed(2),$(".avanti-search-results-text-count",g).text(e.length),$(".avanti-search-results-text-duration",g).text(s),$(".search-loading-cover",g).hide()},function(){},"0")}var h=performance.now(),f=performance.now(),y=0;y=+((f-a)/1e3).toFixed(2),console.log("Execution time after BO call: "+y+" seconds");var b=0;b=+((h-d)/1e3).toFixed(2),$(".avanti-search-results-text-count",n.ParentDiv).text(e[t].RowsReturned),$(".avanti-search-results-text-duration",n.ParentDiv).text(b),$(".search-loading-cover",n.ParentDiv).hide()},function(t){n.interopHelper.handleError(t.ErrorMessage,"Performing Avanti Search")},!1,!1),console.log("99 Perform Search")}catch(e){n.interopHelper.handleError(e.message,"Initializing Avanti Search")}},AvantiSearchClass.prototype.BindFiltersToCard=function(e,t){var a=this;console.log("00 BindFiltersToCard");try{if(a.InitApplyFilterButton(),e){var o=e.Query.Item;o&&o.Columns&&o.Columns.Categories&&$.each(o.Columns.Categories,function(e,t){console.log(e);var o="Avanti-Filter-Template"+e,n=$("#"+o,a.ParentDiv);0===n.length&&($("#panelbar",a.ParentDiv).append(a.ReturnTabPanelHTML(e.toString())),a.FilterCategoryNum++);var d=$("#"+o,a.ParentDiv);if(t.Column.length||(t.Column=Array(t.Column)),0<t.Column.length)for(var s=0;s<t.Column.length;s++)null===t.Column[s].ColumnDefault&&(t.Column[s].ColumnDefault="");var l=kendo.observable(t);if(kendo.bind(d,l),!t.Column.length){var r=JSON.stringify(t.Column);t.Column=[],t.Column.push(JSON.parse(r))}for(var s=0;s<t.Column.length;s++)console.log("Tbl Desc: "+t.Column[s].TableDesc),a.InitializeAndPopulateControl(t.Column[s])});var n=50;e.Query.Item&&e.Query.Item.PrimaryRows?n=e.Query.Item.PrimaryRows:e.Query.Item&&e.Query.Item.Columns&&e.Query.Item.Columns.PrimaryRows&&(n=e.Query.Item.Columns.PrimaryRows),0==n&&(n=50),a.BindSearchListInCard(n,t),queryLayoutUIHelpers.initializeViewOnly(!1,$("#panelbar",a.ParentDiv),""),a.ShowHideDefaulttext(!o||!o.Columns||!o.Columns.Categories||0===o.Columns.Categories.length),console.log("99 - BindFiltersToCard")}}catch(t){a.interopHelper.handleError(t.message,"Error on Bind Search Filter")}},AvantiSearchClass.prototype.ApplyFilter=function(){var t=this;console.log("00 Apply Filter");try{if(!t.ApplySearchFilter)return;var a=[],o="",n="",d="",s="",l="",r=0,l="";$.each($(".Filter-Data-Item"),function(){switch(console.log(this.getAttribute("data-ColumnObject")),o=this.getAttribute("data-name"),d=this.getAttribute("data-tablename"),s=this.getAttribute("data-ColumnObject"),s){case"0":n=$("input",this).val().toString();break;case"1":l="Filter_"+o+"_"+d+"_"+s,n=$("#"+l,t.ParentDiv).val().toString();break;case"2":var e="Filter_"+o+"_"+d+"_"+s;n=$("#"+e,t.ParentDiv).val()+"",("none"===n||"All"===n)&&(n="");break;case"3":l="Filter_"+o+"_"+d+"_"+s;var e="Filter_"+o+"_"+d+"_"+s;n="N",$("#"+e,t.ParentDiv).is(":checked")&&(n="Y");break;case"4":l="Filter_"+o+"_"+d+"_"+s;var e="Filter_"+o+"_"+d+"_"+s;n=t.GetTheSelectedRadioButton(e),console.log("Radio Button ID:"+e),console.log("Radio Button value:"+n);break;case"5":l="Filter_"+o+"_"+d+"_"+s;var c="RangeSlider_"+o+"_"+d+"_"+s;n=$("#"+c,t.ParentDiv)[0].getAttribute("data-slider-startvalue")+","+$("#"+c,t.ParentDiv)[0].getAttribute("data-slider-endvalue");break;case"7":l="Filter_"+o+"_"+d+"_"+s;var e="Filter_"+o+"_"+d+"_"+s;n="",n=t.GetAllCheckedCheckBoxes(e);break;case"8":l="Filter_"+o+"_"+d+"_"+s,n=t.GetDateInBOFormat(l);break;case"9":l="Filter_"+o+"_"+d+"_"+s;var c="DateRangeSlider_"+o+"_"+d+"_"+s;n=$("#"+c,t.ParentDiv)[0].getAttribute("data-slider-endvalue")&&$("#"+c,t.ParentDiv)[0].getAttribute("data-slider-startvalue")&&"0"!==$("#"+c,t.ParentDiv)[0].getAttribute("data-slider-startvalue")&&"0"!==$("#"+c,t.ParentDiv)[0].getAttribute("data-slider-endvalue")&&"null"!==$("#"+c,t.ParentDiv)[0].getAttribute("data-slider-startvalue")&&"null"!==$("#"+c,t.ParentDiv)[0].getAttribute("data-slider-endvalue")?$("#"+c,t.ParentDiv)[0].getAttribute("data-slider-startvalue")+","+$("#"+c,t.ParentDiv)[0].getAttribute("data-slider-endvalue"):"#IGNORE#";}console.log($("input",this).val()),d=d.split("Plus").join("+"),"#IGNORE#"!==n&&(a.push({Column:o,Value:n,TableName:d,Type:s}),r++)}),console.log(a),t.ApplyGivenSearchFilter(a)}catch(a){console.log(a.message),t.interopHelper.handleError(a.message,"Error on Apply Filter")}},AvantiSearchClass.prototype.InitializeAndPopulateControl=function(e){var t=this;try{var a="Filter_"+e.ColumnName+"_"+e.TableName+"_"+e.ColumnObject,o=e.ColumnObject;switch(o){case"0":break;case"1":break;case"2":t.InitAndPopulateComboBox(a,e);break;case"3":break;case"4":t.BuildRadioButtons(a,e);break;case"5":a="RangeSlider_"+e.ColumnName+"_"+e.TableName+"_"+e.ColumnObject,a="Chart_"+e.ColumnName+"_"+e.TableName+"_"+e.ColumnObject;var n=queryLayoutUIHelpers.calculateYValuesOnNormalCurve(parseInt(e.NumSliderValues.NumMinimum),parseInt(e.NumSliderValues.NumMaximum),parseFloat(e.NumSliderValues.NumStdDev),parseFloat(e.NumSliderValues.NumAverage),30);t.BuildAndPopulateChart(a,"",e.ColumnDesc,"","","",parseInt(e.NumSliderValues.NumMinimum),parseInt(e.NumSliderValues.NumMaximum),n);break;case"6":break;case"7":t.BuildCheckBoxes(a,e);break;case"8":t.InitDatePicker(a);}}catch(e){t.interopHelper.handleError(e.message,"Initialize and populate filters")}},AvantiSearchClass.prototype.InitAndPopulateComboBox=function(e,t){var a=this;try{var o=[];t.ColumnValues&&t.ColumnValues.ColumnValue&&(o=t.ColumnValues.ColumnValue);var n="";$("#"+e,a.ParentDiv).append("<option value=\"none\">All</option>");for(var d=0;d<o.length;d++)n=a.RemoveSingleQuotes(o[d].Value),""!=n&&(!o[d].Description&&(o[d].Description=n),$("#"+e,a.ParentDiv).append("<option value=\""+n+"\">"+o[d].Description+"</option>"))}catch(t){console.log(t.message)}},AvantiSearchClass.prototype.InitPanelBar=function(){$(this.ParentDiv+" #panelbar").kendoPanelBar().data("kendoPanelBar")},AvantiSearchClass.prototype.BuildAndPopulateChart=function(a,o,n,d,s,l,r,c,p){var u=this;try{o="blueOpal",d="area",s="",l="";var m=p.reduce(function(e,a){return t(e,a)}),g=p.reduce(function(t,a){return e(t,a)});$("#"+a,u.ParentDiv).kendoChart({chartArea:{height:80},theme:o,legend:{visible:!1},series:[{type:d,data:p,line:{style:"smooth"}}],categoryAxis:{min:r,max:c,categories:[],majorGridLines:{visible:!1},majorTicks:{visible:!1}},tooltip:{visible:!1,template:"#= value #",format:"{00.00}"},valueAxis:{max:m,min:g,title:{text:l},majorGridLines:{visible:!1},visible:!1}})}catch(t){u.interopHelper.handleError(t.message,"Error on Plot chart")}},AvantiSearchClass.prototype.BuildCheckBoxes=function(e,t){var a=this;try{var o=[];t.ColumnValues&&t.ColumnValues.ColumnValue&&(o=t.ColumnValues.ColumnValue);for(var n="",d=null,s="Check_"+t.ColumnName,l=[{caption:"All",value:"All",Name:t.ColumnName,id:t.ColumnName+n,Class:s}],r=0;r<o.length;r++)n=a.RemoveSingleQuotes(o[r].Value),""!=n&&(!o[r].Description&&(o[r].Description=n),l.push({caption:o[r].Description,value:n,Name:t.ColumnName,id:t.ColumnName+n,Class:s})),null==d&&(d="All");if(1==l.length)return void a.RemoveFilterItem(e);var c=$("#"+e,a.ParentDiv),p=kendo.observable({id:"checkboxgroup",Items:l});kendo.bind(c,p),a.CheckAllCheckBoxed(t.ColumnName,s)}catch(t){a.interopHelper.handleError(t.message,"Error on Build checkboxes")}},AvantiSearchClass.prototype.BuildRadioButtons=function(e,t){var a=this;try{var o=[];t.ColumnValues&&t.ColumnValues.ColumnValue&&(o=t.ColumnValues.ColumnValue);for(var n=[{caption:"All",value:"All",Name:t.ColumnName,id:t.ColumnName+d}],d="",s=null,l=0;l<o.length;l++)d=a.RemoveSingleQuotes(o[l].Value),""!=d&&(!o[l].Description&&(o[l].Description=d),n.push({caption:o[l].Description,value:d,Name:t.ColumnName,id:t.ColumnName+d})),null==s&&(s="All");if(0==n.length)return void a.RemoveFilterItem(e);var r={selectedValue:s,id:"radiogroup",Items:n},c=$("#"+e,a.ParentDiv),p=kendo.observable(r);kendo.bind(c,p)}catch(t){a.interopHelper.handleError(t.message,"Error on Build Radio Buttons")}},AvantiSearchClass.prototype.RemoveSingleQuotes=function(e){var t;return e=e.trim(),t=e.substring(1,e.length-1),t.trim()},AvantiSearchClass.prototype.CamelCaseToSentence=function(e){return e?e.replace(/^[a-z]|[A-Z]/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}):""},AvantiSearchClass.prototype.RemoveFilterItem=function(e){var t=this;console.log("Removed Control Filter Item: "+e),$("#"+e,t.ParentDiv).parent().parent().remove(),console.log("Removed DIV - "+e)},AvantiSearchClass.prototype.InitApplyFilterButton=function(){var e=this;$("#ApplyFilterButton",e.ParentDiv).kendoButton(),$("#ClearFilter",e.ParentDiv).kendoButton()},AvantiSearchClass.prototype.InitNumericTextBoxes=function(e){var t=this;$("#"+e,t.ParentDiv).kendoNumericTextBox()},AvantiSearchClass.prototype.ShowHideDefaulttext=function(e){var t=this;try{e?($("#nosearchfilters",t.ParentDiv).show(),$(".floaty",t.ParentDiv).hide(),$("#nosearchfilters",t.ParentDiv).closest(".column-parent").addClass("minimized")):($("#nosearchfilters",t.ParentDiv).hide(),$(".floaty",t.ParentDiv).show(),$("#nosearchfilters",t.ParentDiv).closest(".column-parent").removeClass("minimized"))}catch(t){}},AvantiSearchClass.prototype.SetAutomaticSearch=function(){var e=this;try{var t=$("#Auto-Search",e.ParentDiv).parent();if(!0===e.ApplySearchFilter){e.ApplySearchFilter=!1,$("#Auto-Search-mi",e.ParentDiv).remove(),$("#Auto-Search",e.ParentDiv).remove(),t.removeClass("floaty-list-item floaty-list-item--blue"),t.addClass("floaty-list-item floaty-list-item--gray");var a="<i id='Auto-Search-mi'class='material-icons' style='vertical-align:middle'>highlight_off</i><span id='Auto-Search' class='floaty-list-item-label'>Automatic search: OFF</span>";t.prepend(a)}else{e.ApplySearchFilter=!0,$("#Auto-Search-mi",e.ParentDiv).remove(),$("#Auto-Search",e.ParentDiv).remove(),t.removeClass("floaty-list-item floaty-list-item--gray"),t.addClass("floaty-list-item floaty-list-item--blue");var a="<i id='Auto-Search-mi'class='material-icons' style='vertical-align:middle'>autorenew</i><span id='Auto-Search' class='floaty-list-item-label'>Automatic search: ON</span>";t.prepend(a)}}catch(t){throw t}},AvantiSearchClass.prototype.InitDatePicker=function(e){var t=this,a=$("#"+e,t).data("kendoDatePicker");a&&a.value(new Date)},AvantiSearchClass.prototype.GetTheSelectedRadioButton=function(e){var t=this,a="",o=$("#"+e,t.ParentDiv).find(":radio:checked");return 0<o.length&&(a=o[0].value),"All"==a&&(a=""),a},AvantiSearchClass.prototype.setRangeSliderMinValue=function(){var e=this;try{var t=$(event.target).closest(".form-group").getAttribute("data-name"),a=$(event.target).closest(".form-group").getAttribute("data-tablename"),o=$(event.target).closest(".form-group").getAttribute("data-ColumnObject"),n=parseInt($(event.target).getAttribute("data-NumMinValue")),d="RangeSlider_"+t+"_"+a+"_"+o,s=parseInt($("#"+d,e.ParentDiv)[0].getAttribute("data-slider-endvalue"));$("#"+d,e.ParentDiv)[0].noUiSlider.set([n,s]),e.ApplyFilter()}catch(t){console.log("Error: "+t.message)}},AvantiSearchClass.prototype.setRangeSliderMaxValue=function(){var e=this;try{var t=$(event.target).closest(".form-group").getAttribute("data-name"),a=$(event.target).closest(".form-group").getAttribute("data-tablename"),o=$(event.target).closest(".form-group").getAttribute("data-ColumnObject"),n=parseInt($(event.target).getAttribute("data-NumMaxValue")),d="RangeSlider_"+t+"_"+a+"_"+o,s=parseInt($("#"+d,e.ParentDiv)[0].getAttribute("data-slider-startvalue"));$("#"+d,e.ParentDiv)[0].noUiSlider.set([s,n]),e.ApplyFilter()}catch(t){console.log("Error: "+t.message)}},AvantiSearchClass.prototype.setRowCountSliderMaxValue=function(){var e=this;try{var t=parseInt($("#avanti-search-count-slider",e.ParentDiv).getAttribute("data-slider-max"));$("#avanti-search-count-slider",e.ParentDiv)[0].noUiSlider.set([1,t])}catch(t){console.log("Error: "+t.message)}},AvantiSearchClass.prototype.ApplyFilterButtonClicked=function(){var e=this,t=e.ApplySearchFilter;e.ApplySearchFilter=!0,e.ApplyFilter(),e.ApplySearchFilter=t},AvantiSearchClass.prototype.FormatLinkedColumns=function(e){return e?e.replace("_"," "):""},AvantiSearchClass.prototype.GetAllCheckedCheckBoxes=function(e){var t=this,a="",o=$("#"+e,t.ParentDiv).find(":checkbox");if(1<o.length)for(var n=1;n<o.length;n++)o[n].checked?a+=o[n].value+",":o[0].checked=!1;return 0<o.length&&o[0].checked?"":(a=a.substring(0,a.length-1),a)},AvantiSearchClass.prototype.GetDateInBOFormat=function(e){try{try{return kendo.toString($("#"+e).closest(".date").datepicker("getDate"),"yyyy-MM-dd")}catch(t){return"#IGNORE#"}}catch(t){console.log("Error in GetDateInBOFormat: "+t.message)}},AvantiSearchClass.prototype.CheckAllCheckBoxed=function(e,t){var a=this;$("#"+e).click(function(){$("."+t).prop("checked",$(this).prop("checked")),a.ApplyFilter()})},AvantiSearchClass.prototype.ClearSearchFilters=function(){var t=this;try{t.BindFiltersToCard(t.FilterUIData,!1)}catch(a){t.interopHelper.handleError(a.message,"Error on Reset Search Filter")}},AvantiSearchClass.prototype.FormatNumberToTwoDecimalPlaces=function(e){return parseFloat(e).toFixed(2)},AvantiSearchClass.prototype.ReturnTabPanelHTML=function(e){var t=this,a="";return a="<div class='row'>",a+="<div class='col-sm-12'>",a+="<div class='panel-group' id='24b725fc-1ced-443e-b687-6014e0a5a912"+t.FilterCategoryNum+"' role='tablist' aria- multiselectable='true'>",a+="<div class='panel sys-widget sys-box-shadow-off '>",a+="<h4 class='sys-mg-off' role='tab' id='ae6854d2-ac24-47da-9dd6-68783444a02f"+t.FilterCategoryNum+"'>",a+="<a class='sys-fg-lighten panel-heading sys-block sys-bg-white sys-fg-primary sys-pd-off-l' data-toggle='collapse' data-parent='#24b725fc-1ced-443e-b687-6014e0a5a912"+t.FilterCategoryNum+"' href='#7703c5f2-0fd9-4856-8c97-83a07c777170"+t.FilterCategoryNum+"' ariaexpanded='false' aria-controls='7703c5f2-0fd9-4856-8c97-83a07c777170"+t.FilterCategoryNum+"' aria-expanded='true'>",a+="<i class='material-icons sys-mg-r-2'>brightness_5</i>",a+=t.CamelCaseToSentence(e),a+="<i class='material-icons pull-right collapsible-open-icon'>keyboard_arrow_down</i>",a+="<i class='material-icons pull-right collapsible-close-icon'>keyboard_arrow_up</i>",a+="</a>",a+="</h4>",a+="<div class='panel-collapse collapse in' id='7703c5f2-0fd9-4856-8c97-83a07c777170"+t.FilterCategoryNum+"' role='tabpanel' aria-labelledby='ae6854d2-ac24-47da-9dd6-68783444a02f"+t.FilterCategoryNum+"' aria-expanded='true' style=''>",a+="<!-- FILTERS WILL GO HERE -->",a+="<div id='Avanti-Filter-Template"+e+"'>",a+="<div data-bind='source: Column' data-template='Filter_Template'>",a+="</div>",a+="</div>",a+="<!-- FILTERS WILL GO HERE -->",a+="</div></div></div></div>",a+="</div>",a},(AvantiSearchClass.prototype.SliderEnd=function(){this.ApplyFilter()},AvantiSearchClass.prototype.CheckForKeyfieldChange=function(e){var t=this,a=e;if(0===e.indexOf("Conversion")){e=e.replace("Conversion",""),a=e,"StockCode"===e&&t.interopHelper.getGlobalValue("Warehouse")&&(a="WarehouseStockCode"),"Warehouse"===e&&t.interopHelper.getGlobalValue("StockCode")&&(a="StockCodeWarehouse");try{"ComplaintOwner"===e&&"Global"==JSON.parse(this.interopHelper.getToolbarValues()).Toolbar.CMSPOWTB40200.Value&&(a="Operator"),"ComplaintUser"===e&&"Global"==JSON.parse(this.interopHelper.getToolbarValues()).Toolbar.CMSPURTB40200.Value&&(a="Operator"),"ComplaintGroup"===e&&"Global"==JSON.parse(this.interopHelper.getToolbarValues()).Toolbar.CMSPGRTB40200.Value&&(a="OperatorGroup")}catch(e){}}return a},AvantiSearchClass)}();function sysproInteropFunction(argument){try{return eval(argument)}catch(t){alert("sysproInteropFunction - "+argument+" - "+t.message)}}function sysproInteropSparklineSeriesClick(t){sysproInterop.sparklineSeriesClick(t)}function formatnumber(e){return kendo.toString(parseFloat(e),"n")}$(window).bind("resizeEnd",function(){console.log("---------------------------------------------------------------------resizeEnd"),sysproInterop.resizeSparklines(null)}),$(window).on("load",function(){sysproInterop.createKendoBinders(),sysproInterop.subscribeToFieldEvents()}),$(window).one("touchstart",function(){sysproInterop.isTouchDevice=!0});function WebView_Predictive_Search_Template(e,t){"*"===t&&(t=""),t=t.replace(".","\\."),t=t.replace("[","\\[");var a=new RegExp("("+t+")","gi"),o="<div class=\"text-complete syspro-predictivesearch-container\">";return o=o+"<div class=\"syspro-predictivesearch-item syspro-predictivesearch-image-container\"><img src=\" "+e.Image+"\" class=\"syspro-predictivesearch-image\" onerror=\"this.style.display = 'none'\"></img></div>",o=o+"<div class=\"syspro-predictivesearch-item\"><strong>"+e.Id.replace(a,"<span class=\"highlightedTerm\">$1</span>")+"</strong>",e.Description&&(o=o+"<div class=\"sys-400 sys-txt-md\"><strong>"+e.Description.replace(a,"<span class=\"highlightedTerm\">$1</span>")+"</strong></div>"),e.AdditionalField1&&(o=o+"<div class=\"sys-400 sys-txt-md\">"+e.AdditionalField1.replace(a,"<span class=\"highlightedTerm\">$1</span>")+"</div>"),e.AdditionalField2&&(o=o+"<div class=\"sys-400 sys-txt-md\">"+e.AdditionalField2.replace(a,"<span class=\"highlightedTerm\">$1</span>")+"</div>"),e.AdditionalField3&&(o=o+"<div class=\"sys-400 sys-txt-md\">"+e.AdditionalField3.replace(a,"<span class=\"highlightedTerm\">$1</span>")+"</div>"),o+="</div></div>",o}function OpenMenuScreen(){callLayerInterop.menuHtml&&($("#harness-container").html(""),$("#harness-container").html(callLayerInterop.menuHtml),$("body")[0].setAttribute("data-column-layout",callLayerInterop.menuDetail),$("[id=loading-cover]").fadeOut(),queryLayoutUIHelpers.initializeViewOnly(!1,null,null),queryLayoutUIHelpers.initializeToolbarEvents(),sysproInterop.viewModel=null,sysproInterop.toolbarModel=null)}var queryLayoutUIHelpers=new QueryLayoutUIHelpersClass,sysproInterop=new SYSPROInteropClass,callLayerInterop=sysproInterop.callLayerInterop,AvantiSearchInterop=new AvantiSearchClass(sysproInterop),AvantiSRSInterop={version:"8.0.0.0",//Builds the SRS MENU with no icons
BindSRSMenu:function BindSRSMenu(){try{console.log("00 - BindSRSMenu");sysproInterop.callBusinessObject("query","COMGET-SRS","<Query><Key><FileType>MF</FileType></Key></Query>","",function(e){console.log(e);try{for(i=0;i<e.ReportMenu.Report.length;i++){if(e.ReportMenu.Report[i].Report=AvantiSRSInterop.ConvertoArray(e.ReportMenu.Report[i].Report),e.ReportMenu.Report[i].Report.hasOwnProperty("length")&&e.ReportMenu.Report[i].Report.length)for(j=0;j<e.ReportMenu.Report[i].Report.length;j++)e.ReportMenu.Report[i].Report[j].Report=AvantiSRSInterop.ConvertoArray(e.ReportMenu.Report[i].Report[j].Report);e.ReportMenu.Report[i].Report.length||(e.ReportMenu.Report[i].Report=AvantiSRSInterop.ConvertoArray(Report))}}catch(t){}var t=new kendo.data.HierarchicalDataSource({data:e.ReportMenu.Report,schema:{model:{children:"Report"}}});console.log("DataSource: "+t),$("#treeview-right").kendoTreeView({dataSpriteCssClassField:"sprite",dataSource:t,select:function select(t){this.dataItem(t.node).Type&&(console.log("Report Id - "+this.dataItem(t.node).Id),sysproInterop.callPlugin("SRSMain","srstreeviewevent",this.dataItem(t.node).Id+"|"+this.dataItem(t.node).Description))},dataTextField:["Description","Description"]})},function(t){console.log("error:"+t.message)},!0,!1),console.log("99 - BindSRSMenu")}catch(e){sysproInterop.handleError(e.message,"BindSRSMenu")}},ConvertoArray:function ConvertoArray(e){return Array.isArray(e)?e:Array(e)},BinSRSArchive:function BinSRSArchive(){try{//alert("BinSRSArchive");
sysproInterop.callBusinessObject("query","COMQAR","<Query><Key><FileType>BA</FileType></Key></Query>","",function(e){console.log("COMQAR XML OUT"),console.log(e);var t=new kendo.data.HierarchicalDataSource({data:e.Query.ReportArchive.Company,schema:{model:{children:["Company","Year","Month","Operator"]}}});$("#treeview-report-archive").kendoTreeView({dataSource:t})})}catch(e){console.log(e.message),sysproInterop.handleError(e.message,"BinSRSArchive")}},Bind_Report_Queue:function Bind_Report_Queue(){try{sysproInterop.callPlugin("SRSMain","refreshreportqueue","")}catch(e){console.log("Bind_Report_Queue: "+e.message),sysproInterop.handleError(e.message,"Bind_Report_Queue")}},GetVersion:function GetVersion(){return AvantiSRSInterop.version}};(function(t){function _isChar(e){if("undefined"==typeof e.which)return!0;return!!("number"==typeof e.which&&0<e.which)&&!e.ctrlKey&&!e.metaKey&&!e.altKey&&8!=e.which// backspace
&&9!=e.which// tab
&&13!=e.which// enter
&&16!=e.which// shift
&&17!=e.which// ctrl
&&20!=e.which// caps lock
&&27!=e.which// escape
}function _addFormGroupFocus(e){var a=t(e);a.prop("disabled")||a.closest(".form-group").addClass("is-focused")}function _toggleDisabledState(e,t){var a;return a=e.hasClass("checkbox-inline")||e.hasClass("radio-inline")?e:e.closest(".checkbox").length?e.closest(".checkbox"):e.closest(".radio"),a.toggleClass("disabled",t)}function _toggleTypeFocus(e){var a=!1;(e.is(t.material.options.checkboxElements)||e.is(t.material.options.radioElements))&&(a=!0),e.closest("label").hover(function(){var e=t(this).find("input"),o=e.prop("disabled");a&&_toggleDisabledState(t(this),o),o||_addFormGroupFocus(e)},function(){_removeFormGroupFocus(t(this).find("input"))})}function _removeFormGroupFocus(e){t(e).closest(".form-group").removeClass("is-focused")}// Selector to select only not already processed elements
t.expr[":"].notmdproc=function(e){return!t(e).data("mdproc")},t.material={options:{// These options set what will be started by $.material.init()
validate:!0,input:!0,ripples:!1,checkbox:!0,togglebutton:!0,radio:!0,arrive:!0,autofill:!1,withRipples:".btn:not(.btn-link),.card-image,.navbar a:not(.withoutripple),.dropdown-menu a,.nav-tabs a:not(.withoutripple),.withripple,.pagination li:not(.active):not(.disabled) a:not(.withoutripple)",inputElements:"input.form-control, textarea.form-control, select.form-control",checkboxElements:".checkbox > label > input[type=checkbox], label.checkbox-inline > input[type=checkbox]",togglebuttonElements:".togglebutton > label > input[type=checkbox]",radioElements:".radio > label > input[type=radio], label.radio-inline > input[type=radio]"},checkbox:function checkbox(e){// Add fake-checkbox to material checkboxes
var a=t(e?e:this.options.checkboxElements).filter(":notmdproc").data("mdproc",!0).after("<span class='checkbox-material'><span class='check'></span></span>");_toggleTypeFocus(a)},togglebutton:function togglebutton(e){// Add fake-checkbox to material checkboxes
var a=t(e?e:this.options.togglebuttonElements).filter(":notmdproc").data("mdproc",!0).after("<span class='toggle'></span>");_toggleTypeFocus(a)},radio:function radio(e){// Add fake-radio to material radios
var a=t(e?e:this.options.radioElements).filter(":notmdproc").data("mdproc",!0).after("<span class='circle'></span><span class='check'></span>");_toggleTypeFocus(a)},input:function input(e){t(e?e:this.options.inputElements).filter(":notmdproc").data("mdproc",!0).each(function(){var e=t(this),a=e.closest(".form-group");// Requires form-group standard markup (will add it if necessary)
0!==a.length||"hidden"===e.attr("type")||e.attr("hidden")||(e.wrap("<div class='form-group'></div>"),a=e.closest(".form-group")),e.attr("data-hint")&&(e.after("<p class='help-block'>"+e.attr("data-hint")+"</p>"),e.removeAttr("data-hint"));// Legacy - Add label-floating if using old shorthand <input class="floating-label" placeholder="foo">
if(t.each({"input-lg":"form-group-lg","input-sm":"form-group-sm"},function(t,o){e.hasClass(t)&&(e.removeClass(t),a.addClass(o))}),e.hasClass("floating-label")){var o=e.attr("placeholder");e.attr("placeholder",null).removeClass("floating-label");var n=e.attr("id"),d="";n&&(d="for='"+n+"'"),a.addClass("label-floating"),e.after("<label "+d+"class='control-label'>"+o+"</label>")}// Set as empty if is empty (damn I must improve this...)
(null===e.val()||"undefined"==e.val()||""===e.val())&&a.addClass("is-empty"),0<a.find("input[type=file]").length&&a.addClass("is-fileinput")})},attachInputEventHandlers:function attachInputEventHandlers(){var e=this.options.validate;t(document).on("keydown paste",".form-control",function(a){_isChar(a)&&t(this).closest(".form-group").removeClass("is-empty")}).on("keyup change",".form-control",function(){var a=t(this),o=a.closest(".form-group"),n="undefined"==typeof a[0].checkValidity||a[0].checkValidity();""===a.val()?o.addClass("is-empty"):o.removeClass("is-empty"),e&&(n?o.removeClass("has-error"):o.addClass("has-error"))}).on("focus",".form-control, .form-group.is-fileinput",function(){_addFormGroupFocus(this)}).on("blur",".form-control, .form-group.is-fileinput",function(){_removeFormGroupFocus(this)})// make sure empty is added back when there is a programmatic value change.
//  NOTE: programmatic changing of value using $.val() must trigger the change event i.e. $.val('x').trigger('change')
.on("change",".form-group input",function(){var e=t(this);if("file"!=e.attr("type")){var a=e.closest(".form-group"),o=e.val();o?a.removeClass("is-empty"):a.addClass("is-empty")}})// set the fileinput readonly field with the name of the file
.on("change",".form-group.is-fileinput input[type='file']",function(){var e=t(this),a=e.closest(".form-group"),o="";t.each(this.files,function(e,t){o+=t.name+", "}),o=o.substring(0,o.length-2),o?a.removeClass("is-empty"):a.addClass("is-empty"),a.find("input.form-control[readonly]").val(o)})},ripples:function ripples(e){t(e?e:this.options.withRipples).ripples()},autofill:function autofill(){// This part of code will detect autofill when the page is loading (username and password inputs for example)
var e=setInterval(function(){t("input[type!=checkbox]").each(function(){var e=t(this);e.val()&&e.val()!==e.attr("value")&&e.trigger("change")})},100);// After 10 seconds we are quite sure all the needed inputs are autofilled then we can stop checking them
setTimeout(function(){clearInterval(e)},1e4)},attachAutofillEventHandlers:function attachAutofillEventHandlers(){// Listen on inputs of the focused form (because user can select from the autofill dropdown only when the input has focus)
var e;t(document).on("focus","input",function(){var a=t(this).parents("form").find("input").not("[type=file]");e=setInterval(function(){a.each(function(){var e=t(this);e.val()!==e.attr("value")&&e.trigger("change")})},100)}).on("blur",".form-group input",function(){clearInterval(e)})},init:function init(e){this.options=t.extend({},this.options,e);var a=t(document);t.fn.ripples&&this.options.ripples&&this.ripples(),this.options.input&&(this.input(),this.attachInputEventHandlers()),this.options.checkbox&&this.checkbox(),this.options.togglebutton&&this.togglebutton(),this.options.radio&&this.radio(),this.options.autofill&&(this.autofill(),this.attachAutofillEventHandlers()),document.arrive&&this.options.arrive&&(t.fn.ripples&&this.options.ripples&&a.arrive(this.options.withRipples,function(){t.material.ripples(t(this))}),this.options.input&&a.arrive(this.options.inputElements,function(){t.material.input(t(this))}),this.options.checkbox&&a.arrive(this.options.checkboxElements,function(){t.material.checkbox(t(this))}),this.options.radio&&a.arrive(this.options.radioElements,function(){t.material.radio(t(this))}),this.options.togglebutton&&a.arrive(this.options.togglebuttonElements,function(){t.material.togglebutton(t(this))}))}}})(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e(require("jquery")):e(jQuery)}(function(t){var a={options:{optionClass:"",dropdownClass:"",autoinit:!1,callback:!1,onSelected:!1,destroy:function destroy(e){this.destroy(e)},dynamicOptLabel:"Add a new option..."},init:function init(o){function initElement(n){// Don't do anything if this is not a select or if this select was already initialized, or if it is busy being initialized.
if(!(n.data("dropdownjs")||!n.is("select")||n.data("dropdownjsbusy"))){n.attr("data-dropdownjsbusy",!0);// Is it a multi select?
var d=n.attr("multiple"),s=n.attr("data-dynamic-opts"),l=t(),r=t("<div></div>");// Does it allow to create new options dynamically?
r.addClass("dropdownjs").addClass(o.dropdownClass),r.data("select",n);// Create the fake input used as "select" element and cache it as $input
var c=t("<input type=text readonly class=fakeinput>");t.material&&c.data("mdproc",!0),r.append(c);// Create the UL that will be used as dropdown and cache it AS $ul
var p=t("<ul></ul>");p.data("select",n),r.append(p),c.attr("placeholder",n.attr("placeholder")),n.find("option").each(function(){// Cache $(this)
var e=t(this);a._addOption(p,e)}),s&&(l=t("<li class=dropdownjs-add></li>"),l.append("<input>"),l.find("input").attr("placeholder",o.dynamicOptLabel),p.append(l));// Cache the dropdown options
r.find("li");// If is a single select, selected the first one or the last with selected attribute
if(!d){var u;u=n.find(":selected").length?n.find(":selected").last():n.find("option, li").first(),a._select(r,u)}else{var m=[],g=n.val();for(var h in g)m.push("li[value="+g[h]+"]");if(0<m.length){var e=r.find(m.join(","));e.removeClass("selected"),a._select(r,e)}}// Transfer the classes of the select to the input dropdown
c.addClass(n[0].className),n.hide().attr("data-dropdownjs",!0),n.after(r),o.callback&&o.callback(r),p.on("click","li:not(.dropdownjs-add)",function(){a._select(r,t(this)),n.change()}),p.on("keydown","li:not(.dropdownjs-add)",function(o){return 27===o.which||9===o.which?(t(".dropdownjs > ul > li").attr("tabindex",-1),c.removeClass("focus").blur()):32!==o.which||t(o.target).is("input")?void 0:(a._select(r,t(this)),!1)}),t(document).keydown(function(o){var e=p.find("li");if(t(o.currentTarget.activeElement).is(c)){var d=o.keyCode,s=e.filter(".selected"),l;if(40==d||38==d||13==d||9==d)return o.preventDefault(),9==d?(p.closest(".form-group").next().hasClass("form-group")&&p.closest(".form-group").next().find("input, select, textarea").focus(),c.removeClass("focus").blur()):13==d?(s.length?(a._select(r,s),l=s):(a._select(r,e.eq(0)),l=e.eq(0)),l.addClass("selected"),n.change(),c.removeClass("focus").blur()):void(e.removeClass("selected"),40==d?!s.length||s.is(":last-child")?l=e.eq(0):l=s.next():38==d&&(!s.length||s.is(":first-child")?l=e.last():l=s.prev()),l.addClass("selected"))}}),p.on("focus","li:not(.dropdownjs-add)",function(){n.is(":disabled")||c.addClass("focus")}),s&&s.length&&l.on("keydown",function(a){if(13===a.which){var e=t("<option>"),o=l.find("input").val();l.find("input").val(""),e.attr("value",o),e.text(o),n.append(e)}}),n.on("DOMNodeInserted",function(o){var e=t(o.target);e.val()&&e.val().length&&("SELECT"===o.target.tagName||(a._addOption(p,e),p.find("li").not(".dropdownjs-add").attr("tabindex",0)))}),n.on("DOMNodeRemoved",function(t){var e=t.target.getAttribute("value");p.find("li[value='"+e+"']").remove();var o;setTimeout(function(){o=n.find(":selected").length?n.find(":selected").last():n.find("option, li").first(),a._select(r,o)},100)}),n.on("change",function(o){t(o.target);if(!d){var e;e=n.find(":selected").length?n.find(":selected").last():n.find("option, li").first(),a._select(r,e)}else;}),c.on("click focus",function(a){if(a.stopPropagation(),!n.is(":disabled")){//$(".dropdownjs > ul > li").not(".dropdownjs-add").attr("tabindex", 0);
// Set height of the dropdown
if(t(".dropdownjs > ul > li").attr("tabindex",-1),t(".dropdownjs > input").not(t(this)).removeClass("focus").blur(),0<t(this).parents(".window-container").length)var e={top:t(this).offset().top-t(this).closest(".k-window").offset().top,left:t(this).offset().left-t(this).closest(".k-window").offset().left,bottom:t(this).closest(".k-window").height()+t(this).closest(".k-window").offset().top-t(this).offset().top,right:t(this).offset().right-t(this).closest(".k-window").offset().right};else var e={top:t(this).offset().top-t(document).scrollTop(),left:t(this).offset().left-t(document).scrollLeft(),bottom:t(window).height()-(t(this).offset().top-t(document).scrollTop()),right:t(window).width()-(t(this).offset().left-t(document).scrollLeft())};var o=e.bottom;// Decide if place the dropdown below or above the input
200>o&&e.top>e.bottom?(o=e.top,p.attr("placement","top-left")):p.attr("placement","bottom-left"),t(this).next("ul").css("max-height",o-20),t(this).addClass("focus")}})}}o=o?t.extend(a.options,o):a.options,o.autoinit&&t(document).on("DOMNodeInserted",function(a){var e=t(a.target);e.is("select")||(e=e.find("select")),e.is(o.autoinit)&&e.each(function(){initElement(t(this))})});var n=t(this).selector;// Close every dropdown on click outside
// Loop trough elements
t(document).on("click",function(a){// Don't close the multi dropdown if user is clicking inside it
t(a.target).hasClass("dropdownjs")||t(a.target).parents(n).attr("multiple")&&t(a.target).parents(".dropdownjs").length||t(a.target).parents(".dropdownjs-add").length||t(a.target).is(".dropdownjs-add")||(// Close opened dropdowns
t(".dropdownjs > ul > li").attr("tabindex",-1),t(".dropdownjs input.focus").removeClass("focus"));// Don't close the dropdown if user is clicking inside the dynamic-opts widget
}),t(this).each(function(){initElement(t(this))})},select:function select(e){var o=t(this).find("[value=\""+e+"\"]");a._select(t(this),o)},_select:function _select(e,a){if(!a.is(".dropdownjs-add")){// Get dropdown's elements
var o=e.data("select"),n=e.find("input.fakeinput");if(o){// Is it a multi select?
var d=o.attr("multiple"),s=e.find("li");// Cache the dropdown options
// Behavior for multiple select
if(d){a.toggleClass("selected"),a.each(function(){var e=o.find("[value=\""+t(this).attr("value")+"\"]");e.prop("selected",t(this).hasClass("selected"))});// Add or remove the value from the input
var l=[];s.each(function(){t(this).hasClass("selected")&&l.push(t(this).text())}),n.val(l.join(", "))}// Behavior for single select
d||(a.is("li")&&s.not(a).removeClass("selected"),a.addClass("selected"),o.val(a.attr("value")),n.val(a.text().trim())),t.material&&(n.val().trim()?o.removeClass("empty"):o.addClass("empty")),this.options.onSelected&&this.options.onSelected(a.attr("value"))}}},_addOption:function _addOption(e,a){// Create the option
var o=t("<li></li>");// Style the option
// Set the value of the option
o.addClass(this.options.optionClass),a.text()?o.text(a.text()):o.html("&nbsp;"),o.attr("value",a.val()),e.data("select").attr("data-dynamic-opts")&&(o.append("<span class=close></span>"),o.find(".close").on("click",function(){o.remove(),a.remove()})),a.prop("selected")&&(o.attr("selected",!0),o.addClass("selected")),e.find(".dropdownjs-add").length?e.find(".dropdownjs-add").before(o):e.append(o)},destroy:function destroy(e){t(e).show().removeAttr("data-dropdownjs").next(".dropdownjs").remove()}};t.fn.dropdown=function(e){return("function"==typeof a[e]&&a[e](this),a[e])?a[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"===_typeof(e)|!e?a.init.apply(this,arguments):void t.error("Method "+e+" does not exists on jQuery.dropdown")}});//// mutationobserver-shim v0.3.2 (github.com/megawac/MutationObserver.js)
//// Authors: Graeme Yeates (github.com/megawac)
//window.MutationObserver =
//    window.MutationObserver ||
//    (function (w) {
//        function v(a) {
//            this.i = [];
//            this.m = a;
//        }
//        function I(a) {
//            (function c() {
//                var d = a.takeRecords();
//                d.length && a.m(d, a);
//                a.h = setTimeout(c, v._period);
//            })();
//        }
//        function p(a) {
//            var b = {
//                type: null,
//                target: null,
//                addedNodes: [],
//                removedNodes: [],
//                previousSibling: null,
//                nextSibling: null,
//                attributeName: null,
//                attributeNamespace: null,
//                oldValue: null,
//            },
//                c;
//            for (c in a) b[c] !== w && a[c] !== w && (b[c] = a[c]);
//            return b;
//        }
//        function J(a, b) {
//            var c = C(a, b);
//            return function (d) {
//                var f = d.length,
//                    n;
//                b.a &&
//                    3 === a.nodeType &&
//                    a.nodeValue !== c.a &&
//                    d.push(
//                        new p({
//                            type: "characterData",
//                            target: a,
//                            oldValue: c.a,
//                        })
//                    );
//                b.b && c.b && A(d, a, c.b, b.f);
//                if (b.c || b.g) n = K(d, a, c, b);
//                if (n || d.length !== f) c = C(a, b);
//            };
//        }
//        function L(a, b) {
//            return b.value;
//        }
//        function M(a, b) {
//            return "style" !== b.name ? b.value : a.style.cssText;
//        }
//        function A(a, b, c, d) {
//            for (var f = {}, n = b.attributes, k, g, x = n.length; x--;)
//                (k = n[x]),
//                    (g = k.name),
//                    (d && d[g] === w) ||
//                    (D(b, k) !== c[g] &&
//                        a.push(
//                            p({
//                                type: "attributes",
//                                target: b,
//                                attributeName: g,
//                                oldValue: c[g],
//                                attributeNamespace: k.namespaceURI,
//                            })
//                        ),
//                        (f[g] = !0));
//            for (g in c)
//                f[g] ||
//                    a.push(
//                        p({
//                            target: b,
//                            type: "attributes",
//                            attributeName: g,
//                            oldValue: c[g],
//                        })
//                    );
//        }
//        function K(a, b, c, d) {
//            function f(b, c, f, k, y) {
//                var g = b.length - 1;
//                y = -~((g - y) / 2);
//                for (var h, l, e; (e = b.pop());)
//                    (h = f[e.j]),
//                        (l = k[e.l]),
//                        d.c &&
//                        y &&
//                        Math.abs(e.j - e.l) >= g &&
//                        (a.push(
//                            p({
//                                type: "childList",
//                                target: c,
//                                addedNodes: [h],
//                                removedNodes: [h],
//                                nextSibling: h.nextSibling,
//                                previousSibling: h.previousSibling,
//                            })
//                        ),
//                            y--),
//                        d.b && l.b && A(a, h, l.b, d.f),
//                        d.a &&
//                        3 === h.nodeType &&
//                        h.nodeValue !== l.a &&
//                        a.push(
//                            p({
//                                type: "characterData",
//                                target: h,
//                                oldValue: l.a,
//                            })
//                        ),
//                        d.g && n(h, l);
//            }
//            function n(b, c) {
//                for (
//                    var g = b.childNodes,
//                    q = c.c,
//                    x = g.length,
//                    v = q ? q.length : 0,
//                    h,
//                    l,
//                    e,
//                    m,
//                    t,
//                    z = 0,
//                    u = 0,
//                    r = 0;
//                    u < x || r < v;
//                )
//                    (m = g[u]),
//                        (t = (e = q[r]) && e.node),
//                        m === t
//                            ? (d.b && e.b && A(a, m, e.b, d.f),
//                                d.a &&
//                                e.a !== w &&
//                                m.nodeValue !== e.a &&
//                                a.push(
//                                    p({
//                                        type: "characterData",
//                                        target: m,
//                                        oldValue: e.a,
//                                    })
//                                ),
//                                l && f(l, b, g, q, z),
//                                d.g &&
//                                (m.childNodes.length ||
//                                    (e.c && e.c.length)) &&
//                                n(m, e),
//                                u++ ,
//                                r++)
//                            : ((k = !0),
//                                h || ((h = {}), (l = [])),
//                                m &&
//                                (h[(e = E(m))] ||
//                                    ((h[e] = !0),
//                                        -1 === (e = F(q, m, r, "node"))
//                                            ? d.c &&
//                                            (a.push(
//                                                p({
//                                                    type: "childList",
//                                                    target: b,
//                                                    addedNodes: [m],
//                                                    nextSibling: m.nextSibling,
//                                                    previousSibling:
//                                                        m.previousSibling,
//                                                })
//                                            ),
//                                                z++)
//                                            : l.push({ j: u, l: e })),
//                                    u++),
//                                t &&
//                                t !== g[u] &&
//                                (h[(e = E(t))] ||
//                                    ((h[e] = !0),
//                                        -1 === (e = F(g, t, u))
//                                            ? d.c &&
//                                            (a.push(
//                                                p({
//                                                    type: "childList",
//                                                    target: c.node,
//                                                    removedNodes: [t],
//                                                    nextSibling: q[r + 1],
//                                                    previousSibling: q[r - 1],
//                                                })
//                                            ),
//                                                z--)
//                                            : l.push({ j: e, l: r })),
//                                    r++));
//                l && f(l, b, g, q, z);
//            }
//            var k;
//            n(b, c);
//            return k;
//        }
//        function C(a, b) {
//            var c = !0;
//            return (function f(a) {
//                var k = { node: a };
//                !b.a || (3 !== a.nodeType && 8 !== a.nodeType)
//                    ? (b.b &&
//                        c &&
//                        1 === a.nodeType &&
//                        (k.b = G(a.attributes, function (c, f) {
//                            if (!b.f || b.f[f.name]) c[f.name] = D(a, f);
//                            return c;
//                        })),
//                        c &&
//                        (b.c || b.a || (b.b && b.g)) &&
//                        (k.c = N(a.childNodes, f)),
//                        (c = b.g))
//                    : (k.a = a.nodeValue);
//                return k;
//            })(a);
//        }
//        function E(a) {
//            try {
//                return a.id || (a.mo_id = a.mo_id || H++);
//            } catch (b) {
//                try {
//                    return a.nodeValue;
//                } catch (c) {
//                    return H++;
//                }
//            }
//        }
//        function N(a, b) {
//            for (var c = [], d = 0; d < a.length; d++) c[d] = b(a[d], d, a);
//            return c;
//        }
//        function G(a, b) {
//            for (var c = {}, d = 0; d < a.length; d++) c = b(c, a[d], d, a);
//            return c;
//        }
//        function F(a, b, c, d) {
//            for (; c < a.length; c++) if ((d ? a[c][d] : a[c]) === b) return c;
//            return -1;
//        }
//        v._period = 30;
//        v.prototype = {
//            observe: function (a, b) {
//                for (
//                    var c = {
//                        b: !!(
//                            b.attributes ||
//                            b.attributeFilter ||
//                            b.attributeOldValue
//                        ),
//                        c: !!b.childList,
//                        g: !!b.subtree,
//                        a: !(!b.characterData && !b.characterDataOldValue),
//                    },
//                    d = this.i,
//                    f = 0;
//                    f < d.length;
//                    f++
//                )
//                    d[f].s === a && d.splice(f, 1);
//                b.attributeFilter &&
//                    (c.f = G(b.attributeFilter, function (a, b) {
//                        a[b] = !0;
//                        return a;
//                    }));
//                d.push({ s: a, o: J(a, c) });
//                this.h || I(this);
//            },
//            takeRecords: function () {
//                for (var a = [], b = this.i, c = 0; c < b.length; c++)
//                    b[c].o(a);
//                return a;
//            },
//            disconnect: function () {
//                this.i = [];
//                clearTimeout(this.h);
//                this.h = null;
//            },
//        };
//        var B = document.createElement("i");
//        B.style.top = 0;
//        var D = (B = "null" != B.attributes.style.value) ? L : M,
//            H = 1;
//        return v;
//    })(void 0);
////# sourceMappingURL=mutationobserver.map
var sysproSessionAdmin={bindSessionsGrid:function bindSessionsGrid(e){callLayerInterop.callFusionService("api/UXAdminWeb/GetSYSPROProcesses",null,"GET",function(t){if(t){for(var a=[],o=0,n;o<t.length;o++)n=sysproSessionAdmin.createFlatSession(t[o]),a.push(n);a.length&&$(document).ready(function(){var t=$(".sysproRunningProcessGrid",e);$(t).kendoGrid({dataSource:{data:a},height:350,scrollable:!0,sortable:!0,filterable:!0,columnMenu:!0,columns:[{command:[{name:"Logout",visible:function visible(e){return e.SessionId!==sysproInterop.currentUserSession.FusionSessionId},click:function click(a){a.preventDefault();// e.target is the DOM element representing the button
var e=$(a.target).closest("tr"),o=this.dataItem(e);// get the current table row (tr)
// get the data bound to the current table row
callLayerInterop.callFusionService("api/UXAdminWeb/CloseSYSPROProcess",{SessionId:o.SessionId},"GET",function(a){if(a){var o=$(t).data("kendoGrid");o.removeRow(e)}})}},{name:"Logout",visible:function visible(e){return e.SessionId===sysproInterop.currentUserSession.FusionSessionId},className:"btn-danger-important",click:function click(a){a.preventDefault();// e.target is the DOM element representing the button
var e=$(a.target).closest("tr"),o=this.dataItem(e);// get the current table row (tr)
// get the data bound to the current table row
alert("Logout session: "+o.SessionId),callLayerInterop.callFusionService("api/UXAdminWeb/CloseSYSPROProcess",{SessionId:o.SessionId},"GET",function(a){if(a){var o=$(t).data("kendoGrid");o.removeRow(e)}})}}],width:"90px"},{field:"Id",title:"Process ID",width:"130px",hidden:!0},{field:"SessionId",title:"Session ID",width:"130px",hidden:!0},{field:"Operator",title:"User ID",width:"130px",hidden:!0},{field:"OperatorName",title:"User",width:"130px"},{field:"Company",title:"Company ID",width:"130px",hidden:!0},{field:"CompanyName",title:"Company",width:"130px"},{field:"Program",title:"Program ID",width:"130px",hidden:!0},{field:"WindowTitle",title:"Program",width:"130px"},{field:"LastAccessed",title:"Time Accessed",width:"130px",hidden:!0},{field:"LastAccessedRelative",title:"Accessed",width:"130px"},{field:"Responding",title:"Status",width:"130px"},{field:"TotalProcessorTime",title:"CPU",width:"130px",hidden:!0},{field:"StartTime",title:"Started",width:"130px",hidden:!0},{field:"Age",title:"Age",width:"130px",hidden:!0},{field:"DataUsageBrowser",title:"User Data",width:"130px",format:"{0:#,# K}"},{field:"DataUsageServer",title:"Server Data",width:"130px",hidden:!0},{field:"WorkingSetM",title:"Memory",width:"130px",format:"{0:#,# M}"}]})})}})},createFlatSession:function createFlatSession(e){var t={},a=JSON.parse(e.CustomSettings._SYS_.SessionDetails),o=JSON.parse(e.CustomSettings._SYS_.WindowDetails);return t.Id=e.ProcessInfo.ProcessId,t.SessionId=e.SessionInfo.SessionId,t.Operator=a.Operator,t.OperatorName=a.OperatorName,t.Company=a.Company,t.CompanyName=a.CompanyName,t.Program=o.Program,t.WindowTitle=o.Title,t.LastAccessed=new Date(e.SessionInfo.LastAccessed),t.LastAccessedRelative=moment(t.LastAccessed).fromNow(),t.Responding=e.ProcessInfo.Responding?"Healthy":"Not Responding",t.TotalProcessorTime=moment(e.ProcessInfo.TotalProcessorTime,"hh:mm:ss").from(moment().startOf("day"),!0),t.StartTime=new Date(e.ProcessInfo.StartTime),t.Age=moment(t.StartTime).fromNow(!0),t.DataUsageBrowser=e.CustomSettings._SYS_.DataUsageBrowserToService/1024,t.DataUsageServer=0,t.WorkingSetM=e.ProcessInfo.WorkingSet/1024/1024,t.WorkingSet=e.ProcessInfo.WorkingSet,t}};/* Tree()
 * ======
 * Converts a nested list into a multilevel
 * tree view menu.
 *
 * @Usage: $('.my-menu').tree(options)
 *         or add [data-widget="tree"] to the ul element
 *         Pass any option as data-option="value"
 */+function(e){'use strict';// Plugin Definition
// =================
function Plugin(a){return this.each(function(){var o=e(this),n=o.data("lte.tree");if(!n){var s=e.extend({},t,o.data(),"object"==_typeof(a)&&a);o.data("lte.tree",new d(o,s))}})}var t={animationSpeed:300,accordion:!0,followLink:!1,trigger:".treeview a"},a={tree:".tree",treeview:".treeview",treeviewMenu:".treeview-menu",open:".menu-open, .active",li:"li",data:"[data-widget=\"tree\"]",active:".active"},o={open:"menu-open",tree:"tree"},n={collapsed:"collapsed.tree",expanded:"expanded.tree"},d=function(t,n){this.element=t,this.options=n,e(this.element).addClass(o.tree),e(a.treeview+a.active,this.element).addClass(o.open),this._setUpListeners()};d.prototype.toggle=function(e,t){var n=e.next(a.treeviewMenu),d=e.parent(),s=d.hasClass(o.open);d.is(a.treeview)&&((!this.options.followLink||"#"===e.attr("href"))&&t.preventDefault(),s?this.collapse(n,d):this.expand(n,d))},d.prototype.expand=function(t,d){var s=e.Event(n.expanded);if(this.options.accordion){var l=d.siblings(a.open),r=l.children(a.treeviewMenu);this.collapse(r,l)}d.addClass(o.open),t.slideDown(this.options.animationSpeed,function(){e(this.element).trigger(s)}.bind(this))},d.prototype.collapse=function(t,d){var s=e.Event(n.collapsed);t.find(a.open).removeClass(o.open),d.removeClass(o.open),t.slideUp(this.options.animationSpeed,function(){t.find(a.open+" > "+a.treeview).slideUp(),e(this.element).trigger(s)}.bind(this))},d.prototype._setUpListeners=function(){var t=this;e(this.element).on("click",this.options.trigger,function(a){t.toggle(e(this),a)})};var s=e.fn.tree;// No Conflict Mode
// ================
// Tree Data API
// =============
e.fn.tree=Plugin,e.fn.tree.Constructor=d,e.fn.tree.noConflict=function(){return e.fn.tree=s,this},e(window).on("load",function(){e(a.data).each(function(){Plugin.call(e(this))})})}(jQuery),!function(t){"use strict";/* COMBOBOX PUBLIC CLASS DEFINITION
     * ================================ */var e=function(e,a){this.options=t.extend({},t.fn.combobox.defaults,a),this.template=this.options.template||this.template,this.$source=t(e),this.$container=this.setup(),this.$element=this.$container.find("input[type=text]"),this.$target=this.$container.find("input[type=hidden]"),this.$button=this.$container.find(".dropdown-toggle"),this.$menu=t(this.options.menu).appendTo("body"),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.newOptionsAllowed=this.options.newOptionsAllowed,this.shown=!1,this.selected=!1,this.refresh(),this.transferAttributes(),this.listen()};/* COMBOBOX PLUGIN DEFINITION
     * =========================== */e.prototype={constructor:e,setup:function setup(){var e=t(this.template());return this.$source.before(e),this.$source.hide(),e},disable:function disable(){this.$element.prop("disabled",!0),this.$button.attr("disabled",!0),this.disabled=!0,this.$container.addClass("combobox-disabled")},enable:function enable(){this.$element.prop("disabled",!1),this.$button.attr("disabled",!1),this.disabled=!1,this.$container.removeClass("combobox-disabled")},parse:function parse(){var e=this,a={},o=[],n=!1,d="";return this.$source.find("option").each(function(){var s=t(this);return""===s.val()?void(e.options.placeholder=s.text()):void(a[s.text()]=s.val(),o.push(s.text()),s.prop("selected")&&(n=s.text(),d=s.val()))}),this.map=a,n&&(this.$element.val(n),this.$target.val(d),this.$container.addClass("combobox-selected"),this.selected=!0),o},transferAttributes:function transferAttributes(){// Remove from source otherwise form will pass parameter twice.
this.options.placeholder=this.$source.attr("data-placeholder")||this.options.placeholder,"undefined"!==this.options.appendId&&this.$element.attr("id",this.$source.attr("id")+this.options.appendId),this.$element.attr("placeholder",this.options.placeholder),this.$target.prop("name",this.$source.prop("name")),this.$target.val(this.$source.val()),this.$source.removeAttr("name"),this.$element.attr("required",this.$source.attr("required")),this.$element.attr("rel",this.$source.attr("rel")),this.$element.attr("title",this.$source.attr("title")),this.$element.attr("class",this.$source.attr("class")),this.$element.attr("tabindex",this.$source.attr("tabindex")),this.$source.removeAttr("tabindex"),this.$source.attr("disabled")!==void 0&&this.disable()},select:function select(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).trigger("change"),this.$target.val(this.map[e]).trigger("change"),this.$source.val(this.map[e]).trigger("change"),this.$container.addClass("combobox-selected"),this.selected=!0,this.hide()},updater:function updater(e){return e},show:function show(){var e=t.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:e.top+e.height,left:e.left}).show(),t(".dropdown-menu").on("mousedown",t.proxy(this.scrollSafety,this)),this.shown=!0,this},hide:function hide(){return this.$menu.hide(),t(".dropdown-menu").off("mousedown",t.proxy(this.scrollSafety,this)),this.$element.on("blur",t.proxy(this.blur,this)),this.shown=!1,this},lookup:function lookup(){return this.query=this.$element.val(),this.process(this.source)},process:function process(e){var a=this;return e=t.grep(e,function(e){return a.matcher(e)}),e=this.sorter(e),e.length?this.render(e.slice(0,this.options.items)).show():this.shown?this.hide():this},template:function template(){return"2"==this.options.bsVersion?"<div class=\"combobox-container\"><input type=\"hidden\" /> <div class=\"input-append\"> <input type=\"text\" autocomplete=\"off\" /> <span class=\"add-on dropdown-toggle\" data-dropdown=\"dropdown\"> <span class=\"caret\"/> <i class=\"icon-remove\"/> </span> </div> </div>":"<div class=\"combobox-container\"> <input type=\"hidden\" /> <div class=\"input-group\"> <input type=\"text\" autocomplete=\"off\" /> <span class=\"input-group-addon dropdown-toggle\" data-dropdown=\"dropdown\"> <span class=\"material-icons pulldown\">arrow_drop_down</span>  </span> </div> </div>"},matcher:function matcher(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function sorter(e){for(var t=[],a=[],o=[],n;n=e.shift();)n.toLowerCase().indexOf(this.query.toLowerCase())?~n.indexOf(this.query)?a.push(n):o.push(n):t.push(n);return t.concat(a,o)},highlighter:function highlighter(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function render(e){var a=this;return e=t(e).map(function(e,o){return e=t(a.options.item).attr("data-value",o),e.find("a").html(a.highlighter(o)),e[0]}),e.first().addClass("active"),this.$menu.html(e),this},next:function(){var e=this.$menu.find(".active").removeClass("active"),a=e.next();a.length||(a=t(this.$menu.find("li")[0])),a.addClass("active")},prev:function(){var e=this.$menu.find(".active").removeClass("active"),t=e.prev();t.length||(t=this.$menu.find("li").last()),t.addClass("active")},toggle:function toggle(){this.disabled||(this.$container.hasClass("combobox-selected")?this.lookup():this.shown?this.hide():this.lookup())},scrollSafety:function scrollSafety(t){"UL"==t.target.tagName&&this.$element.off("blur")},clearElement:function clearElement(){this.$element.val("").focus()},clearTarget:function clearTarget(){this.$source.val(""),this.$target.val(""),this.$container.removeClass("combobox-selected"),this.selected=!1},triggerChange:function triggerChange(){this.$source.trigger("change")},refresh:function refresh(){this.source=this.parse(),this.options.items=this.source.length},listen:function listen(){this.$element.on("focus",t.proxy(this.focus,this)).on("blur",t.proxy(this.blur,this)).on("keypress",t.proxy(this.keypress,this)).on("keyup",t.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",t.proxy(this.keydown,this)),this.$menu.on("click",t.proxy(this.click,this)).on("mouseenter","li",t.proxy(this.mouseenter,this)).on("mouseleave","li",t.proxy(this.mouseleave,this)),this.$button.on("click",t.proxy(this.toggle,this))},eventSupported:function eventSupported(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t="function"==typeof this.$element[e]),t},move:function move(t){if(this.shown){switch(t.keyCode){case 9:// tab
case 13:// enter
case 27:t.preventDefault();break;case 38:t.preventDefault(),this.prev(),this.fixMenuScroll();break;case 40:t.preventDefault(),this.next(),this.fixMenuScroll();}t.stopPropagation()}},fixMenuScroll:function fixMenuScroll(){var e=this.$menu.find(".active");if(e.length){var t=e.position().top,a=t+e.height(),o=this.$menu.scrollTop(),n=this.$menu.height();a>n?this.$menu.scrollTop(o+a-n):0>t&&this.$menu.scrollTop(o+t)}},keydown:function keydown(a){this.suppressKeyPressRepeat=~t.inArray(a.keyCode,[40,38,9,13,27]),this.move(a)},keypress:function keypress(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function keyup(t){switch(t.keyCode){case 40:this.shown||this.toggle();break;case 39:// right arrow
case 38:// up arrow
case 37:// left arrow
case 36:// home
case 35:// end
case 16:// shift
case 17:// ctrl
case 18:// alt
break;case 9:// tab
case 13:// enter
if(!this.shown)return;this.select();break;case 27:// escape
if(!this.shown)return;this.hide();break;default:this.clearTarget(),this.lookup();}t.stopPropagation(),t.preventDefault()},focus:function focus(){this.focused=!0},blur:function blur(a){if(!(a.relatedTarget&&1==t(a.relatedTarget).closest(this.$container).length)){var e=this;this.focused=!1;var o=this.$element.val();this.newOptionsAllowed?0===this.length&&this.$target.val(o):!this.selected&&""!==o&&(this.$element.val(""),this.$source.val("").trigger("change"),this.$target.val("").trigger("change")),!this.mousedover&&this.shown&&setTimeout(function(){e.hide()},200)}},click:function click(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function mouseenter(a){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),t(a.currentTarget).addClass("active")},mouseleave:function mouseleave(){this.mousedover=!1}},t.fn.combobox=function(a){return this.each(function(){var o=t(this),n=o.data("combobox"),d="object"==_typeof(a)&&a;n||o.data("combobox",n=new e(this,d)),"string"==typeof a&&n[a]()})},t.fn.combobox.defaults={bsVersion:"3",menu:"<ul class=\"typeahead typeahead-long dropdown-menu\"></ul>",item:"<li><a href=\"#\"></a></li>",newOptionsAllowed:!0},t.fn.combobox.Constructor=e}(window.jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?e(require("jquery")):e(jQuery)}(function(t){var e=Math.abs,a=Math.min,n=Math.max,s=Math.floor;function UTCDate(){return new Date(Date.UTC.apply(Date,arguments))}function UTCToday(){var e=new Date;return UTCDate(e.getFullYear(),e.getMonth(),e.getDate())}function isUTCEquals(e,t){return e.getUTCFullYear()===t.getUTCFullYear()&&e.getUTCMonth()===t.getUTCMonth()&&e.getUTCDate()===t.getUTCDate()}function alias(e,a){return function(){return void 0!==a&&t.fn.datepicker.deprecated(a),this[e].apply(this,arguments)}}function isValidDate(e){return e&&!isNaN(e.getTime())}function opts_from_el(e,a){function re_lower(e,t){return t.toLowerCase()}// Derive options from element data-attrs
var o=t(e).data(),n={},d=new RegExp("^"+a.toLowerCase()+"([A-Z])"),s;for(var l in a=new RegExp("^"+a.toLowerCase()),o)a.test(l)&&(s=l.replace(d,re_lower),n[s]=o[l]);return n}function opts_from_locale(e){// Derive options from locale plugins
var a={};// Check if "de-DE" style date is available, if not language should
// fallback to 2 letter code eg "de"
if(h[e]||(e=e.split("-")[0],!!h[e])){var o=h[e];return t.each(g,function(e,t){t in o&&(a[t]=o[t])}),a}}var l=function(){var e={get:function get(e){return this.slice(e)[0]},contains:function contains(e){// Array.indexOf is not cross-browser;
// $.inArray doesn't work with Dates
for(var t=e&&e.valueOf(),a=0,o=this.length;a<o;a++)// Use date arithmetic to allow dates with different times to match
if(0<=this[a].valueOf()-t&&this[a].valueOf()-t<86400000)return a;return-1},remove:function remove(e){this.splice(e,1)},replace:function replace(e){e&&(!t.isArray(e)&&(e=[e]),this.clear(),this.push.apply(this,e))},clear:function clear(){this.length=0},copy:function copy(){var e=new l;return e.replace(this),e}};return function(){var o=[];return o.push.apply(o,arguments),t.extend(o,e),o}}(),r=function(e,a){t.data(e,"datepicker",this),this._process_options(a),this.dates=new l,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=t(e),this.isInput=this.element.is("input"),this.inputField=this.isInput?this.element:this.element.find("input"),this.component=!!this.element.hasClass("date")&&this.element.find(".add-on, .input-group-addon, .btn"),this.component&&0===this.component.length&&(this.component=!1),this.isInline=!this.component&&this.element.is("div"),this.picker=t(f.template),this._check_template(this.o.templates.leftArrow)&&this.picker.find(".prev").html(this.o.templates.leftArrow),this._check_template(this.o.templates.rightArrow)&&this.picker.find(".next").html(this.o.templates.rightArrow),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.o.calendarWeeks&&this.picker.find(".datepicker-days .datepicker-switch, thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(e,t){return+t+1}),this._process_options({startDate:this._o.startDate,endDate:this._o.endDate,daysOfWeekDisabled:this.o.daysOfWeekDisabled,daysOfWeekHighlighted:this.o.daysOfWeekHighlighted,datesDisabled:this.o.datesDisabled}),this._allow_update=!1,this.setViewMode(this.o.startView),this._allow_update=!0,this.fillDow(),this.fillMonths(),this.update(),this.isInline&&this.show()};// Picker object
r.prototype={constructor:r,_resolveViewName:function _resolveViewName(e){return t.each(f.viewModes,function(a,o){if(e===a||-1!==t.inArray(e,o.names))return e=a,!1}),e},_resolveDaysOfWeek:function _resolveDaysOfWeek(e){return t.isArray(e)||(e=e.split(/[,\s]*/)),t.map(e,Number)},_check_template:function _check_template(e){try{// If empty
if(e===void 0||""===e)return!1;// If no html, everything ok
if(0>=(e.match(/[<>]/g)||[]).length)return!0;// Checking if html is fine
var a=t(e);return 0<a.length}catch(e){return!1}},_process_options:function _process_options(e){this._o=t.extend({},this._o,e);// Processed options
var s=this.o=t.extend({},this._o),o=s.language;// Check if "de-DE" style date is available, if not language should
// fallback to 2 letter code eg "de"
h[o]||(o=o.split("-")[0],!h[o]&&(o=m.language)),s.language=o,s.startView=this._resolveViewName(s.startView),s.minViewMode=this._resolveViewName(s.minViewMode),s.maxViewMode=this._resolveViewName(s.maxViewMode),s.startView=n(this.o.minViewMode,a(this.o.maxViewMode,s.startView)),!0!==s.multidate&&(s.multidate=+s.multidate||!1,!1!==s.multidate&&(s.multidate=n(0,s.multidate))),s.multidateSeparator+="",s.weekStart%=7,s.weekEnd=(s.weekStart+6)%7;var l=f.parseFormat(s.format);s.startDate!==-Infinity&&(s.startDate?s.startDate instanceof Date?s.startDate=this._local_to_utc(this._zero_time(s.startDate)):s.startDate=f.parseDate(s.startDate,l,s.language,s.assumeNearbyYear):s.startDate=-Infinity),s.endDate!==1/0&&(s.endDate?s.endDate instanceof Date?s.endDate=this._local_to_utc(this._zero_time(s.endDate)):s.endDate=f.parseDate(s.endDate,l,s.language,s.assumeNearbyYear):s.endDate=1/0),s.daysOfWeekDisabled=this._resolveDaysOfWeek(s.daysOfWeekDisabled||[]),s.daysOfWeekHighlighted=this._resolveDaysOfWeek(s.daysOfWeekHighlighted||[]),s.datesDisabled=s.datesDisabled||[],t.isArray(s.datesDisabled)||(s.datesDisabled=s.datesDisabled.split(",")),s.datesDisabled=t.map(s.datesDisabled,function(e){return f.parseDate(e,l,s.language,s.assumeNearbyYear)});var r=(s.orientation+"").toLowerCase().split(/\s+/g),c=s.orientation.toLowerCase();if(r=t.grep(r,function(e){return /^auto|left|right|top|bottom$/.test(e)}),s.orientation={x:"auto",y:"auto"},!c||"auto"===c);// no action
else if(1===r.length)switch(r[0]){case"top":case"bottom":s.orientation.y=r[0];break;case"left":case"right":s.orientation.x=r[0];}else c=t.grep(r,function(e){return /^left|right$/.test(e)}),s.orientation.x=c[0]||"auto",c=t.grep(r,function(e){return /^top|bottom$/.test(e)}),s.orientation.y=c[0]||"auto";if(s.defaultViewDate instanceof Date||"string"==typeof s.defaultViewDate)s.defaultViewDate=f.parseDate(s.defaultViewDate,l,s.language,s.assumeNearbyYear);else if(s.defaultViewDate){var p=s.defaultViewDate.year||new Date().getFullYear(),u=s.defaultViewDate.month||0,g=s.defaultViewDate.day||1;s.defaultViewDate=UTCDate(p,u,g)}else s.defaultViewDate=UTCToday()},_events:[],_secondaryEvents:[],_applyEvents:function _applyEvents(e){for(var t=0,a,o,n;t<e.length;t++)a=e[t][0],2===e[t].length?(o=void 0,n=e[t][1]):3===e[t].length&&(o=e[t][1],n=e[t][2]),a.on(n,o)},_unapplyEvents:function _unapplyEvents(e){for(var t=0,a,o,n;t<e.length;t++)a=e[t][0],2===e[t].length?(n=void 0,o=e[t][1]):3===e[t].length&&(n=e[t][1],o=e[t][2]),a.off(o,n)},_buildEvents:function _buildEvents(){var e={keyup:t.proxy(function(a){-1===t.inArray(a.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:t.proxy(this.keydown,this),paste:t.proxy(this.paste,this)};!0===this.o.showOnFocus&&(e.focus=t.proxy(this.show,this)),this._events=this.isInput?[[this.element,e]]:this.component&&this.inputField.length?[// For components that are not readonly, allow keyboard nav
[this.inputField,e],[this.component,{click:t.proxy(this.show,this)}]]:[[this.element,{click:t.proxy(this.show,this),keydown:t.proxy(this.keydown,this)}]],this._events.push(// Component: listen for blur on element descendants
[this.element,"*",{blur:t.proxy(function(t){this._focused_from=t.target},this)}],// Input: listen for blur on element
[this.element,{blur:t.proxy(function(t){this._focused_from=t.target},this)}]),this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":t.proxy(function(t){this.update(t.date)},this)}]),this._secondaryEvents=[[this.picker,{click:t.proxy(this.click,this)}],[this.picker,".prev, .next",{click:t.proxy(this.navArrowsClick,this)}],[this.picker,".day:not(.disabled)",{click:t.proxy(this.dayCellClick,this)}],[t(window),{resize:t.proxy(this.place,this)}],[t(document),{"mousedown touchstart":t.proxy(function(t){this.element.is(t.target)||this.element.find(t.target).length||this.picker.is(t.target)||this.picker.find(t.target).length||this.isInline||this.hide()},this)}]]},_attachEvents:function _attachEvents(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function _detachEvents(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function _attachSecondaryEvents(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function _detachSecondaryEvents(){this._unapplyEvents(this._secondaryEvents)},_trigger:function _trigger(e,a){var o=a||this.dates.get(-1),n=this._utc_to_local(o);this.element.trigger({type:e,date:n,viewMode:this.viewMode,dates:t.map(this.dates,this._utc_to_local),format:t.proxy(function(e,t){0===arguments.length?(e=this.dates.length-1,t=this.o.format):"string"==typeof e&&(t=e,e=this.dates.length-1),t=t||this.o.format;var a=this.dates.get(e);return f.formatDate(a,t,this.o.language)},this)})},show:function show(){if(!(this.inputField.prop("disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly))return this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&t(this.element).blur(),this},hide:function hide(){return this.isInline||!this.picker.is(":visible")?this:(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.setViewMode(this.o.startView),this.o.forceParse&&this.inputField.val()&&this.setValue(),this._trigger("hide"),this)},destroy:function destroy(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},paste:function paste(a){var e;if(a.originalEvent.clipboardData&&a.originalEvent.clipboardData.types&&-1!==t.inArray("text/plain",a.originalEvent.clipboardData.types))e=a.originalEvent.clipboardData.getData("text/plain");else if(window.clipboardData)e=window.clipboardData.getData("Text");else return;this.setDate(e),this.update(),a.preventDefault()},_utc_to_local:function _utc_to_local(e){if(!e)return e;var t=new Date(e.getTime()+6e4*e.getTimezoneOffset());return t.getTimezoneOffset()!==e.getTimezoneOffset()&&(t=new Date(e.getTime()+6e4*t.getTimezoneOffset())),t},_local_to_utc:function _local_to_utc(e){return e&&new Date(e.getTime()-6e4*e.getTimezoneOffset())},_zero_time:function _zero_time(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function _zero_utc_time(e){return e&&UTCDate(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())},getDates:function getDates(){return t.map(this.dates,this._utc_to_local)},getUTCDates:function getUTCDates(){return t.map(this.dates,function(e){return new Date(e)})},getDate:function getDate(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function getUTCDate(){var e=this.dates.get(-1);return void 0===e?null:new Date(e)},clearDates:function clearDates(){this.inputField.val(""),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()},setDates:function setDates(){var e=t.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,e),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function setUTCDates(){var e=t.isArray(arguments[0])?arguments[0]:arguments;return this.setDates.apply(this,t.map(e,this._utc_to_local)),this},setDate:alias("setDates"),setUTCDate:alias("setUTCDates"),remove:alias("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead"),setValue:function setValue(){var e=this.getFormattedDate();return this.inputField.val(e),this},getFormattedDate:function getFormattedDate(e){e===void 0&&(e=this.o.format);var a=this.o.language;return t.map(this.dates,function(t){return f.formatDate(t,e,a)}).join(this.o.multidateSeparator)},getStartDate:function getStartDate(){return this.o.startDate},setStartDate:function setStartDate(e){return this._process_options({startDate:e}),this.update(),this.updateNavArrows(),this},getEndDate:function getEndDate(){return this.o.endDate},setEndDate:function setEndDate(e){return this._process_options({endDate:e}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function setDaysOfWeekDisabled(e){return this._process_options({daysOfWeekDisabled:e}),this.update(),this},setDaysOfWeekHighlighted:function setDaysOfWeekHighlighted(e){return this._process_options({daysOfWeekHighlighted:e}),this.update(),this},setDatesDisabled:function setDatesDisabled(e){return this._process_options({datesDisabled:e}),this.update(),this},place:function place(){if(this.isInline)return this;var e=this.picker.outerWidth(),a=this.picker.outerHeight(),o=t(this.o.container),d=o.width(),s="body"===this.o.container?t(document).scrollTop():o.scrollTop(),l=o.offset(),r=[0];this.element.parents().each(function(){var e=t(this).css("z-index");"auto"!==e&&0!==+e&&r.push(+e)});var c=n.apply(Math,r)+this.o.zIndexOffset,p=this.component?this.component.parent().offset():this.element.offset(),u=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),m=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),g=p.left-l.left,h=p.top-l.top;"body"!==this.o.container&&(h+=s),this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"===this.o.orientation.x?0>p.left?(this.picker.addClass("datepicker-orient-left"),g-=p.left-10):g+e>d?(this.picker.addClass("datepicker-orient-right"),g+=m-e):this.o.rtl?this.picker.addClass("datepicker-orient-right"):this.picker.addClass("datepicker-orient-left"):(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(g-=e-m));// auto y orientation is best-situation: top or bottom, no fudging,
// decision based on which shows more of the calendar
var f=this.o.orientation.y,y;if("auto"===f&&(y=-s+h-a,f=50>y?"bottom":"top"),this.picker.addClass("datepicker-orient-"+f),"top"===f?h-=a+parseInt(this.picker.css("padding-top")):h+=u,this.o.rtl){var b=d-(g+m);this.picker.css({top:h,right:b,zIndex:c})}else this.picker.css({top:h,left:g,zIndex:c});return this},_allow_update:!0,update:function update(){if(!this._allow_update)return this;var e=this.dates.copy(),a=[],o=!1;return arguments.length?(t.each(arguments,t.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),a.push(t)},this)),o=!0):(a=this.isInput?this.element.val():this.element.data("date")||this.inputField.val(),a=a&&this.o.multidate?a.split(this.o.multidateSeparator):[a],delete this.element.data().date),a=t.map(a,t.proxy(function(e){return f.parseDate(e,this.o.format,this.o.language,this.o.assumeNearbyYear)},this)),a=t.grep(a,t.proxy(function(e){return!this.dateWithinRange(e)||!e},this),!0),this.dates.replace(a),this.o.updateViewDate&&(this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=this.o.defaultViewDate),o?(this.setValue(),this.element.change()):this.dates.length&&e+""!==this.dates+""&&o&&(this._trigger("changeDate"),this.element.change()),!this.dates.length&&e.length&&(this._trigger("clearDate"),this.element.change()),this.fill(),this},fillDow:function fillDow(){if(this.o.showWeekDays){var e=this.o.weekStart,a="<tr>";for(this.o.calendarWeeks&&(a+="<th class=\"cw\">&#160;</th>");e<this.o.weekStart+7;)a+="<th class=\"dow",-1!==t.inArray(e,this.o.daysOfWeekDisabled)&&(a+=" disabled"),a+="\">"+h[this.o.language].daysMin[e++%7]+"</th>";a+="</tr>",this.picker.find(".datepicker-days thead").append(a)}},fillMonths:function fillMonths(){for(var e=this._utc_to_local(this.viewDate),t="",a=0,o;12>a;a++)o=e&&e.getMonth()===a?" focused":"",t+="<span class=\"month"+o+"\">"+h[this.o.language].monthsShort[a]+"</span>";this.picker.find(".datepicker-months td").html(t)},setRange:function setRange(e){e&&e.length?this.range=t.map(e,function(e){return e.valueOf()}):delete this.range,this.fill()},getClassNames:function getClassNames(e){var a=[],o=this.viewDate.getUTCFullYear(),n=this.viewDate.getUTCMonth(),d=UTCToday();return e.getUTCFullYear()<o||e.getUTCFullYear()===o&&e.getUTCMonth()<n?a.push("old"):(e.getUTCFullYear()>o||e.getUTCFullYear()===o&&e.getUTCMonth()>n)&&a.push("new"),this.focusDate&&e.valueOf()===this.focusDate.valueOf()&&a.push("focused"),this.o.todayHighlight&&isUTCEquals(e,d)&&a.push("today"),-1!==this.dates.contains(e)&&a.push("active"),this.dateWithinRange(e)||a.push("disabled"),this.dateIsDisabled(e)&&a.push("disabled","disabled-date"),-1!==t.inArray(e.getUTCDay(),this.o.daysOfWeekHighlighted)&&a.push("highlighted"),this.range&&(e>this.range[0]&&e<this.range[this.range.length-1]&&a.push("range"),-1!==t.inArray(e.valueOf(),this.range)&&a.push("selected"),e.valueOf()===this.range[0]&&a.push("range-start"),e.valueOf()===this.range[this.range.length-1]&&a.push("range-end")),a},_fill_yearsView:function _fill_yearsView(e,a,o,n,d,l,r){for(var c="",p=o/10,u=this.picker.find(e),m=s(n/o)*o,g=m+9*p,h=s(this.viewDate.getFullYear()/p)*p,f=t.map(this.dates,function(e){return s(e.getUTCFullYear()/p)*p}),y=m-p,b,v,w;y<=g+p;y+=p)b=[a],v=null,y===m-p?b.push("old"):y===g+p&&b.push("new"),-1!==t.inArray(y,f)&&b.push("active"),(y<d||y>l)&&b.push("disabled"),y===h&&b.push("focused"),r!==t.noop&&(w=r(new Date(y,0,1)),void 0===w?w={}:"boolean"==typeof w?w={enabled:w}:"string"==typeof w&&(w={classes:w}),!1===w.enabled&&b.push("disabled"),w.classes&&(b=b.concat(w.classes.split(/\s+/))),w.tooltip&&(v=w.tooltip)),c+="<span class=\""+b.join(" ")+"\""+(v?" title=\""+v+"\"":"")+">"+y+"</span>";u.find(".datepicker-switch").text(m+"-"+g),u.find("td").html(c)},fill:function fill(){var e=new Date(this.viewDate),a=e.getUTCFullYear(),o=e.getUTCMonth(),n=this.o.startDate===-Infinity?-Infinity:this.o.startDate.getUTCFullYear(),d=this.o.startDate===-Infinity?-Infinity:this.o.startDate.getUTCMonth(),s=this.o.endDate===1/0?1/0:this.o.endDate.getUTCFullYear(),l=this.o.endDate===1/0?1/0:this.o.endDate.getUTCMonth(),r=h[this.o.language].today||h.en.today||"",c=h[this.o.language].clear||h.en.clear||"",p=h[this.o.language].titleFormat||h.en.titleFormat,u,m;if(!(isNaN(a)||isNaN(o))){this.picker.find(".datepicker-days .datepicker-switch").text(f.formatDate(e,p,this.o.language)),this.picker.find("tfoot .today").text(r).css("display",!0===this.o.todayBtn||"linked"===this.o.todayBtn?"table-cell":"none"),this.picker.find("tfoot .clear").text(c).css("display",!0===this.o.clearBtn?"table-cell":"none"),this.picker.find("thead .datepicker-title").text(this.o.title).css("display","string"==typeof this.o.title&&""!==this.o.title?"table-cell":"none"),this.updateNavArrows(),this.fillMonths();var g=UTCDate(a,o,0),y=g.getUTCDate();g.setUTCDate(y-(g.getUTCDay()-this.o.weekStart+7)%7);var b=new Date(g);100>g.getUTCFullYear()&&b.setUTCFullYear(g.getUTCFullYear()),b.setUTCDate(b.getUTCDate()+42),b=b.valueOf();for(var v=[],w,C;g.valueOf()<b;){if(w=g.getUTCDay(),w===this.o.weekStart&&(v.push("<tr>"),this.o.calendarWeeks)){// ISO 8601: First week contains first thursday.
// ISO also states week starts on Monday, but we can be more abstract here.
var// Start of current week: based on weekstart/current date
k=new Date(+g+864e5*((this.o.weekStart-w-7)%7)),// Thursday of this week
x=new Date(+k+864e5*((11-k.getUTCDay())%7)),// First Thursday of year, year from thursday
S=new Date(+(S=UTCDate(x.getUTCFullYear(),0,1))+864e5*((11-S.getUTCDay())%7)),// Calendar week: ms between thursdays, div ms per day, div 7 days
T=(x-S)/864e5/7+1;v.push("<td class=\"cw\">"+T+"</td>")}C=this.getClassNames(g),C.push("day");var W=g.getUTCDate();this.o.beforeShowDay!==t.noop&&(m=this.o.beforeShowDay(this._utc_to_local(g)),void 0===m?m={}:"boolean"==typeof m?m={enabled:m}:"string"==typeof m&&(m={classes:m}),!1===m.enabled&&C.push("disabled"),m.classes&&(C=C.concat(m.classes.split(/\s+/))),m.tooltip&&(u=m.tooltip),m.content&&(W=m.content)),C=t.isFunction(t.uniqueSort)?t.uniqueSort(C):t.unique(C),v.push("<td class=\""+C.join(" ")+"\""+(u?" title=\""+u+"\"":"")+" data-date=\""+g.getTime().toString()+"\">"+W+"</td>"),u=null,w===this.o.weekEnd&&v.push("</tr>"),g.setUTCDate(g.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").html(v.join(""));var D=h[this.o.language].monthsTitle||h.en.monthsTitle||"Months",I=this.picker.find(".datepicker-months").find(".datepicker-switch").text(2>this.o.maxViewMode?D:a).end().find("tbody span").removeClass("active");if(t.each(this.dates,function(e,t){t.getUTCFullYear()===a&&I.eq(t.getUTCMonth()).addClass("active")}),(a<n||a>s)&&I.addClass("disabled"),a===n&&I.slice(0,d).addClass("disabled"),a===s&&I.slice(l+1).addClass("disabled"),this.o.beforeShowMonth!==t.noop){var O=this;t.each(I,function(e,o){var n=new Date(a,e,1),d=O.o.beforeShowMonth(n);void 0===d?d={}:"boolean"==typeof d?d={enabled:d}:"string"==typeof d&&(d={classes:d}),!1!==d.enabled||t(o).hasClass("disabled")||t(o).addClass("disabled"),d.classes&&t(o).addClass(d.classes),d.tooltip&&t(o).prop("title",d.tooltip)})}// Generating decade/years picker
this._fill_yearsView(".datepicker-years","year",10,a,n,s,this.o.beforeShowYear),this._fill_yearsView(".datepicker-decades","decade",100,a,n,s,this.o.beforeShowDecade),this._fill_yearsView(".datepicker-centuries","century",1e3,a,n,s,this.o.beforeShowCentury)}},updateNavArrows:function updateNavArrows(){if(this._allow_update){var e=new Date(this.viewDate),t=e.getUTCFullYear(),a=e.getUTCMonth(),o=this.o.startDate===-Infinity?-Infinity:this.o.startDate.getUTCFullYear(),n=this.o.startDate===-Infinity?-Infinity:this.o.startDate.getUTCMonth(),d=this.o.endDate===1/0?1/0:this.o.endDate.getUTCFullYear(),l=this.o.endDate===1/0?1/0:this.o.endDate.getUTCMonth(),r=1,c,p;switch(this.viewMode){case 4:r*=10;/* falls through */case 3:r*=10;/* falls through */case 2:r*=10;/* falls through */case 1:c=s(t/r)*r<o,p=s(t/r)*r+r>d;break;case 0:c=t<=o&&a<n,p=t>=d&&a>l;}this.picker.find(".prev").toggleClass("disabled",c),this.picker.find(".next").toggleClass("disabled",p)}},click:function click(a){a.preventDefault(),a.stopPropagation();var e,o,n,d;e=t(a.target),e.hasClass("datepicker-switch")&&this.viewMode!==this.o.maxViewMode&&this.setViewMode(this.viewMode+1),e.hasClass("today")&&!e.hasClass("day")&&(this.setViewMode(0),this._setDate(UTCToday(),"linked"===this.o.todayBtn?null:"view")),e.hasClass("clear")&&this.clearDates(),!e.hasClass("disabled")&&(e.hasClass("month")||e.hasClass("year")||e.hasClass("decade")||e.hasClass("century"))&&(this.viewDate.setUTCDate(1),o=1,1===this.viewMode?(d=e.parent().find("span").index(e),n=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(d)):(d=0,n=+e.text(),this.viewDate.setUTCFullYear(n)),this._trigger(f.viewModes[this.viewMode-1].e,this.viewDate),this.viewMode===this.o.minViewMode?this._setDate(UTCDate(n,d,o)):(this.setViewMode(this.viewMode-1),this.fill())),this.picker.is(":visible")&&this._focused_from&&this._focused_from.focus(),delete this._focused_from},dayCellClick:function dayCellClick(a){var e=t(a.currentTarget),o=e.data("date"),n=new Date(o);this.o.updateViewDate&&(n.getUTCFullYear()!==this.viewDate.getUTCFullYear()&&this._trigger("changeYear",this.viewDate),n.getUTCMonth()!==this.viewDate.getUTCMonth()&&this._trigger("changeMonth",this.viewDate)),this._setDate(n)},// Clicked on prev or next
navArrowsClick:function navArrowsClick(a){var e=t(a.currentTarget),o=e.hasClass("prev")?-1:1;0!==this.viewMode&&(o*=12*f.viewModes[this.viewMode].navStep),this.viewDate=this.moveMonth(this.viewDate,o),this._trigger(f.viewModes[this.viewMode].e,this.viewDate),this.fill()},_toggle_multidate:function _toggle_multidate(e){var t=this.dates.contains(e);if(e||this.dates.clear(),-1===t?!1===this.o.multidate?(this.dates.clear(),this.dates.push(e)):this.dates.push(e):(!0===this.o.multidate||1<this.o.multidate||this.o.toggleActive)&&this.dates.remove(t),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function _setDate(e,t){t&&"date"!==t||this._toggle_multidate(e&&new Date(e)),(!t&&this.o.updateViewDate||"view"===t)&&(this.viewDate=e&&new Date(e)),this.fill(),this.setValue(),t&&"view"===t||this._trigger("changeDate"),this.inputField.trigger("change"),this.o.autoclose&&(!t||"date"===t)&&this.hide()},moveDay:function moveDay(e,t){var a=new Date(e);return a.setUTCDate(e.getUTCDate()+t),a},moveWeek:function moveWeek(e,t){return this.moveDay(e,7*t)},moveMonth:function moveMonth(t,a){if(!isValidDate(t))return this.o.defaultViewDate;if(!a)return t;var o=new Date(t.valueOf()),n=o.getUTCDate(),d=o.getUTCMonth(),s=e(a),l,r;if(a=0<a?1:-1,1===s)r=-1===a// If going back one month, make sure month is not current month
// (eg, Mar 31 -> Feb 31 == Feb 28, not Mar 02)
?function(){return o.getUTCMonth()===d}// If going forward one month, make sure month is as expected
// (eg, Jan 31 -> Feb 31 == Feb 28, not Mar 02)
:function(){return o.getUTCMonth()!==l},l=d+a,o.setUTCMonth(l),l=(l+12)%12;else{// For magnitudes >1, move one month at a time...
for(var c=0;c<s;c++)// ...which might decrease the day (eg, Jan 31 to Feb 28, etc)...
o=this.moveMonth(o,a);// ...then reset the day, keeping it in the new month
l=o.getUTCMonth(),o.setUTCDate(n),r=function(){return l!==o.getUTCMonth()}}// Common date-resetting loop -- if date is beyond end of month, make it
// end of month
for(;r();)o.setUTCDate(--n),o.setUTCMonth(l);return o},moveYear:function moveYear(e,t){return this.moveMonth(e,12*t)},moveAvailableDate:function moveAvailableDate(e,t,a){do{if(e=this[a](e,t),!this.dateWithinRange(e))return!1;a="moveDay"}while(this.dateIsDisabled(e));return e},weekOfDateIsDisabled:function weekOfDateIsDisabled(e){return-1!==t.inArray(e.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function dateIsDisabled(e){return this.weekOfDateIsDisabled(e)||0<t.grep(this.o.datesDisabled,function(t){return isUTCEquals(e,t)}).length},dateWithinRange:function dateWithinRange(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function keydown(t){if(!this.picker.is(":visible"))return void((40===t.keyCode||27===t.keyCode)&&(this.show(),t.stopPropagation()));var e=!1,a=this.focusDate||this.viewDate,o,n;switch(t.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),t.preventDefault(),t.stopPropagation();break;case 37:// left
case 38:// up
case 39:// right
case 40:// down
if(!this.o.keyboardNavigation||7===this.o.daysOfWeekDisabled.length)break;o=37===t.keyCode||38===t.keyCode?-1:1,0===this.viewMode?t.ctrlKey?(n=this.moveAvailableDate(a,o,"moveYear"),n&&this._trigger("changeYear",this.viewDate)):t.shiftKey?(n=this.moveAvailableDate(a,o,"moveMonth"),n&&this._trigger("changeMonth",this.viewDate)):37===t.keyCode||39===t.keyCode?n=this.moveAvailableDate(a,o,"moveDay"):!this.weekOfDateIsDisabled(a)&&(n=this.moveAvailableDate(a,o,"moveWeek")):1===this.viewMode?((38===t.keyCode||40===t.keyCode)&&(o*=4),n=this.moveAvailableDate(a,o,"moveMonth")):2===this.viewMode&&((38===t.keyCode||40===t.keyCode)&&(o*=4),n=this.moveAvailableDate(a,o,"moveYear")),n&&(this.focusDate=this.viewDate=n,this.setValue(),this.fill(),t.preventDefault());break;case 13:// enter
if(!this.o.forceParse)break;a=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(a),e=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(t.preventDefault(),t.stopPropagation(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide();}e&&(this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.inputField.trigger("change"))},setViewMode:function setViewMode(e){this.viewMode=e,this.picker.children("div").hide().filter(".datepicker-"+f.viewModes[this.viewMode].clsName).show(),this.updateNavArrows(),this._trigger("changeViewMode",new Date(this.viewDate))}};var c=function(e,a){t.data(e,"datepicker",this),this.element=t(e),this.inputs=t.map(a.inputs,function(e){return e.jquery?e[0]:e}),delete a.inputs,this.keepEmptyValues=a.keepEmptyValues,delete a.keepEmptyValues,u.call(t(this.inputs),a).on("changeDate",t.proxy(this.dateUpdated,this)),this.pickers=t.map(this.inputs,function(e){return t.data(e,"datepicker")}),this.updateDates()};c.prototype={updateDates:function updateDates(){this.dates=t.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function updateRanges(){var e=t.map(this.dates,function(e){return e.valueOf()});t.each(this.pickers,function(t,a){a.setRange(e)})},clearDates:function clearDates(){t.each(this.pickers,function(e,t){t.clearDates()})},dateUpdated:function dateUpdated(a){// `this.updating` is a workaround for preventing infinite recursion
// between `changeDate` triggering and `setUTCDate` calling.  Until
// there is a better mechanism.
if(!this.updating){this.updating=!0;var e=t.data(a.target,"datepicker");if(void 0!==e){var o=e.getUTCDate(),n=this.keepEmptyValues,d=t.inArray(a.target,this.inputs),s=d-1,r=d+1,c=this.inputs.length;if(-1!==d){if(t.each(this.pickers,function(t,a){a.getUTCDate()||a!==e&&n||a.setUTCDate(o)}),o<this.dates[s])// Date being moved earlier/left
for(;0<=s&&o<this.dates[s];)this.pickers[s--].setUTCDate(o);else if(o>this.dates[r])// Date being moved later/right
for(;r<c&&o>this.dates[r];)this.pickers[r++].setUTCDate(o);this.updateDates(),delete this.updating}}}},destroy:function destroy(){t.map(this.pickers,function(e){e.destroy()}),t(this.inputs).off("changeDate",this.dateUpdated),delete this.element.data().datepicker},remove:alias("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead")};var p=t.fn.datepicker,u=function(e){var a=Array.apply(null,arguments);a.shift();var o;if(this.each(function(){var n=t(this),d=n.data("datepicker"),s="object"===_typeof(e)&&e;if(!d){var l=opts_from_el(this,"date"),// Preliminary otions
p=t.extend({},m,l,s),u=opts_from_locale(p.language),// Options priority: js args, data-attrs, locales, defaults
g=t.extend({},m,u,l,s);n.hasClass("input-daterange")||g.inputs?(t.extend(g,{inputs:g.inputs||n.find("input").toArray()}),d=new c(this,g)):d=new r(this,g),n.data("datepicker",d)}"string"==typeof e&&"function"==typeof d[e]&&(o=d[e].apply(d,a))}),void 0===o||o instanceof r||o instanceof c)return this;if(1<this.length)throw new Error("Using only allowed for the collection of a single element ("+e+" function)");else return o};t.fn.datepicker=u;var m=t.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:t.noop,beforeShowMonth:t.noop,beforeShowYear:t.noop,beforeShowDecade:t.noop,beforeShowCentury:t.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keepEmptyValues:!1,keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,updateViewDate:!0,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:12,container:"body",immediateUpdates:!1,title:"",templates:{leftArrow:"&#x00AB;",rightArrow:"&#x00BB;"},showWeekDays:!0},g=t.fn.datepicker.locale_opts=["format","rtl","weekStart"];t.fn.datepicker.Constructor=r;var h=t.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},f={viewModes:[{names:["days","month"],clsName:"days",e:"changeMonth"},{names:["months","year"],clsName:"months",e:"changeYear",navStep:1},{names:["years","decade"],clsName:"years",e:"changeDecade",navStep:10},{names:["decades","century"],clsName:"decades",e:"changeCentury",navStep:100},{names:["centuries","millennium"],clsName:"centuries",e:"changeMillennium",navStep:1e3}],validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,parseFormat:function parseFormat(e){if("function"==typeof e.toValue&&"function"==typeof e.toDisplay)return e;// IE treats \0 as a string end in inputs (truncating the value),
// so it's a bad format delimiter, anyway
var t=e.replace(this.validParts,"\0").split("\0"),a=e.match(this.validParts);if(!t||!t.length||!a||0===a.length)throw new Error("Invalid date format.");return{separators:t,parts:a}},parseDate:function parseDate(e,a,o,n){function applyNearbyYear(e,t){return!0===t&&(t=10),100>e&&(e+=2e3,e>new Date().getFullYear()+t&&(e-=100)),e}// Process remainder
function match_part(){var e=this.slice(0,c[g].length),t=c[g].slice(0,e.length);return e.toLowerCase()===t.toLowerCase()}if(e){if(e instanceof Date)return e;if("string"==typeof a&&(a=f.parseFormat(a)),a.toValue)return a.toValue(e,a,o);var d={d:"moveDay",m:"moveMonth",w:"moveWeek",y:"moveYear"},l={yesterday:"-1d",today:"+0d",tomorrow:"+1d"},c,p,u,g,m;if(e in l&&(e=l[e]),/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/i.test(e)){for(c=e.match(/([\-+]\d+)([dmwy])/gi),e=new Date,g=0;g<c.length;g++)p=c[g].match(/([\-+]\d+)([dmwy])/i),u=+p[1],m=d[p[2].toLowerCase()],e=r.prototype[m](e,u);return r.prototype._zero_utc_time(e)}c=e&&e.match(this.nonpunctuation)||[];var y={},b=["yyyy","yy","M","MM","m","mm","d","dd"],v={yyyy:function yyyy(e,t){return e.setUTCFullYear(n?applyNearbyYear(t,n):t)},m:function m(e,t){if(isNaN(e))return e;for(t-=1;0>t;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!==t;)e.setUTCDate(e.getUTCDate()-1);return e},d:function d(e,t){return e.setUTCDate(t)}},w,C;v.yy=v.yyyy,v.M=v.MM=v.mm=v.m,v.dd=v.d,e=UTCToday();var k=a.parts.slice();// Remove noop parts
if(c.length!==k.length&&(k=t(k).filter(function(e,a){return-1!==t.inArray(a,b)}).toArray()),c.length===k.length){var x;for(g=0,x=k.length;g<x;g++)w=parseInt(c[g],10),p=k[g],isNaN(w)&&("MM"===p?(C=t(h[o].months).filter(match_part),w=t.inArray(C[0],h[o].months)+1):"M"===p?(C=t(h[o].monthsShort).filter(match_part),w=t.inArray(C[0],h[o].monthsShort)+1):void 0),y[p]=w;var S,T;for(g=0;g<b.length;g++)T=b[g],T in y&&!isNaN(y[T])&&(S=new Date(e),v[T](S,y[T]),!isNaN(S)&&(e=S))}return e}},formatDate:function formatDate(e,a,o){if(!e)return"";if("string"==typeof a&&(a=f.parseFormat(a)),a.toDisplay)return a.toDisplay(e,a,o);var n={d:e.getUTCDate(),D:h[o].daysShort[e.getUTCDay()],DD:h[o].days[e.getUTCDay()],m:e.getUTCMonth()+1,M:h[o].monthsShort[e.getUTCMonth()],MM:h[o].months[e.getUTCMonth()],yy:e.getUTCFullYear().toString().substring(2),yyyy:e.getUTCFullYear()};n.dd=(10>n.d?"0":"")+n.d,n.mm=(10>n.m?"0":"")+n.m,e=[];for(var d=t.extend([],a.separators),s=0,l=a.parts.length;s<=l;s++)d.length&&e.push(d.shift()),e.push(n[a.parts[s]]);return e.join("")},headTemplate:"<thead><tr><th colspan=\"7\" class=\"datepicker-title\"></th></tr><tr><th class=\"prev\">"+m.templates.leftArrow+"</th><th colspan=\"5\" class=\"datepicker-switch\"></th><th class=\"next\">"+m.templates.rightArrow+"</th></tr></thead>",contTemplate:"<tbody><tr><td colspan=\"7\"></td></tr></tbody>",footTemplate:"<tfoot><tr><th colspan=\"7\" class=\"today\"></th></tr><tr><th colspan=\"7\" class=\"clear\"></th></tr></tfoot>"};/* DATEPICKER NO CONFLICT
	* =================== */ /* DATEPICKER VERSION
	 * =================== */ /* DATEPICKER DATA-API
	* ================== */f.template="<div class=\"datepicker\"><div class=\"datepicker-days\"><table class=\"table-condensed\">"+f.headTemplate+"<tbody></tbody>"+f.footTemplate+"</table></div><div class=\"datepicker-months\"><table class=\"table-condensed\">"+f.headTemplate+f.contTemplate+f.footTemplate+"</table></div><div class=\"datepicker-years\"><table class=\"table-condensed\">"+f.headTemplate+f.contTemplate+f.footTemplate+"</table></div><div class=\"datepicker-decades\"><table class=\"table-condensed\">"+f.headTemplate+f.contTemplate+f.footTemplate+"</table></div><div class=\"datepicker-centuries\"><table class=\"table-condensed\">"+f.headTemplate+f.contTemplate+f.footTemplate+"</table></div></div>",t.fn.datepicker.DPGlobal=f,t.fn.datepicker.noConflict=function(){return t.fn.datepicker=p,this},t.fn.datepicker.version="1.8.0",t.fn.datepicker.deprecated=function(e){var t=window.console;t&&t.warn&&t.warn("DEPRECATED: "+e)},t(document).on("focus.datepicker.data-api click.datepicker.data-api","[data-provide=\"datepicker\"]",function(a){var e=t(this);e.data("datepicker")||(// component click requires us to explicitly show it
a.preventDefault(),u.call(e,"show"))}),t(function(){u.call(t("[data-provide=\"datepicker-inline\"]"))})}),function(e){'use strict';if("function"==typeof define&&define.amd)// AMD is used - Register as an anonymous module.
define(["jquery","moment"],e);else if("object"===("undefined"==typeof exports?"undefined":_typeof(exports)))module.exports=e(require("jquery"),require("moment"));else{// Neither AMD nor CommonJS used. Use global variables.
if("undefined"==typeof jQuery)throw"bootstrap-datetimepicker requires jQuery to be loaded first";if("undefined"==typeof moment)throw"bootstrap-datetimepicker requires Moment.js to be loaded first";e(jQuery,moment)}}(function(t,e){'use strict';var a=Math.min,o=Math.max,n=Math.round;if(!e)throw new Error("bootstrap-datetimepicker requires Moment.js to be loaded first");var d=function(d,s){var l={},r=!0,c=!1,p=!1,u=0,m=[{clsName:"days",navFnc:"M",navStep:1},{clsName:"months",navFnc:"y",navStep:1},{clsName:"years",navFnc:"y",navStep:10},{clsName:"decades",navFnc:"y",navStep:100}],g=["days","months","years","decades"],h=["top","bottom","auto"],f=["left","right","auto"],y=["default","top","bottom"],b={up:38,38:"up",down:40,40:"down",left:37,37:"left",right:39,39:"right",tab:9,9:"tab",escape:27,27:"escape",enter:13,13:"enter",pageUp:33,33:"pageUp",pageDown:34,34:"pageDown",shift:16,16:"shift",control:17,17:"control",space:32,32:"space",t:84,84:"t",delete:46,46:"delete"},v={},/********************************************************************************
             *
             * Private functions
             *
             ********************************************************************************/w=function(){return void 0!==e.tz&&void 0!==s.timeZone&&null!==s.timeZone&&""!==s.timeZone},C=function(t){var a;return a=void 0===t||null===t?e():e.isDate(t)||e.isMoment(t)?e(t):w()?e.tz(t,ve,s.useStrict,s.timeZone):e(t,ve,s.useStrict),w()&&a.tz(s.timeZone),a},k=function(e){if("string"!=typeof e||1<e.length)throw new TypeError("isEnabled expects a single character string parameter");return"y"===e?-1!==be.indexOf("Y"):"M"===e?-1!==be.indexOf("M"):"d"===e?-1!==be.toLowerCase().indexOf("d"):"h"===e||"H"===e?-1!==be.toLowerCase().indexOf("h"):"m"===e?-1!==be.indexOf("m"):"s"==e&&-1!==be.indexOf("s")},x=function(){return k("h")||k("m")||k("s")},S=function(){return k("y")||k("M")||k("d")},T=function(){var e=t("<thead>").append(t("<tr>").append(t("<th>").addClass("prev").attr("data-action","previous").append(t("<span>keyboard_arrow_left</span>").addClass(s.icons.previous))).append(t("<th>").addClass("picker-switch").attr("data-action","pickerSwitch").attr("colspan",s.calendarWeeks?"6":"5")).append(t("<th>").addClass("next").attr("data-action","next").append(t("<span>keyboard_arrow_right</span>").addClass(s.icons.next)))),a=t("<tbody>").append(t("<tr>").append(t("<td>").attr("colspan",s.calendarWeeks?"8":"7")));return[t("<div>").addClass("datepicker-days").append(t("<table>").addClass("table-condensed").append(e).append(t("<tbody>"))),t("<div>").addClass("datepicker-months").append(t("<table>").addClass("table-condensed").append(e.clone()).append(a.clone())),t("<div>").addClass("datepicker-years").append(t("<table>").addClass("table-condensed").append(e.clone()).append(a.clone())),t("<div>").addClass("datepicker-decades").append(t("<table>").addClass("table-condensed").append(e.clone()).append(a.clone()))]},W=function(){var e=t("<tr>"),a=t("<tr>"),o=t("<tr>");return k("h")&&(e.append(t("<td>").append(t("<a>").attr({href:"#",tabindex:"-1",title:s.tooltips.incrementHour}).addClass("btn").attr("data-action","incrementHours").append(t("<span>keyboard_arrow_up</span>").addClass(s.icons.up)))),a.append(t("<td>").append(t("<span>").addClass("timepicker-hour").attr({"data-time-component":"hours",title:s.tooltips.pickHour}).attr("data-action","showHours"))),o.append(t("<td>").append(t("<a>").attr({href:"#",tabindex:"-1",title:s.tooltips.decrementHour}).addClass("btn").attr("data-action","decrementHours").append(t("<span>keyboard_arrow_down</span>").addClass(s.icons.down))))),k("m")&&(k("h")&&(e.append(t("<td>").addClass("separator")),a.append(t("<td>").addClass("separator").html(":")),o.append(t("<td>").addClass("separator"))),e.append(t("<td>").append(t("<a>").attr({href:"#",tabindex:"-1",title:s.tooltips.incrementMinute}).addClass("btn").attr("data-action","incrementMinutes").append(t("<span>keyboard_arrow_up</span>").addClass(s.icons.up)))),a.append(t("<td>").append(t("<span>").addClass("timepicker-minute").attr({"data-time-component":"minutes",title:s.tooltips.pickMinute}).attr("data-action","showMinutes"))),o.append(t("<td>").append(t("<a>").attr({href:"#",tabindex:"-1",title:s.tooltips.decrementMinute}).addClass("btn").attr("data-action","decrementMinutes").append(t("<span>keyboard_arrow_down</span>").addClass(s.icons.down))))),k("s")&&(k("m")&&(e.append(t("<td>").addClass("separator")),a.append(t("<td>").addClass("separator").html(":")),o.append(t("<td>").addClass("separator"))),e.append(t("<td>").append(t("<a>").attr({href:"#",tabindex:"-1",title:s.tooltips.incrementSecond}).addClass("btn").attr("data-action","incrementSeconds").append(t("<span>keyboard_arrow_up</span>").addClass(s.icons.up)))),a.append(t("<td>").append(t("<span>").addClass("timepicker-second").attr({"data-time-component":"seconds",title:s.tooltips.pickSecond}).attr("data-action","showSeconds"))),o.append(t("<td>").append(t("<a>").attr({href:"#",tabindex:"-1",title:s.tooltips.decrementSecond}).addClass("btn").attr("data-action","decrementSeconds").append(t("<span>keyboard_arrow_down</span>").addClass(s.icons.down))))),ye||(e.append(t("<td>").addClass("separator")),a.append(t("<td>").append(t("<button>").addClass("btn btn-primary").attr({"data-action":"togglePeriod",tabindex:"-1",title:s.tooltips.togglePeriod}))),o.append(t("<td>").addClass("separator"))),t("<div>").addClass("timepicker-picker").append(t("<table>").addClass("table-condensed").append([e,a,o]))},D=function(){var e=t("<div>").addClass("timepicker-hours").append(t("<table>").addClass("table-condensed")),a=t("<div>").addClass("timepicker-minutes").append(t("<table>").addClass("table-condensed")),o=t("<div>").addClass("timepicker-seconds").append(t("<table>").addClass("table-condensed")),n=[W()];return k("h")&&n.push(e),k("m")&&n.push(a),k("s")&&n.push(o),n},I=function(){var e=[];return s.showTodayButton&&e.push(t("<td>").append(t("<a>").attr({"data-action":"today",title:s.tooltips.today}).append(t("<span>today</span>").addClass(s.icons.today)))),!s.sideBySide&&S()&&x()&&e.push(t("<td>").append(t("<a>").attr({"data-action":"togglePicker"}).append(t("<span class=\"sys-fg-inverse\">access_time</span>").addClass(s.icons.time).attr({title:s.tooltips.selectTime})))),s.showClear&&e.push(t("<td>").append(t("<a>").attr({"data-action":"clear",title:s.tooltips.clear}).append(t("<span>delete_forever</span>").addClass(s.icons.clear)))),s.showClose&&e.push(t("<td>").append(t("<a>").attr({"data-action":"close",title:s.tooltips.close}).append(t("<span class=\"sys-fg-success\">check</span>").addClass(s.icons.close)))),t("<table>").addClass("table-condensed").append(t("<tbody>").append(t("<tr>").append(e)))},O=function(){var e=t("<div>").addClass("bootstrap-datetimepicker-widget dropdown-menu"),a=t("<div>").addClass("datepicker").append(T()),o=t("<div>").addClass("timepicker").append(D()),n=t("<ul>").addClass("list-unstyled"),d=t("<li>").addClass("picker-switch"+(s.collapse?" accordion-toggle":"")).append(I());return(s.inline&&e.removeClass("dropdown-menu"),ye&&e.addClass("usetwentyfour"),k("s")&&!ye&&e.addClass("wider"),s.sideBySide&&S()&&x())?(e.addClass("timepicker-sbs"),"top"===s.toolbarPlacement&&e.append(d),e.append(t("<div>").addClass("row").append(a.addClass("col-md-6")).append(o.addClass("col-md-6"))),"bottom"===s.toolbarPlacement&&e.append(d),e):("top"===s.toolbarPlacement&&n.append(d),S()&&n.append(t("<li>").addClass(s.collapse&&x()?"collapse in":"").append(a)),"default"===s.toolbarPlacement&&n.append(d),x()&&n.append(t("<li>").addClass(s.collapse&&S()?"collapse":"").append(o)),"bottom"===s.toolbarPlacement&&n.append(d),e.append(n))},_=function(){var e=(c||d).position(),a=(c||d).offset(),o=s.widgetPositioning.vertical,n=s.widgetPositioning.horizontal,l;if(s.widgetParent)l=s.widgetParent.append(p);else if(d.is("input"))l=d.after(p).parent();else{if(s.inline)return void(l=d.append(p));l=d,d.children().first().after(p)}// Top and bottom logic
if("auto"===o&&(a.top+1.5*p.height()>=t(window).height()+t(window).scrollTop()&&p.height()+d.outerHeight()<a.top?o="top":o="bottom"),"auto"===n&&(l.width()<a.left+p.outerWidth()/2&&a.left+p.outerWidth()>t(window).width()?n="right":n="left"),"top"===o?p.addClass("top").removeClass("bottom"):p.addClass("bottom").removeClass("top"),"right"===n?p.addClass("pull-right"):p.removeClass("pull-right"),"static"===l.css("position")&&(l=l.parents().filter(function(){return"static"!==t(this).css("position")}).first()),0===l.length)throw new Error("datetimepicker component should be placed within a non-static positioned container");p.css({top:"top"===o?"auto":e.top+d.outerHeight(),bottom:"top"===o?l.outerHeight()-(l===d?0:e.top):"auto",left:"left"===n?l===d?0:e.left:"auto",right:"left"===n?"auto":l.outerWidth()-d.outerWidth()-(l===d?0:e.left)})},P=function(t){"dp.change"===t.type&&(t.date&&t.date.isSame(t.oldDate)||!t.date&&!t.oldDate)||d.trigger(t)},E=function(t){"y"===t&&(t="YYYY"),P({type:"dp.update",change:t,viewDate:he.clone()})},F=function(e){p&&(e&&(we=o(u,a(3,we+e))),p.find(".datepicker > div").hide().filter(".datepicker-"+m[we].clsName).show())},A=function(){var e=t("<tr>"),a=he.clone().startOf("w").startOf("d");for(!0===s.calendarWeeks&&e.append(t("<th>").addClass("cw").text("#"));a.isBefore(he.clone().endOf("w"));)e.append(t("<th>").addClass("dow").text(a.format("dd"))),a.add(1,"d");p.find(".datepicker-days thead").append(e)},N=function(e){return!0===s.disabledDates[e.format("YYYY-MM-DD")]},M=function(e){return!0===s.enabledDates[e.format("YYYY-MM-DD")]},L=function(e){return!0===s.disabledHours[e.format("H")]},B=function(e){return!0===s.enabledHours[e.format("H")]},R=function(e,a){if(!e.isValid())return!1;if(s.disabledDates&&"d"===a&&N(e))return!1;if(s.enabledDates&&"d"===a&&!M(e))return!1;if(s.minDate&&e.isBefore(s.minDate,a))return!1;if(s.maxDate&&e.isAfter(s.maxDate,a))return!1;if(s.daysOfWeekDisabled&&"d"===a&&-1!==s.daysOfWeekDisabled.indexOf(e.day()))return!1;if(s.disabledHours&&("h"===a||"m"===a||"s"===a)&&L(e))return!1;if(s.enabledHours&&("h"===a||"m"===a||"s"===a)&&!B(e))return!1;if(s.disabledTimeIntervals&&("h"===a||"m"===a||"s"===a)){var o=!1;if(t.each(s.disabledTimeIntervals,function(){if(e.isBetween(this[0],this[1]))return o=!0,!1}),o)return!1}return!0},V=function(){for(var e=[],a=he.clone().startOf("y").startOf("d");a.isSame(he,"y");)e.push(t("<span>").attr("data-action","selectMonth").addClass("month").text(a.format("MMM"))),a.add(1,"M");p.find(".datepicker-months td").empty().append(e)},H=function(){var e=p.find(".datepicker-months"),a=e.find("th"),o=e.find("tbody").find("span");a.eq(0).find("span").attr("title",s.tooltips.prevYear),a.eq(1).attr("title",s.tooltips.selectYear),a.eq(2).find("span").attr("title",s.tooltips.nextYear),e.find(".disabled").removeClass("disabled"),R(he.clone().subtract(1,"y"),"y")||a.eq(0).addClass("disabled"),a.eq(1).text(he.year()),R(he.clone().add(1,"y"),"y")||a.eq(2).addClass("disabled"),o.removeClass("active"),ge.isSame(he,"y")&&!r&&o.eq(ge.month()).addClass("active"),o.each(function(e){R(he.clone().month(e),"M")||t(this).addClass("disabled")})},U=function(){var e=p.find(".datepicker-years"),t=e.find("th"),a=he.clone().subtract(5,"y"),o=he.clone().add(6,"y"),n="";for(t.eq(0).find("span").attr("title",s.tooltips.prevDecade),t.eq(1).attr("title",s.tooltips.selectDecade),t.eq(2).find("span").attr("title",s.tooltips.nextDecade),e.find(".disabled").removeClass("disabled"),s.minDate&&s.minDate.isAfter(a,"y")&&t.eq(0).addClass("disabled"),t.eq(1).text(a.year()+"-"+o.year()),s.maxDate&&s.maxDate.isBefore(o,"y")&&t.eq(2).addClass("disabled");!a.isAfter(o,"y");)n+="<span data-action=\"selectYear\" class=\"year"+(a.isSame(ge,"y")&&!r?" active":"")+(R(a,"y")?"":" disabled")+"\">"+a.year()+"</span>",a.add(1,"y");e.find("td").html(n)},q=function(){var t=p.find(".datepicker-decades"),a=t.find("th"),o=e({y:he.year()-he.year()%100-1}),n=o.clone().add(100,"y"),d=o.clone(),l=!1,r=!1,c="",u;for(a.eq(0).find("span").attr("title",s.tooltips.prevCentury),a.eq(2).find("span").attr("title",s.tooltips.nextCentury),t.find(".disabled").removeClass("disabled"),(o.isSame(e({y:1900}))||s.minDate&&s.minDate.isAfter(o,"y"))&&a.eq(0).addClass("disabled"),a.eq(1).text(o.year()+"-"+n.year()),(o.isSame(e({y:2e3}))||s.maxDate&&s.maxDate.isBefore(n,"y"))&&a.eq(2).addClass("disabled");!o.isAfter(n,"y");)u=o.year()+12,l=s.minDate&&s.minDate.isAfter(o,"y")&&s.minDate.year()<=u,r=s.maxDate&&s.maxDate.isAfter(o,"y")&&s.maxDate.year()<=u,c+="<span data-action=\"selectDecade\" class=\"decade"+(ge.isAfter(o)&&ge.year()<=u?" active":"")+(R(o,"y")||l||r?"":" disabled")+"\" data-selection=\""+(o.year()+6)+"\">"+(o.year()+1)+" - "+(o.year()+12)+"</span>",o.add(12,"y");c+="<span></span><span></span><span></span>",t.find("td").html(c),a.eq(1).text(d.year()+1+"-"+o.year())},G=function(){var e=p.find(".datepicker-days"),a=e.find("th"),o=[],n=[],d,l,c;if(S()){for(a.eq(0).find("span").attr("title",s.tooltips.prevMonth),a.eq(1).attr("title",s.tooltips.selectMonth),a.eq(2).find("span").attr("title",s.tooltips.nextMonth),e.find(".disabled").removeClass("disabled"),a.eq(1).text(he.format(s.dayViewHeaderFormat)),R(he.clone().subtract(1,"M"),"M")||a.eq(0).addClass("disabled"),R(he.clone().add(1,"M"),"M")||a.eq(2).addClass("disabled"),d=he.clone().startOf("M").startOf("w").startOf("d"),c=0;42>c;c++)0===d.weekday()&&(l=t("<tr>"),s.calendarWeeks&&l.append("<td class=\"cw\">"+d.week()+"</td>"),o.push(l)),n=["day"],d.isBefore(he,"M")&&n.push("old"),d.isAfter(he,"M")&&n.push("new"),d.isSame(ge,"d")&&!r&&n.push("active"),R(d,"d")||n.push("disabled"),d.isSame(C(),"d")&&n.push("today"),(0===d.day()||6===d.day())&&n.push("weekend"),P({type:"dp.classify",date:d,classNames:n}),l.append("<td data-action=\"selectDay\" data-day=\""+d.format("L")+"\" class=\""+n.join(" ")+"\">"+d.date()+"</td>"),d.add(1,"d");e.find("tbody").empty().append(o),H(),U(),q()}},z=function(){var e=p.find(".timepicker-hours table"),a=he.clone().startOf("d"),o=[],n=t("<tr>");for(11<he.hour()&&!ye&&a.hour(12);a.isSame(he,"d")&&(ye||12>he.hour()&&12>a.hour()||11<he.hour());)0==a.hour()%4&&(n=t("<tr>"),o.push(n)),n.append("<td data-action=\"selectHour\" class=\"hour"+(R(a,"h")?"":" disabled")+"\">"+a.format(ye?"HH":"hh")+"</td>"),a.add(1,"h");e.empty().append(o)},Y=function(){for(var e=p.find(".timepicker-minutes table"),a=he.clone().startOf("h"),o=[],n=t("<tr>"),d=1===s.stepping?5:s.stepping;he.isSame(a,"h");)0==a.minute()%(4*d)&&(n=t("<tr>"),o.push(n)),n.append("<td data-action=\"selectMinute\" class=\"minute"+(R(a,"m")?"":" disabled")+"\">"+a.format("mm")+"</td>"),a.add(d,"m");e.empty().append(o)},K=function(){for(var e=p.find(".timepicker-seconds table"),a=he.clone().startOf("m"),o=[],n=t("<tr>");he.isSame(a,"m");)0==a.second()%20&&(n=t("<tr>"),o.push(n)),n.append("<td data-action=\"selectSecond\" class=\"second"+(R(a,"s")?"":" disabled")+"\">"+a.format("ss")+"</td>"),a.add(5,"s");e.empty().append(o)},J=function(){var e=p.find(".timepicker span[data-time-component]"),t,a;ye||(t=p.find(".timepicker [data-action=togglePeriod]"),a=ge.clone().add(12<=ge.hours()?-12:12,"h"),t.text(ge.format("A")),R(a,"h")?t.removeClass("disabled"):t.addClass("disabled")),e.filter("[data-time-component=hours]").text(ge.format(ye?"HH":"hh")),e.filter("[data-time-component=minutes]").text(ge.format("mm")),e.filter("[data-time-component=seconds]").text(ge.format("ss")),z(),Y(),K()},Q=function(){p&&(G(),J())},X=function(e){var t=r?null:ge;// case of calling setValue(null or false)
if(!e)return r=!0,fe.val(""),d.data("date",""),P({type:"dp.change",date:!1,oldDate:t}),void Q();if(e=e.clone().locale(s.locale),w()&&e.tz(s.timeZone),1!==s.stepping)for(e.minutes(n(e.minutes()/s.stepping)*s.stepping).seconds(0);s.minDate&&e.isBefore(s.minDate);)e.add(s.stepping,"minutes");R(e)?(ge=e,he=ge.clone(),fe.val(ge.format(be)),d.data("date",ge.format(be)),r=!1,Q(),P({type:"dp.change",date:ge.clone(),oldDate:t})):(s.keepInvalid?P({type:"dp.change",date:e,oldDate:t}):fe.val(r?"":ge.format(be)),P({type:"dp.error",date:e,oldDate:t}))},/**
             * Hides the widget. Possibly will emit dp.hide
             */Z=function(){var e=!1;return p?(p.find(".collapse").each(function(){var a=t(this).data("collapse");return!(a&&a.transitioning)||(e=!0,!1)}),e)?l:(c&&c.hasClass("btn")&&c.toggleClass("active"),p.hide(),t(window).off("resize",_),p.off("click","[data-action]"),p.off("mousedown",!1),p.remove(),p=!1,P({type:"dp.hide",date:ge.clone()}),fe.blur(),he=ge.clone(),l):l;// Ignore event if in the middle of a picker transition
},ee=function(){X(null)},te=function(t){//inputDate.locale(options.locale);
return void 0===s.parseInputDate?(!e.isMoment(t)||t instanceof Date)&&(t=C(t)):t=s.parseInputDate(t),t},/********************************************************************************
             *
             * Widget UI interaction functions
             *
             ********************************************************************************/ae={next:function next(){var e=m[we].navFnc;he.add(m[we].navStep,e),G(),E(e)},previous:function previous(){var e=m[we].navFnc;he.subtract(m[we].navStep,e),G(),E(e)},pickerSwitch:function pickerSwitch(){F(1)},selectMonth:function selectMonth(a){var e=t(a.target).closest("tbody").find("span").index(t(a.target));he.month(e),we===u?(X(ge.clone().year(he.year()).month(he.month())),!s.inline&&Z()):(F(-1),G()),E("M")},selectYear:function selectYear(a){var e=parseInt(t(a.target).text(),10)||0;he.year(e),we===u?(X(ge.clone().year(he.year())),!s.inline&&Z()):(F(-1),G()),E("YYYY")},selectDecade:function selectDecade(a){var e=parseInt(t(a.target).data("selection"),10)||0;he.year(e),we===u?(X(ge.clone().year(he.year())),!s.inline&&Z()):(F(-1),G()),E("YYYY")},selectDay:function selectDay(a){var e=he.clone();t(a.target).is(".old")&&e.subtract(1,"M"),t(a.target).is(".new")&&e.add(1,"M"),X(e.date(parseInt(t(a.target).text(),10))),x()||s.keepOpen||s.inline||Z()},incrementHours:function incrementHours(){var e=ge.clone().add(1,"h");R(e,"h")&&X(e)},incrementMinutes:function incrementMinutes(){var e=ge.clone().add(s.stepping,"m");R(e,"m")&&X(e)},incrementSeconds:function incrementSeconds(){var e=ge.clone().add(1,"s");R(e,"s")&&X(e)},decrementHours:function decrementHours(){var e=ge.clone().subtract(1,"h");R(e,"h")&&X(e)},decrementMinutes:function decrementMinutes(){var e=ge.clone().subtract(s.stepping,"m");R(e,"m")&&X(e)},decrementSeconds:function decrementSeconds(){var e=ge.clone().subtract(1,"s");R(e,"s")&&X(e)},togglePeriod:function togglePeriod(){X(ge.clone().add(12<=ge.hours()?-12:12,"h"))},togglePicker:function togglePicker(a){var e=t(a.target),o=e.closest("ul"),n=o.find(".in"),d=o.find(".collapse:not(.in)"),s;if(n&&n.length){if(s=n.data("collapse"),s&&s.transitioning)return;n.collapse?(n.collapse("hide"),d.collapse("show")):(n.removeClass("in"),d.addClass("in")),e.is("span")?t(".timepicker-picker").closest(".collapse").hasClass("in")||"true"===t(".timepicker-picker").closest(".collapsing").attr("aria-expanded")?e.text("calendar_today").attr({title:"Select date"}):e.text("access_time").attr({title:"Select time"}):t(".timepicker-picker").closest(".collapse").hasClass("in")||"true"===t(".timepicker-picker").closest(".collapsing").attr("aria-expanded")?e.find("span").text("calendar_today").attr({title:"Select date"}):e.find("span").text("access_time").attr({title:"Select time"})}},showPicker:function showPicker(){p.find(".timepicker > div:not(.timepicker-picker)").hide(),p.find(".timepicker .timepicker-picker").show()},showHours:function showHours(){p.find(".timepicker .timepicker-picker").hide(),p.find(".timepicker .timepicker-hours").show()},showMinutes:function showMinutes(){p.find(".timepicker .timepicker-picker").hide(),p.find(".timepicker .timepicker-minutes").show()},showSeconds:function showSeconds(){p.find(".timepicker .timepicker-picker").hide(),p.find(".timepicker .timepicker-seconds").show()},selectHour:function selectHour(a){var e=parseInt(t(a.target).text(),10);ye||(12<=ge.hours()?12!==e&&(e+=12):12===e&&(e=0)),X(ge.clone().hours(e)),ae.showPicker.call(l)},selectMinute:function selectMinute(a){X(ge.clone().minutes(parseInt(t(a.target).text(),10))),ae.showPicker.call(l)},selectSecond:function selectSecond(a){X(ge.clone().seconds(parseInt(t(a.target).text(),10))),ae.showPicker.call(l)},clear:ee,today:function today(){var e=C();R(e,"d")&&X(e)},close:Z},oe=function(a){return!t(a.currentTarget).is(".disabled")&&(ae[t(a.currentTarget).data("action")].apply(l,arguments),!1)},/**
             * Shows the widget. Possibly will emit dp.show and dp.change
             */ie=function(){var e;return fe.prop("disabled")||!s.ignoreReadonly&&fe.prop("readonly")||p?l:(void 0!==fe.val()&&0!==fe.val().trim().length?X(te(fe.val().trim())):r&&s.useCurrent&&(s.inline||fe.is("input")&&0===fe.val().trim().length)&&(e=C(),"string"==typeof s.useCurrent&&(e={year:function year(e){return e.month(0).date(1).hours(0).seconds(0).minutes(0)},month:function month(e){return e.date(1).hours(0).seconds(0).minutes(0)},day:function day(e){return e.hours(0).seconds(0).minutes(0)},hour:function hour(e){return e.seconds(0).minutes(0)},minute:function minute(e){return e.seconds(0)}}[s.useCurrent](e)),X(e)),p=O(),A(),V(),p.find(".timepicker-hours").hide(),p.find(".timepicker-minutes").hide(),p.find(".timepicker-seconds").hide(),Q(),F(),t(window).on("resize",_),p.on("click","[data-action]",oe),p.on("mousedown",!1),c&&c.hasClass("btn")&&c.toggleClass("active"),_(),p.show(),s.focusOnShow&&!fe.is(":focus")&&fe.focus(),P({type:"dp.show"}),l)},/**
             * Shows or hides the widget
             */ne=function(){return p?Z():ie()},de=function(t){var e=null,a=[],o={},n=t.which,d,r,c,u;for(d in v[n]="p",v)v.hasOwnProperty(d)&&"p"===v[d]&&(a.push(d),parseInt(d,10)!==n&&(o[d]=!0));for(d in s.keyBinds)if(s.keyBinds.hasOwnProperty(d)&&"function"==typeof s.keyBinds[d]&&(c=d.split(" "),c.length===a.length&&b[n]===c[c.length-1])){for(u=!0,r=c.length-2;0<=r;r--)if(!(b[c[r]]in o)){u=!1;break}if(u){e=s.keyBinds[d];break}}e&&(e.call(l,p),t.stopPropagation(),t.preventDefault())},se=function(t){v[t.which]="r",t.stopPropagation(),t.preventDefault()},le=function(a){var e=t(a.target).val().trim(),o=e?te(e):null;return X(o),a.stopImmediatePropagation(),!1},re=function(){fe.on({change:le,blur:s.debug?"":Z,keydown:de,keyup:se,focus:s.allowInputToggle?ie:""}),d.is("input")?fe.on({focus:ie}):c&&(c.on("click",ne),c.on("mousedown",!1))},ce=function(){fe.off({change:le,blur:blur,keydown:de,keyup:se,focus:s.allowInputToggle?Z:""}),d.is("input")?fe.off({focus:ie}):c&&(c.off("click",ne),c.off("mousedown",!1))},pe=function(e){// Store given enabledDates and disabledDates as keys.
// This way we can check their existence in O(1) time instead of looping through whole array.
// (for example: options.enabledDates['2014-02-27'] === true)
var a={};return t.each(e,function(){var e=te(this);e.isValid()&&(a[e.format("YYYY-MM-DD")]=!0)}),!!Object.keys(a).length&&a},ue=function(e){// Store given enabledHours and disabledHours as keys.
// This way we can check their existence in O(1) time instead of looping through whole array.
// (for example: options.enabledHours['2014-02-27'] === true)
var a={};return t.each(e,function(){a[this]=!0}),!!Object.keys(a).length&&a},me=function(){var e=s.format||"L LT";be=e.replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(e){var t=ge.localeData().longDateFormat(e)||e;return t.replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(e){//temp fix for #740
return ge.localeData().longDateFormat(e)||e})}),ve=s.extraFormats?s.extraFormats.slice():[],0>ve.indexOf(e)&&0>ve.indexOf(be)&&ve.push(be),ye=1>be.toLowerCase().indexOf("a")&&1>be.replace(/\[.*?\]/g,"").indexOf("h"),k("y")&&(u=2),k("M")&&(u=1),k("d")&&(u=0),we=o(u,we),r||X(ge)},ge,he,fe,ye,be,ve,we;/********************************************************************************
         *
         * Public API functions
         * =====================
         *
         * Important: Do not expose direct references to private objects or the options
         * object to the outer world. Always return a clone when returning values or make
         * a clone when setting a private variable.
         *
         ********************************************************************************/ // initializing element and component attributes
if(l.destroy=function(){Z(),ce(),d.removeData("DateTimePicker"),d.removeData("date")},l.toggle=ne,l.show=ie,l.hide=Z,l.disable=function(){return Z(),c&&c.hasClass("btn")&&c.addClass("disabled"),fe.prop("disabled",!0),l},l.enable=function(){return c&&c.hasClass("btn")&&c.removeClass("disabled"),fe.prop("disabled",!1),l},l.ignoreReadonly=function(e){if(0===arguments.length)return s.ignoreReadonly;if("boolean"!=typeof e)throw new TypeError("ignoreReadonly () expects a boolean parameter");return s.ignoreReadonly=e,l},l.options=function(e){if(0===arguments.length)return t.extend(!0,{},s);if(!(e instanceof Object))throw new TypeError("options() options parameter should be an object");return t.extend(!0,s,e),t.each(s,function(e,t){if(void 0!==l[e])l[e](t);else throw new TypeError("option "+e+" is not recognized!")}),l},l.date=function(t){///<signature helpKeyword="$.fn.datetimepicker.date">
///<summary>Returns the component's model current date, a moment object or null if not set.</summary>
///<returns type="Moment">date.clone()</returns>
///</signature>
///<signature>
///<summary>Sets the components model current moment to it. Passing a null value unsets the components model current moment. Parsing of the newDate parameter is made using moment library with the options.format and options.useStrict components configuration.</summary>
///<param name="newDate" locid="$.fn.datetimepicker.date_p:newDate">Takes string, Date, moment, null parameter.</param>
///</signature>
if(0===arguments.length)return r?null:ge.clone();if(null!==t&&"string"!=typeof t&&!e.isMoment(t)&&!(t instanceof Date))throw new TypeError("date() parameter must be one of [null, string, moment or Date]");return X(null===t?null:te(t)),l},l.format=function(e){///<summary>test su</summary>
///<param name="newFormat">info about para</param>
///<returns type="string|boolean">returns foo</returns>
if(0===arguments.length)return s.format;if("string"!=typeof e&&("boolean"!=typeof e||!1!==e))throw new TypeError("format() expects a string or boolean:false parameter "+e);return s.format=e,be&&me(),l},l.timeZone=function(e){if(0===arguments.length)return s.timeZone;if("string"!=typeof e)throw new TypeError("newZone() expects a string parameter");return s.timeZone=e,l},l.dayViewHeaderFormat=function(e){if(0===arguments.length)return s.dayViewHeaderFormat;if("string"!=typeof e)throw new TypeError("dayViewHeaderFormat() expects a string parameter");return s.dayViewHeaderFormat=e,l},l.extraFormats=function(e){if(0===arguments.length)return s.extraFormats;if(!1!==e&&!(e instanceof Array))throw new TypeError("extraFormats() expects an array or false parameter");return s.extraFormats=e,ve&&me(),l},l.disabledDates=function(e){///<signature helpKeyword="$.fn.datetimepicker.disabledDates">
///<summary>Returns an array with the currently set disabled dates on the component.</summary>
///<returns type="array">options.disabledDates</returns>
///</signature>
///<signature>
///<summary>Setting this takes precedence over options.minDate, options.maxDate configuration. Also calling this function removes the configuration of
///options.enabledDates if such exist.</summary>
///<param name="dates" locid="$.fn.datetimepicker.disabledDates_p:dates">Takes an [ string or Date or moment ] of values and allows the user to select only from those days.</param>
///</signature>
if(0===arguments.length)return s.disabledDates?t.extend({},s.disabledDates):s.disabledDates;if(!e)return s.disabledDates=!1,Q(),l;if(!(e instanceof Array))throw new TypeError("disabledDates() expects an array parameter");return s.disabledDates=pe(e),s.enabledDates=!1,Q(),l},l.enabledDates=function(e){///<signature helpKeyword="$.fn.datetimepicker.enabledDates">
///<summary>Returns an array with the currently set enabled dates on the component.</summary>
///<returns type="array">options.enabledDates</returns>
///</signature>
///<signature>
///<summary>Setting this takes precedence over options.minDate, options.maxDate configuration. Also calling this function removes the configuration of options.disabledDates if such exist.</summary>
///<param name="dates" locid="$.fn.datetimepicker.enabledDates_p:dates">Takes an [ string or Date or moment ] of values and allows the user to select only from those days.</param>
///</signature>
if(0===arguments.length)return s.enabledDates?t.extend({},s.enabledDates):s.enabledDates;if(!e)return s.enabledDates=!1,Q(),l;if(!(e instanceof Array))throw new TypeError("enabledDates() expects an array parameter");return s.enabledDates=pe(e),s.disabledDates=!1,Q(),l},l.daysOfWeekDisabled=function(e){if(0===arguments.length)return s.daysOfWeekDisabled.splice(0);if("boolean"==typeof e&&!e)return s.daysOfWeekDisabled=!1,Q(),l;if(!(e instanceof Array))throw new TypeError("daysOfWeekDisabled() expects an array parameter");if(s.daysOfWeekDisabled=e.reduce(function(e,t){return(t=parseInt(t,10),6<t||0>t||isNaN(t))?e:(-1===e.indexOf(t)&&e.push(t),e)},[]).sort(),s.useCurrent&&!s.keepInvalid){for(var t=0;!R(ge,"d");){if(ge.add(1,"d"),31===t)throw"Tried 31 times to find a valid date";t++}X(ge)}return Q(),l},l.maxDate=function(e){if(0===arguments.length)return s.maxDate?s.maxDate.clone():s.maxDate;if("boolean"==typeof e&&!1===e)return s.maxDate=!1,Q(),l;"string"==typeof e&&("now"===e||"moment"===e)&&(e=C());var t=te(e);if(!t.isValid())throw new TypeError("maxDate() Could not parse date parameter: "+e);if(s.minDate&&t.isBefore(s.minDate))throw new TypeError("maxDate() date parameter is before options.minDate: "+t.format(be));return s.maxDate=t,s.useCurrent&&!s.keepInvalid&&ge.isAfter(e)&&X(s.maxDate),he.isAfter(t)&&(he=t.clone().subtract(s.stepping,"m")),Q(),l},l.minDate=function(e){if(0===arguments.length)return s.minDate?s.minDate.clone():s.minDate;if("boolean"==typeof e&&!1===e)return s.minDate=!1,Q(),l;"string"==typeof e&&("now"===e||"moment"===e)&&(e=C());var t=te(e);if(!t.isValid())throw new TypeError("minDate() Could not parse date parameter: "+e);if(s.maxDate&&t.isAfter(s.maxDate))throw new TypeError("minDate() date parameter is after options.maxDate: "+t.format(be));return s.minDate=t,s.useCurrent&&!s.keepInvalid&&ge.isBefore(e)&&X(s.minDate),he.isBefore(t)&&(he=t.clone().add(s.stepping,"m")),Q(),l},l.defaultDate=function(e){///<signature helpKeyword="$.fn.datetimepicker.defaultDate">
///<summary>Returns a moment with the options.defaultDate option configuration or false if not set</summary>
///<returns type="Moment">date.clone()</returns>
///</signature>
///<signature>
///<summary>Will set the picker's inital date. If a boolean:false value is passed the options.defaultDate parameter is cleared.</summary>
///<param name="defaultDate" locid="$.fn.datetimepicker.defaultDate_p:defaultDate">Takes a string, Date, moment, boolean:false</param>
///</signature>
if(0===arguments.length)return s.defaultDate?s.defaultDate.clone():s.defaultDate;if(!e)return s.defaultDate=!1,l;"string"==typeof e&&("now"===e||"moment"===e?e=C():e=C(e));var t=te(e);if(!t.isValid())throw new TypeError("defaultDate() Could not parse date parameter: "+e);if(!R(t))throw new TypeError("defaultDate() date passed is invalid according to component setup validations");return s.defaultDate=t,(s.defaultDate&&s.inline||""===fe.val().trim())&&X(s.defaultDate),l},l.locale=function(t){if(0===arguments.length)return s.locale;if(!e.localeData(t))throw new TypeError("locale() locale "+t+" is not loaded from moment locales!");return s.locale=t,ge.locale(s.locale),he.locale(s.locale),be&&me(),p&&(Z(),ie()),l},l.stepping=function(e){return 0===arguments.length?s.stepping:(e=parseInt(e,10),(isNaN(e)||1>e)&&(e=1),s.stepping=e,l)},l.useCurrent=function(e){var t=["year","month","day","hour","minute"];if(0===arguments.length)return s.useCurrent;if("boolean"!=typeof e&&"string"!=typeof e)throw new TypeError("useCurrent() expects a boolean or string parameter");if("string"==typeof e&&-1===t.indexOf(e.toLowerCase()))throw new TypeError("useCurrent() expects a string parameter of "+t.join(", "));return s.useCurrent=e,l},l.collapse=function(e){if(0===arguments.length)return s.collapse;if("boolean"!=typeof e)throw new TypeError("collapse() expects a boolean parameter");return s.collapse===e?l:(s.collapse=e,p&&(Z(),ie()),l)},l.icons=function(e){if(0===arguments.length)return t.extend({},s.icons);if(!(e instanceof Object))throw new TypeError("icons() expects parameter to be an Object");return t.extend(s.icons,e),p&&(Z(),ie()),l},l.tooltips=function(e){if(0===arguments.length)return t.extend({},s.tooltips);if(!(e instanceof Object))throw new TypeError("tooltips() expects parameter to be an Object");return t.extend(s.tooltips,e),p&&(Z(),ie()),l},l.useStrict=function(e){if(0===arguments.length)return s.useStrict;if("boolean"!=typeof e)throw new TypeError("useStrict() expects a boolean parameter");return s.useStrict=e,l},l.sideBySide=function(e){if(0===arguments.length)return s.sideBySide;if("boolean"!=typeof e)throw new TypeError("sideBySide() expects a boolean parameter");return s.sideBySide=e,p&&(Z(),ie()),l},l.viewMode=function(e){if(0===arguments.length)return s.viewMode;if("string"!=typeof e)throw new TypeError("viewMode() expects a string parameter");if(-1===g.indexOf(e))throw new TypeError("viewMode() parameter must be one of ("+g.join(", ")+") value");return s.viewMode=e,we=o(g.indexOf(e),u),F(),l},l.toolbarPlacement=function(e){if(0===arguments.length)return s.toolbarPlacement;if("string"!=typeof e)throw new TypeError("toolbarPlacement() expects a string parameter");if(-1===y.indexOf(e))throw new TypeError("toolbarPlacement() parameter must be one of ("+y.join(", ")+") value");return s.toolbarPlacement=e,p&&(Z(),ie()),l},l.widgetPositioning=function(e){if(0===arguments.length)return t.extend({},s.widgetPositioning);if("[object Object]"!=={}.toString.call(e))throw new TypeError("widgetPositioning() expects an object variable");if(e.horizontal){if("string"!=typeof e.horizontal)throw new TypeError("widgetPositioning() horizontal variable must be a string");if(e.horizontal=e.horizontal.toLowerCase(),-1===f.indexOf(e.horizontal))throw new TypeError("widgetPositioning() expects horizontal parameter to be one of ("+f.join(", ")+")");s.widgetPositioning.horizontal=e.horizontal}if(e.vertical){if("string"!=typeof e.vertical)throw new TypeError("widgetPositioning() vertical variable must be a string");if(e.vertical=e.vertical.toLowerCase(),-1===h.indexOf(e.vertical))throw new TypeError("widgetPositioning() expects vertical parameter to be one of ("+h.join(", ")+")");s.widgetPositioning.vertical=e.vertical}return Q(),l},l.calendarWeeks=function(e){if(0===arguments.length)return s.calendarWeeks;if("boolean"!=typeof e)throw new TypeError("calendarWeeks() expects parameter to be a boolean value");return s.calendarWeeks=e,Q(),l},l.showTodayButton=function(e){if(0===arguments.length)return s.showTodayButton;if("boolean"!=typeof e)throw new TypeError("showTodayButton() expects a boolean parameter");return s.showTodayButton=e,p&&(Z(),ie()),l},l.showClear=function(e){if(0===arguments.length)return s.showClear;if("boolean"!=typeof e)throw new TypeError("showClear() expects a boolean parameter");return s.showClear=e,p&&(Z(),ie()),l},l.widgetParent=function(e){if(0===arguments.length)return s.widgetParent;if("string"==typeof e&&(e=t(e)),null!==e&&"string"!=typeof e&&!(e instanceof t))throw new TypeError("widgetParent() expects a string or a jQuery object parameter");return s.widgetParent=e,p&&(Z(),ie()),l},l.keepOpen=function(e){if(0===arguments.length)return s.keepOpen;if("boolean"!=typeof e)throw new TypeError("keepOpen() expects a boolean parameter");return s.keepOpen=e,l},l.focusOnShow=function(e){if(0===arguments.length)return s.focusOnShow;if("boolean"!=typeof e)throw new TypeError("focusOnShow() expects a boolean parameter");return s.focusOnShow=e,l},l.inline=function(e){if(0===arguments.length)return s.inline;if("boolean"!=typeof e)throw new TypeError("inline() expects a boolean parameter");return s.inline=e,l},l.clear=function(){return ee(),l},l.keyBinds=function(e){return 0===arguments.length?s.keyBinds:(s.keyBinds=e,l)},l.getMoment=function(e){return C(e)},l.debug=function(e){if("boolean"!=typeof e)throw new TypeError("debug() expects a boolean parameter");return s.debug=e,l},l.allowInputToggle=function(e){if(0===arguments.length)return s.allowInputToggle;if("boolean"!=typeof e)throw new TypeError("allowInputToggle() expects a boolean parameter");return s.allowInputToggle=e,l},l.showClose=function(e){if(0===arguments.length)return s.showClose;if("boolean"!=typeof e)throw new TypeError("showClose() expects a boolean parameter");return s.showClose=e,l},l.keepInvalid=function(e){if(0===arguments.length)return s.keepInvalid;if("boolean"!=typeof e)throw new TypeError("keepInvalid() expects a boolean parameter");return s.keepInvalid=e,l},l.datepickerInput=function(e){if(0===arguments.length)return s.datepickerInput;if("string"!=typeof e)throw new TypeError("datepickerInput() expects a string parameter");return s.datepickerInput=e,l},l.parseInputDate=function(e){if(0===arguments.length)return s.parseInputDate;if("function"!=typeof e)throw new TypeError("parseInputDate() sholud be as function");return s.parseInputDate=e,l},l.disabledTimeIntervals=function(e){///<signature helpKeyword="$.fn.datetimepicker.disabledTimeIntervals">
///<summary>Returns an array with the currently set disabled dates on the component.</summary>
///<returns type="array">options.disabledTimeIntervals</returns>
///</signature>
///<signature>
///<summary>Setting this takes precedence over options.minDate, options.maxDate configuration. Also calling this function removes the configuration of
///options.enabledDates if such exist.</summary>
///<param name="dates" locid="$.fn.datetimepicker.disabledTimeIntervals_p:dates">Takes an [ string or Date or moment ] of values and allows the user to select only from those days.</param>
///</signature>
if(0===arguments.length)return s.disabledTimeIntervals?t.extend({},s.disabledTimeIntervals):s.disabledTimeIntervals;if(!e)return s.disabledTimeIntervals=!1,Q(),l;if(!(e instanceof Array))throw new TypeError("disabledTimeIntervals() expects an array parameter");return s.disabledTimeIntervals=e,Q(),l},l.disabledHours=function(e){///<signature helpKeyword="$.fn.datetimepicker.disabledHours">
///<summary>Returns an array with the currently set disabled hours on the component.</summary>
///<returns type="array">options.disabledHours</returns>
///</signature>
///<signature>
///<summary>Setting this takes precedence over options.minDate, options.maxDate configuration. Also calling this function removes the configuration of
///options.enabledHours if such exist.</summary>
///<param name="hours" locid="$.fn.datetimepicker.disabledHours_p:hours">Takes an [ int ] of values and disallows the user to select only from those hours.</param>
///</signature>
if(0===arguments.length)return s.disabledHours?t.extend({},s.disabledHours):s.disabledHours;if(!e)return s.disabledHours=!1,Q(),l;if(!(e instanceof Array))throw new TypeError("disabledHours() expects an array parameter");if(s.disabledHours=ue(e),s.enabledHours=!1,s.useCurrent&&!s.keepInvalid){for(var a=0;!R(ge,"h");){if(ge.add(1,"h"),24===a)throw"Tried 24 times to find a valid date";a++}X(ge)}return Q(),l},l.enabledHours=function(e){///<signature helpKeyword="$.fn.datetimepicker.enabledHours">
///<summary>Returns an array with the currently set enabled hours on the component.</summary>
///<returns type="array">options.enabledHours</returns>
///</signature>
///<signature>
///<summary>Setting this takes precedence over options.minDate, options.maxDate configuration. Also calling this function removes the configuration of options.disabledHours if such exist.</summary>
///<param name="hours" locid="$.fn.datetimepicker.enabledHours_p:hours">Takes an [ int ] of values and allows the user to select only from those hours.</param>
///</signature>
if(0===arguments.length)return s.enabledHours?t.extend({},s.enabledHours):s.enabledHours;if(!e)return s.enabledHours=!1,Q(),l;if(!(e instanceof Array))throw new TypeError("enabledHours() expects an array parameter");if(s.enabledHours=ue(e),s.disabledHours=!1,s.useCurrent&&!s.keepInvalid){for(var a=0;!R(ge,"h");){if(ge.add(1,"h"),24===a)throw"Tried 24 times to find a valid date";a++}X(ge)}return Q(),l},l.viewDate=function(t){if(0===arguments.length)return he.clone();if(!t)return he=ge.clone(),l;if("string"!=typeof t&&!e.isMoment(t)&&!(t instanceof Date))throw new TypeError("viewDate() parameter must be one of [string, moment or Date]");return he=te(t),E(),l},d.is("input"))fe=d;else if(fe=d.find(s.datepickerInput),0===fe.length)fe=d.find("input");else if(!fe.is("input"))throw new Error("CSS class \""+s.datepickerInput+"\" cannot be applied to non input element");if(d.hasClass("input-group")&&(0===d.find(".datepickerbutton").length?c=d.find(".input-group-addon"):c=d.find(".datepickerbutton")),!s.inline&&!fe.is("input"))throw new Error("Could not initialize DateTimePicker without an input element");// Set defaults for date here now instead of in var declaration
return ge=C(),he=ge.clone(),t.extend(!0,s,function dataToOptions(){var e={},a;return a=d.is("input")||s.inline?d.data():d.find("input").data(),a.dateOptions&&a.dateOptions instanceof Object&&(e=t.extend(!0,e,a.dateOptions)),t.each(s,function(t){var o="date"+t.charAt(0).toUpperCase()+t.slice(1);void 0!==a[o]&&(e[t]=a[o])}),e}()),l.options(s),me(),re(),fe.prop("disabled")&&l.disable(),fe.is("input")&&0!==fe.val().trim().length?X(te(fe.val().trim())):s.defaultDate&&void 0===fe.attr("placeholder")&&X(s.defaultDate),s.inline&&ie(),l};/********************************************************************************
     *
     * jQuery plugin constructor and defaults object
     *
     ********************************************************************************/ /**
    * See (http://jquery.com/).
    * @name jQuery
    * @class
    * See the jQuery Library  (http://jquery.com/) for full details.  This just
    * documents the function and classes that are added to jQuery by this plug-in.
    */ /**
     * See (http://jquery.com/)
     * @name fn
     * @class
     * See the jQuery Library  (http://jquery.com/) for full details.  This just
     * documents the function and classes that are added to jQuery by this plug-in.
     * @memberOf jQuery
     */ /**
     * Show comments
     * @class datetimepicker
     * @memberOf jQuery.fn
     */return t.fn.datetimepicker=function(e){e=e||{};var a=Array.prototype.slice.call(arguments,1),o=!0,n;if("object"===_typeof(e))return this.each(function(){var a=t(this),o;a.data("DateTimePicker")||(o=t.extend(!0,{},t.fn.datetimepicker.defaults,e),a.data("DateTimePicker",d(a,o)))});if("string"==typeof e)return this.each(function(){var d=t(this),s=d.data("DateTimePicker");if(!s)throw new Error("bootstrap-datetimepicker(\""+e+"\") method was called on an element that is not using DateTimePicker");n=s[e].apply(s,a),o=n===s}),o||-1<t.inArray(e,["destroy","hide","show","toggle"])?this:n;throw new TypeError("Invalid arguments for DateTimePicker: "+e)},t.fn.datetimepicker.defaults={timeZone:"",format:!1,dayViewHeaderFormat:"MMMM YYYY",extraFormats:!1,stepping:1,minDate:!1,maxDate:!1,useCurrent:!0,collapse:!0,locale:e.locale(),defaultDate:!1,disabledDates:!1,enabledDates:!1,icons:{time:"material-icons material-icons-time",date:"material-icons material-icons-calendar",up:"material-icons material-icons-chevron-up",down:"material-icons material-icons-chevron-down",previous:"material-icons material-icons-chevron-left",next:"material-icons material-icons-chevron-right",today:"material-icons material-icons-screenshot",clear:"material-icons material-icons-trash",close:"material-icons material-icons-remove"},tooltips:{today:"Go to today",clear:"Clear selection",close:"Close the picker",selectMonth:"Select Month",prevMonth:"Previous Month",nextMonth:"Next Month",selectYear:"Select Year",prevYear:"Previous Year",nextYear:"Next Year",selectDecade:"Select Decade",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevCentury:"Previous Century",nextCentury:"Next Century",pickHour:"Pick Hour",incrementHour:"Increment Hour",decrementHour:"Decrement Hour",pickMinute:"Pick Minute",incrementMinute:"Increment Minute",decrementMinute:"Decrement Minute",pickSecond:"Pick Second",incrementSecond:"Increment Second",decrementSecond:"Decrement Second",togglePeriod:"Toggle Period",selectTime:"Select Time"},useStrict:!1,sideBySide:!1,daysOfWeekDisabled:!1,calendarWeeks:!1,viewMode:"days",toolbarPlacement:"default",showTodayButton:!1,showClear:!1,showClose:!1,widgetPositioning:{horizontal:"auto",vertical:"auto"},widgetParent:null,ignoreReadonly:!1,keepOpen:!1,focusOnShow:!0,inline:!1,keepInvalid:!1,datepickerInput:".datepickerinput",keyBinds:{up:function up(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")?this.date(t.clone().subtract(7,"d")):this.date(t.clone().add(this.stepping(),"m"))}},down:function down(e){if(!e)return void this.show();var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")?this.date(t.clone().add(7,"d")):this.date(t.clone().subtract(this.stepping(),"m"))},"control up":function controlUp(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")?this.date(t.clone().subtract(1,"y")):this.date(t.clone().add(1,"h"))}},"control down":function controlDown(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")?this.date(t.clone().add(1,"y")):this.date(t.clone().subtract(1,"h"))}},left:function left(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")&&this.date(t.clone().subtract(1,"d"))}},right:function right(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")&&this.date(t.clone().add(1,"d"))}},pageUp:function pageUp(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")&&this.date(t.clone().subtract(1,"M"))}},pageDown:function pageDown(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")&&this.date(t.clone().add(1,"M"))}},enter:function enter(){this.hide()},escape:function escape(){this.hide()},//tab: function (widget) { //this break the flow of the form. disabling for now
//    var toggle = widget.find('.picker-switch a[data-action="togglePicker"]');
//    if(toggle.length > 0) toggle.click();
//},
"control space":function controlSpace(e){!e||e.find(".timepicker").is(":visible")&&e.find(".btn[data-action=\"togglePeriod\"]").click()},t:function t(){this.date(this.getMoment())},delete:function _delete(){this.clear()}},debug:!1,allowInputToggle:!1,disabledTimeIntervals:!1,disabledHours:!1,enabledHours:!1,viewDate:!1},t.fn.datetimepicker}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};(function(t,a){var o;return a.Offcanvas=o=function(){function Offcanvas(a){var o;this.element=a,this.bodyOverflow=e(this.bodyOverflow,this),this._sendEventsAfter=e(this._sendEventsAfter,this),this._sendEventsBefore=e(this._sendEventsBefore,this),this._close=e(this._close,this),this._open=e(this._open,this),this._clicked=e(this._clicked,this),this._navbarHeight=e(this._navbarHeight,this),o=!!this.element.attr("data-target")&&this.element.attr("data-target"),o?(this.target=t(o),this.target.length&&!this.target.hasClass("js-offcanvas-done")&&(this.element.addClass("js-offcanvas-has-events"),this.location=this.target.hasClass("navbar-offcanvas-right")?"right":"left",this.target.addClass(this._transformSupported()?"offcanvas-transform js-offcanvas-done":"offcanvas-position js-offcanvas-done"),this.target.data("offcanvas",this),this.element.on("click",this._clicked),this.target.on("transitionend",function(e){return function(){if(e.target.is(":not(.in)"))return e.target.height("")}}(this)),this.target.on("offcanvas.toggle",function(t){return function(a){return t._clicked(a)}}(this)),this.target.on("offcanvas.close",function(t){return function(a){return t._close(a)}}(this)),this.target.on("offcanvas.open",function(t){return function(a){return t._open(a)}}(this)))):console.warn("Offcanvas: `data-target` attribute must be present.")}return Offcanvas.prototype._navbarHeight=function(){if(this.target.is(".in"))return this.target.height(t(a).outerHeight()-t("#fusion-toolbar").outerHeight())},Offcanvas.prototype._clicked=function(a){return a.preventDefault(),this._sendEventsBefore(),t(".navbar-offcanvas").not(this.target).trigger("offcanvas.close"),this.target.toggleClass("in"),this.element.toggleClass("is-open"),this._navbarHeight(),this.bodyOverflow()},Offcanvas.prototype._open=function(t){if(t.preventDefault(),!this.target.is(".in"))return this._sendEventsBefore(),this.target.addClass("in"),this.element.addClass("is-open"),this._navbarHeight(),this.bodyOverflow()},Offcanvas.prototype._close=function(t){if(t.preventDefault(),!this.target.is(":not(.in)"))return this._sendEventsBefore(),this.target.removeClass("in"),this.element.removeClass("is-open"),this._navbarHeight(),this.bodyOverflow()},Offcanvas.prototype._sendEventsBefore=function(){return this.target.hasClass("in")?this.target.trigger("hide.bs.offcanvas"):this.target.trigger("show.bs.offcanvas")},Offcanvas.prototype._sendEventsAfter=function(){return this.target.hasClass("in")?this.target.trigger("shown.bs.offcanvas"):this.target.trigger("hidden.bs.offcanvas")},Offcanvas.prototype.bodyOverflow=function(e){// if (this.target.is(".in")) {
//     $("body").addClass("offcanvas-stop-scrolling");
// } else {
//     $("body").removeClass("offcanvas-stop-scrolling");
// }
if(null==e&&(e=!0),e)return this._sendEventsAfter()},Offcanvas.prototype._transformSupported=function(){var e,t,a,o;return t=document.createElement("div"),o="translate3d(0px, 0px, 0px)",a=/translate3d\(0px, 0px, 0px\)/g,t.style.cssText="-webkit-transform: "+o+"; -moz-transform: "+o+"; -o-transform: "+o+"; transform: "+o,e=t.style.cssText.match(a),null!=e.length},Offcanvas}(),t.fn.bsOffcanvas=function(){return this.each(function(){return new o(t(this))})},t(function(){return t("[data-toggle=\"offcanvas\"]").each(function(){return t(this).bsOffcanvas()}),t(".offcanvas-toggle").each(function(){return t(this).on("click",function(){var e,a;if(!t(this).hasClass("js-offcanvas-has-events")&&(a=t(this).attr("data-target"),e=t(a),e))return e.removeClass("in"),t("body").css({overflow:"",position:""})})})})})(window.jQuery,window)}.call(this),function(e,t){"function"==typeof define&&define.amd?define(t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t():e.ResizeSensor=t()}("undefined"==typeof window?this:window,function(){var e=Math.round;/**
     * Iterate over each of the provided element(s).
     *
     * @param {HTMLElement|HTMLElement[]} elements
     * @param {Function}                  callback
     */function forEachElement(e,t){var a=Object.prototype.toString.call(e),o="[object Array]"===a||"[object NodeList]"===a||"[object HTMLCollection]"===a||"[object Object]"===a||"undefined"!=typeof jQuery&&e instanceof jQuery,n=0,d=e.length;if(o)for(;n<d;n++)t(e[n]);else t(e)}/**
     * Get element size
     * @param {HTMLElement} element
     * @returns {Object} {width, height}
     */function getElementSize(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var a=t.getBoundingClientRect();return{width:e(a.width),height:e(a.height)}}/**
     * Class for dimension change detection.
     *
     * @param {Element|Element[]|Elements|jQuery} element
     * @param {Function} callback
     *
     * @constructor
     */ // Make sure it does not throw in a SSR (Server Side Rendering) situation
if("undefined"==typeof window)return null;// Only used for the dirty checking, so the event callback count is limited to max 1 call per fps per sensor.
// In combination with the event based resize sensor this saves cpu time, because the sensor is too fast and
// would generate too many unnecessary events.
var t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)},a=function(e,o){/**
         *
         * @constructor
         */function EventQueue(){var e=[];this.add=function(t){e.push(t)};var t,a;this.call=function(){for(t=0,a=e.length;t<a;t++)e[t].call()},this.remove=function(o){var n=[];for(t=0,a=e.length;t<a;t++)e[t]!==o&&n.push(e[t]);e=n},this.length=function(){return e.length}}/**
         *
         * @param {HTMLElement} element
         * @param {Function}    resized
         */function attachResizeEvent(e,a){if(e){if(e.resizedAttached)return void e.resizedAttached.add(a);e.resizedAttached=new EventQueue,e.resizedAttached.add(a),e.resizeSensor=document.createElement("div"),e.resizeSensor.dir="ltr",e.resizeSensor.className="resize-sensor";var o="position: absolute; left: 0; top: 0; transition: 0s;";e.resizeSensor.style.cssText="position: absolute; left: -10px; top: -10px; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",e.resizeSensor.innerHTML="<div class=\"resize-sensor-expand\" style=\"position: absolute; left: -10px; top: -10px; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;\"><div style=\""+o+"\"></div></div><div class=\"resize-sensor-shrink\" style=\"position: absolute; left: -10px; top: -10px; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;\"><div style=\""+o+" width: 200%; height: 200%\"></div></div>",e.appendChild(e.resizeSensor);var n=window.getComputedStyle(e).getPropertyValue("position");"absolute"!==n&&"relative"!==n&&"fixed"!==n&&(e.style.position="relative");var d=e.resizeSensor.childNodes[0],s=d.childNodes[0],l=e.resizeSensor.childNodes[1],r=getElementSize(e),c=r.width,p=r.height,u=function(){//set display to block, necessary otherwise hidden elements won't ever work
var t=0===e.offsetWidth&&0===e.offsetHeight;if(t){var a=e.style.display;e.style.display="block"}s.style.width="100000px",s.style.height="100000px",d.scrollLeft=1e5,d.scrollTop=1e5,l.scrollLeft=1e5,l.scrollTop=1e5,t&&(e.style.display=a)},m,g,h,f;e.resizeSensor.resetSensor=u;var y=function(){g=0,m&&(c=h,p=f,e.resizedAttached&&e.resizedAttached.call())},b=function(){var a=getElementSize(e),o=a.width,n=a.height;m=o!=c||n!=p,m&&!g&&(g=t(y)),u()},v=function(e,t,a){e.attachEvent?e.attachEvent("on"+t,a):e.addEventListener(t,a)};v(d,"scroll",b),v(l,"scroll",b),t(u)}}forEachElement(e,function(e){attachResizeEvent(e,o)}),this.detach=function(t){a.detach(e,t)},this.reset=function(){e.resizeSensor.resetSensor()}};return a.reset=function(e){forEachElement(e,function(e){e.resizeSensor.resetSensor()})},a.detach=function(e,t){forEachElement(e,function(e){!e||e.resizedAttached&&"function"==typeof t&&(e.resizedAttached.remove(t),e.resizedAttached.length())||e.resizeSensor&&(e.contains(e.resizeSensor)&&e.removeChild(e.resizeSensor),delete e.resizeSensor,delete e.resizedAttached)})},a}),"use strict",function(e,t){"function"==typeof define&&define.amd?define(["./ResizeSensor.js"],t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t(require("./ResizeSensor.js")):(e.ElementQueries=t(e.ResizeSensor),e.ElementQueries.listen())}("undefined"==typeof window?this:window,function(t){var a=Math.round,o=function(){/**
         *
         * @param element
         * @returns {Number}
         */function getEmSize(e){e||(e=document.documentElement);var t=window.getComputedStyle(e,null).fontSize;return parseFloat(t)||16}/**
         * Get element size
         * @param {HTMLElement} element
         * @returns {Object} {width, height}
         */function getElementSize(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:a(t.width),height:a(t.height)}}/**
         *
         * @copyright https://github.com/Mr0grog/element-query/blob/master/LICENSE
         *
         * @param {HTMLElement} element
         * @param {*} value
         * @returns {*}
         */function convertToPx(e,t){var a=t.split(/\d/),o=a[a.length-1];switch(t=parseFloat(t),o){case"px":return t;case"em":return t*getEmSize(e);case"rem":return t*getEmSize();// Viewport units!
// According to http://quirksmode.org/mobile/tableViewport.html
// documentElement.clientWidth/Height gets us the most reliable info
case"vw":return t*document.documentElement.clientWidth/100;case"vh":return t*document.documentElement.clientHeight/100;case"vmin":case"vmax":var n=document.documentElement.clientWidth/100,d=document.documentElement.clientHeight/100,s=Math["vmin"===o?"min":"max"];return t*s(n,d);default:return t;// for now, not supporting physical units (since they are just a set number of px)
// or ex/ch (getting accurate measurements is hard)
}}/**
         *
         * @param {HTMLElement} element
         * @param {String} id
         * @constructor
         */function SetupInformation(t,a){this.element=t;var o=["min-width","min-height","max-width","max-height"],n,d,s,l,r,c,p,u;this.call=function(){for(n in s=getElementSize(this.element),c={},e[a])e[a].hasOwnProperty(n)&&(d=e[a][n],l=convertToPx(this.element,d.value),r="width"===d.property?s.width:s.height,u=d.mode+"-"+d.property,p="","min"===d.mode&&r>=l&&(p+=d.value),"max"===d.mode&&r<=l&&(p+=d.value),c[u]||(c[u]=""),p&&-1===(" "+c[u]+" ").indexOf(" "+p+" ")&&(c[u]+=" "+p));for(var t in o)o.hasOwnProperty(t)&&(c[o[t]]?this.element.setAttribute(o[t],c[o[t]].substr(1)):this.element.removeAttribute(o[t]))}}/**
         * @param {HTMLElement} element
         * @param {Object}      id
         */function setupElement(e,a){e.elementQueriesSetupInformation||(e.elementQueriesSetupInformation=new SetupInformation(e,a)),e.elementQueriesSensor||(e.elementQueriesSensor=new t(e,function(){e.elementQueriesSetupInformation.call()})),e.elementQueriesSetupInformation.call()}/**
         * Stores rules to the selector that should be applied once resized.
         *
         * @param {String} selector
         * @param {String} mode min|max
         * @param {String} property width|height
         * @param {String} value
         */function queueQuery(t,a,n,d){if("undefined"==typeof e[t]){e[t]=[];// add animation to trigger animationstart event, so we know exactly when a element appears in the DOM
var s=o.length;l.innerHTML+="\n"+t+" {animation: 0.1s element-queries;}",l.innerHTML+="\n"+t+" > .resize-sensor {min-width: "+s+"px;}",o.push(t)}e[t].push({mode:a,property:n,value:d})}function getQuery(e){var t;if(document.querySelectorAll&&(t=e?e.querySelectorAll.bind(e):document.querySelectorAll.bind(document)),t||"undefined"==typeof $$||(t=$$),t||"undefined"==typeof jQuery||(t=jQuery),!t)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return t}/**
         * If animationStart didn't catch a new element in the DOM, we can manually search for it
         */function findElementQueriesElements(t){var a=getQuery(t);for(var o in e)if(e.hasOwnProperty(o))// find all elements based on the extract query selector from the element query rule
for(var n=a(o,t),d=0,s=n.length;d<s;d++)setupElement(n[d],o)}/**
         *
         * @param {HTMLElement} element
         */function attachResponsiveImage(e){function check(){var t=!1,r;for(r in a)a.hasOwnProperty(r)&&o[r].minWidth&&e.offsetWidth>o[r].minWidth&&(t=r);if(t||(t=d),s===t)a[t].src=n[t];else//image change
if(!l[t]){//image has not been loaded yet, we need to load the image first in memory to prevent flash of
//no content
var c=new Image;c.onload=function(){a[t].src=n[t],a[s].style.display="none",a[t].style.display="block",l[t]=!0,s=t},c.src=n[t]}else a[s].style.display="none",a[t].style.display="block",s=t}var a=[],o=[],n=[],d=0,s=-1,l=[];for(var r in e.children)if(e.children.hasOwnProperty(r)&&e.children[r].tagName&&"img"===e.children[r].tagName.toLowerCase()){a.push(e.children[r]);var c=e.children[r].getAttribute("min-width")||e.children[r].getAttribute("data-min-width"),p=e.children[r].getAttribute("data-src")||e.children[r].getAttribute("url");//var minHeight = element.children[i].getAttribute('min-height') || element.children[i].getAttribute('data-min-height');
n.push(p),o.push({minWidth:c}),c?e.children[r].style.display="none":(d=a.length-1,e.children[r].style.display="block")}s=d,e.resizeSensor=new t(e,check),check()}function findResponsiveImages(){for(var e=getQuery(),t=e("[data-responsive-image],[responsive-image]"),a=0,o=t.length;a<o;a++)attachResponsiveImage(t[a])}/**
         * @param {String} css
         */function extractQuery(e){var t,a,o,s;for(e=e.replace(/'/g,"\"");null!==(t=n.exec(e));)for(a=t[1]+t[3],o=t[2];null!==(s=d.exec(o));)queueQuery(a,s[1],s[2],s[3])}/**
         * @param {CssRule[]|String} rules
         */function readRules(e){var t="";if(e)if("string"==typeof e)e=e.toLowerCase(),(-1!==e.indexOf("min-width")||-1!==e.indexOf("max-width"))&&extractQuery(e);else for(var a=0,o=e.length;a<o;a++)1===e[a].type?(t=e[a].selectorText||e[a].cssText,-1!==t.indexOf("min-height")||-1!==t.indexOf("max-height")?extractQuery(t):(-1!==t.indexOf("min-width")||-1!==t.indexOf("max-width"))&&extractQuery(t)):4===e[a].type?readRules(e[a].cssRules||e[a].rules):3===e[a].type&&e[a].styleSheet.hasOwnProperty("cssRules")&&readRules(e[a].styleSheet.cssRules)}//<style> element with our dynamically created styles
var e={},o=[],n=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,d=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim,s=!1,l;//all rules found for element queries
this.init=function(){var e="animationstart";"undefined"==typeof document.documentElement.style.webkitAnimationName?"undefined"==typeof document.documentElement.style.MozAnimationName?"undefined"!=typeof document.documentElement.style.OAnimationName&&(e="oanimationstart"):e="mozanimationstart":e="webkitAnimationStart",document.body.addEventListener(e,function(a){var e=a.target,n=window.getComputedStyle(e,null);if(-1!==n.getPropertyValue("animation-name").indexOf("element-queries")){e.elementQueriesSensor=new t(e,function(){e.elementQueriesSetupInformation&&e.elementQueriesSetupInformation.call()});var d=window.getComputedStyle(e.resizeSensor,null),s=d.getPropertyValue("min-width");s=parseInt(s.replace("px","")),setupElement(a.target,o[s])}}),s||(l=document.createElement("style"),l.type="text/css",l.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",l.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(l),s=!0);for(var a=0,n=document.styleSheets.length;a<n;a++)try{document.styleSheets[a].href&&0===document.styleSheets[a].href.indexOf("file://")&&console.log("CssElementQueries: unable to parse local css files, "+document.styleSheets[a].href),readRules(document.styleSheets[a].cssRules||document.styleSheets[a].rules||document.styleSheets[a].cssText)}catch(t){}findResponsiveImages()},this.findElementQueriesElements=function(e){findElementQueriesElements(e)},this.update=function(){this.init()}};o.update=function(){o.instance.update()},o.detach=function(e){e.elementQueriesSetupInformation?(e.elementQueriesSensor.detach(),delete e.elementQueriesSetupInformation,delete e.elementQueriesSensor):e.resizeSensor&&(e.resizeSensor.detach(),delete e.resizeSensor)},o.init=function(){o.instance||(o.instance=new o),o.instance.init()};var n=function(e){/* Mozilla, Chrome, Opera */if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))/* Safari, iCab, Konqueror */var t=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(e(),clearInterval(t))},10);else window.onload=e;/* Other web browsers */};return o.findElementQueriesElements=function(e){o.instance.findElementQueriesElements(e)},o.listen=function(){n(o.init)},o}),function(){if("undefined"!=typeof window)try{var e=new window.CustomEvent("test",{cancelable:!0});if(e.preventDefault(),!0!==e.defaultPrevented)// IE has problems with .preventDefault() on custom events
// http://stackoverflow.com/questions/23349191
throw new Error("Could not prevent default")}catch(a){var t=function(e,t){var a,o;return t=t||{},t.bubbles=!!t.bubbles,t.cancelable=!!t.cancelable,a=document.createEvent("CustomEvent"),a.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o=a.preventDefault,a.preventDefault=function(){o.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function get(){return!0}})}catch(t){this.defaultPrevented=!0}},a};t.prototype=window.Event.prototype,window.CustomEvent=t}}(),!function(a,e){if("function"==typeof define&&define.amd)define(["module","exports"],e);else if("undefined"!=typeof exports)e(module,exports);else{var t={exports:{}};e(t,t.exports),a.fitty=t.exports}}(this,function(a,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=Object.assign||function(a){for(var e=1,o;e<arguments.length;e++)for(var d in o=arguments[e],o)Object.prototype.hasOwnProperty.call(o,d)&&(a[d]=o[d]);return a};e["default"]=function(C){function F(a,e){var d=o({},S,e),t=a.map(function(a){var e=o({},d,{element:a});return v(e),h(e),{element:a,fit:m(e,k.DIRTY),unsubscribe:y(e)}});return W(),t}function g(a){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof a?F(n(document.querySelectorAll(a)),e):F([a],e)[0]}if(C){var n=function(t){return[].slice.call(t)},k={IDLE:0,DIRTY_CONTENT:1,DIRTY_LAYOUT:2,DIRTY:3},r=[],x=null,W="requestAnimationFrame"in C?function(){C.cancelAnimationFrame(x),x=C.requestAnimationFrame(function(){t(r.filter(function(t){return t.dirty}))})}:function(){},u=function(t){return function(){r.forEach(function(a){a.dirty=t}),W()}},t=function(o){o.filter(function(t){return!t.styleComputed}).forEach(function(t){t.styleComputed=s(t)}),o.filter(f).forEach(d);var e=o.filter(c);e.forEach(l),e.forEach(function(t){d(t),a(t)}),e.forEach(p)},a=function(t){return t.dirty=k.IDLE},l=function(t){t.availableWidth=t.element.parentNode.clientWidth,t.currentWidth=t.element.scrollWidth,t.previousFontSize=t.currentFontSize,t.currentFontSize=Math.min(Math.max(t.minSize,t.availableWidth/t.currentWidth*t.previousFontSize),t.maxSize),t.whiteSpace=t.multiLine&&t.currentFontSize===t.minSize?"normal":"nowrap"},c=function(t){return t.dirty!==k.DIRTY_LAYOUT||t.dirty===k.DIRTY_LAYOUT&&t.element.parentNode.clientWidth!==t.availableWidth},s=function(a){var e=C.getComputedStyle(a.element,null);a.currentFontSize=parseInt(e.getPropertyValue("font-size"),10),a.display=e.getPropertyValue("display"),a.whiteSpace=e.getPropertyValue("white-space")},f=function(a){var e=!1;return!a.preStyleTestCompleted&&(/inline-/.test(a.display)||(e=!0,a.display="inline-block"),"nowrap"!==a.whiteSpace&&(e=!0,a.whiteSpace="nowrap"),a.preStyleTestCompleted=!0,e)},d=function(t){t.originalStyle||(t.originalStyle=t.element.getAttribute("style")||""),t.element.style.cssText=t.originalStyle+";white-space:"+t.whiteSpace+";display:"+t.display+";font-size:"+t.currentFontSize+"px"},p=function(t){t.element.dispatchEvent(new CustomEvent("fit",{detail:{oldValue:t.previousFontSize,newValue:t.currentFontSize,scaleFactor:t.currentFontSize/t.previousFontSize}}))},m=function(a,e){return function(){a.dirty=e,W()}},v=function(t){t.newbie=!0,t.dirty=!0,r.push(t)},y=function(a){return function(){r=r.filter(function(t){return t.element!==a.element}),a.observeMutations&&a.observer.disconnect(),a.element.style.cssText=a.originalStyle}},h=function(t){t.observeMutations&&(t.observer=new MutationObserver(m(t,k.DIRTY_CONTENT)),t.observer.observe(t.element,t.observeMutations))},S={minSize:16,maxSize:512,multiLine:!0,observeMutations:"MutationObserver"in C&&{subtree:!0,childList:!0,characterData:!0}},b=null,D=function(){C.clearTimeout(b),b=C.setTimeout(u(k.DIRTY_LAYOUT),g.observeWindowDelay)},T=["resize","orientationchange"];return Object.defineProperty(g,"observeWindow",{set:function set(a){var o=(a?"add":"remove")+"EventListener";T.forEach(function(t){C[o](t,D)})}}),g.observeWindow=!0,g.observeWindowDelay=100,g.fitAll=u(k.DIRTY),g}}("undefined"==typeof window?null:window),a.exports=e["default"]});var tour={id:"syspro-deg",steps:[{title:"Welcome to the tour!",content:"You will progress through a few steps to learn how to use the visual builder. Click 'Next' to keep going.",target:document.querySelector("#tour_starter"),placement:"left",//       arrowOffset: 200,
showNextButton:!0},{title:"Add a layout section",content:"You start off by adding layout sections - these are set layouts into which you can add individual fields (bits of data) at a later stage. Click the 'Add layout section' button to the left now.",target:document.querySelector("#main_column_0 .add-row-section"),placement:"right",nextOnTargetClick:!0,showNextButton:!1},{title:"Choose a type of layout section",content:"There are three main types (layout sections, cards and charts) to play around with - select 'Add layout section' for now...",target:document.querySelector("#tour_layout_widget"),placement:"bottom",nextOnTargetClick:!0,showNextButton:!1,showPrevButton:!0,onPrev:function onPrev(){SYSPRO_VB.rowWindow.close()}},{title:"Choose a layout section",content:"Most of the layout sections are sets of columns and rows, to ensure your information is well structured and easy to read. You can also add list views and carousels (so you can click to cycle through a few different bits of content). Select the 2 column layout section to continue the tour.",delay:120,target:document.querySelector("#rowWindow #tour_2_col"),placement:"bottom",xOffset:-10,nextOnTargetClick:!0,showNextButton:!1,showPrevButton:!0},{title:"Style the layout section",content:"You can add a title, make the whole section collapsible, and choose whether each block should be seperate or joined, and what kind of borders it should have. These options just change the way the layout section looks. You can choose some options now, and then click 'Add section'",delay:200,zindex:999999,target:document.querySelector("#addLayoutWidgetButton"),arrowOffset:100,xOffset:-310,yOffset:-550,placement:"left",nextOnTargetClick:!0,showNextButton:!1,showPrevButton:!0},{title:"Add a data widget",content:"Now you have your first layout widget, you can add some actual data to it. Click one of the plus icons to the left to do this.",delay:120,zindex:999999,target:document.querySelector("#main_column_0"),yOffset:100,placement:"right",nextOnTargetClick:!0,showNextButton:!1,showPrevButton:!0},{title:"Choose a data field",content:"to the left are all the available fields you can choose to add to your layout section. Select a data field by clicking it, and then click 'Next'",delay:220,zindex:999999,target:document.querySelector("#initial-fields-list-data-window"),placement:"right",nextOnTargetClick:!1,showNextButton:!0,showPrevButton:!0},{title:"Style the data",content:"You can now change the way the data will look with the styling options on the right. Click 'Add field' at the bottom right when you are done.",delay:100,zindex:999999,target:document.querySelector("#addDataButtonPopoverWrap"),arrowOffset:100,xOffset:-310,yOffset:-550,placement:"left",nextOnTargetClick:!0,showNextButton:!1,showPrevButton:!0},{title:"Drag and drop data widgets",content:"You can drag and drop data widgets - drag the one you just created to the other available place in your layout section by hovering over it, and clicking and dragging on this icon: <i class='material-icons text-primary drag-row-section'>open_with</i> - Click 'Next' when you have done it.",delay:200,zindex:999999,target:document.querySelector("#main_column_0"),placement:"right",yOffset:100,nextOnTargetClick:!0,showNextButton:!0,showPrevButton:!0},{title:"Edit a data widget",content:"You can also edit an existing data widget by clicking the 'More' icon: <i class='material-icons text-primary'>more_vert</i> that shows when you move the mouse arrow over it, then clicking 'Edit' - try it now, and click next when the edit window appears.",delay:100,zindex:999999,target:document.querySelector("#main_column_0"),placement:"right",yOffset:100,nextOnTargetClick:!1,showNextButton:!0,showPrevButton:!0},{title:"Make some changes",content:"Try change some styling options, or perhaps even the data field, then click 'Save changes'.",delay:400,zindex:999999,xOffset:40,yOffset:-400,target:document.querySelector("#editDataWidgetSaveButton"),placement:"right",nextOnTargetClick:!0,showNextButton:!1,showPrevButton:!0},{title:"Move a layout section",content:"You can drag and drop layout sections - drag the one above to the middle column by hovering over it, and clicking and dragging on this icon: <i class='material-icons text-primary drag-row-section'>open_with</i> that appears to the top left - Click 'Next' when you have done it.",delay:100,zindex:999999,target:document.querySelector("#main_column_0"),placement:"bottom",nextOnTargetClick:!1,showNextButton:!0,showPrevButton:!0},{title:"Edit a layout section",content:"Make changes to a layout section by clicking the 'More' icon: <i class='material-icons text-primary'>more_vert</i> that appears to the top right when you move the mouse arrow over it, then clicking 'Edit' - try it now, and click next when the edit window appears.",delay:100,zindex:999999,target:document.querySelector("#main_column_1"),placement:"bottom",nextOnTargetClick:!1,showNextButton:!0,showPrevButton:!0},{title:"Make some changes",content:"Make some changes to your layout section, then click 'Save changes' when you are done.",delay:100,zindex:999999,target:document.querySelector("#editLayoutWidgetButton"),placement:"right",xOffset:40,yOffset:-400,nextOnTargetClick:!0,showNextButton:!1,showPrevButton:!0},{title:"Using the quick add feature",content:"You can also add layout sections by dragging them from the Quick Add menu. Click this icon to open the menu: <i class='material-icons text-primary'>add_to_photos</i> ",delay:100,zindex:999999,target:document.querySelector("#quickAddLayoutTourStop"),placement:"right",xOffset:-5,nextOnTargetClick:!0,showNextButton:!1,showPrevButton:!0},{title:"Drag to add a layout section",content:"You can click and drag a layout section from the menu, onto the main layout area when you move your mouse over one and see this icon: <i class='material-icons text-primary drag-row-section'>open_with</i>. Try it now with the 3 column layout section, and click 'Next' when you have done it.",delay:350,zindex:999999,target:document.querySelector("#sidebar-wrapper"),placement:"right",yOffset:100,nextOnTargetClick:!1,showNextButton:!0,showPrevButton:!0},{title:"Quick add data fields",content:"You can also add data fields in the same way - of course you would have to style them later, if required, by editing them like you did previously. Click the <i class='material-icons text-primary'>note_add</i> icon to the right to show the Quick Add data menu.",delay:350,zindex:999999,target:document.querySelector("#quickAddDataTourStop"),placement:"right",xOffset:-5,nextOnTargetClick:!0,showNextButton:!1,showPrevButton:!0},{title:"Drag to add a data field",content:"You can click and drag a data field from the menu, into an available space in a layout section. Click to expand one of the data field sections to the left, and then click and drag a data field whenever you see the: <i class='material-icons text-primary drag-row-section'>open_with</i> icon. Drag your data field to one of the available, pulsing green spaces, and click 'Next' when you're done.",delay:130,zindex:999999,target:document.querySelector("#sidebar-wrapper"),placement:"right",yOffset:100,nextOnTargetClick:!1,showNextButton:!0,showPrevButton:!0},{title:"Change overall layout",content:"You don't have to use the three column layout - you can try out the different options displayed after clicking this icon to the right: <i class='material-icons text-primary'>view_column</i> - try some different options, then switch back to three columns and click next to continue the help tour.",delay:350,zindex:999999,target:document.querySelector("#quickAddDataTourStop"),placement:"right",xOffset:-5,nextOnTargetClick:!1,showNextButton:!0,showPrevButton:!0}]};// Start the tour!
//// HoverForMore.js v1.2.1
//// ----------------------
//// Author: Luke Dennis
//// Website: http://lukifer.github.com/HoverForMore.js
//// License: http://opensource.org/licenses/mit-license.php
//;(function($, window)
//{
//	var isjQuery = !!$.fn.jquery;
//	var isFirefox = /Firefox/.test(navigator.userAgent);
//	var isMobile  = /Mobile/ .test(navigator.userAgent);
//	var defaults = {
//		"speed": 60.0,
//		"gap": 20,
//		"loop": true,
//		"removeTitle": true,
//		"snapback": true,
//		"alwaysOn": false,
//		"addStyles": true,
//		"target": false,
//		"startEvent": isMobile ? "touchstart" : (isjQuery ? "mouseenter" : "mouseover"),
//		"stopEvent":  isMobile ? "touchend"   : (isjQuery ? "mouseleave" : "mouseout" )
//	};
//	$.fn['hoverForMore'] = function(options)
//	{
//		var self = this;
//		var head = document.getElementsByTagName('head')[0];
//		var originalOverflow, originalOverflowParent, startTime;
//		options = $.extend({}, defaults, options);
//		var targetSelector = options.target || self.selector;
//		// Always-on without looping is just silly
//		if(options.alwaysOn)
//		{
//			options.loop = true;
//			options.startEvent = "startLooping"; // only triggered programmatically
//		}
//		// Detect CSS prefix and presence of CSS animation
//		var hasAnimation = document.body.style.animationName ? true : false,
//			animationString = 'animation',
//			transitionString = 'transition',
//			transformString = 'transform',
//			keyframePrefix = '',
//			domPrefixes = 'Webkit Moz O ms Khtml'.split(' '),
//			pfx  = '';
//		// Find the CSS prefix, if necessary
//		if( hasAnimation === false )
//		for( var i = 0; i < domPrefixes.length; i++ )
//		{
//			if( document.body.style[ domPrefixes[i] + 'AnimationName' ] === undefined )
//				continue;
//			pfx = domPrefixes[ i ];
//			animationString = pfx + 'Animation';
//			transitionString = pfx + 'Transition';
//			transformString = pfx + 'Transform';
//			cssPrefix = '-' + pfx.toLowerCase() + '-';
//			hasAnimation = true;
//			break;
//		}
//		// Auto-add ellipsis and such
//		if(options.addStyles)
//		{
//			head.appendChild($(
//			'<style type="text/css">'
//			+	self.selector+'{'
//			+		'cursor:default;'
//			+		'text-align:left;'
//			+		'display:block;'
//			+		'overflow:hidden;'
//			+		'white-space:nowrap;'
//			+		'text-overflow:ellipsis;'
//			+		cssPrefix+'user-select: none;'
//			+	'}</style>')[0]);
//		}
//		// Non-animation fallback. TODO: Animate with jQuery instead
//		if(!hasAnimation)
//		{
//			// Fallback to title text hover
//			$(options.target || self.selector).each(function(n, el)
//			{
//				var $el = $(el);
//				$el.attr("title", $.trim($el.text()));
//			});
//			return self;
//		}
//		// Keyframes are only used in loop mode
//		if(options.loop)
//		{
//			// Attach global style
//			var $keyframeStyle = $('<style type="text/css"></style>');
//			var $keyframeStyleReverse = $('<style type="text/css"></style>');
//			head.appendChild($keyframeStyle[0]);
//			head.appendChild($keyframeStyleReverse[0]);
//		}
//		// For non-loop mode, set an empty transform value (FireFox needs this to transition properly)
//		else
//		{
//			$(self.selector).each(function(n, el)
//			{	el.style[transformString] = 'translateX(0px)';
//			});
//		}
//		// Attach start event
//		//$(targetSelector).live(options.startEvent, function(e)
//		$(document).on(options.startEvent, targetSelector, function(e)
//		//$(targetSelector).on(options.startEvent, function(e)
//		{
//			startTime = (new Date()).getTime();
//			// Get hovered item, and ensure that it contains an overflown item
//			var $item = $(options.target ? self.selector : this).filter(":first");
//			if(!$item.length) return true;
//			var $parent = $item.parent();
//			var pixelDiff = $item[0].scrollWidth - $item.width();
//			if(pixelDiff <= 0) // && !options.alwaysOn // TODO: <marquee> without overflow
//				return true;
//			if(options.removeTitle) $item.removeAttr("title");
//			// Over-ride the text overflow, and cache the overflow css that we started with
//			originalOverflowParent = originalOverflowParent	|| $parent.css("overflow");
//			originalOverflow       = originalOverflow       || $item  .css("overflow");
//			$parent.css("overflow", "hidden");
//			if(isMobile && options.addStyles)
//				$('body').css(cssPrefix+"user-select", "none");
//			$item
//				.css("overflow", "visible")
//				.addClass("scrolling");
//			if(options.loop)
//			{
//				// Remove a previous clone
//				$item.children(".hoverForMoreContent").remove();
//				// Attach a duplicate string which will allow content to appear wrapped
//				var $contentClone = $('<span class="hoverForMoreContent" />')
//					.css({"paddingLeft": parseInt(options.gap)+"px"})
//					.text($item.text());
//				$item.append($contentClone);
//				var contentWidth = ($contentClone.width() + parseInt(options.gap));
//				// Build keyframe string and attach to global style
//				var keyframes = '@' + cssPrefix + 'keyframes hoverForMoreSlide { '
//				+		'from {' 	+ cssPrefix + 'transform:translateX( 0 ) }'
//				+		  'to {' 	+ cssPrefix + 'transform:translateX( -'+contentWidth+'px ) }'
//				+	'}';
//				$keyframeStyle[0].innerHTML = keyframes;
//				// Go go gadget animation!
//				var sec = contentWidth / parseFloat(options.speed);
//				$item[0].style[animationString] = 'hoverForMoreSlide '+sec+'s linear infinite';
//			}
//			else // if(!options.loop)
//			{
//				var sec = pixelDiff / parseFloat(options.speed);
//				// Apply transition + transform instead of looping
//				$item[0].style[transitionString] = cssPrefix+'transform '+sec+'s linear';
//				// Alas, Firefox won't honor the transition immediately
//				if(!isFirefox)
//					$item[0].style[transformString] = 'translateX(-'+pixelDiff+'px)';
//				else setTimeout(function()
//				{
//					$item[0].style[transformString] = 'translateX(-'+pixelDiff+'px)';
//				}, 0);
//			}
//		});
//		// Attach stop event
//		if(!options.alwaysOn)
//		//$(targetSelector).live(options.stopEvent, function(e)
//		//$(targetSelector).on(options.stopEvent, function(e)
//		$(document).on(options.stopEvent, targetSelector, function(e)
//		{
//			var $item = $(options.target ? self.selector : this).filter(":first");
//			if(!$item.length) return true;
//			if(options.loop)
//			{
//				if(options.snapback)
//				{
//					// Reverse our animation
//					var contentWidth = $item.children('.hoverForMoreContent').width() + parseInt(options.gap);
//					var timeDiff = ((new Date()).getTime() - startTime)*0.001;
//					var offsetX = (timeDiff * options.speed) % contentWidth;
//					var switchDirection = offsetX > (contentWidth/2);
//					// Build keyframe string and attach to global style
//					var keyframes = '@' + cssPrefix + 'keyframes hoverForMoreSlideReverse { '
//					+		'from {' 	+ cssPrefix + 'transform:translateX( '+(0 - offsetX)+'px ) }'
//					+		  'to {' 	+ cssPrefix + 'transform:translateX( '
//					+									(switchDirection ? 0-contentWidth : 0)+'px ) }'
//					+	'}';
//					$keyframeStyleReverse[0].innerHTML = keyframes;
//					var sec = (switchDirection ? contentWidth-offsetX : offsetX) * 0.2 / parseFloat(options.speed);
//					$item[0].style[animationString] = 'hoverForMoreSlideReverse '+(sec>1?1:sec)+'s linear';
//					$item.removeClass("scrolling");
//					// After animation resolves, restore original overflow setting, and remove the cloned element
//					setTimeout(function()
//					{
//						if($item.is(".scrolling")) return;
//						$item
//							.children(".hoverForMoreContent")
//							.remove();
//						$item.css("overflow", originalOverflow);
//						$item.parent().css("overflow", originalOverflowParent);
//						if(isMobile && options.addStyles)
//							$('body').css(cssPrefix+"user-select", 'text');
//					}, (sec * 1000) - -50);
//				}
//				else // if(!options.snapback)
//				{
//					$item[0].style[animationString] = '';
//					$item
//						.css("overflow", originalOverflow)
//						.find(".hoverForMoreContent")
//						.remove();			
//					$item.parent().css("overflow", originalOverflowParent);
//					if(isMobile && options.addStyles)
//						$('body').css(cssPrefix+"user-select", 'text');
//				}
//			}
//			else // if(!options.loop)
//			{
//				var timeDiff = ((new Date()).getTime() - startTime) / 1000.0;
//				var match = $item[0].style[transitionString].match(/transform (.*)s/);
//				var sec = (match && match[1] && parseFloat(match[1]) < timeDiff) ? parseFloat(match[1]) : timeDiff;
//				sec *= 0.5;
//				if(!options.snapback)
//					$item[0].style[transitionString] = '';
//				else
//					$item[0].style[transitionString] = cssPrefix+'transform '+sec+'s linear';
//				$item.removeClass("scrolling")
//				// Firefox needs a delay for the transition to take effect
//				if(!isFirefox)
//					$item[0].style[transformString] = 'translateX(0px)';
//				else setTimeout(function(){
//					$item[0].style[transformString] = 'translateX(0px)';
//				}, 0);
//				if(!options.snapback)
//				{
//					$item.css("overflow", originalOverflow);
//					if(isMobile && options.addStyles)
//						$('body').css(cssPrefix+"user-select", 'text');
//				}
//				else // if(options.snapback)
//				{
//					setTimeout(function()
//					{
//						if($item.is(".scrolling")) return;
//						$item.css("overflow", originalOverflow);
//						if(isMobile && options.addStyles)
//							$('body').css(cssPrefix+"user-select", 'text');
//					}, sec * 1000);
//				}
//			}
//		});
//		// To manually refresh active elements when in always-on mode
//		self.refresh = function()
//		{
//			$(self.selector).each(function(n,el)
//			{
//				$(el).not(".scrolling").trigger(options.startEvent);
//			})
//		};
//		// Always-on mode, activate! <marquee>, eat your heart out.
//		if(options.alwaysOn)
//			self.refresh();
//		return self;
//	};
//})(window.jQuery || $);
/*!
 * jQuery twitter bootstrap wizard plugin
 * Examples and documentation at: http://github.com/VinceG/twitter-bootstrap-wizard
 * version 1.0
 * Requires jQuery v1.3.2 or later
 * Supports Bootstrap 2.2.x, 2.3.x, 3.0
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 * Authors: Vadim Vincent Gabriel (http://vadimg.com), Jason Gill (www.gilluminate.com)
 */ /*global jQuery */ /*!
* FitText.js 1.2
*
* Copyright 2011, Dave Rupert http://daverupert.com
* Released under the WTFPL license
* http://sam.zoy.org/wtfpl/
*
* Date: Thu May 05 14:23:00 2011 -0600
*/ /* eslint-disable vars-on-top */ /* eslint-disable no-var */ /* eslint-disable indent */ /******************************/ /* SYSPRO Visual Builder JS   */ /*							  */ /*							  */ /******************************/(function(t){var e=function(e,a){var e=t(e),o=this,n="li:has([data-toggle=\"tab\"])",d=t.extend({},t.fn.bootstrapWizard.defaults,a),s=null,l=null;this.rebindClick=function(e,t){e.unbind("click",t).bind("click",t)},this.fixNavigationButtons=function(){if(s.length||(l.find("a:first").tab("show"),s=l.find(n+":first")),t(d.previousSelector,e).toggleClass("disabled",o.firstIndex()>=o.currentIndex()),t(d.nextSelector,e).toggleClass("disabled",o.currentIndex()>=o.navigationLength()),o.rebindClick(t(d.nextSelector,e),o.next),o.rebindClick(t(d.previousSelector,e),o.previous),o.rebindClick(t(d.lastSelector,e),o.last),o.rebindClick(t(d.firstSelector,e),o.first),d.onTabShow&&"function"==typeof d.onTabShow&&!1===d.onTabShow(s,l,o.currentIndex()))return!1},this.next=function(){// If we clicked the last then dont activate this
return!e.hasClass("last")&&!(d.onNext&&"function"==typeof d.onNext&&!1===d.onNext(s,l,o.nextIndex()))&&void(// Did we click the last button
$index=o.nextIndex(),$index>o.navigationLength()||l.find(n+":eq("+$index+") a").tab("show"))},this.previous=function(){// If we clicked the first then dont activate this
return!e.hasClass("first")&&!(d.onPrevious&&"function"==typeof d.onPrevious&&!1===d.onPrevious(s,l,o.previousIndex()))&&void($index=o.previousIndex(),0>$index||l.find(n+":eq("+$index+") a").tab("show"))},this.first=function(){return!(d.onFirst&&"function"==typeof d.onFirst&&!1===d.onFirst(s,l,o.firstIndex()))&&!e.hasClass("disabled")&&void l.find(n+":eq(0) a").tab("show");// If the element is disabled then we won't do anything
},this.last=function(){return!(d.onLast&&"function"==typeof d.onLast&&!1===d.onLast(s,l,o.lastIndex()))&&!e.hasClass("disabled")&&void l.find(n+":eq("+o.navigationLength()+") a").tab("show");// If the element is disabled then we won't do anything
},this.currentIndex=function(){return l.find(n).index(s)},this.firstIndex=function(){return 0},this.lastIndex=function(){return o.navigationLength()},this.getIndex=function(t){return l.find(n).index(t)},this.nextIndex=function(){return l.find(n).index(s)+1},this.previousIndex=function(){return l.find(n).index(s)-1},this.navigationLength=function(){return l.find(n).length-1},this.activeTab=function(){return s},this.nextTab=function(){return l.find(n+":eq("+(o.currentIndex()+1)+")").length?l.find(n+":eq("+(o.currentIndex()+1)+")"):null},this.previousTab=function(){return 0>=o.currentIndex()?null:l.find(n+":eq("+parseInt(o.currentIndex()-1)+")")},this.show=function(t){return isNaN(t)?e.find(n+" a[href=#"+t+"]").tab("show"):e.find(n+":eq("+t+") a").tab("show")},this.disable=function(e){l.find(n+":eq("+e+")").addClass("disabled")},this.enable=function(e){l.find(n+":eq("+e+")").removeClass("disabled")},this.hide=function(e){l.find(n+":eq("+e+")").hide()},this.display=function(e){l.find(n+":eq("+e+")").show()},this.remove=function(e){var a=e[0],o="undefined"!=typeof e[1]&&e[1],d=l.find(n+":eq("+a+")");// Remove the tab pane first if needed
if(o){var s=d.find("a").attr("href");t(s).remove()}// Remove menu item
d.remove()};var r=function(a){// Get the index of the clicked tab
var e=l.find(n).index(t(a.currentTarget).parent(n));if(d.onTabClick&&"function"==typeof d.onTabClick&&!1===d.onTabClick(s,l,o.currentIndex(),e))return!1},c=function(a){$element=t(a.target).parent();var e=l.find(n).index($element);// If it's disabled then do not change
return!$element.hasClass("disabled")&&!(d.onTabChange&&"function"==typeof d.onTabChange&&!1===d.onTabChange(s,l,o.currentIndex(),e))&&void(// activated tab
s=$element,o.fixNavigationButtons())};// attach to both shown and shown.bs.tab to support Bootstrap versions 2.3.2 and 3.0.0
this.resetWizard=function(){// remove the existing handlers
// reset elements based on current state of the DOM
// re-add handlers
t("a[data-toggle=\"tab\"]",l).off("click",r),t("a[data-toggle=\"tab\"]",l).off("shown shown.bs.tab",c),l=e.find("ul:first",e),s=l.find(n+".active",e),t("a[data-toggle=\"tab\"]",l).on("click",r),t("a[data-toggle=\"tab\"]",l).on("shown shown.bs.tab",c),o.fixNavigationButtons()},l=e.find("ul:first",e),s=l.find(n+".active",e),l.hasClass(d.tabClass)||l.addClass(d.tabClass),d.onInit&&"function"==typeof d.onInit&&d.onInit(s,l,0),d.onShow&&"function"==typeof d.onShow&&d.onShow(s,l,o.nextIndex()),t("a[data-toggle=\"tab\"]",l).on("click",r),t("a[data-toggle=\"tab\"]",l).on("shown shown.bs.tab",c)};// expose options
t.fn.bootstrapWizard=function(a){//expose methods
if("string"==typeof a){var o=Array.prototype.slice.call(arguments,1);return 1===o.length&&o.toString(),this.data("bootstrapWizard")[a](o)}return this.each(function(){var o=t(this);// Return early if this element already has a plugin instance
if(!o.data("bootstrapWizard")){// pass options to plugin constructor
var n=new e(o,a);// Store plugin object in this element's data
o.data("bootstrapWizard",n),n.fixNavigationButtons()}})},t.fn.bootstrapWizard.defaults={tabClass:"nav nav-pills",nextSelector:".wizard li.next",previousSelector:".wizard li.previous",firstSelector:".wizard li.first",lastSelector:".wizard li.last",onShow:null,onInit:null,onNext:null,onPrevious:null,onLast:null,onFirst:null,onTabChange:null,onTabClick:null,onTabShow:null}})(jQuery),function(e){var t=Number.POSITIVE_INFINITY;e.fn.fitText=function(a,o){var n=Number.NEGATIVE_INFINITY,d=e.extend({minFontSize:n,maxFontSize:t},o);return this.each(function(){// Store the object
var t=e(this),o=function(){t.css("font-size",Math.max(Math.min(t.width()/(10*(a||1)),parseFloat(d.maxFontSize)),parseFloat(d.minFontSize)))};// Resizer() resizes items based on the object width divided by the compressor * 10
// Call once to set.
// Call on resize. Opera debounces their resize by default.
o(),e(window).on("resize.fittext orientationchange.fittext",o)})}}(jQuery),"use strict",function(){var e=String.prototype,t=Math.abs,a=Math.max,o=Number.POSITIVE_INFINITY,n=Math.floor,d=kendo.data.Node.define({id:"Id"}),s=kendo.data.Node.define({id:"Id",children:{schema:{data:"Widgets",model:d}}}),l=kendo.data.Node.define({id:"Id",children:{schema:{data:"Columns",model:s}}}),r=kendo.data.Node.define({id:"Id",children:{schema:{data:"Rows",model:l}}}),c=kendo.data.Node.define({id:"Id"}),p=kendo.data.Node.define({id:"Id",children:{schema:{data:"Widgets",model:c}}}),u=kendo.data.Node.define({id:"Id",children:{schema:{data:"Widgets",model:p}}}),m=kendo.data.Node.define({id:"Id",children:{schema:{data:"Widgets",model:u}}}),g=kendo.data.Node.define({id:"Id",children:{schema:{data:"Widgets",model:r}}}),h=kendo.data.Node.define({id:"Id",children:{schema:{data:"Widgets",model:m}}}),f=sysproInterop.generateUUID(),y=sysproInterop.generateUUID(),b;kendo.data.binders.dataPath=kendo.data.Binder.extend({init:function init(e,t,a){kendo.data.Binder.fn.init.call(this,e,t,a);var o=this;//listen for the change event of the element
$(o.element).on("click",function(){o.change()})},refresh:function refresh(){var e=this,t=e.bindings.dataPath.get();$(e.element).toggleClass("active",t===$(e.element).data("field-path"))},change:function change(){var e=$(this.element).data("field-path");this.bindings.dataPath.set(e);//update the View-Model
var t=$(this.element).clone();t.find("i, span").remove(),b.selected&&(b.selected.FieldName=t.text(),b.selected.HasSmartTag=$(this.element).data("smart-tag"),b.selected.DataType=$(this.element).data("data-type"),b.selected.EntryType=$(this.element).data("entry-type"))}}),kendo.data.binders.iconName=kendo.data.Binder.extend({init:function init(e,t,a){kendo.data.Binder.fn.init.call(this,e,t,a);var o=this;//listen for the change event of the element
$(o.element).on("click",function(){o.change()})},refresh:function refresh(){var e=this,t=e.bindings.iconName.get();$(e.element).toggleClass("active",t===$(e.element).data("icon-name"))},change:function change(){var e=$(this.element).data("icon-name");this.bindings.iconName.set(e)}}),kendo.data.binders.linkListField=kendo.data.Binder.extend({init:function init(e,t,a){kendo.data.Binder.fn.init.call(this,e,t,a);var o=this;//listen for the change event of the element
$(o.element).on("click",function(){o.change()})},refresh:function refresh(){var e=this,t=e.bindings.linkListField.get();$(e.element).toggleClass("active",t===$(e.element).data("key-action"))},change:function change(){//const value = this.element.value;
var e=$(this.element).data("key-action");this.bindings.linkListField.set(e)}}),kendo.data.binders.tileBind=kendo.data.Binder.extend({init:function init(e,t,a){kendo.data.Binder.fn.init.call(this,e,t,a);var o=this;//listen for the change event of the element
$(o.element).on("click",function(){o.change()})},refresh:function refresh(){var e=this,t=e.bindings.tileBind.get();$(e.element).toggleClass("active",t===$(e.element).data("tile-name"))},change:function change(){//const value = this.element.value;
var e=$(this.element).data("tile-name");this.bindings.tileBind.set(e)}}),kendo.data.binders.layoutWidgetType=kendo.data.Binder.extend({refresh:function refresh(){var e=this.bindings.layoutWidgetType.get();e===$(this.element).data("widget-type")&&$(this.element).tab("show")}}),kendo.data.binders.toolbarFieldName=kendo.data.Binder.extend({init:function init(e,t,a){kendo.data.Binder.fn.init.call(this,e,t,a);var o=this;//listen for the change event of the element
$(o.element).on("click",function(){o.change()})},refresh:function refresh(){var e=this,t=e.bindings.toolbarFieldName.get();$(e.element).toggleClass("active",t===$(e.element).data("field-name"))},change:function change(){var e=$(this.element).data("field-name");this.bindings.toolbarFieldName.set(e),b.selected&&(b.selected.ToolbarWidgetType=$(this.element).data("toolbar-widget-type"))}}),$(window).on("load",function(){v.rowEditWindow&&v.rowEditWindow.destroy(),v.rowEditWindow=v.createKendoWindow("rowEditWindow","Edit layout widget",v.rowEditWindowOpen,v.rowEditWindowClose),v.dataWindow&&v.dataWindow.destroy(),v.dataWindow=v.createKendoWindow("dataWindow","Add new data widget",v.dataWindowOpen,v.dataWindowClose),v.dataEditWindow&&v.dataEditWindow.destroy(),v.dataEditWindow=v.createKendoWindow("dataEditWindow","Edit data widget",v.dataEditWindowOpen,v.dataEditWindowClose),v.tileWindow&&v.tileWindow.destroy(),v.tileWindow=v.createKendoWindow("tileWindow","Add tile",v.tileWindowOpen,v.tileWindowClose),v.tileEditWindow&&v.tileEditWindow.destroy(),v.tileEditWindow=v.createKendoWindow("tileEditWindow","Edit tile",v.tileEditWindowOpen,v.tileEditWindowClose),v.toolbarWindow&&v.toolbarWindow.destroy(),v.toolbarWindow=v.createKendoWindow("toolbarWindow","Add toolbar item",v.toolbarWindowOpen,v.toolbarWindowClose),v.toolbarEditWindow&&v.toolbarEditWindow.destroy(),v.toolbarEditWindow=v.createKendoWindow("toolbarEditWindow","Edit toolbar item",v.toolbarEditWindowOpen,v.toolbarEditWindowClose),v.rowWindow&&v.rowWindow.destroy(),v.rowWindow=v.createKendoWindow("rowWindow","Add new layout widget",v.rowWindowOpen,v.rowWindowClose)});var v={//Initisalisation function
init:function init(){// Initialise form JS
$.material.init(),$(".dropdown-select").dropdown({autoinit:!0}),$(document).ready(function(){v.initDatePicker(),$(".combobox:not(.combobox-initialized)").combobox({newOptionsAllowed:!0}),$(".combobox:not(.combobox-initialized)").addClass("combobox-initialized"),Inputmask().mask(document.querySelectorAll(".syspro-supports-mask:not([disabled])"))}),$(document).off("click",".disabled, .disabled a"),$(document).on("click",".disabled, .disabled a",function(t){t.stopImmediatePropagation()}),sysproInterop.getModel("",function(e){function menuToggle(t){t.preventDefault(),$("#sidebar-wrapper").off().on("transitionend",function(e){$("#sidebar-tab-controls").find("li.active").removeClass("active"),$(window).trigger("resize"),$(this).off(e)}),$("#wrapper").toggleClass("toggled")}function menuTabToggle(t){function initColumnChanging(){$(".column-parent").off().on("transitionend",function(e){//SYSPRO_VB.sizeTiles();
$(window).trigger("resize"),$(this).off(e)});var e=$("body").data("column-layout"),t=b.dataSource.data().toJSON();"1col"==$(this).val()?($("#main_column_2").closest(".column-parent").hide(0,function(){$("#main_column_1").closest(".column-parent").hide(0,function(){$("#main_column_0").closest(".column-parent").removeClass("col-sm-4").removeClass("col-sm-8").removeClass("col-sm-6").addClass("col-sm-12"),2===t.length&&(v.column1Copy=t[1]),3===t.length&&(v.column1Copy=t[1],v.column2Copy=t[2]),t.splice(1,2),t[0].ResponsiveStyle=0})}),b.dataSource.data(t),b.set("columnLayout",$(this).val())):"2colequal"==$(this).val()?("1col"===e?($("#main_column_0").closest(".column-parent").hide(),$("#main_column_0").closest(".column-parent").removeClass("col-sm-4 col-sm-8 col-sm-12").addClass("col-sm-6"),$("#main_column_1").closest(".column-parent").removeClass("col-sm-4 col-sm-8 col-sm-12").addClass("col-sm-6"),$("#main_column_0").closest(".column-parent").show(0,function(){$("#main_column_1").closest(".column-parent").show(0,function(){t.splice(1,0,v.column1Copy),t[0].ResponsiveStyle=1,t[1].ResponsiveStyle=1})})):$("#main_column_2").closest(".column-parent").hide(0,function(){$("#main_column_0").closest(".column-parent").removeClass("col-sm-4 col-sm-8 col-sm-12").addClass("col-sm-6").show(),$("#main_column_1").closest(".column-parent").removeClass("col-sm-4 col-sm-8 col-sm-12").addClass("col-sm-6").show(0,function(){t[0].ResponsiveStyle=1,t[1].ResponsiveStyle=1})}),"3col"===e&&(v.column2Copy=t[2],t.splice(2,1)),b.dataSource.data(t),b.set("columnLayout",$(this).val())):"2colleft"==$(this).val()?("1col"===e?($("#main_column_0").closest(".column-parent").hide(),$("#main_column_0").closest(".column-parent").removeClass("col-sm-4 col-sm-6 col-sm-12").addClass("col-sm-8"),$("#main_column_1").closest(".column-parent").removeClass("col-sm-6 col-sm-8 col-sm-12").addClass("col-sm-4"),$("#main_column_0").closest(".column-parent").show(0,function(){$("#main_column_1").closest(".column-parent").show(0,function(){t.splice(1,0,v.column1Copy),t[0].ResponsiveStyle=2,t[1].ResponsiveStyle=3})})):$("#main_column_2").closest(".column-parent").hide(0,function(){$("#main_column_0").closest(".column-parent").removeClass("col-sm-4 col-sm-6 col-sm-12").addClass("col-sm-8").show(),$("#main_column_1").closest(".column-parent").removeClass("col-sm-6 col-sm-8 col-sm-12").addClass("col-sm-4").show(0,function(){t[0].ResponsiveStyle=2,t[1].ResponsiveStyle=3})}),"3col"===e&&(v.column2Copy=t[2],t.splice(2,1)),b.dataSource.data(t),b.set("columnLayout",$(this).val())):"2colright"==$(this).val()?("1col"===e?($("#main_column_0").closest(".column-parent").hide(),$("#main_column_0").closest(".column-parent").removeClass("col-sm-4 col-sm-8 col-sm-12").addClass("col-sm-4"),$("#main_column_1").closest(".column-parent").removeClass("col-sm-4 col-sm-8 col-sm-12").addClass("col-sm-8"),$("#main_column_0").closest(".column-parent").show(0,function(){$("#main_column_1").closest(".column-parent").show(0,function(){t.splice(1,0,v.column1Copy),t[0].ResponsiveStyle=3,t[1].ResponsiveStyle=2})})):$("#main_column_2").closest(".column-parent").hide(0,function(){$("#main_column_0").closest(".column-parent").removeClass("col-sm-8 col-sm-6 col-sm-12").addClass("col-sm-4").show(),$("#main_column_1").closest(".column-parent").removeClass("col-sm-6 col-sm-4 col-sm-12").addClass("col-sm-8").show(0,function(){t[0].ResponsiveStyle=3,t[1].ResponsiveStyle=2})}),"3col"===e&&(v.column2Copy=t[2],t.splice(2,1)),b.dataSource.data(t),b.set("columnLayout",$(this).val())):"3col"==$(this).val()&&($("#main_column_0").closest(".column-parent").hide(),$("#main_column_1").closest(".column-parent").hide(),$("#main_column_2").closest(".column-parent").hide(),$("#main_column_0").closest(".column-parent").removeClass("col-sm-8 col-sm-6 col-sm-12").addClass("col-sm-4"),$("#main_column_1").closest(".column-parent").removeClass("col-sm-8 col-sm-6 col-sm-12").addClass("col-sm-4"),$("#main_column_2").closest(".column-parent").removeClass("col-sm-8 col-sm-6 col-sm-12").addClass("col-sm-4"),$("#main_column_0").closest(".column-parent").show(0,function(){$("#main_column_1").closest(".column-parent").show(),$("#main_column_2").closest(".column-parent").show(0,function(){1===t.length?(t[0].ResponsiveStyle=3,t.splice(1,0,v.column1Copy),t[1].ResponsiveStyle=3,t.splice(2,0,v.column2Copy),t[2].ResponsiveStyle=3):2===t.length&&(t[0].ResponsiveStyle=3,t[1].ResponsiveStyle=3,t.splice(2,0,v.column2Copy),t[2].ResponsiveStyle=3),v.sizeTiles()})}),b.dataSource.data(t),b.set("columnLayout",$(this).val())),$("body").data("column-layout",$(this).val()),$("body").attr("data-column-layout",$(this).val())}t.preventDefault();$("#sidebar-wrapper").off().on("transitionend",function(e){$(window).trigger("resize"),$("#wrapper").hasClass("toggled")?$("input[name='column-layout']").off("change",initColumnChanging):$("input[name='column-layout']").on("change",initColumnChanging),$(this).off(e)}),$("#wrapper").hasClass("toggled")&&$("#wrapper").toggleClass("toggled")}function clearIconSelection(t){t.preventDefault(),$(this).parents(".window-content").find(".icon-field-container .icon-option.active").removeClass("active"),$(this).parents(".window-content").find(".icon-field-container .icon-search input").val("").trigger("keyup")}e.OffCanvasLayouts=e.OffCanvasLayouts||{},$.each(e.OffCanvasLayouts,function(e,t){t.Id&&(v.CleanOffCanvasModels["offcanvas-"+t.Id]={Id:t.Id,OffCanvas:t.OffCanvas,columnLayout:t.columnLayout,Title:t.Title,Columns:new kendo.data.HierarchicalDataSource({data:t.Columns,schema:{model:g}}),MainToolbar:kendo.observable({IsToolbarVisible:t.MainToolbar.IsToolbarVisible,Columns:new kendo.data.HierarchicalDataSource({data:t.MainToolbar.Columns,schema:{model:h}})})},v.CleanOffCanvasModels["offcanvas-"+t.Id].Columns.read(),v.CleanOffCanvasModels["offcanvas-"+t.Id].MainToolbar.Columns.read(),v.createInvisibleTreeView("invisibleColumns"+t.Id,v.CleanOffCanvasModels["offcanvas-"+t.Id].Columns),v.createInvisibleTreeView("invisibleToolbar"+t.Id,v.CleanOffCanvasModels["offcanvas-"+t.Id].MainToolbar.Columns),v.CleanOffCanvasModels["offcanvas-"+t.Id].Columns.data().forEach(function(e){e.Widgets.forEach(function(e){if(e.hasOwnProperty("Tabs")&&e.Tabs&&e.Tabs.length){var t=JSON.parse(JSON.stringify(e.Tabs));e.Tabs=new kendo.data.HierarchicalDataSource({data:t,schema:{model:g},change:function change(){this.data()},error:function error(t){console.log("ERROR!",t)}}),e.Tabs.read(),v.createInvisibleTreeView("TABS_"+e.id,e.Tabs)}})}))}),b=kendo.observable({//create a dataSource
dataSource:new kendo.data.HierarchicalDataSource({data:e.Columns,schema:{model:g},error:function error(t){console.log("DATASOURCE ERROR!",t)}}),toolbar:new kendo.data.HierarchicalDataSource({data:e.MainToolbar.Columns,// autoSync: true,
schema:{model:h},error:function error(t){console.log(t)}}),OffCanvasLayouts:v.CleanOffCanvasModels,selected:{},//this field will contain the edited dataItem
targetLayoutWidget:null,selectedOffCanvas:null,// To hold currently edited off canvas widget object
genericObject:{//A generic object to set 'selected' to when it is not in use, to prevent issues with removing objects otherwise currently assigned to 'selected'
Id:0,id:0},columnLayout:"3col"//this field will contain the overall column layout type
}),b.dataSource.read(),b.toolbar.read(),v.createInvisibleTreeView("invisibleNode",b.dataSource),v.createInvisibleTreeView("invisibleToolbarNode",b.toolbar),b.dataSource.data().forEach(function(e){e.Widgets.forEach(function(e){if(e.hasOwnProperty("Tabs")&&e.Tabs&&e.Tabs.length){var t=JSON.parse(JSON.stringify(e.Tabs));e.Tabs=new kendo.data.HierarchicalDataSource({data:t,schema:{model:g},change:function change(){this.data()},error:function error(t){console.log("ERROR!",t)}}),e.Tabs.read(),v.createInvisibleTreeView("TABS_"+e.id,e.Tabs)}})}),kendo.bind($("#dataEditWindow"),b),kendo.bind($("#rowEditWindow"),b),kendo.bind($("#toolbarEditWindow"),b),kendo.bind($("#tileEditWindow"),b),sysproInterop.getAvailableFields(function(e){//Now perform a bind to make sure values are populated correctly
v.bindableFieldsData=e,v.initEditRemoveDataWidget(),sysproInterop.performBind(v.bindableFieldsData,!0)},function(e){//The error callback where a.ErrorMessage is the error
console.log("Error: "+e.ErrorMessage)},!0),$(".menu-toggle").off("click",menuToggle).on("click",menuToggle),$(".menu-toggle-tab").off("click",menuTabToggle).on("click",menuTabToggle),$.each(["#rowWindow","#dataWindow","#dataEditWindow","#rowEditWindow","#toolbarWindow","#toolbarEditWindow","#tileWindow","#tileEditWindow"],function(e,t){v.initialiseMultiPaneWindow(t)});// Packery centering initialisation
var t=Packery.prototype._resetLayout;// always resize
// Main column layout changing
//Initialise the add buttons for layout widgets only once
//Initialise the edit and remove buttons on data widgets and layout widgets only once
Packery.prototype._resetLayout=function(){t.call(this);// reset packer
var e=getSize(this.element.parentNode),a=this.columnWidth+this.gutter;this.fitWidth=n((e.innerWidth+this.gutter)/a)*a,this.packer.width=this.fitWidth,this.packer.height=o,this.packer.reset()},Packery.prototype._getContainerSize=function(){// remove empty space from fit width
for(var e=0,t=0,a=this.packer.spaces.length,n;t<a;t++)n=this.packer.spaces[t],0===n.y&&n.height===o&&(e+=n.width);return{width:this.fitWidth-this.gutter-e,height:this.maxY-this.gutter}},Packery.prototype.needsResizeLayout=function(){return!0},$("input[name='column-layout']").parent().off().on("click",function(){$("input[name='column-layout']",this).trigger("change")}),$("#exportTotalJSON").length&&$("#exportTotalJSON").off().on("click",function(){console.log(JSON.stringify(b.dataSource.data().toJSON()))}),$(document).one("kendo:pageUnload",function(){v.errorNotification&&v.errorNotification.hide()}),$(":not(.k-grid-toolbar) [data-tooltip=\"tooltip\"]").tooltip(),$("body").tooltip({selector:".k-grid-toolbar [data-tooltip=\"tooltip\"]",trigger:"hover",container:"body"}),$("body").off("mouseleave",".k-grid-toolbar [data-tooltip=\"tooltip\"]").on("mouseleave",".k-grid-toolbar [data-tooltip=\"tooltip\"]",function(){$(".k-grid-toolbar [data-tooltip=\"tooltip\"]").tooltip("destroy"),$("body > .tooltip").remove()}),$(".block-bg-button").popover(),$(".block-bg-button").off().on("shown.bs.popover",function(){$(".popover .btn-colour").click(function(){var e="sys-bg-"+$(this).find(".block-background-colour").val();$(this).parents(".popover").siblings(".block-bg-button").removeClass().addClass("block-bg-button btn btn-radio btn-colour "+e),$(".block-bg-button").popover("hide")})}),$("input[name*='row_options']").change(function(){var e=$(this).val();$(".block-bg-setting").hide(0,function(){$("#block-bg-"+e).velocity("fadeIn",{duration:100})})}),$("input[name='column-layout']").each(function(){$(this).val()==$("body").data("column-layout")?($(this).prop("checked",!0),$(this).parent().addClass("active")):($(this).prop("checked",!1),$(this).parent().removeClass("active"))}),$(document).off("click",".add-row-section"),$(document).on("click",".add-row-section",function(e){if(e.preventDefault(),!$(this).parents(".layout-widget-preview").length){var t=v.setContext($(this));v.loadIconJSON("base","#rowWindow"),$("#rowWindow .drilldown-loading-cover").show(),$("#rowWindow").data("kendoWindow").setOptions({context:t}),$("#rowWindow").data("kendoWindow").center().open()}}),"SYSPRORehostedBrowser"===callLayerInterop.interopType&&$(".add-data-section.list-group-item").on("click",function(e){if(e.preventDefault(),!$(this).parents(".layout-widget-preview").length){var t=v.setContext($(this));4===t.targetLayoutWidget.DisplayStyle?($("#loading-cover").toggle(!v.tileWindowsReady),b.set("selected",t.targetLayoutWidget),v.loadIconJSON("base","#tileWindow"),$("#tileWindow").data("kendoWindow").setOptions({context:t}),$("#tileWindow").data("kendoWindow").center().open()):(t.section_num=$(this).closest("[data-section]").data("section"),v.loadIconJSON("base","#dataWindow"),$("#dataWindow").data("kendoWindow").setOptions({context:t}),$("#dataWindow").data("kendoWindow").center().open())}}),$(document).off("click",".add-data-section"),$(document).on("click",".add-data-section",function(e){e.preventDefault();this;if(!$(this).parents(".layout-widget-preview").length){var t=v.setContext($(this));4===t.targetLayoutWidget.DisplayStyle?($("#loading-cover").toggle(!v.tileWindowsReady),$("#tileWindow .drilldown-loading-cover").show(),v.loadIconJSON("base","#tileWindow"),setTimeout(function(){b.set("selected",t.targetLayoutWidget),$("#tileWindow").data("kendoWindow").setOptions({context:t}),$("#tileWindow").data("kendoWindow").center().open()},400)):($("#dataWindow .drilldown-loading-cover").show(),t.section_num=$(this).closest("[data-section]").data("section"),v.loadIconJSON("base","#dataWindow"),$("#dataWindow").data("kendoWindow").setOptions({context:t}),$("#dataWindow").data("kendoWindow").center().open())}}),$(document).off("click",".remove-section"),$(document).on("click",".remove-section",function(e){e.preventDefault();var t=v.setContext($(this)),a;//Rob: Now always do a get instead of getByUid so we can use our own Id.
1===t.targetLayoutWidget.DisplayStyle?(a=t.currentDataSource.get($(e.target).closest(".draggable-data-section").data("guid")),$(this).closest("tr.draggable-data-section").remove(),t.currentDataSource.remove(a)):3===t.targetLayoutWidget.DisplayStyle?(a=t.currentDataSource.get($(e.target).closest(".draggable-data-section").data("guid")),t.currentDataSource.remove(a),$(this).closest("a.draggable-data-section").remove(),t.currentDataSource.remove(a),$(this).closest(".data-section").find(".add-data-widget").show(),$(this).closest(".data-section").find(".panel").not(".add-data-widget").remove(),$(this).closest("a.list-group-item.draggable-data-section").remove()):4===t.targetLayoutWidget.DisplayStyle?(a=t.currentDataSource.get($(e.target).closest(".tile").data("guid")),t.currentDataSource.remove(a),v.initiateTiles(t.targetLayoutWidget)):5===t.targetLayoutWidget.DisplayStyle?(a=t.currentDataSource.get($(e.target).closest(".draggable-data-section").data("guid")),t.currentDataSource.remove(a),$(this).closest(".draggable-data-section").remove()):(a=t.currentDataSource.get($(e.target).closest(".draggable-data-section").data("guid")),t.currentDataSource.remove(a),$(this).closest(".data-section").find(".add-data-widget").show(),$(this).closest(".data-section").find(".panel").not(".add-data-widget").remove());var o=a.OffCanvasLayoutId;o&&(3==b.OffCanvasLayouts["offcanvas-"+o].OffCanvas?(v.offCanvasWindows["#offcanvas-"+o].destroy(),delete v.offCanvasWindows["#offcanvas-"+o],delete b.OffCanvasLayouts["offcanvas-"+o]):(delete b.OffCanvasLayouts["offcanvas-"+o],$("#offcanvas-"+o).remove())),v.initEditRemoveDataWidget()}),$(document).off("click",".edit-section"),$(document).on("click",".edit-section",function(t){t.preventDefault();var e=v.setContext($(this));if(4===e.targetLayoutWidget.DisplayStyle){$("#loading-cover").toggle(!v.tileEditWindowReady),e.section_num=0,e.row_num=0;var d=$(t.target).parents(".tile").data("guid");//Rob: Now always do a get instead of getByUid so we can use our own Id.
b.set("selected",e.currentDataSource.get(d));var s={};s.TileType=b.selected.Widgets[0].TileType,s.Title=b.selected.Widgets[0].Title,s.TileWidth=b.selected.Widgets[0].TileWidth,s.keyField=b.selected.Widgets[0].KeyType,s.TileWidth=b.selected.Widgets[0].TileWidth,s.parentFieldPath=b.selected.Widgets[0].KeyType,s.TileParameters=b.selected.Widgets[0].TileParameters.toJSON(),v.loadIconJSON("editTile","#tileEditWindow"),setTimeout(function(){$("#tileEditWindow").data("kendoWindow").setOptions({context:e,tempDataWidgetJSON:s}),$("#tileEditWindow").data("kendoWindow").center().open()},500)}else{$("#dataEditWindow .drilldown-loading-cover").show();var l=$(t.target).parents(".draggable-data-section").data("guid");//Rob: Now always do a get instead of getByUid so we can use our own Id.
b.set("selected",e.currentDataSource.get(l));var a=b.selected.toJSON(),o=b.selected.OffCanvasLayoutId,n={};o&&(b.set("selectedOffCanvas",b.OffCanvasLayouts["offcanvas-"+o]),n.Title=b.selectedOffCanvas.Title,n.columnLayout=b.selectedOffCanvas.columnLayout,n.OffCanvas=b.selectedOffCanvas.OffCanvas,n.IsToolbarVisible=b.selectedOffCanvas.MainToolbar.IsToolbarVisible),v.loadIconJSON("editData","#dataEditWindow"),$("#dataEditWindow").data("kendoWindow").setOptions({context:e,tempOffCanvasJSON:n,tempDataWidgetJSON:a}),$("#dataEditWindow").data("kendoWindow").center().open()}}),$(document).off("click",".remove-row-section"),$(document).on("click",".remove-row-section",function(e){e.preventDefault();var t=v.setContext($(this)),a=t.currentDataSource.get($(this).closest(".draggable-row-section").data("guid"));//Rob: Now always do a get instead of getByUid so we can use our own Id.
a.Tabs&&v.destroyTreeView("TABS_"+a.Id),t.currentDataSource.remove(a),$(this).closest(".draggable-row-section").remove()}),$(document).off("click",".edit-row-section"),$(document).on("click",".edit-row-section",function(t){t.preventDefault();var e=v.setContext($(this)),a=$(this).closest(".draggable-row-section");b.set("selected",e.targetLayoutWidget);var o=b.selected.toJSON();b.selected.WidgetName=b.selected.WidgetName||"row_1_col",b.selected.hasOwnProperty("Tabs")&&b.selected.Tabs&&(b.selected.TabsNum=b.selected.Tabs.data().length,b.selected.Tabs.data().forEach(function(e,t){b.selected["TabTitle_"+t]=e.Title})),v.loadIconJSON("editRow","#rowEditWindow"),$("#rowEditWindow").data("kendoWindow").setOptions({title:"Edit "+b.selected.TypeName.split(/(?=[A-Z])/).join(" "),context:e,tempLayoutWidgetJSON:o,currentLayoutWidgetHTML:a}),$("#rowEditWindow").data("kendoWindow").center().open()}),$(document).off("click",".add-toolbar-section"),$(document).on("click",".add-toolbar-section",function(t){t.preventDefault();var e=v.setContext($(this));$("#toolbarWindow .drilldown-loading-cover").show();var a=$(this).closest(".dropdown-menu").length?$(this).closest("li.dropdown-submenu").length?$(this).closest("li.dropdown-submenu"):$(this).closest("li.dropdown"):null,o=$(this).closest(".dropdown-menu").length?a.data("guid"):null,n=$(this).closest(".dropdown-menu").length?e.currentToolbarDataSource.get(o):null;v.loadIconJSON("base","#toolbarWindow"),$("#toolbarWindow").data("kendoWindow").setOptions({context:e,parentToolbarWidgetHTML:a,parentToolbarWidget:n}),$("#toolbarWindow").data("kendoWindow").center().open()}),$(document).off("click",".remove-toolbar-widget"),$(document).on("click",".remove-toolbar-widget",function(t){t.preventDefault();var e=v.setContext($(this)),a=$(t.target).closest("li[data-guid]"),o=e.currentToolbarDataSource.get(a.data("guid")),n=o.OffCanvasLayoutId;n&&(3==b.OffCanvasLayouts["offcanvas-"+n].OffCanvas?(v.offCanvasWindows["#offcanvas-"+n].destroy(),delete v.offCanvasWindows["#offcanvas-"+n],delete b.OffCanvasLayouts["offcanvas-"+n]):(delete b.OffCanvasLayouts["offcanvas-"+n],$("#offcanvas-"+n).remove())),e.currentToolbarDataSource.remove(o),$(this).closest("li[data-guid]").remove()}),$(document).off("click",".edit-toolbar-section"),$(document).on("click",".edit-toolbar-widget",function(t){t.preventDefault();var e=v.setContext($(this));$("#toolbarEditWindow .drilldown-loading-cover").show();var a=$(t.target).closest("li[data-guid]"),o=e.currentToolbarDataSource.get(a.data("guid")),n=o.toJSON(),d=o.OffCanvasLayoutId,s={};// viewModel.set('selected', currentToolbarWidget); //update the viewModel
//update the viewModel
d&&(b.set("selectedOffCanvas",b.OffCanvasLayouts["offcanvas-"+d]),s.Title=b.selectedOffCanvas.Title,s.columnLayout=b.selectedOffCanvas.columnLayout,s.OffCanvas=b.selectedOffCanvas.OffCanvas,s.IsToolbarVisible=b.selectedOffCanvas.MainToolbar.IsToolbarVisible),b.selected=o,v.loadIconJSON("editData","#toolbarEditWindow"),$("#toolbarEditWindow").data("kendoWindow").setOptions({context:e,tempOffCanvasJSON:s,tempToolbarWidgetJSON:n,currentToolbarWidgetHTML:a}),$("#toolbarEditWindow").data("kendoWindow").center().open()}),$(".window-content").off("click",".clear-icon-selection",clearIconSelection).on("click",".clear-icon-selection",clearIconSelection),$(document).off("click",".minimize-column"),$(document).on("click",".minimize-column",function(){var e=$(this).closest(".column-parent");e.toggleClass("minimized",!e.hasClass("minimized"))}),$(".colour-picker-dot").each(function(){var e=this,t=$(e).next(".colour-group-wrap"),a=t.find(".colour-group");$(e).popover("destroy"),$(e).popover({html:!0,trigger:"manual",placement:"right",delay:{show:100,hide:100},content:"<div class=\"popover-colour-picker\"></div>"}).off().on("click",function(){var e=this,t=$(this).attr("class").match(/\bsys-bg\S+/g)[0];$(this).popover("show"),$(this).siblings(".popover").on("mouseleave",function(){$(e).popover("hide")}),$(this).siblings(".popover").on("click",".btn-radio",function(){$(e).removeClass(t);var a=$(this).attr("class").split(/\s+/);$.each(a,function(t,a){a.includes("sys-bg-")&&$(e).addClass(a)}),$(e).popover("hide")})}).on("mouseleave",function(){var e=this,t=function(){setTimeout(function(){$(".popover:hover").length?t():$(e).popover("hide")},50)};t()}).on("hide.bs.popover",function(){a.detach().appendTo(t)}).on("inserted.bs.popover",function(){$(".popover-colour-picker").length&&a.detach().appendTo(".popover-colour-picker")})}),$(document).off("shown.bs.collapse",".collapse"),$(document).on("shown.bs.collapse",".collapse",function(){sysproInterop.resizeSparklines(),sysproInterop.sizeTiles()}),$(window).resize(function(){this.resizeTO&&clearTimeout(this.resizeTO),this.resizeTO=setTimeout(function(){$(this).trigger("resizeEnd")},250)}),$(window).bind("resizeEnd",function(){v.sizeTiles(),v.sizeAddonButtons()}),$(".layout-widget-preview-wrapper").perfectScrollbar({suppressScrollX:!0,suppressScrollY:!1}),ElementQueries.init(),v.initNormalSorting(),v.initAllOffCanvasSections(),v.initToolbarSorting(),v.initQuickAddLayoutWidgets(),v.sizeAddonButtons(),v.initEditRemoveDataWidget(),v.finishAddLayoutWidget(),v.initEditRemoveToolbarWidgets(),v.initLayoutWidgetEvents(),v.initiateExistingTiles(),v.initProgramListTileDragging(),$(":not(.k-grid-toolbar) [data-tooltip=\"tooltip\"]").tooltip(),$("body").tooltip({selector:".k-grid-toolbar [data-tooltip=\"tooltip\"]",trigger:"hover",container:"body"}),$("body").off("mouseleave",".k-grid-toolbar [data-tooltip=\"tooltip\"]").on("mouseleave",".k-grid-toolbar [data-tooltip=\"tooltip\"]",function(){$(".k-grid-toolbar [data-tooltip=\"tooltip\"]").tooltip("destroy"),$("body > .tooltip").remove()}),$("#loading-cover").fadeOut(),window.viewModel=b},function(e){console.log(e)})},// Object scope variables        
tilesSearchJSON:[],fieldsSearchReady:!1,column1Id:f,column2Id:y,column1Copy:{PrimaryStyle:0,ResponsiveStyle:3,Widgets:[],Id:f,Index:1,TypeName:"Column",HasChildren:!1,index:1},column2Copy:{PrimaryStyle:0,ResponsiveStyle:3,Widgets:[],Id:y,Index:2,TypeName:"Column",HasChildren:!1,index:2},currentRowWindow:null,draggedLayoutWidgetCopy:null,draggedDataWidgetTempCopy:null,draggedToolbarWidgetTempCopy:null,tempHiddenWidg:null,openWindow:null,tileWindowsReady:!1,tilesJSONReady:!1,finishedQuickAddWidgets:!1,placeholderCardHTML:"<div class=\"draggable-row-section row widget layout-widget\"><div class=\"col-xs-12\"><div class=\"panel sys-widget card-widget\"><div class=\"card-bindable panel-body sys-pd-off sys-rd-t\"><div class=\"panel-body text-left sys-wrapper sys-bg-primary sys-fg-white sys-rd-t\"><div class=\"row\" ><div class=\"sys-mg-t-11 col-sm-10 col-xs-10 sys-fg-white\"><h3 class=\"sys-mg-t-5 sys-txt-lg sys-mg-b-5 text-white sys-fg-white pull-left card-name\"></h3></div></div></div><div class=\"panel-body text-left sys-wrapper sys-bg-white sys-fg-inverse\"><div class=\"row\"><div class=\"col-xs-12 sys-pd-t-15 text-left sys-vcenter\"><div style=\"height: 300px; float:left; display: block;\"></div></div></div></div></div></div></div></div>",bindableFieldsData:{},quickAddIndex:null,layoutWidgetSelect:$(".widgetSelection"),tileWidgets:{},offCanvasWindows:{},CleanOffCanvasModels:{},invisibleTreeViews:{},diagrams:{},diagramSelected:[],sortableWidgets:[],sortableDataWidgets:[],sortableLinkListDataWidgets:[],quickSortableWidgets:[],sortableToolbarWidgets:[],diagramActiveItemProgram:null,diagramActiveItem:null,// analytics: [],
// New Layout Widget window open function
rowWindowOpen:function rowWindowOpen(){v.openWindow="rowWindow";var e=this,t=e.options.context;$("body").addClass("window-open"),sysproInterop.getAvailableFields(function(e){// Initialise the collapsible title stylings collapsible options section, and hide it initially
// SYSPRO_VB.setupRowWindow('#rowWindow', context.parentTabWidgetJQuery === false);
console.log(e),e.Fields&&(console.log(e.Fields),e.Fields.DisplayFields&&e.Fields.DisplayFields.Charts?($("#chart-fields-list").html(v.processChartWidgetFields(e.Fields.DisplayFields.Charts)),$("#chart-fields-list a.field-name:first-child").addClass("active")):$("#ChartWidgetTab").hide(),e.Fields.hasOwnProperty("CardsAvailable")?v.processCards(e.Fields.CardsAvailable.Card,0):$("#CardWidgetTab").hide(),e.Fields.hasOwnProperty("HarmonyWidgetsAvailable")?v.processHarmony(e.Fields.HarmonyWidgetsAvailable.HarmonyWidget,0):$("#HarmonyWidgetTab").hide(),e.Fields.hasOwnProperty("GridLists")?v.processGridLists(e.Fields.GridLists.GridList,0):$("#GridlistWidgetTab").hide(),e.Fields.hasOwnProperty("TreeLists")?v.processTreeLists(e.Fields.TreeLists.TreeList,0):$("#TreelistWidgetTab").hide(),e.Fields.hasOwnProperty("TreeViews")?v.processTreeViews(e.Fields.TreeViews.TreeView,0):$("#TreeviewWidgetTab").hide(),e.Fields.hasOwnProperty("NotepadWidgets")?v.processNotepadWidgets(e.Fields.NotepadWidgets.NotepadWidget,0):$("#NotepadWidgetTab").hide(),v.finishedQuickAddWidgets=!0),$("#rowWindow .drilldown-loading-cover").fadeOut(),$("#addLayoutButtonPopoverWrap").popover({html:!1,trigger:"hover",placement:"top",/*             container: 'body', */delay:{show:100,hide:100},content:"Select and configure a layout widget to proceed"}),$("#rowWindow_wnd_title").text("Configure new layout section"),v.setupRowWindow("#rowWindow",!t.parentTabWidgetPresent),v.setColourPicker("#rowWindow")},function(e){console.log("Error: "+e)},"Fields,CardsAvailable,HarmonyWidgetsAvailable,GridLists,TreeLists,TreeViews,NotepadWidgets"),$("#rowWindow .btn-primary").on("click",function(){var a=v.setupLayoutWidget("#rowWindow");v.insertLayoutWidget("#rowWindow",a,t),e.close()}),$("#rowWindow .closeWindow").off().on("click",function(){e.close()})},// Row/Layout widget window close function
rowWindowClose:function rowWindowClose(){// Reload the JSON object into the dataSource to prevent issues with immediate removeal, or dragging and dropping of same layout widget.
// Then destroy the old treeviews
// And regenerate
v.openWindow=null,this.options.context.currentDataSource.data(this.options.context.currentDataSource.data().toJSON()),this.options.context.currentParentDataSource.data(this.options.context.currentParentDataSource.data().toJSON()),v.destroyTreeViews(),v.regenerateTreeViews(),$("#addLayoutButtonPopoverWrap").popover("destroy"),$("body").removeClass("window-open"),$("#collapsible_title_styles").collapse("hide"),$(".layout-widget-preview").empty(),$("#layout_widget_title").val(""),$("#rowWindow input[name=\"row_options\"]:checked").prop("checked",!1),$("#rowWindow .hide-on-close").hide(),$("#rowWindow .active").removeClass("active in"),$("#rowWindow .cs-selected").removeClass("cs-selected"),v.layoutWidgetSelectPlaceholder.text("Choose a layout section"),v.layoutWidgetSelect.addClass("cs-active"),$("#addLayoutWidgetButton").addClass("disabled"),$("#addLayoutWidgetButton").prop("disabled",!0),$("#rowWindow input").off(),$("#rowWindow a#tile_layout_section").off(),$("#rowWindow a.widget-option-tab").off(),$("#rowWindow .icon-field-container").off(),$("#rowWindow .icon-field-container > .radio-btn-group").empty(),$("#rowWindow .window-content").off(),$("#rowWindow  #chart-fields-list").off(),$("#chart-fields-list").empty(),$("#rowWindow .btn-primary").off(),$("#rowWindow .data-section-pane-2").hide(),$("#rowWindow .data-section-pane-1").velocity("fadeIn",{duration:1}),$("#rowWindow .icon-option").show(),$("#AvailableCards .layout-radio-options, #HarmonyWidgets .layout-radio-options, #GridlistWidgets .layout-radio-options, #TreelistWidgets .layout-radio-options, #TreeviewWidgets .layout-radio-options, #NotepadWidgets .layout-radio-options").html("")},// Edit layout widget window open function
rowEditWindowOpen:function rowEditWindowOpen(){v.openWindow="rowEditWindow";var e=this,t=e.options,a=t.context,o=t.tempLayoutWidgetJSON,n=t.currentLayoutWidgetHTML;// Initialise the collapsible title stylings collapsible options section, and hide it initially
//SYSPRO_VB.setupEditRowWindow('#rowEditWindow');
kendo.bind($("#rowEditWindow"),b),$("body").addClass("window-open"),$("#rowEditWindow input").each(function(){$(this).parent("label").toggleClass("active",$(this).prop("checked"))}),v.setupRowWindow("#rowEditWindow",null),v.setColourPicker("#rowEditWindow"),$("#rowEditWindow .btn-primary").on("click",function(){if(9===b.selected.DisplayStyle){var t=b.selected.Tabs.data().toJSON(),o=JSON.parse(JSON.stringify(t)),d=[];$("#rowEditWindow input.tab-title-input").each(function(e,t){d[e]=$(t).val()});var s=v.createTabsArray(b.selected.TabsNum,d,o);b.selected.Tabs.data(s)}sysproInterop.getHtmlFromModel("Widget",v.stringifyJSONObject(a.layoutWidgetGuid,a.canvas_id,a.currentDataSource),function(t){var o=$($.trim(t));if(2===b.selected.DisplayStyle){var d=b.selected.Rows.length,s=b.selected.toJSON(),l;s.Rows[0].Columns[0].hasOwnProperty("Widgets")?(l=d,$(o).find(".carousel-inner").append("<div class=\"item\"><div class=\"panel-body sys-bg-white text-left\"><div class=\"row \" data-row=\""+l+"\"><div class=\"col-xs-12\" data-section=\"0\"><div class=\"panel sys-widget sys-box-shadow-off sys-mg-off  add-data-widget\"><div class=\"panel-body text-center sys-fg-primary\"><a class=\"pull-left text-center add-data-section\" href=\"#\"><i class=\"material-icons\">note_add</i></a></div></div></div></div></div></div>")):l=1}else if(4===b.selected.DisplayStyle){var r=o.find(".tile-widget").parent(".col-xs-12").clone();o.find(".tile-widget").parents(".layout-widget").find(".panel-body .row").html(r),o.find(".data-section").removeClass("data-section"),o.children(".col-sm-12").addClass("tile-widget-wrapper"),o.find(".panel-body").first().prepend("<div class=\"tile-loading-cover\"><span class=\"spinner\"></span></div>"),v.tileWidgets[b.selected.Id]&&v.tileWidgets[b.selected.Id].packery("destroy"),delete v.tileWidgets[b.selected.Id]}else 9===b.selected.DisplayStyle&&(o.addClass("tab-layout-widget"),o.find(".main-column").each(function(e,t){$(t).addClass("tab-main-column")}));n.replaceWith(o),4===a.targetLayoutWidget.DisplayStyle&&v.initiateTiles(a.targetLayoutWidget),v.finishAddLayoutWidget(),v.initEditRemoveDataWidget(),sysproInterop.performBind(v.bindableFieldsData,!0,"",o.parent()),e.close()},"","","","",function(t){console.log(t),e.close()},!1)}),$("#rowEditWindow .closeWindow").on("click",function(){//ROB:  Added SYSPRO_VB  for SYSPRO_VB.tempLayoutWidgetJSON because  it got lost in scope andd appeared  as  null.
for(var t in o)b.selected.set(t,o[t]);e.close()})},// Edit Row/Layout widget window close function
rowEditWindowClose:function rowEditWindowClose(){// context.currentLayoutWidget = null;
// Reload the JSON object into the dataSource to prevent issues with immediate removeal, or dragging and dropping of same layout widget.
// Then destroy the old treeviews
// And regenerate
v.openWindow=null,this.options.context.currentDataSource.data(this.options.context.currentDataSource.data().toJSON()),this.options.context.currentParentDataSource.data(this.options.context.currentParentDataSource.data().toJSON()),v.destroyTreeViews(),v.regenerateTreeViews(),$("body").removeClass("window-open"),$("#edit_collapsible_title_styles").collapse("hide"),$("#rowEditWindow .hide-on-close").hide(),$("#edit_layout_widget_title").val(""),$(document.querySelector("input[name=\"row_options\"]:checked")).prop("checked",!1),$("#rowEditWindow .active").removeClass("active in"),$("#rowEditWindow .icon-field-container").off(),$("#rowEditWindow input").off(),$("#rowEditWindow a.widget-option-tab").off(),$("#rowEditWindow .btn-primary").off(),$("#rowEditWindow .closeWindow").off(),$("#rowEditWindow .icon-field-container > .radio-btn-group").empty(),$("#rowEditWindow .window-content").off(),$("#rowEditWindow  #chart-fields-list-edit-window").off(),$("#rowEditWindow .data-section-pane-2").hide(),$("#rowEditWindow .data-section-pane-1").velocity("fadeIn",{duration:1}),$("#rowEditWindow .icon-option").show(),b.set("selected",null)},// Kendo Window data window open function (runs as window opens)
dataWindowOpen:function dataWindowOpen(){function completeCanvasConfigAnimation(){$("#configureDataOffCanvasPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$("#addDataButtonPopoverWrap").velocity("fadeIn",{duration:300,complete:function complete(){$("#addDataWidgetButton").removeClass("disabled"),$("#addDataWidgetButton").prop("disabled",!1),$("#addDataButtonPopoverWrap").popover("destroy")}})}})}v.openWindow="dataWindow";var e=this,t=e.options.context,a=t.targetLayoutWidget.DisplayStyle,o;$("body").addClass("window-open"),sysproInterop.getAvailableFields(function(e){// if (output.Fields && output.Fields.DisplayFields && output.Fields.DisplayFields.Charts) {
//     $('#chart-fields-list').html(
//         SYSPRO_VB.processChartWidgetFields(output.Fields.DisplayFields.Charts)
//     );
//     $('#chart-fields-list a.field-name:first-child').addClass('active');
// }
var a=v.processDataWidgetFields(e.Fields);// Set up fields auto-complete search
$("#initial-fields-list-data-window").html(a),v.dataWindowFieldsList=$("#initial-fields-list-data-window").drilldown(),$("#initial-fields-list-data-window.fieldsPanelBar .list-group-item.field-name").on("click",function(){$("#dataWindow .closeWindow").text("Cancel"),v.setupDataWindowUI("#dataWindow",$(this),t.targetLayoutWidget.DisplayStyle)}),$("#dataWindow .quickAddEntryField").on("click",function(a){a.stopPropagation();var e=$(this);$("#dataWindow #fieldStylingOptions").hide();var n=$(this).closest(".list-group-item"),s=null!==document.querySelector("#dataWindow input[name=\"isMandatory\"]:checked"),l=$("#dataWindow .fields-wrapper .list-group-item.active.field-name").clone();l.find("i").remove();var r=l.text(),c=new d({Id:sysproInterop.generateUUID(),Title:"",FieldName:r,FieldPath:n.data("field-path"),HasSmartTag:n.data("smart-tag"),DataType:n.data("data-type"),KeyField:n.data("key-field"),KeyAction:n.data("key-action"),TypeName:n.data("type-name"),SubType:"",BackgroundColor:9,Caption:{Color:8,Size:0,Alignment:0,Visibility:$("#dataWindow #data_show_caption").prop("checked")},Value:{Color:8,Size:1,Alignment:0,Weight:1},Icon:{Name:null,Color:0,Size:0,Alignment:0,Tooltip:null},EntryType:n.data("entry-type"),IsMandatory:s,OffCanvasLayoutId:null});v.insertDataWidget(c,t,o,null,null,function(){e.removeClass("btn-primary").addClass("btn-success").html("<i class=\"material-icons\">check</i>")}),$("#dataWindow .closeWindow").text("Close window")}),$("#dataWindow .drilldown-loading-cover").fadeOut()},function(e){console.log("Error: "+e)},"Fields,LinksAvailable"),$("#addDataButtonPopoverWrap").popover({html:!1,trigger:"hover",placement:"top",delay:{show:100,hide:100},content:"Select and configure a data widget to proceed"}),v.setColourPicker("#dataWindow"),0===t.canvas_id?$("#dataWindow .OffCanvasLink").show():$("#dataWindow .OffCanvasLink").hide(),0==a||2==a?(o=$("div[data-guid=\""+t.layoutWidgetGuid+"\"] div[data-row=\""+t.row_num+"\"] div[data-section=\""+t.section_num+"\"]"),v.hideShowDataWidgetOptions("#dataWindow",!1,!0,!0,!1,!0,!0,!1,!1,!0,!0,!0,!1,!0,!0,!1,!1)):1==a?(o=$("div[data-guid=\""+t.layoutWidgetGuid+"\"] table tbody"),v.hideShowDataWidgetOptions("#dataWindow",!1,!0,!0,!1,!0,!0,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1)):3==a?(o=$("div[data-guid=\""+t.layoutWidgetGuid+"\"] .list-group"),v.hideShowDataWidgetOptions("#dataWindow",!1,!0,!0,!0,!1,!1,!1,!0,!1,!1,!1,!0,!1,!1,!0,!1)):5==a&&(o=$("div[data-guid=\""+t.layoutWidgetGuid+"\"] div.row[data-row=\"0\"] div[data-section=\""+t.section_num+"\"]"),v.hideShowDataWidgetOptions("#dataWindow",!1,!0,!0,!0,!0,!1,!0,!1,!0,!1,!0,!1,!1,!1,!1,!0),$("#dataWindow").addClass("parentWidgetIsEntryForm")),$("#dataWindow .change-button-back").on("click",function(){$("#addDataButtonPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$("#configureDataOffCanvasPopoverWrap").velocity("fadeIn",{duration:300,complete:function complete(){$("#configureDataOffCanvasPopoverWrap").off("click",completeCanvasConfigAnimation).on("click",completeCanvasConfigAnimation)}})}})}),$("#dataWindow input[name='link_as_button']").on("change",function(){$("#dataWindow .link-button-colour").toggle(!0===$(this).prop("checked")),$("#dataWindow .text-colour-weight-options").toggle(!0!==$(this).prop("checked"))}),$("#dataWindow input[name='data-window-off-canvas-type']").on("change",function(){var e=$("#dataWindow input[name='data-window-off-canvas-type']:checked").val();3==e?($("#dataWindow .not-available-for-windows").hide(),$("input[name='data-window-offcanvas-column-layout'], #data_offcanvas_toolbar_option").prop("checked",!1),$("input[name='data-window-offcanvas-column-layout']").parent().removeClass("active"),$("#data_offcanvas_toolbar_option").parent().removeClass("active"),$("#data-offcanvas-1col").prop("checked",!0),$("#data-offcanvas-1col").parent().addClass("active")):$("#dataWindow .not-available-for-windows").show()}),$("#dataWindow #addDataWidgetButton").on("click",function(){o.prepend("<div class=\"tile-loading-cover\"><span class=\"spinner\"></span></</div>"),o.find(".tile-loading-cover").fadeIn(),$("#dataWindow .closeWindow").text("Cancel");var n=v.setUpDataWidget("#dataWindow",a),d=_slicedToArray(n,2),s=d[0],l=d[1];e.close(),v.insertDataWidget(s,t,o,null,l,null),o.find(".tile-loading-cover").fadeOut().remove()}),$("#dataWindow .closeWindow").on("click",function(){e.close(),$("#dataWindow .closeWindow").text("Cancel")})},// data widget window close function
dataWindowClose:function dataWindowClose(){v.openWindow=null,$("#addDataButtonPopoverWrap").popover("destroy"),$("body").removeClass("window-open"),$("#dataWindow").removeClass("parentWidgetIsEntryForm"),$("#dataWindow #data_show_caption").prop("checked",!0),$("#dataWindow #isMandatory").prop("checked",!1),$("#dataWindow #isMandatory").parent().removeClass("active"),$("#dataWindow #data_show_caption").parent().addClass("active"),$("#dataWindow input[name='data-fields-radios']:checked").prop("checked",!1),$("#dataWindow input[name='link_as_button']").prop("checked",!1),$("#dataWindow input[name='link_as_button']").parent().removeClass("active"),$("#dataWindow .link-button-colour").hide(),$("#dataWindow .quickAddEntryField").off(),$("#dataWindow input:not(.typeahead-fields)").off(),$("#dataWindow .change-button-back").off(),$("#dataWindow #addDataWidgetButton").off(),$("#dataWindow .closeWindow").off(),$("#initial-fields-list-data-window.fieldsPanelBar .list-group-item.field-name").off(),$("#dataWindow .data-text-colour-options .sys-bg-inverse").hasClass("active")||$("#dataWindow .data-text-colour-options .sys-bg-inverse").button("toggle"),$(".quickAddEntryField.btn-success").removeClass("btn-success").addClass("btn-primary").html("Quick add"),$("#dataWindow .data-background-colour-options .sys-bg-white").hasClass("active")||$("#dataWindow .data-background-colour-options .sys-bg-white").button("toggle"),$("#dataWindow .icon-field-container > .radio-btn-group").empty(),$("#dataWindow .data-section-pane-2, #dataWindow .data-section-pane-3").hide(),$("#dataWindow .data-section-pane-1").velocity("fadeIn",{duration:1}),$(".text-colour-weight-options").show(),$("#fieldStylingOptions").hide(),$(".typeahead-fields, #off_canvas_title_data_window").val(""),$("#addDataWidgetButton").addClass("disabled"),$("#addDataWidgetButton").prop("disabled",!0),delete v.dataWindowFieldsList,$("#initial-fields-list-data-window-wrapper").empty().html("<ul id=\"initial-fields-list-data-window\" class=\"fieldsPanelBar\"></ul>"),$("#dataWindow .icon-option").show(),b.set("selected",null)},//data Edit Window open function
dataEditWindowOpen:function dataEditWindowOpen(){function changeOffCanvasOptions(){var e=$("#dataEditWindow input[name='data-edit-window-off-canvas-type']:checked").val();3==e?($("#dataEditWindow .not-available-for-windows").hide(),$("input[name='data-edit-window-offcanvas-column-layout'], #data_edit_offcanvas_toolbar_option").prop("checked",!1),$("input[name='data-edit-window-offcanvas-column-layout']").parent().removeClass("active"),$("#data-edit-offcanvas-1col").prop("checked",!0),$("#data-edit-offcanvas-1col").parent().addClass("active")):$("#dataEditWindow .not-available-for-windows").show()}v.openWindow="dataEditWindow";var e=this,t=e.options,a=t.context,o=t.tempOffCanvasJSON,n=t.tempDataWidgetJSON;$("body").addClass("window-open"),sysproInterop.getAvailableFields(function(e){// if (output.Fields && output.Fields.DisplayFields && output.Fields.DisplayFields.Charts) {
//     $('#chart-fields-list-edit-window').html(
//         SYSPRO_VB.processChartWidgetFields(output.Fields.DisplayFields.Charts)
//     );
// }
var t=v.processDataWidgetFields(e.Fields);$("#initial-fields-list-data-edit-window").html(t),v.dataEditWindowFieldsList=$("#initial-fields-list-data-edit-window").drilldown(),kendo.bind($("#dataEditWindow"),b);var o;$("#initial-fields-list-data-edit-window .list-group-item.active")&&(o=$("#initial-fields-list-data-edit-window .list-group-item.active"),o.addClass("active"),v.dataEditWindowFieldsList[0].resetDdMenu(),v.dataEditWindowFieldsList[0].drillto(o.closest(".dd-parent").parent().closest(".dd-parent")),v.dataEditWindowFieldsList[0].drillto(o.closest(".dd-parent")),setTimeout(function(){v.dataEditWindowFieldsList[0].partResetDdMenu(),$("#initial-fields-list-data-edit-window").scrollTop($("#initial-fields-list-data-edit-window .list-group-item.active").position().top-140)},300)),$("#dataEditWindow input").each(function(){$(this).parent("label").toggleClass("active",$(this).prop("checked"))}),$("#initial-fields-list-data-edit-window .list-group-item.field-name").on("click",function(){var e=$(this);$("#dataEditWindow [name='linklist_link_text']").val(e.data("description")),v.setupDataWindowUI("#dataEditWindow",e,a.targetLayoutWidget.DisplayStyle)}),v.setupDataWindowUI("#dataEditWindow",o,a.targetLayoutWidget.DisplayStyle),changeOffCanvasOptions(),$("#dataEditWindow .link-button-colour").toggle(!0===$("#dataEditWindow input[name='link_as_button']").prop("checked")),$("#dataEditWindow .text-colour-weight-options").toggle(!0!==$("#dataEditWindow input[name='link_as_button']").prop("checked")),$("#dataEditWindow .drilldown-loading-cover").fadeOut()},function(e){console.log("Error: "+e)},"Fields,LinksAvailable"),v.setColourPicker("#dataEditWindow");var d=a.targetLayoutWidget.DisplayStyle,s;0===d||2===d?(s=$("div[data-guid=\""+a.layoutWidgetGuid+"\"] div[data-row=\""+a.row_num+"\"] div[data-section=\""+a.section_num+"\"]"),v.hideShowDataWidgetOptions("#dataEditWindow",!1,!1,!0,!1,!1,!0,!1,!1,!0,!0,!0,!1,!0,!0,!1,!1)):1===d?(s=$("div[data-guid=\""+a.layoutWidgetGuid+"\"] tr[data-row=\"0\"]"),v.hideShowDataWidgetOptions("#dataEditWindow",!1,!1,!0,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1)):3===d?(s=$("div[data-guid=\""+a.layoutWidgetGuid+"\"] a[data-row=\"0\"]"),v.hideShowDataWidgetOptions("#dataEditWindow",!1,!1,!0,!0,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!0,!1)):5===d&&(s=$("div[data-guid=\""+a.layoutWidgetGuid+"\"] a[data-row=\"0\"]"),v.hideShowDataWidgetOptions("#dataEditWindow",!1,!1,!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0),$("#dataEditWindow").addClass("parentWidgetIsEntryForm")),$("#dataEditWindow input[name='link_as_button']").on("change",function(){$("#dataEditWindow .link-button-colour").toggle(!0===$(this).prop("checked")),$("#dataEditWindow .text-colour-weight-options").toggle(!0!==$(this).prop("checked")),b.selected.SubType=null===document.querySelector("#dataEditWindow input[name=\"link_as_button\"]:checked")?null:"Button"}),"Joined"===a.targetLayoutWidget.SubType?$("#dataEditWindow .fieldBackgroundColorOption").hide():(0===d||2===d)&&$("#dataEditWindow .fieldBackgroundColorOption").show(),$("#dataEditWindow input[name='data-edit-window-off-canvas-type']").on("change",function(){changeOffCanvasOptions()}),$("#dataEditWindow #editDataWidgetSaveButton").on("click",function(){var t="LinkWidget"===b.selected.TypeName||!0===b.selected.HasSmartTag?$("[data-guid=\"".concat(b.selected.Id,"\"]")).closest("a"):$("[data-guid=\"".concat(b.selected.Id,"\"]")),n=t.parents(".draggable-row-section");sysproInterop.getHtmlFromModel("Widget",v.stringifyJSONObject(b.selected.Id,a.canvas_id,a.currentDataSource),function(a){var d=$($.trim(a));t.replaceWith(d),kendo.bind($("#dataEditWindow"),b),sysproInterop.performBind(v.bindableFieldsData,!0,"",n),b.selectedOffCanvas&&(v.editOffCanvasSection(),v.insertOffCanvasSection(b.selectedOffCanvas,!0,o,function(){if(3==b.selectedOffCanvas.OffCanvas)d.find("a").removeClass("offcanvas-toggle"),d.find("a").on("click",function(){v.offCanvasWindows[$(this).data("target")].center().open()});else{$("#offcanvas-"+b.selectedOffCanvas.Id).removeClass("js-offcanvas-done");d.hasClass("offcanvas-toggle")?new Offcanvas(d):new Offcanvas(d.find("a.offcanvas-toggle"))}e.close()})),v.initEditRemoveDataWidget(),v.initDataWidgetSorting(),v.finishAddLayoutWidget(),b.selectedOffCanvas||e.close()},a.targetLayoutWidget.SubType,a.targetLayoutWidget.DisplayStyle,a.targetLayoutWidget.Border,a.section_num,function(t){console.log(t),e.close()},!1)}),$("#dataEditWindow .closeWindow").on("click",function(){for(var t in n)b.selected.set(t,n[t]);for(var a in o)"IsToolbarVisible"==a?b.selectedOffCanvas.MainToolbar.set("IsToolbarVisible",o.IsToolbarVisible):b.selectedOffCanvas.set(a,o[a]);e.close()})},//data Edit Window close function
dataEditWindowClose:function dataEditWindowClose(){// Reload the JSON object into the dataSource to prevent issues with immediate removal, or dragging and dropping of same layout widget.
v.openWindow=null,this.options.context.currentDataSource.data(this.options.context.currentDataSource.data().toJSON()),delete v.tempOffCanvasJSON,b.selectedOffCanvas&&(b.selectedOffCanvas.Columns.data(b.selectedOffCanvas.Columns.data().toJSON()),b.selectedOffCanvas.MainToolbar.Columns.data(b.selectedOffCanvas.MainToolbar.Columns.data().toJSON()),b.set("selectedOffCanvas",null)),$("#initial-fields-list-data-edit-window .list-group-item.field-name").off(),$("#dataEditWindow input:not(.typeahead-fields)").off(),$("#dataEditWindow #editDataWidgetSaveButton").off(),$("#dataEditWindow .closeWindow").off(),$("#dataEditWindow .link-button-colour").hide(),$("body").removeClass("window-open"),$("#dataEditWindow").removeClass("parentWidgetIsEntryForm"),$(".typeahead-fields").val(""),$("#dataEditWindow .data-section-pane-2, #dataEditWindow .data-section-pane-3").hide(),$("#dataEditWindow .data-section-pane-1").velocity("fadeIn",{duration:1}),$("#dataEditWindow .icon-field-container > .radio-btn-group").empty(),$("#chart-fields-list-edit-window").empty(),$("#initial-fields-list-data-edit-window-wrapper").empty().html("<ul id=\"initial-fields-list-data-edit-window\" class=\"fieldsPanelBar\"></ul>"),delete v.dataEditWindowFieldsList,$("#dataEditWindow .icon-option").show(),b.set("selected",null)},// Tile window open function
tileWindowOpen:function tileWindowOpen(){$("#loading-cover").hide(),v.openWindow="tileWindow";var e=this,t=e.options.context,a;sysproInterop.getAvailableFields(function(e){var t=v.processTiles(e.Fields.TilesAvailable);a=JSON.parse(sysproInterop.retrieveData("tilesJSON"));var o=v.processTileOptions(a);$("#tiles-parameters-wrapper").append(o),$(".typeahead-tiles").typeahead({source:v.tilesSearchJSON,autoSelect:!0,afterSelect:v.selectTileFromSearch}),$("#tiles-list").html(t),v.tilesList=$("#tiles-list").drilldown(),$("#tiles-list").on("click",".list-group-item.field-name",function(){$("#tiles-list li.active").removeClass("active"),$(this).addClass("active"),$(".tile-kpi-indicator-option").toggle("Y"===$(this).data("kpi-indicator")),v.showTileParameters($(this).data("tile-name"),v.openWindow),$("#addTileButton").removeClass("disabled"),$("#addTileButton").prop("disabled",!1),$("#addTileButtonPopoverWrap").popover("destroy")}),v.setupTileWIndowUI(v.openWindow),$("#tileWindow .drilldown-loading-cover").fadeOut()},function(e){console.log("Error: "+e)},"TilesAvailable"),$("body").addClass("window-open"),$("#addTileButtonPopoverWrap").popover({html:!1,trigger:"hover",placement:"top",delay:{show:100,hide:100},content:"Select and configure a tile to proceed"}),$("#tileWindow input").each(function(){$(this).parent("label").toggleClass("active",$(this).prop("checked"))}),v.setColourPicker("#tileWindow"),$("#tileWindow .btn-primary").on("click",function(){$(".layout-widget[data-guid=\""+t.layoutWidgetGuid+"\"]").find(".tiles-parent .tile-loading-cover").first().show(100,function(){var o=$("#tileWindow input[name='tile_width']:checked").val(),n=$("#tileWindow #tiles-list .list-group-item.active").data("tile-name").replace("IMPMENLZ",""),l=$("#tileWindow #tiles-list .list-group-item.active").data("detail-available"),r=$("#tileWindow #tiles-list .list-group-item.active").data("sub-type"),c=$("#tileWindow #tiles-list .list-group-item.active").data("kpi-indicator"),p=$("#tileWindow select[name='tile_kpi_indicator']").val(),u=$("#tileWindow input[name='tile_background_colour']:checked").val(),m=$("#tileWindow input[name='tile_text_colour']:checked").val(),g={},h=a[n],f=$("#tileWindow #tiles-list .list-group-item.active").data("tile-type"),y="MLText"===f&&"Y"===c&&"gauge"===p?"MLGauge":"Text"===f&&"Y"===c&&"gauge"===p?"TextGauge":f;if(h!==void 0&&h.hasOwnProperty("Parameter"))if(h.Parameter.length)for(var W=0;W<h.Parameter.length;W++)"A"==h.Parameter[W].ParamType?g[h.Parameter[W].ParamName]=$("#tiles-parameters-wrapper ."+n+"Parameters input[name='"+h.Parameter[W].ParamName+"']").val():"L"==h.Parameter[W].ParamType&&(g[h.Parameter[W].ParamName]=$("#tiles-parameters-wrapper ."+n+"Parameters select[name='"+h.Parameter[W].ParamName+"']").val());else"A"==h.Parameter.ParamType?g[h.Parameter.ParamName]=$("#tiles-parameters-wrapper ."+n+"Parameters input[name='"+h.Parameter.ParamName+"']").val():"L"==h.Parameter.ParamType&&(g[h.Parameter.ParamName]=$("#tiles-parameters-wrapper ."+n+"Parameters select[name='"+h.Parameter.ParamName+"']").val());var b=null===document.querySelector("#tileWindow .icon-field-container .icon-option.active")?null:$("#tileWindow .icon-field-container .icon-option.active").data("icon-name"),w=null===document.querySelector("#tileWindow input[name=\"tile_icon_colour\"]:checked")?null:document.querySelector("#tileWindow input[name=\"tile_icon_colour\"]:checked").value,C=r&&0===r.indexOf("Plugin")?r:n,k=$("#tileWindow #tiles-list .list-group-item.active").data("tile-keyfield"),x=sysproInterop.generateUUID(),S=sysproInterop.generateUUID(),T=new d({Id:x,Title:n,FieldName:"",FieldPath:"",HasSmartTag:!1,DataType:"A",KeyField:k,KeyAction:void 0,parentFieldPath:k,TypeName:"Tile",SubType:r,KpiLevelIndicator:c,Details:{Color:m},BackgroundColor:u,TileParameters:g,TileWidth:o,TileTypeDetail:C,TileType:y,TileTypeIcon:b,DetailAvailable:l,TileTypeIconColor:w,Caption:{Color:8,Size:0},HTMLContent:function HTMLContent(){var e=sysproInterop.generateUUID();return sysproInterop.getHtmlFromModel("Widget",T.toJSON(),function(t){$("#async_"+e).html($.trim(t))},"","","","",function(e){console.log(e)},!1),"<div id='async_"+e+"'> </div>"}});if(t.targetLayoutWidget.children.at(0).hasOwnProperty("Columns")){var D=t.targetLayoutWidget.children.at(0).Columns.length,I=new s({Id:S,index:D,ResponsiveStyle:o});I.append(T),t.targetLayoutWidget.children.at(0).append(I)}else{var O=new s({Id:S,index:0,ResponsiveStyle:o});O.append(T),t.targetLayoutWidget.children.at(0).append(O)}v.initiateTiles(t.targetLayoutWidget),v.initEditRemoveDataWidget(),e.close()})}),$("#tileWindow .closeWindow").on("click",function(){e.close()})},// tile window close function
tileWindowClose:function tileWindowClose(){v.openWindow=null,$("#addTileButtonPopoverWrap").popover("destroy"),$("body").removeClass("window-open"),$("#tile-list-option").hide(),$(".hide-on-close").hide(),$(".tile-parameter-wrapper").hide(),$("#tileWindow input[type='text']").val(""),$("#tileWindow .list-group-item.active").removeClass("active"),$("#tileWindow .tile_width").prop("checked",!1),$("#tileWindow input[name='tile_width'][value='2']").prop("checked",!0),$("#tile-text-option").hide(),$("#tile_list").html(),$("#tiles-list").off(),$("#tileWindow .closeWindow").off(),$("#tileWindow .btn-primary").off(),$("#tileWindow input[name='tile_background_colour']").off(),$("#tileWindow input[name='tile_text_colour']").off(),$("#tileWindow .clear-color-selections").off(),$("#addTileButton").addClass("disabled"),$("#addTileButton").prop("disabled",!0),$("#tileWindow .fieldsPanelBar").scrollTop(0),$("#tileWindow .icon-option").show(),$("#tile-widgets-list-wrapper").empty().html("<ul id=\"tiles-list\" class=\"fieldsPanelBar\"></ul>"),$("#tiles-parameters-wrapper").empty(),delete v.tilesList,$("#tileWindow .icon-field-container > .radio-btn-group").empty(),$("#tileWindow .data-section-pane-2").hide(),$("#tileWindow .data-section-pane-1").velocity("fadeIn",{duration:1}),$(".tile-text-colour-options .btn-radio").removeClass("disabled"),$(".tile-background-colour-options .btn-radio").removeClass("disabled")},// Tile edit window open function
tileEditWindowOpen:function tileEditWindowOpen(){$("#loading-cover").hide(),v.openWindow="tileEditWindow";var e=this,t=e.options,a=t.context,o=t.tempDataWidgetJSON,n;sysproInterop.getAvailableFields(function(e){v.tilesJSONReady||v.processTileJSON(e.Fields.TilesAvailable),n=JSON.parse(sysproInterop.retrieveData("tilesJSON"));var t=v.processTileOptions(n,b.selected.Widgets[0].TileTypeDetail);$("#tiles-edit-parameters-wrapper").append(t),$("#tiles-edit-parameters-wrapper").find("input, select").each(function(e,t){$(t).attr("id",$(t).attr("id")+"Edit")}),$(".typeahead-tiles").typeahead({source:v.tilesSearchJSON,autoSelect:!0,afterSelect:v.selectTileFromSearch}),kendo.bind($("#tileEditWindow"),b),$("#tileEditWindow input").each(function(){$(this).parent("label").toggleClass("active",$(this).prop("checked"))}),v.showTileParameters(b.selected.Widgets[0].TileTypeDetail,"tileEditWindow"),$("#tileEditWindow .tile-kpi-indicator-option").toggle("Y"===b.selected.Widgets[0].KpiLevelIndicator),v.setupTileWIndowUI("tileEditWindow")},function(e){console.log("Error: "+e)},"TilesAvailable"),$("body").addClass("window-open"),v.setColourPicker("#tileEditWindow"),$("#tileEditWindow .btn-primary").on("click",function(){v.initiateTiles(a.targetLayoutWidget),v.initEditRemoveDataWidget(),e.close()}),$("#tileEditWindow .closeWindow").on("click",function(){for(var t in o)b.selected.Widgets[0].set(t,o[t]);v.initiateTiles(a.targetLayoutWidget),v.initEditRemoveDataWidget(),e.close()})},// tile window close function
tileEditWindowClose:function tileEditWindowClose(){// SYSPRO_VB.currentTileWidget = null;
v.openWindow=null,$("body").removeClass("window-open"),$("#tileEditWindow .data-section-pane-2").hide(),$("#tileEditWindow .data-section-pane-1").velocity("fadeIn",{duration:1}),$("#tileEditWindow .fieldsPanelBar").scrollTop(0),$("#tileEditWindow .icon-option").show(),$(".hide-on-close").hide(),$(".tile-text-colour-options .btn-radio").removeClass("disabled"),$(".tile-background-colour-options .btn-radio").removeClass("disabled"),$("#tileEditWindow .btn-primary").off(),$("#tileEditWindow .closeWindow").off(),$("#tileEditWindow input[name='tile_background_colour']").off(),$("#tileEditWindow input[name='tile_text_colour']").off(),$("#tileEditWindow .clear-color-selections").off(),$("#tileEditWindow .icon-field-container > .radio-btn-group").empty(),$("#tiles-edit-parameters-wrapper").empty(),b.set("selected",null)},showTileParameters:function showTileParameters(e,t){$(".tile-parameter-wrapper").hide(),$("#"+t+" ."+e+"Parameters").show()},// Determine which colour choices users can make for foreground or background choices, depending on their choice in one of those options
setupTileWIndowUI:function setupTileWIndowUI(e){$("#"+e+" input[name='tile_background_colour']").on("change",function(){var t=this;v.setColourPickerDotColour("#"+e,t,".tile-text-colour-options")}),$("#"+e+" input[name='tile_text_colour']").on("change",function(){var t=this;v.setColourPickerDotColour("#"+e,t,".tile-background-colour-options")}),$("#"+e+".clear-color-selections").on("click",function(t){t.preventDefault(),$(".tile-text-colour-options .btn-radio").removeClass("disabled"),$(".tile-background-colour-options .btn-radio").removeClass("disabled")})},// Kendo Window version of data widget
toolbarWindowOpen:function toolbarWindowOpen(){function completeOffCanvasConfigAnimation(){$("#configureToolbarOffCanvasPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$("#addToolbarWidgetButtonPopoverWrap").velocity("fadeIn",{duration:300,complete:function complete(){$("#addToolbarWidgetButton").removeClass("disabled"),$("#addToolbarWidgetButton").prop("disabled",!1),$("#addToolbarWidgetButtonPopoverWrap").popover("destroy")}})}})}v.openWindow="toolbarWindow";var e=this,t=e.options,a=t.context,o=t.parentToolbarWidgetHTML,n=t.parentToolbarWidget;$("body").addClass("window-open");var d;sysproInterop.getAvailableFields(function(e){$("#toolbar-widgets-list").html(v.processToolbarWidgetFields(e.Fields.ToolbarActions)),v.toolbarActionsList=$("#toolbar-widgets-list").drilldown(),null===n?$("#ToolbarDropdown").show():$("#ToolbarDropdown").hide(),null===n?$("#ToolbarSubDropdown").hide():$("#ToolbarSubDropdown").show(),null!==n&&o.hasClass("dropdown-submenu")&&1===o.parents(".dropdown-submenu").length&&$("#ToolbarSubDropdown").hide(),null!==n&&o.hasClass("dropdown-submenu")&&1===o.parents(".dropdown-submenu").length?d=3:null!==n&&o.hasClass("dropdown-submenu")&&0===o.parents(".dropdown-submenu").length?d=2:null===n||o.hasClass("dropdown-submenu")?null===n&&(d=0):d=1,0===a.canvas_id?$("#OffCanvasToolbarItem").show():$("#OffCanvasToolbarItem").hide(),$("#toolbar-widgets-list.fieldsPanelBar .list-group-item.field-name").on("click",function(){if($("#toolbar-widgets-list.fieldsPanelBar .list-group-item.field-name.active").removeClass("active"),$(this).addClass("active"),$("#toolbarWindow #toolbar_item_text").val($(this).data("shortcaption")),$("#toolbarWindow #toolbar_item_tooltip").val($(this).data("tooltip")),$(".toolbar-text-option").show(),$(".toolbar-icon-option").show(),$("#toolbarWindowIconList label.active").removeClass("active"),$(this).data("toolbar-icon")){var e=$("#toolbarWindowIconList label[data-icon-name='"+$(this).data("toolbar-icon")+"']");e.addClass("active"),setTimeout(function(){$(".toolbar-icon-option .icon-field-container").scrollTop($(".toolbar-icon-option .icon-field-container").scrollTop()+e.position().top-193)},200)}if($("#toolbar-widget-parameters-wrapper").show(),"OffCanvasToolbarItem"===$(this).attr("id")){var t=function(){$("#configureToolbarOffCanvasPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$("#addToolbarWidgetButtonPopoverWrap").velocity("fadeIn",{duration:300,complete:function complete(){$("#addToolbarWidgetButton").removeClass("disabled"),$("#addToolbarWidgetButton").prop("disabled",!1),$("#addToolbarWidgetButtonPopoverWrap").popover("destroy")}})}})};$("#addToolbarWidgetButtonPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$("#configureToolbarOffCanvasPopoverWrap").velocity("fadeIn",{duration:300,complete:function complete(){$("#configureToolbarOffCanvasPopoverWrap").off("click",t).on("click",t)}})}})}else $("#configureToolbarOffCanvasPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$("#addToolbarWidgetButtonPopoverWrap").velocity("fadeIn",{duration:300,complete:function complete(){$("#addToolbarWidgetButton").removeClass("disabled"),$("#addToolbarWidgetButton").prop("disabled",!1),$("#addToolbarWidgetButtonPopoverWrap").popover("destroy")}})}})}),$("#toolbarWindow .drilldown-loading-cover").fadeOut(),console.log(d)},function(e){console.log("Error: "+e)},"ToolbarActions"),$("#addToolbarWidgetButtonPopoverWrap").popover({html:!1,trigger:"hover",placement:"top",delay:{show:100,hide:100},content:"Select and configure a toolbar widget to proceed"}),v.setColourPicker("#toolbarWindow"),$("#toolbarWindow .change-button-back").on("click",function(){$("#addToolbarWidgetButtonPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$("#configureToolbarOffCanvasPopoverWrap").velocity("fadeIn",{duration:300,complete:function complete(){$("#configureToolbarOffCanvasPopoverWrap").off("click",completeOffCanvasConfigAnimation).on("click",completeOffCanvasConfigAnimation)}})}})}),$("#toolbarWindow input[name='toolbar-window-off-canvas-type']").on("change",function(){var e=$("#toolbarWindow input[name='toolbar-window-off-canvas-type']:checked").val();3==e?($("#toolbarWindow .not-available-for-windows").hide(),$("input[name='toolbar-window-offcanvas-column-layout'], #offcanvas_toolbar_option").prop("checked",!1),$(".offcanvas-layout-options label").removeClass("active"),$("#offcanvas_toolbar_option").parent().removeClass("active"),$("#offcanvas-1col").prop("checked",!0),$("#offcanvas-1col").parent().addClass("active")):$("#toolbarWindow .not-available-for-windows").show()}),$("#toolbarWindow #addToolbarWidgetButton").on("click",function(){o?o.find("> .dropdown-menu").append("<li class=\"toolbar-placeholder\"><div class=\"tile-loading-cover\" style=\"display:block;\"><div class=\"loader\"><div class=\"square\" ></div><div class=\"square\"></div><div class=\"square last\"></div><div class=\"square clear\"></div><div class=\"square\"></div><div class=\"square last\"></div><div class=\"square clear\"></div><div class=\"square \"></div><div class=\"square last\"></div></div></div></li>"):0===a.canvas_id?$("#navbar-toolbar ul.nav[data-column='"+a.column_num+"']").append("<li class=\"toolbar-placeholder\"><div class=\"tile-loading-cover\" style=\"display:block;\"><div class=\"loader\"><div class=\"square\" ></div><div class=\"square\"></div><div class=\"square last\"></div><div class=\"square clear\"></div><div class=\"square\"></div><div class=\"square last\"></div><div class=\"square clear\"></div><div class=\"square \"></div><div class=\"square last\"></div></div></div></li>"):$("#offcanvas-"+a.canvas_id+" ul.nav[data-column='"+a.column_num+"']").append("<li class=\"toolbar-placeholder\"><div class=\"tile-loading-cover\" style=\"display:block;\"><div class=\"loader\"><div class=\"square\" ></div><div class=\"square\"></div><div class=\"square last\"></div><div class=\"square clear\"></div><div class=\"square\"></div><div class=\"square last\"></div><div class=\"square clear\"></div><div class=\"square \"></div><div class=\"square last\"></div></div></div></li>");var t=!1,s=null===document.querySelector("#toolbarWindow input[name=\"data_text_colour\"]:checked")?null:document.querySelector("#toolbarWindow input[name=\"data_text_colour\"]:checked").value,l=null===document.querySelector("#toolbarWindow input[name=\"data_text_weight\"]:checked")?null:document.querySelector("#toolbarWindow input[name=\"data_text_weight\"]:checked").value,r=null===document.querySelector("#toolbarWindow input[name=\"data_text_alignment\"]:checked")?null:document.querySelector("#toolbarWindow input[name=\"data_text_alignment\"]:checked").value,g=null===document.querySelector("#toolbarWindow .icon-field-container .icon-option.active")?null:$("#toolbarWindow .icon-field-container .icon-option.active").data("icon-name"),h=null===document.querySelector("#toolbarWindow input[name=\"toolbar_icon_colour\"]:checked")?null:document.querySelector("#toolbarWindow input[name=\"toolbar_icon_colour\"]:checked").value,f=null===document.querySelector("#toolbarWindow input[name=\"toolbar_icon_alignment\"]:checked")?0:document.querySelector("#toolbarWindow input[name=\"toolbar_icon_alignment\"]:checked").value,y=$("#toolbarWindow #toolbar-widgets-list .list-group-item.active.field-name").clone(),w,C,k,x,S;y.find("i").remove(),S=y.data("field-name");var T=$("#toolbarWindow #toolbar_item_tooltip").val(),W=y.data("toolbar-widget-type"),D=$("#toolbarWindow #toolbar_item_text").val();if("ToolbarDropdown"===S)w=k="ToolbarDropdown",S=null;else if("ToolbarSubDropdown"===S)w=k="ToolbarSubDropdown",S=null;else if("ButtonWidget"===S){t=!0,w="ButtonWidget",k="Widget";var I=document.querySelector("#toolbarWindow input[name=\"toolbar-window-off-canvas-type\"]:checked").value,O=document.querySelector("#toolbarWindow input[name=\"toolbar-window-offcanvas-column-layout\"]:checked").value,_=sysproInterop.generateUUID(),P=$("#toolbarWindow #off_canvas_title").val(),E=!!document.querySelector("#toolbarWindow input[name=\"offcanvas_toolbar_option\"]:checked")||null;x=v.setupOffCanvasSection(_,P,I,E,O)}else w=k="ToolbarWidget";var F={Id:sysproInterop.generateUUID(),Title:D,FieldName:S,TypeName:w,ToolbarWidgetType:W,Icon:{Name:g,Color:h,Alignment:f,Visibility:null!==g},Tooltip:T,OffCanvasLayoutId:C// Widgets: [],
},A=0===d?new m(F):1===d?new u(F):2===d?new p(F):new c(F);// TODO: find the top level widget, to be able to build up a path to add the new sub sub or whatever widget straight to the datasource, e.g. context.currentToolbarDataSource.at(context.toolbarcolumnnum)...etcetc
// const topLevelToolbarWidgetHTML = parentToolbarWidgetHTML
//     ? $(this).closest('.multi-level')
//     : null;
// const topLevelToolbarWidgetUid = topLevelToolbarWidgetHTML
//     ? topLevelToolbarWidgetHTML.data('guid')
//     : null;
// const topLevelToolbarWidget = topLevelToolbarWidgetUid
//     ? context.currentToolbarDataSource.get(topLevelToolbarWidgetUid)
//     : null;
// const topLevelToolbarWidgetIndex = topLevelToolbarWidget
//     ? topLevelToolbarWidget.parentNode().indexOf(topLevelToolbarWidget)
//     : null;
// let hierarchicalLevel;
// if ( parentToolbarWidget !== null && parentToolbarWidgetHTML.hasClass("dropdown-submenu") && parentToolbarWidgetHTML.parents(".dropdown-submenu").length === 1 ) {
//     hierarchicalLevel = 3;
// } else if (parentToolbarWidget !== null && parentToolbarWidgetHTML.hasClass("dropdown-submenu") && parentToolbarWidgetHTML.parents(".dropdown-submenu").length === 0 ) {
//     hierarchicalLevel = 2;
// } else if (parentToolbarWidget !== null && !parentToolbarWidgetHTML.hasClass("dropdown-submenu")) {
//     hierarchicalLevel = 1;
// } else if (parentToolbarWidget === null) {
//     hierarchicalLevel = 0;
// }
if(n){// parentToolbarWidget.append(KendoToolbarWidget);
if("ToolbarSubDropdown"===n.TypeName){if("ToolbarSubDropdown"===n.parentNode().TypeName){var N=n.parentNode().children.indexOf(n),M=n.parentNode().parentNode().children.indexOf(n.parentNode()),L=n.parentNode().parentNode().parentNode().children.indexOf(n.parentNode().parentNode());b.toolbar.at(a.column_num).children.at(L).children.at(M).children.at(N).append(A)}else if("ToolbarDropdown"===n.parentNode().TypeName){var B=n.parentNode().children.indexOf(n),R=n.parentNode().parentNode().children.indexOf(n.parentNode());b.toolbar.at(a.column_num).children.at(R).children.at(B).append(A)}}else if("ToolbarDropdown"===n.TypeName){var H=n.parentNode().children.indexOf(n);b.toolbar.at(a.column_num).children.at(H).append(A)}// const VBdata = context.currentToolbarDataSource.data().toJSON();
// context.currentToolbarDataSource.data(VBdata);
}else if(0!==a.canvas_id){var U=b.OffCanvasLayouts["offcanvas-"+a.canvas_id];U.MainToolbar.Columns.at(a.column_num).append(A)}else b.toolbar.at(a.column_num).append(A);e.close();var V="ToolbarSubDropdown"===k?"ToolbarDropdown":k;sysproInterop.getHtmlFromModel(V,A.toJSON(),function(e){var n=$($.trim(e));//if (TypeName === 'ToolbarDropdown') SYSPRO_VB.initToolbarSorting();
0===a.canvas_id?(o?o.find("> .dropdown-menu").append(n):$("#navbar-toolbar ul.nav[data-column='"+a.column_num+"']").append(n),sysproInterop.performBind(v.bindableFieldsData,!0,"",$("#navbar-toolbar")),!0===t&&v.insertOffCanvasSection(x,!1,null,function(){if(3==x.OffCanvas)n.removeClass("offcanvas-toggle"),n.find(".offcanvas-toggle").on("click",function(){v.offCanvasWindows[$(this).data("target")].center().open()});else new Offcanvas(n.find("a.offcanvas-toggle"))})):(o?o.find("> .dropdown-menu").append(n):$("#offcanvas-"+a.canvas_id+" ul.nav[data-column='"+a.column_num+"']").append(n),sysproInterop.performBind(v.bindableFieldsData,!0,"",$("#offcanvas-"+a.canvas_id))),$.material.init(),v.initEditRemoveToolbarWidgets(),$("#navbar-toolbar [data-tooltip=\"tooltip\"]").tooltip("destroy"),$("#navbar-toolbar [data-tooltip=\"tooltip\"]").tooltip(),o?o.find(".dropdown-menu").find(".toolbar-placeholder").fadeOut().remove():0===a.canvas_id?$("#navbar-toolbar ul.nav[data-column='"+a.column_num+"']").find(".toolbar-placeholder").fadeOut().remove():$("#offcanvas-"+a.canvas_id+" ul.nav[data-column='"+a.column_num+"']").find(".toolbar-placeholder").fadeOut().remove(),v.initToolbarSorting()},"",7,"","",function(t){console.log(t),e.close()},!1)}),$("#toolbarWindow .closeWindow").on("click",function(){e.close()})},// data widget window close function
toolbarWindowClose:function toolbarWindowClose(){// this.options.context.currentToolbarDataSource.data(JSON.parse(JSON.stringify(this.options.context.currentToolbarDataSource.data().toJSON())));
// Then destroy the old treeviews
// And regenerate
v.destroyTreeViews(),v.regenerateTreeViews(),v.openWindow=null,$("body").removeClass("window-open"),$("#addToolbarWidgetButtonPopoverWrap").popover("destroy"),$("#toolbarWindow .data-text-colour-options .sys-bg-inverse").hasClass("active")||$("#toolbarWindow .data-text-colour-options .sys-bg-inverse").button("toggle"),$(".toolbar-text-option, #off_canvas_title").val(""),$("#toolbarWindow .field-name.active").removeClass("active"),$("#toolbarWindow input[name='data-fields-radios']:checked").prop("checked",!1),$("#toolbar-widgets-list.fieldsPanelBar .list-group-item.field-name").off(),$("#toolbarWindow .change-button-back").off(),$("#toolbarWindow input[name='toolbar-window-off-canvas-type']").off(),$("#toolbarWindow .closeWindow").off(),$("#toolbarWindow #addToolbarWidgetButton").off(),$("#toolbarWindow .hide-on-close").hide(),$("#toolbarWindow .data-section-pane-2, #toolbarWindow .data-section-pane-3").hide(),$("#toolbarWindow .data-section-pane-1").velocity("fadeIn",{duration:1}),$("#addToolbarWidgetButton").addClass("disabled"),$("#addToolbarWidgetButton").prop("disabled",!0),$("#toolbarWindow .icon-field-container > .radio-btn-group").empty(),delete v.toolbarActionsList,$("#toolbar-widget-list-wrapper").empty().html("<ul id=\"toolbar-widgets-list\" class=\"fieldsPanelBar list-group\"></ul>"),$("#toolbarWindow .icon-option").show()},// toolbar Edit Window open function
toolbarEditWindowOpen:function toolbarEditWindowOpen(){function setupToolbarEditWindowUI(e){if($(".toolbar-text-option").show(),$(".toolbar-icon-option").show(),$("#edit-toolbar-widget-parameters-wrapper").show(),$("#edit-toolbar-widgets-list.fieldsPanelBar .list-group-item.field-name.active")){var t=$("#edit-toolbar-widgets-list.fieldsPanelBar .list-group-item.field-name.active");t.addClass("active"),v.toolbarActionsEditList[0].resetDdMenu(),v.toolbarActionsEditList[0].drillto(t.closest(".dd-parent").parent().closest(".dd-parent")),v.toolbarActionsEditList[0].drillto(t.closest(".dd-parent")),setTimeout(function(){v.toolbarActionsEditList[0].partResetDdMenu(),$("#edit-toolbar-widgets-list").scrollTop($("#edit-toolbar-widgets-list .list-group-item.active").position().top-140)},300)}if("OffCanvasToolbarItem"===$(e).attr("id")){var a=function(){$("#configureEditToolbarOffCanvasButton").velocity("fadeOut",{duration:300,complete:function complete(){$("#editToolbarWidgetButton").velocity("fadeIn",{duration:300,complete:function complete(){$("#editToolbarWidgetButton").removeClass("disabled"),$("#editToolbarWidgetButton").prop("disabled",!1)}})}})};$("#editToolbarWidgetButton").velocity("fadeOut",{duration:300,complete:function complete(){$("#configureEditToolbarOffCanvasButton").velocity("fadeIn",{duration:300,complete:function complete(){$("#configureEditToolbarOffCanvasButton").off("click",a).on("click",a)}})}})}else $("#configureEditToolbarOffCanvasButton").velocity("fadeOut",{duration:300,complete:function complete(){$("#editToolbarWidgetButton").velocity("fadeIn",{duration:300,complete:function complete(){$("#editToolbarWidgetButton").removeClass("disabled"),$("#editToolbarWidgetButton").prop("disabled",!1)}})}})}function changeOffCanvasOptions(){var e=$("#toolbarEditWindow input[name='toolbar-edit-window-off-canvas-type']:checked").val();3==e?($("#toolbarEditWindow .not-available-for-windows").hide(),$("input[name='toolbar-edit-window-offcanvas-column-layout'], #toolbar_edit_offcanvas_toolbar_option").prop("checked",!1),$(".offcanvas-layout-options label").removeClass("active"),$("#toolbar-edit-offcanvas-1col").prop("checked",!0),$("#toolbar-edit-offcanvas-1col").parent().addClass("active")):$("#toolbarEditWindow .not-available-for-windows").show()}$("body").addClass("window-open");var e=this,t=e.options,a=t.context,o=t.tempOffCanvasJSON,n=t.tempToolbarWidgetJSON,d=t.currentToolbarWidgetHTML;v.openWindow="toolbarEditWindow",sysproInterop.getAvailableFields(function(e){$("#edit-toolbar-widgets-list").html(v.processToolbarWidgetFields(e.Fields.ToolbarActions)),v.toolbarActionsEditList=$("#edit-toolbar-widgets-list").drilldown(),kendo.bind($("#toolbarEditWindow"),b),setupToolbarEditWindowUI("#edit-toolbar-widgets-list.fieldsPanelBar .list-group-item.field-name.active"),changeOffCanvasOptions(),$("#edit-toolbar-widgets-list.fieldsPanelBar .list-group-item.field-name").on("click",function(){var e=this;if(setupToolbarEditWindowUI(e),$(e).data("toolbar-icon")){var t=$("#toolbarEditWindowIconList label[data-icon-name='"+$(e).data("toolbar-icon")+"']");t.addClass("active"),b.selected.Icon.Visibility=!0,setTimeout(function(){$(".toolbar-icon-option .icon-field-container").scrollTop($(".toolbar-icon-option .icon-field-container").scrollTop()+t.position().top-193)},300)}}),$("#toolbarEditWindow .drilldown-loading-cover").fadeOut()},function(e){console.log("Error: "+e)},"ToolbarActions"),$("#toolbarEditWindow input").each(function(){$(this).parent("label").toggleClass("active",$(this).prop("checked"))}),v.setColourPicker("#toolbarEditWindow"),$("#toolbarEditWindow input[name='toolbar-edit-window-off-canvas-type']").on("change",function(){changeOffCanvasOptions()});var s="ToolbarDropdown"===b.selected.FieldName?"ToolbarDropdown":"ToolbarSubDropdown"===b.selected.FieldName?"ToolbarDropdown":"ButtonWidget"===b.selected.FieldName?"Widget":"ToolbarWidget";$("#toolbarEditWindow #editToolbarWidgetButton").on("click",function(){null!==b.selected.Icon.Name&&""!==b.selected.Icon.Name&&(b.selected.Icon.Visibility=!0),sysproInterop.getHtmlFromModel(s,b.selected.toJSON(),function(t){var n=$($.trim(t));d.replaceWith(n),0===a.canvas_id?sysproInterop.performBind(v.bindableFieldsData,!0,"",$("#navbar-toolbar")):sysproInterop.performBind(v.bindableFieldsData,!0,"",$("#offcanvas-"+a.canvas_id+" .navbar")),b.selectedOffCanvas&&(v.editOffCanvasSection(),v.insertOffCanvasSection(b.selectedOffCanvas,!0,o,function(){if(3==b.selectedOffCanvas.OffCanvas)n.find("a").removeClass("offcanvas-toggle"),n.find("a").on("click",function(){v.offCanvasWindows[$(this).data("target")].center().open()});else{$("#offcanvas-"+b.selectedOffCanvas.Id).removeClass("js-offcanvas-done");n.hasClass("offcanvas-toggle")?new Offcanvas(n):new Offcanvas(n.find("a.offcanvas-toggle"))}e.close()})),$.material.init(),v.initEditRemoveDataWidget(),v.initEditRemoveToolbarWidgets(),$("#navbar-toolbar [data-tooltip=\"tooltip\"]").tooltip("destroy"),$("#navbar-toolbar [data-tooltip=\"tooltip\"]").tooltip(),v.finishAddLayoutWidget(),b.selectedOffCanvas||e.close()},"",7,"","",function(t){console.log(t),e.close()},!1)}),$("#toolbarEditWindow .closeWindow").on("click",function(){for(var t in n)b.selected.set(t,n[t]);for(var a in o)"IsToolbarVisible"==a?b.selectedOffCanvas.MainToolbar.set("IsToolbarVisible",o.IsToolbarVisible):b.selectedOffCanvas.set(a,o[a]);e.close()})},//toolbar Edit Window close function
toolbarEditWindowClose:function toolbarEditWindowClose(){v.openWindow=null,b.selectedOffCanvas&&(b.selectedOffCanvas.Columns.data(b.selectedOffCanvas.Columns.data().toJSON()),b.selectedOffCanvas.MainToolbar.Columns.data(b.selectedOffCanvas.MainToolbar.Columns.data().toJSON()),b.set("selectedOffCanvas",null)),v.destroyTreeView("invisibleToolbarNode"),v.createInvisibleTreeView("invisibleToolbarNode",b.toolbar),$("#toolbarEditWindow .hide-on-close").hide(),$("#toolbarEditWindow .data-section-pane-2, #toolbarEditWindow .data-section-pane-3").hide(),$("#toolbarEditWindow .data-section-pane-1").velocity("fadeIn",{duration:1}),$("body").removeClass("window-open"),$("#toolbarEditWindow .icon-option").show(),$("#edit-toolbar-widgets-list.fieldsPanelBar .list-group-item.field-name").off(),$("#toolbarEditWindow input[name='toolbar-edit-window-off-canvas-type']").off(),$("#toolbarEditWindow #editToolbarWidgetButton").off(),$("#toolbarEditWindow .closeWindow").off(),$("#toolbarEditWindow .icon-field-container > .radio-btn-group").empty(),delete v.toolbarActionsEditList,$("#toolbar-widget-edit-list-wrapper").empty().html("<ul id=\"edit-toolbar-widgets-list\" class=\"fieldsPanelBar list-group\"></ul>"),b.set("selected",null)},// Helper function to control display of data widget option sections
hideShowDataWidgetOptions:function hideShowDataWidgetOptions(e,t,a,o,n,d,s,l,r,c,p,u,m,g,h){a?$("#non-tiles-addition").show():$("#non-tiles-addition").hide(),o?$("#initial-fields-list-data-window").show():$("#initial-fields-list-data-window").hide(),n?$("#links-fields-list-data-window").show():$("#links-fields-list-data-window").hide(),$(".entryFieldOptions").toggle(d),$("#entry-fields-list-data-window").toggle(d),$(".typeahead-fields").toggle(s),$(".typeahead-entry-fields").toggle(l),$(".typeahead-link-fields").toggle(r),$(".fieldBackgroundColorOption").toggle(c),$(".field-caption-option").toggle(p),$(".text-alignment-options").toggle(u),$(".text-colour-weight-options").toggle(h),$(".linklist-text-option").toggle(m),$(".DisplayFieldsSection").toggle(!m),$(".EntryFieldsSection").toggle(!m),$(e+" .add-icon-option").toggle(g)},// Helper function to control data window UI
setupDataWindowUI:function setupDataWindowUI(e,t,a){var o=t.data("type-name");"LinkWidget"===o?($(e+" .field-caption-option").show(),$(e+" .link-field-options").show(),$(e+" .offcanvas-text-option").hide(),$(e+" .entryFieldOptions").hide(),$(e+" .linklist-text-option").show(),$(e+" [name='linklist_link_text']").val(t.data("description")),$(e+" .dataWidgetWindowOffCanvasPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$(e+" #addDataButtonPopoverWrap, "+e+" .dataWidgetWindowButton").velocity("fadeIn",{duration:300,complete:function complete(){$(e+" .dataWidgetWindowButton").removeClass("disabled"),$(e+" .dataWidgetWindowButton").prop("disabled",!1),$(e+" #addDataButtonPopoverWrap").popover("destroy")}})}}),3===a?$(e+" .text-colour-weight-options").hide():$(e+" .text-colour-weight-options").show(),$(e+" #fieldStylingOptions").show()):"EntryDataWidget"===o&&5===a?($(e+" .field-caption-option").show(),$(e+" .linklist-text-option").hide(),$(e+" .link-field-options").hide(),$(e+" .text-alignment-options").hide(),$(e+" .fieldBackgroundColorOption").hide(),$(e+" .offcanvas-text-option").hide(),$(e+" .entryFieldOptions").show(),$(e+" .text-colour-weight-options").hide(),$(e+" .dataWidgetWindowOffCanvasPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$(e+" #addDataButtonPopoverWrap, "+e+" .dataWidgetWindowButton").velocity("fadeIn",{duration:300,complete:function complete(){$(e+" .dataWidgetWindowButton").removeClass("disabled"),$(e+" .dataWidgetWindowButton").prop("disabled",!1),$(e+" #addDataButtonPopoverWrap").popover("destroy")}})}}),$(e+" #fieldStylingOptions").show()):t.hasClass("freeTextDataField")?($(e+" .field-caption-option").hide(),$(e+" .link-field-options").hide(),$(e+" .offcanvas-text-option").hide(),$(e+" .fieldsPanelBar li.active").removeClass("active"),$(e+" .text-alignment-options").hide(),$(e+" .fieldBackgroundColorOption").hide(),$(e+" .linklist-text-option").show(),$(e+" .text-colour-weight-options").hide(),$(e+" .entryFieldOptions").hide(),$(e+" #fieldStylingOptions").show(),$(e+" .dataWidgetWindowOffCanvasPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$(e+" #addDataButtonPopoverWrap, "+e+" .dataWidgetWindowButton").velocity("fadeIn",{duration:300,complete:function complete(){$(e+" .dataWidgetWindowButton").removeClass("disabled"),$(e+" .dataWidgetWindowButton").prop("disabled",!1),$(e+" #addDataButtonPopoverWrap").popover("destroy")}})}}),$(e+" #fieldStylingOptions").show()):"ButtonWidget"===o?($(e+" .field-caption-option").hide(),$(e+" .link-field-options").hide(),$(e+" .entryFieldOptions").hide(),$(e+" .text-alignment-options").show(),$(e+" .fieldBackgroundColorOption").show(),$(e+" .linklist-text-option").show(),$(e+" .text-colour-weight-options").show(),$(e+" [name='linklist_link_text']").val(t.data("description")),$(e+" .offcanvas-text-option").show(),$(e+" .add-icon-option").show(),$(e+" #addDataButtonPopoverWrap, "+e+" .dataWidgetWindowButton").velocity("fadeOut",{duration:300,complete:function complete(){$(e+" .dataWidgetWindowOffCanvasPopoverWrap").velocity("fadeIn",{duration:300,complete:function complete(){$(e+" .dataWidgetWindowOffCanvasPopoverWrap").click(function(){$(e+" .dataWidgetWindowOffCanvasPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$(e+" #addDataButtonPopoverWrap, "+e+" .dataWidgetWindowButton").velocity("fadeIn",{duration:300,complete:function complete(){$(e+" .dataWidgetWindowButton").removeClass("disabled"),$(e+" .dataWidgetWindowButton").prop("disabled",!1),$(e+" #addDataButtonPopoverWrap").popover("destroy")}})}})})}})}}),$(e+" #fieldStylingOptions").show()):($(e+" .field-caption-option").show(),$(e+" .link-field-options").hide(),$(e+" .offcanvas-text-option").hide(),$(e+" .linklist-text-option").hide(),$(e+" .entryFieldOptions").hide(),$(e+" .text-colour-weight-options").show(),$(e+" .dataWidgetWindowOffCanvasPopoverWrap").velocity("fadeOut",{duration:300,complete:function complete(){$(e+" #addDataButtonPopoverWrap, "+e+" .dataWidgetWindowButton").velocity("fadeIn",{duration:300,complete:function complete(){$(e+" .dataWidgetWindowButton").removeClass("disabled"),$(e+" .dataWidgetWindowButton").prop("disabled",!1),$(e+" #addDataButtonPopoverWrap").popover("destroy")}})}}),5===a?$(e+" #fieldStylingOptions").hide():$(e+" #fieldStylingOptions").show()),$(e+" .fieldsPanelBar .list-group-item.field-name.active").removeClass("active"),t.addClass("active")},// Initialise Edit and remove functions on data widgets
initEditRemoveDataWidget:function initEditRemoveDataWidget(){$(".panel.sys-widget:not(.sys-carousel) .panel.sys-widget .data-widget-options .col-xs-6:last-child i, .panel.sys-widget:not(.sys-carousel) .table td:last-child .data-widget-options i, .panel.sys-widget:not(.sys-carousel) .list-group .data-widget-options .col-xs-6:last-child i, .tile-widget .tile .data-widget-options .col-xs-6:last-child i, .form-group .data-widget-options .col-xs-6:last-child i").popover("destroy"),$(".panel.sys-widget:not(.sys-carousel) .panel.sys-widget .data-widget-options .col-xs-6:last-child i, .panel.sys-widget:not(.sys-carousel) .table td:last-child .data-widget-options i, .panel.sys-widget:not(.sys-carousel) .list-group .data-widget-options .col-xs-6:last-child i, .tile-widget .tile .data-widget-options .col-xs-6:last-child i, .form-group .data-widget-options .col-xs-6:last-child i").popover({html:!0,placement:"left",trigger:"manual",animation:!1,template:"<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><div class=\"popover-content\"></div></div>",content:"<ul class=\"nav nav-pills\"><li><a class=\"edit-section\"><i class=\"material-icons text-primary\">edit</i></a></li><li><a class=\"remove-section\"><i class=\"material-icons text-danger\">delete</i></a></li></ul>"}).off().on("click",function(){var e=this;$(this).popover("show"),$(this).siblings(".popover").on("mouseleave",function(){$(e).popover("hide")})}).on("mouseleave",function(){var e=this,t=function(){setTimeout(function(){$(".popover:hover").length?t():$(e).popover("hide")},50)};t()}),$(".panel.sys-widget.sys-carousel .panel.sys-widget .data-widget-options .col-xs-6:last-child i").popover("destroy"),$(".panel.sys-widget.sys-carousel .panel.sys-widget .data-widget-options .col-xs-6:last-child i").popover({html:!0,placement:"left",trigger:"manual",animation:!1,template:"<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><div class=\"popover-content\"></div></div>",content:"<ul class=\"nav nav-pills\"><li><a class=\"edit-section\"><i class=\"material-icons text-primary\">edit</i></a></li><li><a class=\"remove-section\"><i class=\"material-icons text-danger\">delete</i></a></li></ul>"}).off().on("click",function(){var e=this;$(this).parents(".carousel-inner, .sys-carousel .panel-body").css("overflow","visible"),$(this).popover("show"),$(this).siblings(".popover").on("mouseleave",function(){$(e).popover("hide"),$(this).parents(".carousel-inner, .sys-carousel .panel-body").css("overflow","hidden")})}).on("mouseleave",function(){var e=this,t=function(){setTimeout(function(){$(".popover:hover").length?t():($(e).popover("hide"),$(this).parents(".carousel-inner, .sys-carousel .panel-body").css("overflow","hidden"))},50)};t()})},// Initialise Edit and remove functions on toolbar widgets
initEditRemoveToolbarWidgets:function initEditRemoveToolbarWidgets(){$(".toolbar-widget-options .col-xs-6:last-child i").popover("destroy"),$(".toolbar-widget-options .col-xs-6:last-child i").popover({html:!0,placement:"left",trigger:"manual",animation:!1,template:"<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><div class=\"popover-content\"></div></div>",content:"<ul class=\"nav nav-pills\"><li><a class=\"edit-toolbar-widget\"><i class=\"material-icons text-primary\">edit</i></a></li><li><a class=\"remove-toolbar-widget\"><i class=\"material-icons text-danger\">delete</i></a></li></ul>"}).off().on("click",function(t){t.stopPropagation();var e=this;$(this).popover("show"),$(this).siblings(".popover").on("mouseleave",function(){$(e).popover("hide")})}).on("mouseleave",function(){var e=this,t=function(){setTimeout(function(){$(".popover:hover").length?t():$(e).popover("hide")},50)};t()})},// Runs when a layout widget ends being dragged, but complete process is not finished yet
endDragWidget:function endDragWidget(e,t){//Rob: Now always do a get instead of getByUid so we can use our own Id.
var a=t.currentDataSource.get($(e.item).data("guid"));if("remove"===e.action){if(e.item.hasClass("quickAddWidget"))v.endQuickDragWidget();else{var o=t.currentDataSource.data().toJSON(),n=e.item.closest(".main-column").data("column");v.draggedLayoutWidgetCopy=o[n].Widgets[e.oldIndex],t.currentDataSource.remove(a)}}else if("receive"===e.action){if(e.item.hasClass("quickAddWidget")){var d=e.item.attr("id"),s=e.item.data("layout-widget-type"),l=e.item.data("layout-widget-subtype"),r=e.item.data("layout-widget-displaystyle"),c=e.item.data("card-type-detail"),p=e.item.data("parent-field-path");$("body").removeClass("window-open");var g=v.setupFinalLayoutWidget("",{WidgetName:d,Title:"",TypeName:s,SubType:l,Collapsible:!1,DisplayStyle:r,Border:0,TitleBackground:9,TitleForeground:8,Joined:"Joined",Striped:"",FieldName:"",FieldPath:"",CardTypeDetail:c,ParentFieldPath:p,CardBackground:0,CardColor:9,ChartColor:0,BackgroundColor:9,Icon:"",ChartTitle:"",ChartLegend:null,LineColor:null,HarmonyComponentId:null,GridDataFieldName:null,GridListCaption:null,IsCollapsibleOpen:!0});t.currentDataSource.at(t.column_num).children.insert(e.newIndex,g),sysproInterop.getHtmlFromModel("Widget",v.stringifyJSONObject(g.Id,t.canvas_id,t.currentDataSource),function(a){var o=$($.trim(a));4===r&&(o.find(".data-section").removeClass("data-section"),o.children(".col-sm-12").addClass("tile-widget-wrapper"),o.find(".panel-body").first().prepend("<div class=\"tile-loading-cover\"><span class=\"spinner\"></span></div>")),t.canvas_id?0===e.newIndex?$("#offcanvas-"+t.canvas_id+" .main-column[data-column='"+t.column_num+"'] .sortable-list").prepend(o):o.insertAfter("#offcanvas-"+t.canvas_id+" .main-column[data-column='"+t.column_num+"'] .sortable-list .draggable-row-section:nth-child("+e.newIndex+")"):0===e.newIndex?$("#main_column_"+t.column_num+" .sortable-list").prepend(o):o.insertAfter("#main_column_"+t.column_num+" .sortable-list .draggable-row-section:nth-child("+e.newIndex+")"),v.finishAddLayoutWidget(),v.initEditRemoveDataWidget()},"","","","",function(e){console.log(e)},!1),e.preventDefault()}}else if("sort"===e.action&&!e.item.hasClass("quickAddWidget")){var h=t.currentDataSource.data().toJSON();a=t.currentDataSource.get($(e.item).data("guid"));var u=e.item.parents(".main-column").data("column"),m=h[u].Widgets[e.oldIndex];t.currentDataSource.remove(a),t.currentDataSource.at(null===t.tab_column_num?t.column_num:t.tab_column_num).children.insert(e.newIndex,m)}},// Runs when a widget starts being dragged
endQuickDragWidget:function endQuickDragWidget(){$(".quick-sortable-list div").each(function(){$(this).addClass("draggable")})},// Runs when a layout widget is finished being dragged
finishDragWidget:function finishDragWidget(e,t){"receive"===e.action&&(t.currentDataSource.at(null===t.tab_column_num?t.column_num:t.tab_column_num).hasChildren?t.currentDataSource.at(null===t.tab_column_num?t.column_num:t.tab_column_num).children.insert(e.newIndex,v.draggedLayoutWidgetCopy):t.currentDataSource.at(null===t.tab_column_num?t.column_num:t.tab_column_num).append(v.draggedLayoutWidgetCopy))},// Runs when a data widget is finished being dragged
finishDragDataWidget:function finishDragDataWidget(e){var t=v.setContext(e.draggableEvent.currentTarget);if("receive"===e.action)if(1===t.targetLayoutWidget.DisplayStyle||3===t.targetLayoutWidget.DisplayStyle){var a=t.targetLayoutWidget.children.at(0).children.at(0).hasChildren;a?t.currentDataSource.at(null===t.tab_column_num?t.column_num:t.tab_column_num).children.at(t.widget_index).children.at(0).children.at(0).children.insert(e.newIndex,v.draggedDataWidgetTempCopy):t.currentDataSource.at(null===t.tab_column_num?t.column_num:t.tab_column_num).children.at(t.widget_index).children.at(0).children.at(0).append(v.draggedDataWidgetTempCopy)}else 5===t.targetLayoutWidget.DisplayStyle?t.currentDataSource.at(null===t.tab_column_num?t.column_num:t.tab_column_num).children.at(t.widget_index).children.at(0).children.at(t.section_num).hasChildren?t.currentDataSource.at(null===t.tab_column_num?t.column_num:t.tab_column_num).children.at(t.widget_index).children.at(0).children.at(t.section_num).children.insert(e.newIndex,v.draggedDataWidgetTempCopy):t.currentDataSource.at(null===t.tab_column_num?t.column_num:t.tab_column_num).children.at(t.widget_index).children.at(0).children.at(t.section_num).append(v.draggedDataWidgetTempCopy):t.currentDataSource.at(null===t.tab_column_num?t.column_num:t.tab_column_num).children.at(t.widget_index).children.at(t.row_num).children.at(t.section_num).append(v.draggedDataWidgetTempCopy);sysproInterop.performBind(v.bindableFieldsData,!0,"",$(e.item).parents(".draggable-row-section"))},// Runs when a toolbar widget is finished being dragged
finishDragToolbarWidget:function finishDragToolbarWidget(e,t){"receive"===e.action&&t.currentToolbarDataSource.at(t.column_num).Widgets.splice(e.newIndex,0,v.draggedToolbarWidgetTempCopy)},// Helper function for drag and drop interactivity
placeholder:function placeholder(e){return e.clone().addClass("placeholderGhost")},// Helper function for drag and drop interactivity
quickplaceholder:function quickplaceholder(e){var t=e.data("layout-widget-type"),a=e.attr("id"),o=e.clone();o.find("i").remove();var n=o.text();if("Card"===t||"HarmonyWidget"===t){var d=$(v.placeholderCardHTML);return d.find(".card-name").text(n),d.addClass("placeholderGhost")}return v.layoutWidgetHTML[a]?$(v.layoutWidgetHTML[a]).addClass("placeholderGhost"):$("<div class=\"draggable-row-section sortable-item removeable placeholderGhost\" data-guid=\"\"><div class=\"panel sys-widget card-widget sys-bd-off\"> <div class=\"panel-body text-center sys-bg-white\"> <h4 class=\"sys-mg-off sys-pd-t-10\">"+n+"</h4> <small>"+t+"</small> </div> </div></div>")},// Helper function for drag and drop interactivity
hint:function hint(e){return e.clone().addClass("hint").height(0<e.height()?e.height():40).width(0<e.width()?e.width()+25:300)},// Helper function for drag and drop interactivity
quickhint:function quickhint(e){var t=e.data("layout-widget-type"),a=e.attr("id"),o=e.clone();o.find("i").remove();var n=o.text();if("Card"===t||"HarmonyWidget"===t){var d=$(v.placeholderCardHTML);return d.find(".card-name").text(n),d.addClass("hint").width($(".main-column").width())}return v.layoutWidgetHTML[a]?$(v.layoutWidgetHTML[a]).addClass("hint").width($(".main-column").width()):$("<div class=\"draggable-row-section sortable-item removeable hint\"><div class=\"panel sys-widget card-widget sys-bd-off\"> <div class=\"panel-body text-center sys-bg-white\"> <h4 class=\"sys-mg-off sys-pd-t-10\">"+n+"</h4> <small>"+t+"</small> </div> </div></div>").width($(".main-column").width())},// Helper functionn to get number of items in a JSON object
objLength:function objLength(e){var t=0;for(key in e)t++;return t},// Return preview Layout Widget HTML
previewLayoutWidgetHTML:function previewLayoutWidgetHTML(e){var t=v.setupLayoutWidget(e),a;a=9===t.DisplayStyle?_objectSpread({},t,{Tabs:t.Tabs.data().toJSON()}):t.toJSON(),sysproInterop.getHtmlFromModel("Widget",a,function(t){var a=$($.trim(t));a.find(".remove-row-section, .edit-row-section, .drag-row-section, .layout-widget-options").remove(),$(".layout-widget-preview-wrapper").show(),$(".layout-widget-preview-title").show(),$(e+" .layout-widget-preview").html(a),sysproInterop.performBind(v.bindableFieldsData,!0,e+" .layout-widget-preview"),v.sizeTiles()},"","","","",function(e){console.log(e)},!0)},// Setup tab number slider
setupTabNumSlider:function setupTabNumSlider(e){function updateSlider(t,o){var n=t[o];a.val(parseInt(n)).change(),$("".concat(e," .tab-title-input-wrapper")).each(function(e,t){$(t).toggle(n>e)})}var t=document.querySelector("".concat(e," .tab_widget_slider")),a=$(e+" [name='tab_widget_number']");"#rowEditWindow"===e&&t.noUiSlider&&a.val()&&(t.noUiSlider.set(a.val()),updateSlider([a.val()],0)),t.noUiSlider&&(t.noUiSlider.off("slide"),t.noUiSlider.on("slide",updateSlider))},setupRowWindow:function setupRowWindow(t,a){function setupButtons(){$("#addLayoutWidgetButton").removeClass("disabled"),$("#addLayoutWidgetButton").prop("disabled",!1),$("#addLayoutButtonPopoverWrap").popover("destroy")}function previewHTML(){v.previewLayoutWidgetHTML(t)}// Display only relevant border settings
function onMultiOptionsChange(){"#rowEditWindow"===t&&v.changeLayoutOptions(t,b.selected.WidgetName,b.selected.TypeName),!0===$("".concat(t," #widget_collapsible")).prop("checked")&&""===$("".concat(t," input[name='").concat(n,"layout_widget_title']")).val()&&$("".concat(t," input[name='").concat(n,"layout_widget_title']")).val("Default title"),previewHTML(),"#rowWindow"===t&&setupButtons()}var o=this,n="#rowEditWindow"===t?"edit_":"";if($("".concat(t," #").concat(n,"collapsible_title_styles")).collapse({toggle:!1}),v.setupTabNumSlider(t),v.showCorrectBorderOptions($("".concat(t," input[name='blocks_joined']:checked")).val(),t),"#rowWindow"===t){// Display correct styling options for the different layout widgets
var d=function(){var e=document.querySelector("".concat(t," input[name=\"row_options\"]:checked")),a=e.getAttribute("data-layout-widget-type"),o=$("".concat(t," input[name='row_options']:checked")).val();v.changeLayoutOptions(t,o,a),$("#addLayoutWidgetButton").removeClass("disabled"),$("#addLayoutWidgetButton").prop("disabled",!1),$("#addLayoutButtonPopoverWrap").popover("destroy")},s=function(){$("".concat(t," #tiles_section")).prop("checked",!0),v.changeLayoutOptions(t,"tiles_section","LayoutWidget")},l=function(a){$($(a.target).attr("href")).find(".row_options").prop("checked",!1),$($(a.target).attr("href")).find("label.btn-radio.active").removeClass("active"),$("".concat(t," .chart-selection-title")).hide(),$("".concat(t," .layout-section-styling-title")).hide(),$("".concat(t," .widget_title_options")).hide(),$("".concat(t," .widget_joined_options")).hide(),$("".concat(t," .widget_border_options")).hide(),$("".concat(t," .widget_listview_options")).hide(),$("".concat(t," .tile_section_options")).hide(),$("".concat(t," .widget_size_options")).hide(),$("".concat(t," .widget_card_options")).hide(),$("".concat(t," .widget_chart_options")).hide(),$("".concat(t," input[name=\"row_options\"]:checked")).prop("checked",!1),$("".concat(t," input[name=\"row_options\"]:checked")).parent().removeClass("active"),$("".concat(t," #collapsible_title_styles")).collapse("hide"),$("".concat(t," #widget_collapsible")).prop("checked",!1),$("".concat(t," #widget_collapsible")).parent().removeClass("active"),$("".concat(t," #default_open")).prop("checked",!1),$("".concat(t," #default_open")).parent().removeClass("active"),$("".concat(t," .layout-widget-preview")).empty(),v.showCorrectBorderOptions($("".concat(t," input[name='blocks_joined']:checked")).val(),t)};$("".concat(t," input")).each(function(){$(o).parent("label").toggleClass("active",$(o).prop("checked"))}),$("".concat(t," .tab-widget-option")).toggle(a),$("".concat(t," input[name='row_options']")).on("change",d),$("a#tile_layout_section").on("shown.bs.tab",s),$("".concat(t," a.widget-option-tab")).on("show.bs.tab",l)}else null===document.querySelector("".concat(t," input[name=\"widget_collapsible\"]:checked"))?$("".concat(t," #edit_collapsible_title_styles")).collapse("hide"):$("".concat(t," #edit_collapsible_title_styles")).collapse("show"),v.changeLayoutOptions(t,b.selected.WidgetName,b.selected.TypeName);$("".concat(t," input[name='blocks_joined']")).on("change",function(a){v.showCorrectBorderOptions($(a.currentTarget).val(),t),previewHTML(),"#rowWindow"===t&&setupButtons()}),$(t).on("change","input[name='border_options'], input[name='widget_collapsible'], input[name='widget_title_text_colour'], input[name='widget_title_background_colour'], input[name='layout_widget_title'], input[name='edit_layout_widget_title'], input[name='listview_striped_rows'], input[name='card_colour'], input[name='chart_colour'], input[name='linklist_compact'], input.tile-row-column-layout, input[name='tile_border_colour'], input[name='separator_colour'], input[name='chart_legend'], input[name='chart_title'], input[name='chart_stacked'], input.tab-title-input, input[name='tab_widget_number']",onMultiOptionsChange),$("".concat(t," input[name='").concat(n,"layout_widget_title']")).on("input",previewHTML),$("".concat(t," .icon-field-container")).on("click",".icon-option",previewHTML),$("".concat(t," .window-content")).on("click",".clear-icon-selection",previewHTML),$("".concat(t," #chart-fields-list")).on("click",".list-group-item",function(){previewHTML(),$("#chart-fields-list.fieldsPanelBar a.field-name.active").removeClass("active"),$(this).addClass("active")}),$("".concat(t," #chart-fields-list-edit-window")).on("click",".list-group-item",previewHTML)},// Helper function to chenge visible styling options in the layout widget windows
changeLayoutOptions:function changeLayoutOptions(e,t,a){function hideShowWindowElements(e,t,a,o,n,d,s,l,r,c,p,u,m){$(e+" .tile_section_options").toggle(t),$(e+" .widget_title_options").toggle(a),$(e+" .widget_joined_options").toggle(o),$(e+" .widget_border_options").toggle(n),$(e+" .widget_listview_options").toggle(d),$(e+" .widget_linklist_options").toggle(s),$(e+" #no_borders").toggle(l),$(e+" .widget_card_options").toggle(r),$(e+" .chart-selection-title").toggle(c),$(e+" .widget_chart_options").toggle(c),$(e+" .widget_size_options").toggle(u),$(e+" .widget_separator_options").toggle(p),$(e+" .widget_tab_options").toggle(m),p&&($(e+" #collapsible_title_styles").collapse("hide"),$(e+" #widget_collapsible").prop("checked",!1),$(e+" #widget_collapsible").parent(".btn-checkbox").removeClass("active"))}"#rowWindow"===e&&$(e+" .layout-section-styling-title").show(),"Sparkline"===a&&($(e+" .line-bar-options").toggle("line_chart_widget"===t||"column_chart_widget"===t),$(e+" .widget_chart_options .fieldsPanelBar").show()),v.previewLayoutWidgetHTML(e),"row_1_col"===t?("#rowWindow"===e&&$(e+" .layout-section-styling-title .step-number").text("3"),hideShowWindowElements(e,!1,!0,!1,!0,!1,!1,!0,!1,!1,!1,!1,!1)):"row_2_col"===t||"row_3_col"===t||"row_4_col"===t||"row_4_block"===t||"row_6_block"===t?("#rowWindow"===e&&$(e+" .layout-section-styling-title .step-number").text("3"),hideShowWindowElements(e,!1,!0,!0,!0,!1,!1,!0,!1,!1,!1,!1,!1)):"row_list_view"===t?("#rowWindow"===e?$(e+" .layout-section-styling-title .step-number").text("3"):!0===b.selected.SubType&&b.set("selected.SubType","Striped"),hideShowWindowElements(e,!1,!0,!1,!0,!0,!0,!1,!1,!1,!1,!1,!1),$(e+" .all_borders").show(),$(e+" .inner_borders").show(),$(e+" .outer_borders").show()):"row_link_list"===t?("#rowWindow"===e?$(e+" .layout-section-styling-title .step-number").text("3"):!0===b.selected.SubType&&b.set("selected.SubType","Compact"),v.showCorrectBorderOptions("Separate",e),hideShowWindowElements(e,!1,!0,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1)):"Card"===a?("#rowWindow"===e&&$(e+" .layout-section-styling-title .step-number").text("3"),hideShowWindowElements(e,!1,!1,!1,!1,!1,!1,!0,!0,!1,!1,!1,!1)):"GridList"===a||"TreeList"===a||"TreeView"===a||"RichTextWidget"===a?("#rowWindow"===e&&$(e+" .layout-section-styling-title .step-number").text("3"),hideShowWindowElements(e,!1,!0,!1,!0,!1,!1,!0,!1,!1,!1,!0,!1)):"HarmonyWidget"===a?hideShowWindowElements(e,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1):"Sparkline"===a?("#rowWindow"===e&&($(e+" .layout-section-styling-title .step-number").text("4"),$("#chart-fields-list a.field-name:first-child").addClass("active")),hideShowWindowElements(e,!1,!0,!1,!1,!1,!1,!0,!1,!0,!1,!0,!1)):"row_carousel"===t?("#rowWindow"===e&&$(e+" .layout-section-styling-title .step-number").text("3"),hideShowWindowElements(e,!1,!0,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1)):"row_tab_widget"===t?("#rowWindow"===e&&$(e+" .layout-section-styling-title .step-number").text("3"),$(e+" .all_borders").hide(),$(e+" .inner_borders").hide(),hideShowWindowElements(e,!1,!0,!1,!0,!1,!1,!0,!1,!1,!1,!1,!0),v.showCorrectBorderOptions("Separate",e)):"tiles_section"===t?("#rowWindow"===e&&($(e+" .layout-section-styling-title .step-number").text("2"),$("#addLayoutWidgetButton").removeClass("disabled"),$("#addLayoutWidgetButton").prop("disabled",!1),$("#addLayoutButtonPopoverWrap").popover("destroy")),hideShowWindowElements(e,!0,!0,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1)):"row_separator"===t?("#rowWindow"===e&&($("#addLayoutWidgetButton").removeClass("disabled"),$("#addLayoutWidgetButton").prop("disabled",!1),$("#addLayoutButtonPopoverWrap").popover("destroy")),hideShowWindowElements(e,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1)):"1col_form_widget"===t||"2col_form_widget"===t||"3col_form_widget"===t?("#rowWindow"===e&&($("#addLayoutWidgetButton").removeClass("disabled"),$("#addLayoutWidgetButton").prop("disabled",!1),$("#addLayoutButtonPopoverWrap").popover("destroy")),$(e+" .all_borders").hide(),$(e+" .inner_borders").hide(),hideShowWindowElements(e,!1,!0,!1,!0,!1,!1,!0,!1,!1,!1,!1,!1),v.showCorrectBorderOptions("Separate",e)):"custom_text"===t&&("#rowWindow"===e&&($("#addLayoutWidgetButton").removeClass("disabled"),$("#addLayoutWidgetButton").prop("disabled",!1),$("#addLayoutButtonPopoverWrap").popover("destroy")),$(e+" .all_borders").hide(),$(e+" .inner_borders").hide(),hideShowWindowElements(e,!1,!0,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1))},// Helper function to show correct border options
showCorrectBorderOptions:function showCorrectBorderOptions(e,t){$(t+" .all_borders").toggle("Joined"===e),$(t+" .inner_borders").toggle("Joined"===e),"Joined"!==e&&(3==$(t+" input[name='border_options']").val()||2==$(t+" input[name='border_options']").val()||1==$(t+" input[name='border_options']").val())&&($(t+" #border_options_2").prop("checked",!1),$(t+" #border_options_2").parent().removeClass("active"),$(t+" #border_options_3").prop("checked",!1),$(t+" #border_options_3").parent().removeClass("active"),$(t+" #border_options_1").prop("checked",!1),$(t+" #border_options_1").parent().removeClass("active"),$(t+" #border_options_0").prop("checked",!0),$(t+" #border_options_0").parent().addClass("active"))},// Setup Layout Widget helper function
setupLayoutWidget:function setupLayoutWidget(e){var t=b.selected&&b.selected.WidgetName?b.selected.WidgetName:$(e+".k-window-content").find("input[name='row_options']:checked"),a=b.selected&&b.selected.WidgetName?b.selected.WidgetName:$(t).val(),o=b.selected&&b.selected.TypeName?b.selected.TypeName:$(t).data("layout-widget-type"),n=b.selected&&b.selected.SubType?b.selected.SubType:$(t).data("layout-widget-subtype"),d=b.selected&&b.selected.CardTypeDetail?b.selected.CardTypeDetail:$(t).data("card-type-detail"),s=b.selected&&b.selected.ComponentId?b.selected.ComponentId:$(t).data("component-id"),l=b.selected&&b.selected.GridDataFieldName?b.selected.GridDataFieldName:$(t).data("gridlist-field-name"),r=b.selected&&b.selected.Caption?b.selected.Caption:$(t).data("caption"),c=b.selected&&b.selected.ParentFieldPath?b.selected.ParentFieldPath:$(t).data("parent-field-path"),p=b.selected&&b.selected.DisplayStyle?b.selected.DisplayStyle:$(t).data("layout-widget-displaystyle"),u=b.selected&&b.selected.RichTextFieldName?b.selected.RichTextFieldName:$(t).data("richtext-field-name"),m=b.selected&&b.selected.Title?b.selected.Title:$(e+" .layout_widget_title").val(),g=$(e+" input[name=\"tab_widget_number\"]").val(),h=null===document.querySelector(e+" input[name=\"blocks_joined\"]:checked")?null:document.querySelector(e+" input[name=\"blocks_joined\"]:checked").value,f=null===document.querySelector(e+" input[name=\"border_options\"]:checked")?0:document.querySelector(e+" input[name=\"border_options\"]:checked").value,y=null===document.querySelector(e+" input[name=\"size_options\"]:checked")?0:document.querySelector(e+" input[name=\"size_options\"]:checked").value,w=null===document.querySelector(e+" input[name=\"widget_title_text_colour\"]:checked")?8:document.querySelector(e+" input[name=\"widget_title_text_colour\"]:checked").value,C=null===document.querySelector(e+" input[name=\"widget_title_background_colour\"]:checked")?9:document.querySelector(e+" input[name=\"widget_title_background_colour\"]:checked").value,k=null===document.querySelector(e+" input[name=\"tile_border_colour\"]:checked")?9:document.querySelector(e+" input[name=\"tile_border_colour\"]:checked").value,x=null===document.querySelector(e+" .icon-field-container .icon-option.active")?null:$(e+" .icon-field-container .icon-option.active").data("icon-name"),S=null===document.querySelector(e+" input[name=\"card_colour\"]:checked")?0:document.querySelector(e+" input[name=\"card_colour\"]:checked").value,T=0==S||2==S||3==S||4==S||8==S||7==S?9:8,W=null===document.querySelector(e+" input[name=\"chart_colour\"]:checked")?0:document.querySelector(e+" input[name=\"chart_colour\"]:checked").value,D,I;(3===p||1===p)&&(I=null===document.querySelector(e+" input[name=\"linklist_compact\"]:checked")?null:document.querySelector(e+" input[name=\"linklist_compact\"]:checked").value,D=null===document.querySelector(e+" input[name=\"listview_striped_rows\"]:checked")?null:document.querySelector(e+" input[name=\"listview_striped_rows\"]:checked").value);var O=null===document.querySelector(e+" #chart-fields-list .list-group-item.active")?null:$(e+" #chart-fields-list .list-group-item.active").data("field-path"),_=null===document.querySelector(e+" #chart-fields-list .list-group-item.active")?null:$(e+" #chart-fields-list .list-group-item.active").data("field-path"),P=[];$(e+" input.tab-title-input").each(function(e,t){P[e]=$(t).val()});var E=$(e+" [name=\"chart_title\"]").prop("checked"),F=$(e+" [name=\"chart_legend\"]").prop("checked"),A=$(e+" [name=\"chart_stacked\"]").prop("checked"),N=$(e+" [name=\"widget_collapsible\"]").prop("checked"),M=$(e+" [name=\"default_open\"]").prop("checked"),L=$(e+" input[name=\"separator_colour\"]:checked").val(),B=v.setupFinalLayoutWidget(e,{WidgetName:a,Title:m,TypeName:o,SubType:n,Collapsible:N,DisplayStyle:p,Border:f,TitleBackground:C,TitleForeground:w,Joined:h,Striped:D,FieldName:O,FieldPath:_,CardTypeDetail:d,ParentFieldPath:c,CardBackground:S,CardColor:T,ChartColor:W,BackgroundColor:k,Icon:x,ChartTitle:E,ChartLegend:F,LineColor:L,HarmonyComponentId:s,GridDataFieldName:l,GridListCaption:r,IsCollapsibleOpen:M,Size:y,Compact:I,RichTextFieldName:u,ChartStacked:A,TabNum:g,TabTitles:P});//Rob: Use the Id instead of the uid.
return B},// Helper function to create array of Tabs for Tab widgets
createTabsArray:function createTabsArray(e,t,a){var o;// TODO: need to check for duplicates on 'Tab' property
if(a&&e<a.length)o=a.slice(0,e);else if(a&&e===a.length)o=a;else{o=a||[];for(var n=o.length;n<parseInt(e);n++)o.push({Index:n,Title:t[n],Tab:t[n].replace(/[^A-Z0-9]/ig,""),ResponsiveStyle:0,Widgets:[],TypeName:"Column"})}for(var d=0;d<parseInt(e);d++)o[d].Title=t[d];return o},// FInal setup and creation of Kendo Object for Layout Widget
setupFinalLayoutWidget:function setupFinalLayoutWidget(e,t){var a=t.WidgetName,o=t.Title,n=t.TypeName,d=t.Collapsible,c=t.DisplayStyle,p=t.Border,u=t.TitleBackground,m=t.TitleForeground,h=t.Joined,f=t.Striped,y=t.FieldName,b=t.FieldPath,w=t.CardTypeDetail,C=t.ParentFieldPath,k=t.CardBackground,x=t.CardColor,S=t.ChartColor,T=t.BackgroundColor,W=t.Icon,D=t.ChartTitle,I=t.ChartLegend,O=t.LineColor,_=t.HarmonyComponentId,P=t.GridDataFieldName,E=t.GridListCaption,F=t.IsCollapsibleOpen,A=t.Size,N=t.Compact,M=t.RichTextFieldName,L=t.TabNum,B=t.TabTitles,R=t.SubType,V=t.ChartStacked,H=sysproInterop.generateUUID(),U;switch(n){case"LayoutWidget":{switch(a){case"row_1_col":{var z=new l({Index:0});z.append(new s({Index:0,ResponsiveStyle:0})),R=h,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(z);break}case"row_2_col":{var Y=new l({Index:0});Y.append(new s({Index:0,ResponsiveStyle:4})),Y.append(new s({Index:1,ResponsiveStyle:4})),R=h,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(Y);break}case"row_3_col":{var K=new l({Index:0});K.append(new s({Index:0,ResponsiveStyle:5})),K.append(new s({Index:1,ResponsiveStyle:5})),K.append(new s({Index:2,ResponsiveStyle:5})),R=h,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(K);break}case"row_4_col":{var J=new l({Index:0});J.append(new s({Index:0,ResponsiveStyle:6})),J.append(new s({Index:1,ResponsiveStyle:6})),J.append(new s({Index:2,ResponsiveStyle:6})),J.append(new s({Index:3,ResponsiveStyle:6})),R=h,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(J);break}case"row_4_block":{var Q=new l({Index:0});Q.append(new s({Index:0,ResponsiveStyle:4})),Q.append(new s({Index:1,ResponsiveStyle:4}));var X=new l({Index:1});X.append(new s({Index:0,ResponsiveStyle:4})),X.append(new s({Index:1,ResponsiveStyle:4})),R=h,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(Q),U.append(X);break}case"row_6_block":{var Z=new l({Index:0});Z.append(new s({Index:0,ResponsiveStyle:5})),Z.append(new s({Index:1,ResponsiveStyle:5})),Z.append(new s({Index:2,ResponsiveStyle:5}));var ee=new l({Index:1});ee.append(new s({Index:0,ResponsiveStyle:5})),ee.append(new s({Index:1,ResponsiveStyle:5})),ee.append(new s({Index:2,ResponsiveStyle:5})),R=h,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(Z),U.append(ee);break}case"row_list_view":{var te=new l({Index:0});te.append(new s({Index:0,ResponsiveStyle:0})),R=f&&N?"CompactStriped":f&&!N?"Striped":N&&!f?"Compact":null,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(te);break}case"row_tab_widget":{var q=v.createTabsArray(L,B,null),G=new kendo.data.HierarchicalDataSource({data:q,schema:{model:g},change:function change(){this.data()},error:function error(t){console.log("ERROR!",t)}});U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A,Tabs:G// Rows: [],
}),U.Tabs.read();break}case"row_link_list":{var ae=new l({Index:0});ae.append(new s({Index:0,ResponsiveStyle:0})),R=N?"Compact":null,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(ae);break}case"row_carousel":{var oe=new l({Index:0});oe.append(new s({Index:0,ResponsiveStyle:0})),U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(oe);break}case"tiles_section":{U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,BackgroundColor:T,Icon:W,Height:A});var ie=new l({Index:0});U.append(ie);break}case"1col_form_widget":{var ne=new l({Index:0});ne.append(new s({Index:0,ResponsiveStyle:0})),R=h,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(ne);break}case"standard_form_widget":{var de=new l({Index:0});de.append(new s({Index:0,ResponsiveStyle:0})),R=h,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:"1col_form_widget",Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(de);break}case"2col_form_widget":{var se=new l({Index:0});se.append(new s({Index:0,ResponsiveStyle:4})),se.append(new s({Index:1,ResponsiveStyle:4})),R=h,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(se);break}case"3col_form_widget":{var le=new l({Index:0});le.append(new s({Index:0,ResponsiveStyle:5})),le.append(new s({Index:1,ResponsiveStyle:5})),le.append(new s({Index:2,ResponsiveStyle:5})),R=h,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(le);break}case"custom_text":{var re=new l({Index:0});//Rob: Set the Id in the constructor.
R=h,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,Icon:W,Height:A}),U.append(re)}}break}case"Sparkline":{var ce=new l({Index:0});ce.append(new s({Index:0,ResponsiveStyle:0})),V=!("column_chart_widget"!==a&&"line_chart_widget"!==a)&&V,U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,FieldName:y,FieldPath:b,Details:{Color:S},Icon:W,ChartTitle:D,ChartLegend:I,Stacked:V,Height:A}),U.append(ce);break}case"Card":{U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,CardTypeDetail:w,ParentFieldPath:C,BackgroundColor:k,Details:{Color:x},Icon:W,Height:A}),U.append([]);break}case"HarmonyWidget":{U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,CardTypeDetail:w,ParentFieldPath:C,BackgroundColor:k,Details:{Color:x},Icon:W,ComponentId:_,Height:A}),U.append([]);break}case"GridList":{U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,CardTypeDetail:w,ParentFieldPath:C,BackgroundColor:k,Details:{Color:x},Icon:W,ComponentId:_,GridDataFieldName:P,Caption:E,Height:A}),U.append([]);break}case"TreeList":{U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,CardTypeDetail:w,ParentFieldPath:C,BackgroundColor:k,Details:{Color:x},Icon:W,ComponentId:_,GridDataFieldName:P,Caption:E,Height:A}),U.append([]);break}case"TreeView":{U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,CardTypeDetail:w,ParentFieldPath:C,BackgroundColor:k,Details:{Color:x},Icon:W,ComponentId:_,GridDataFieldName:P,Caption:E,Height:A}),U.append([]);break}case"RichTextWidget":{U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:"Builder_card",Collapsible:d,IsCollapsibleOpen:F,DisplayStyle:c,Border:p,TitleBackground:u,TitleForeground:m,CardTypeDetail:w,ParentFieldPath:C,BackgroundColor:k,Details:{Color:x},Icon:W,ComponentId:_,RichTextFieldName:M,Caption:E,Height:A}),U.append([]);break}case"StaticElement":{//Rob: Set the Id in the constructor.
U=new r({Id:H,Title:o,TypeName:n,SubType:R,WidgetName:a,DisplayStyle:c,Details:{Color:O},Color:O,Height:A}),U.append([])}}return U},// Insert Layout Widget
insertLayoutWidget:function insertLayoutWidget(e,t,a){var o=t.toJSON();if(o.Id=t.Id,a.parentTabWidget){a.parentTabWidget.Tabs.at(a.tab_column_num).append(t);var n=a.currentParentDataSource.data().toJSON();a.currentParentDataSource.data(n)}else{var d=a.currentDataSource.data().toJSON();d[a.column_num].Widgets.unshift(o),a.currentDataSource.data(d)}sysproInterop.getHtmlFromModel("Widget",v.stringifyJSONObject(t.Id,a.canvas_id,a.currentDataSource),function(o){var n=$($.trim(o));if(4===t.DisplayStyle&&(n.find(".data-section").removeClass("data-section"),n.children(".col-sm-12").addClass("tile-widget-wrapper"),n.find(".panel-body").first().prepend("<div class=\"tile-loading-cover\"><span class=\"spinner\"></span></div>")),9===t.DisplayStyle&&(n.addClass("tab-layout-widget"),n.find(".sortable-list").each(function(e,t){$(t).removeClass("sortable-list").addClass("tab-sortable-list")}),n.find(".main-column").each(function(e,t){$(t).addClass("tab-main-column")})),a.parentTabWidgetPresent){var d=$("[data-guid=\""+a.layoutWidgetGuid+"\"").find(".tab-pane").eq(a.tab_column_num).find(".main-column");d.children(".tab-sortable-list").append(n)}else{var s=0===a.canvas_id?$("#main-container div[data-column=\""+a.column_num+"\"]:not(.tab-main-column)"):$("#offcanvas-"+a.canvas_id+" div[data-column=\""+a.column_num+"\"]");s.children(".sortable-list").prepend(n)}$(e+" .layout-radio-options .btn-radio").each(function(){$(this).removeClass("active")}),$(e+" span[href='#empty-tab']").tab("show"),t.Tabs&&v.createInvisibleTreeView("TABS_"+t.Id,t.Tabs),kendo.bind(n,b),v.finishAddLayoutWidget(),v.initEditRemoveDataWidget()},"","","","",function(e){console.log(e)},!1)},// Helper function to
setUpDataWidget:function setUpDataWidget(e){var t=null===document.querySelector(e+" input[name=\"data_text_colour\"]:checked")?8:document.querySelector(e+" input[name=\"data_text_colour\"]:checked").value,a=null===document.querySelector(e+" input[name=\"data_text_size\"]:checked")?1:document.querySelector(e+" input[name=\"data_text_size\"]:checked").value,o=null===document.querySelector(e+" input[name=\"data_text_weight\"]:checked")?1:document.querySelector(e+" input[name=\"data_text_weight\"]:checked").value,n=null===document.querySelector(e+" input[name=\"data_text_alignment\"]:checked")?0:document.querySelector(e+" input[name=\"data_text_alignment\"]:checked").value,s=null===document.querySelector(e+" input[name=\"link_as_button\"]:checked")?null===document.querySelector(e+" input[name=\"data_background_colour\"]:checked")?9:document.querySelector(e+" input[name=\"data_background_colour\"]:checked").value:document.querySelector(e+" input[name=\"link_button_colour\"]:checked").value,l=null===document.querySelector(e+" .icon-field-container .icon-option.active")?null:$(e+" .icon-field-container .icon-option.active").data("icon-name"),r=null===document.querySelector(e+" input[name=\"icon_colour\"]:checked")?0:document.querySelector(e+" input[name=\"icon_colour\"]:checked").value,c=null===document.querySelector(e+" input[name=\"icon_alignment\"]:checked")?0:document.querySelector(e+" input[name=\"icon_alignment\"]:checked").value,p=null===document.querySelector(e+" input[name=\"icon_size\"]:checked")?1:document.querySelector(e+" input[name=\"icon_size\"]:checked").value,u=null!==document.querySelector(e+" input[name=\"isMandatory\"]:checked"),m=null===document.querySelector(e+" input[name=\"link_as_button\"]:checked")?"":"Button",g=$(e+" #icon_tooltip").val(),h=$(e+" #linklist_link_text").val(),f=$(e+" .fields-wrapper .list-group-item.active.field-name").clone();f.find("i").remove(),f.find(".quickAddEntryField").remove();var y=f.text(),b=f.data("field-path"),w=f.data("smart-tag"),C=f.data("data-type"),k=f.data("key-field"),x=f.data("entry-type"),S=f.data("type-name"),T=f.data("key-action"),W=$(e+" #data_show_caption").prop("checked"),D,I;if("ButtonWidget"===S){var O=document.querySelector("#dataWindow input[name=\"data-window-off-canvas-type\"]:checked").value,_=document.querySelector("#dataWindow input[name=\"data-window-offcanvas-column-layout\"]:checked").value;I=sysproInterop.generateUUID();var E=$("#dataWindow #off_canvas_title_data_window").val();m=document.querySelector("#dataWindow input[name=\"offcanvas-text-options\"]:checked").value;var F=!!document.querySelector("#dataWindow input[name=\"data-window-offcanvas_toolbar_option\"]:checked")||null;D=v.setupOffCanvasSection(I,E,O,F,_)}//Rob: Generate a Unique GUID for the Id and set it so we don't have to use the kendo uid because we don't have it yet.
var P=new d({Id:sysproInterop.generateUUID(),Title:h,FieldName:y,FieldPath:b,HasSmartTag:w,DataType:C,KeyField:k,KeyAction:T,TypeName:S,SubType:m,BackgroundColor:s,Caption:{Color:8,Size:0,Alignment:n,Visibility:W},Value:{Color:t,Size:a,Alignment:n,Weight:o},Icon:{Name:l,Color:r,Size:p,Alignment:c,Tooltip:g},EntryType:x,IsMandatory:u,OffCanvasLayoutId:I});//Rob: Use the ID instead of the uid.
return[P,D]},// Helper function to insert new Kendo Data Widget
insertDataWidget:function insertDataWidget(e,t,a,o,n,d){var r,c;//Rob: Now always do a get instead of getByUid so we can use our own Id.
if(0===t.targetLayoutWidget.DisplayStyle)t.targetLayoutWidget.children.at(t.row_num).children.at(t.section_num).append(e);else if(1===t.targetLayoutWidget.DisplayStyle||3===t.targetLayoutWidget.DisplayStyle)// Check if this data widget coming in to a listview is coming in from a quick add drag, in which case we need to inert it at the right index, rather than just adding it to the end of the 'list'
c=t.targetLayoutWidget.children.at(0).children.at(0).hasChildren,null!==o&&c?t.targetLayoutWidget.children.at(0).children.at(0).children.insert(o,e):t.targetLayoutWidget.children.at(0).children.at(0).append(e);else if(2===t.targetLayoutWidget.DisplayStyle){var p=t.targetLayoutWidget.Rows.length,u=t.targetLayoutWidget.toJSON();if(u.Rows[0].Columns[0].hasOwnProperty("Widgets")){var m=new l({Index:p});m.append(new s({Index:0,ResponsiveStyle:0})),t.targetLayoutWidget.append(m),t.targetLayoutWidget.children.at(p).children.at(0).append(e),r=p+1}else r=1,t.targetLayoutWidget.children.at(0).children.at(0).append(e)}else 5===t.targetLayoutWidget.DisplayStyle&&t.targetLayoutWidget.children.at(0).children.at(t.section_num).append(e);sysproInterop.getHtmlFromModel("Widget",v.stringifyJSONObject(e.Id,t.offCanvasID,t.currentDataSource),function(s){var l=$($.trim(s));0===t.targetLayoutWidget.DisplayStyle?(a.find(".add-data-widget")&&a.find(".add-data-widget").hide(),a.append(l)):1===t.targetLayoutWidget.DisplayStyle?null!==o&&c?l.insertAfter(a.find("tr:nth-child("+o+")")):a.append(l):2===t.targetLayoutWidget.DisplayStyle?(a.find(".add-data-widget")&&a.find(".add-data-widget").remove(),a.append(l),a.parents(".carousel-inner").append("<div class=\"item\"><div class=\"panel-body sys-bg-white text-left\"><div class=\"row \" data-row=\""+r+"\"><div class=\"col-xs-12\" data-section=\"0\"><div class=\"panel sys-widget sys-box-shadow-off sys-mg-off  add-data-widget\"><div class=\"panel-body text-center sys-fg-primary\"><a class=\"pull-left text-center add-data-section\" href=\"#\"><i class=\"material-icons\">note_add</i></a></div></div></div></div></div></div>"),v.initEditRemoveDataWidget()):3===t.targetLayoutWidget.DisplayStyle?null!==o&&c?l.insertAfter(a.find("a:nth-child("+o+")")):a.append(l):5===t.targetLayoutWidget.DisplayStyle&&(!l.find(".always-show").text().trim().length&&l.find(".always-show").removeClass("always-show"),!l.find(".help-block").text().trim().length&&l.find(".help-block").addClass("disabled-help-block"),a.append(l),v.initDatePicker("div[data-guid=\""+t.layoutWidgetGuid+"\"]")),kendo.bind($("#dataEditWindow"),b),sysproInterop.performBind(v.bindableFieldsData,!0,"",a.closest(".layout-widget")),"ButtonWidget"===e.TypeName&&v.insertOffCanvasSection(n,!1,null,function(){if(3==n.OffCanvas)l.find("a").removeClass("offcanvas-toggle"),l.find("a").on("click",function(){v.offCanvasWindows[$(this).data("target")].center().open()});else l.hasClass("offcanvas-toggle")?new Offcanvas(l):new Offcanvas(l.find("a.offcanvas-toggle"))}),v.initEditRemoveDataWidget(),v.initDataWidgetSorting(),d&&"function"==typeof d&&d()},t.targetLayoutWidget.SubType,t.targetLayoutWidget.DisplayStyle,t.targetLayoutWidget.Border,t.section_num,function(e){console.log(e)},!1)},// Setup an off-canvas section with a parent column layout
setupOffCanvasSection:function setupOffCanvasSection(e,t,a,o,n){var d;"1col"===n?d=[new g({Index:0,ResponsiveStyle:0,Widgets:[]})]:"2colequal"===n?d=[new g({Index:0,ResponsiveStyle:1,Widgets:[]}),new g({Index:1,ResponsiveStyle:1,Widgets:[]})]:"2colleft"===n?d=[new g({Index:0,ResponsiveStyle:2,Widgets:[]}),new g({Index:1,ResponsiveStyle:3,Widgets:[]})]:"2colright"===n?d=[new g({Index:0,ResponsiveStyle:3,Widgets:[]}),new g({Index:1,ResponsiveStyle:2,Widgets:[]})]:"3col"===n?d=[new g({Index:0,ResponsiveStyle:3,Widgets:[]}),new g({Index:1,ResponsiveStyle:3,Widgets:[]}),new g({Index:2,ResponsiveStyle:3,Widgets:[]})]:void 0;var s=o?[new h({Index:0,Alignment:0,ResponsiveStyle:0,Widgets:[]}),new h({Index:1,Alignment:1,ResponsiveStyle:0,Widgets:[]})]:[],l=kendo.observable({Id:e,Title:t,OffCanvas:a,columnLayout:n,Columns:new kendo.data.HierarchicalDataSource({data:d,schema:{model:g}}),//IsToolbarVisible: IsToolbarVisible,
MainToolbar:kendo.observable({IsToolbarVisible:!!o,Columns:new kendo.data.HierarchicalDataSource({data:s,schema:{model:h}})})});return l.Columns.read(),l.MainToolbar.Columns.read(),v.createInvisibleTreeView("OC_"+e,l.Columns),v.createInvisibleTreeView("OCT_"+e,l.MainToolbar.Columns),l},// Edit an off-canvas section
editOffCanvasSection:function editOffCanvasSection(){var e=b.selectedOffCanvas.Columns.data().length,t=b.selectedOffCanvas.MainToolbar.Columns.data().length;switch(b.selectedOffCanvas.columnLayout){case"1col":if(1<e){var a=b.selectedOffCanvas.Columns.data().toJSON();a.splice(1,2),b.selectedOffCanvas.Columns.data(a)}b.selectedOffCanvas.Columns.at(0).ResponsiveStyle=0;break;case"2colequal":if(3===e){var o=b.selectedOffCanvas.Columns.data().toJSON();o.splice(2,1),b.selectedOffCanvas.Columns.data(o)}else 1===e&&b.selectedOffCanvas.Columns.data().push(new g({Index:1,ResponsiveStyle:1,Widgets:[]}));b.selectedOffCanvas.Columns.at(0).ResponsiveStyle=1,b.selectedOffCanvas.Columns.at(1).ResponsiveStyle=1;break;case"2colleft":if(3===e){var n=b.selectedOffCanvas.Columns.data().toJSON();n.splice(2,1),b.selectedOffCanvas.Columns.data(n)}else 1===e&&b.selectedOffCanvas.Columns.data().push(new g({Index:1,ResponsiveStyle:1,Widgets:[]}));b.selectedOffCanvas.Columns.at(0).ResponsiveStyle=2,b.selectedOffCanvas.Columns.at(1).ResponsiveStyle=3;break;case"2colright":if(3===e){var d=b.selectedOffCanvas.Columns.data().toJSON();d.splice(2,1),b.selectedOffCanvas.Columns.data(d)}else 1===e&&b.selectedOffCanvas.Columns.data().push(new g({Index:1,ResponsiveStyle:1,Widgets:[]}));b.selectedOffCanvas.Columns.at(0).ResponsiveStyle=3,b.selectedOffCanvas.Columns.at(1).ResponsiveStyle=2;break;case"3col":2===e?b.selectedOffCanvas.Columns.data().push(new g({Index:2,ResponsiveStyle:3,Widgets:[]})):1===e&&(b.selectedOffCanvas.Columns.data().push(new g({Index:1,ResponsiveStyle:3,Widgets:[]})),b.selectedOffCanvas.Columns.data().push(new g({Index:2,ResponsiveStyle:3,Widgets:[]}))),b.selectedOffCanvas.Columns.at(0).ResponsiveStyle=3,b.selectedOffCanvas.Columns.at(1).ResponsiveStyle=3,b.selectedOffCanvas.Columns.at(2).ResponsiveStyle=3;}b.selectedOffCanvas.MainToolbar.IsToolbarVisible&&0===t?b.selectedOffCanvas.MainToolbar.Columns.data([new h({Index:0,Alignment:0,ResponsiveStyle:0,Widgets:[]}),new h({Index:1,Alignment:1,ResponsiveStyle:0,Widgets:[]})]):!b.selectedOffCanvas.MainToolbar.IsToolbarVisible&&0<t&&b.selectedOffCanvas.MainToolbar.Columns.data([])},//Insert off canvas section
insertOffCanvasSection:function insertOffCanvasSection(e,t,a,o){t||(b.OffCanvasLayouts["offcanvas-"+e.Id]=e);var n={Id:e.Id,Title:e.Title,OffCanvas:e.OffCanvas,columnLayout:e.columnLayout,Columns:e.Columns.data().toJSON(),MainToolbar:{IsToolbarVisible:e.MainToolbar.IsToolbarVisible,Columns:e.MainToolbar.Columns.data().toJSON()}};sysproInterop.getHtmlFromModel("OffCanvas",n,function(n){var d=$($.trim(n));// TODO: cater for kendo window types
t?a&&3==a.OffCanvas?(v.offCanvasWindows["#offcanvas-"+e.Id].destroy(),delete v.offCanvasWindows["#offcanvas-"+e.Id],$("#offCanvasContainer").append(d),3==e.OffCanvas&&(v.offCanvasWindows["#offcanvas-"+e.Id]=v.createKendoWindow("offcanvas-"+e.Id,e.Title,null,null,["Close"],null,null,!0,!0,!1))):3==e.OffCanvas?($("#offcanvas-"+e.Id).remove(),$("#offCanvasContainer").append(d),v.offCanvasWindows["#offcanvas-"+e.Id]=v.createKendoWindow("offcanvas-"+e.Id,e.Title,null,null,["Close"],null,null,!0,!0,!1)):$("#offcanvas-"+e.Id).replaceWith(d):($("#offCanvasContainer").append(d),3==e.OffCanvas&&(v.offCanvasWindows["#offcanvas-"+e.Id]=v.createKendoWindow("offcanvas-"+e.Id,e.Title,null,null,["Close"],null,null,!0,!0,!1))),3!==e.OffCanvas&&$(d.find(".offcanvas-toggle")).on("click",function(){var e,t;if(t=$(this).attr("data-target"),e=$(t),e)return e.removeClass("in"),$("body").css({overflow:"",position:""})}),o&&"function"==typeof o&&o(),v.initNormalSorting(),v.initDataWidgetSorting()},"","","","",function(e){console.log(e)},!1)},// Initialising some JS after Layout Widgets added
finishAddLayoutWidget:function finishAddLayoutWidget(){// A few things to initialise the sortablitiy and draggability of the newly added elements - might need to move these after changing to Rob's convertor
$(".layout-widget-options .col-xs-3:last-child i, .layout-widget-options .col-xs-6:last-child i").popover({html:!0,placement:"left",trigger:"manual",animation:!1,template:"<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><div class=\"popover-content\"></div></div>",content:"<ul class=\"nav nav-pills\"><li><a class=\"edit-row-section\"><i class=\"material-icons text-primary\">edit</i></a></li><li><a class=\"remove-row-section\"><i class=\"material-icons text-danger\">delete</i></a></li></ul>"}).off().on("click",function(){var e=this;$(this).popover("show"),$(this).siblings(".popover").on("mouseleave",function(){$(e).popover("hide")})}),$(".options-popover").off().on("click",function(){$(this).parents(".sys-carousel").popover({html:!0,placement:"left",trigger:"hover",template:"<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><div class=\"popover-content\"></div></div>",content:"<ul class=\"nav nav-pills\"><li><a href=\"#\"><i class=\"material-icons text-primary\">edit</i></a></li><li><a href=\"#\"><i class=\"material-icons text-danger\">delete</i></a></li></ul>"})}),$(".initial-target").each(function(){$(this).toggle(!$(this).siblings(".draggable-row-section").length)}),v.sizeTiles(),v.initNormalSorting(),v.initDataWidgetSorting()},// Main sorting initialisation function for layout widgets
initNormalSorting:function initNormalSorting(){function initSectionNormalSorting(e){$(e+" .main-column").each(function(t,a){v.sortableWidgets[v.sortableWidgets.length]=$(a).find(".sortable-list, .tab-sortable-list").kendoSortable({connectWith:e+" .sortable-list, "+e+" .tab-sortable-list",placeholder:v.placeholder,hint:v.hint,handle:">.draggable-row-section .layout-widget-options > .row > .col-xs-3:first-child",filter:".draggable-row-section",ignore:".data-section, .data-section>div, .data-section *, .tile-widget, .tile, .tile-widget *, .form-control, .form-group *, tr, tr *, .diagram-card, .diagram-card *",cursor:"move",end:function end(t){var a=v.setContext(t.sender.draggedElement?t.sender.draggedElement[0].parentElement:t.sender.element);v.endDragWidget(t,a),$(e+" .initial-target").each(function(){$(this).toggle(!$(this).siblings(".draggable-row-section").length)})},change:function change(e){var t=v.setContext(e.item);v.finishDragWidget(e,t)},move:function move(t){var a=t.target;$(e+" .initial-target").each(function(){$(this).siblings(".draggable-row-section").not(".placeholderGhost").length||$(this).toggle(!$(this).is(a))})}}).data("kendoSortable")})}var e=["wrapper"];for(var t in b.OffCanvasLayouts)t.includes("offcanvas")&&e.push(t);v.sortableWidgets.length&&v.destroySorting(v.sortableWidgets),v.sortableWidgets=[];for(var a=0;a<e.length;a++)initSectionNormalSorting("#"+e[a])},// Destroy Layout widgets Kendo Sortable Widget
destroySorting:function destroySorting(e){for(var t=0;t<e.length;t++)e[t].draggable&&e[t].draggable.destroy(),e[t].destroy()},// Data Widget sorting initialisation
initDataWidgetSorting:function initDataWidgetSorting(){function initDataSectionNormalSorting(e){$(e+" div.data-section, "+e+" tbody.data-section").each(function(){v.sortableDataWidgets[v.sortableDataWidgets.length]=$(this).kendoSortable({connectWith:e+" div.data-section, "+e+" tbody.data-section",placeholder:v.placeholder,hint:v.hint,ignore:"input",filter:">div:not(.form-group:first-child), >tr, >a",disabled:".add-data-widget",handle:".data-widget-options .drag-data-section",cursor:"move",start:function start(){// Need to disable every sortable widget that already has a data widget in it, so it cannot be a valid target
$(e+" .panel.draggable-data-section").each(function(){$(this).closest(".data-section").removeClass("data-section").addClass("data-section-disabled")}),this.element.find(".add-data-widget")&&(v.tempHiddenWidg=this.element.find(".add-data-widget")),this.element.find(".add-data-section")&&this.element.find(".add-data-section").show()},end:function end(t){var a=v.setContext(t.sender.element);if($(e+" .draggable-data-section").each(function(){$(this).closest(".data-section-disabled").removeClass("data-section-disabled").addClass("data-section")}),"receive"===t.action){var o=t.item.closest(".draggable-data-section");sysproInterop.getHtmlFromModel("Widget",v.draggedDataWidgetTempCopy.toJSON(),function(e){var n=$($.trim(e));0===a.targetLayoutWidget.DisplayStyle||5===a.targetLayoutWidget.DisplayStyle||2===a.targetLayoutWidget.DisplayStyle?(o.replaceWith(n),v.initEditRemoveDataWidget()):(1===a.targetLayoutWidget.DisplayStyle||3===a.targetLayoutWidget.DisplayStyle)&&o.replaceWith(n);var d=v.draggedDataWidgetTempCopy.OffCanvasLayoutId||null;if(d){var s=parseInt(b.OffCanvasLayouts["offcanvas-"+d].OffCanvas);if(3===s)n.find("a").removeClass("offcanvas-toggle"),n.find("a").on("click",function(){v.offCanvasWindows[$(this).data("target")].center().open()});else{$(n.find("a.offcanvas-toggle").data("target")).removeClass("js-offcanvas-done");n.hasClass("offcanvas-toggle")?new Offcanvas(n):new Offcanvas(n.find("a.offcanvas-toggle"))}}sysproInterop.performBind(v.bindableFieldsData,!0,"",t.item.closest(".layout-widget")),v.initEditRemoveDataWidget(),v.initDataWidgetSorting(),v.finishAddLayoutWidget()},a.targetLayoutWidget.SubType,a.targetLayoutWidget.DisplayStyle,a.targetLayoutWidget.Border,a.section_num,function(e){console.log(e)},!1)}else if("remove"===t.action){//Rob: Now always do a get instead of getByUid so we can use our own Id.
var n=a.currentDataSource.get($(t.item).data("guid")||$(t.item).children(".draggable-data-section").data("guid"));v.draggedDataWidgetTempCopy=n,a.currentDataSource.remove(n)}else if("sort"===t.action){var d=a.currentDataSource.get($(t.item).data("guid")||$(t.item).children(".draggable-data-section").data("guid"));if(1===a.targetLayoutWidget.DisplayStyle||3===a.targetLayoutWidget.DisplayStyle){var s=d.toJSON();a.currentDataSource.remove(d),a.currentDataSource.at(null===a.tab_column_num?a.column_num:a.tab_column_num).children.at(a.widget_index).children.at(0).children.at(0).children.insert(t.newIndex-1,s)}else if(5===a.targetLayoutWidget.DisplayStyle){var l=d.toJSON();a.currentDataSource.remove(d),a.currentDataSource.at(null===a.tab_column_num?a.column_num:a.tab_column_num).children.at(a.widget_index).children.at(0).children.at(a.section_num).children.insert(t.newIndex,l)}}},change:function change(e){v.setContext(e.item);v.finishDragDataWidget(e)},move:function move(t){null!==v.tempHiddenWidg&&v.tempHiddenWidg.show(),$(e+" .add-data-widget").each(function(){$(this).siblings(".draggable-data-section:visible").length?($(this).not(v.tempHiddenWidg).hide(),t.target.hasClass("add-data-widget")&&t.target.hide()):($(this).not(t.target).show(),$(this).addClass("pulse"))})}}).data("kendoSortable")})}function initLinkListNormalSorting(e){$(e+" div.layout-widget .panel-body .list-group").each(function(t){v.sortableLinkListDataWidgets[t]=$(this).kendoSortable({connectWith:e+" div.layout-widget .panel-body .list-group",placeholder:v.placeholder,hint:v.hint,ignore:"input",filter:">a",disabled:".add-data-widget",handle:".drag-data-section",cursor:"move",end:function end(e){var t=v.setContext(e.sender.element);if("receive"===e.action){var d=e.item.closest(".draggable-data-section");sysproInterop.getHtmlFromModel("Widget",v.draggedDataWidgetTempCopy.toJSON(),function(t){var a=$($.trim(t));d.replaceWith(a),sysproInterop.performBind(v.bindableFieldsData,!0,"",e.item.closest(".layout-widget")),v.initEditRemoveDataWidget(),v.initDataWidgetSorting(),v.finishAddLayoutWidget()},t.targetLayoutWidget.SubType,t.targetLayoutWidget.DisplayStyle,t.targetLayoutWidget.Border,t.section_num)}else if("remove"===e.action){//Rob: Now always do a get instead of getByUid so we can use our own Id.
var s=t.currentDataSource.get($(e.item).data("guid"));v.draggedDataWidgetTempCopy=s,t.currentDataSource.remove(s)}else if("sort"===e.action){var a=e.item.data("guid"),o=t.currentDataSource.get(a),n=o.toJSON();t.currentDataSource.remove(o),t.currentDataSource.at(t.column_num).children.at(t.widget_index).children.at(0).children.at(0).children.insert(e.newIndex-1,n)}},change:function change(e){v.setContext(e.item);v.finishDragDataWidget(e)}}).data("kendoSortable")})}var e=["wrapper"];for(var a in b.OffCanvasLayouts)a.includes("offcanvas")&&e.push(a);v.sortableDataWidgets.length&&v.destroySorting(v.sortableDataWidgets),v.sortableDataWidgets=[];for(var o=0;o<e.length;o++)initDataSectionNormalSorting("#"+e[o]);var t=["wrapper"];for(var n in b.OffCanvasLayouts)n.includes("offcanvas")&&t.push(n);v.sortableLinkListDataWidgets.length&&v.destroySorting(v.sortableLinkListDataWidgets),v.sortableLinkListDataWidgets=[];for(var d=0;d<t.length;d++)initLinkListNormalSorting("#"+t[d])},// Initialise quick add layout widgets for dragging from the left sidebar
initQuickAddLayoutWidgets:function initQuickAddLayoutWidgets(){$(".quick-sortable-list").data("kendoSortable")&&$(".quick-sortable-list").data("kendoSortable").destroy();$(".quick-sortable-list").kendoSortable({connectWith:".sortable-list, .tab-sortable-list",placeholder:v.quickplaceholder,hint:v.quickhint,filter:">div",cursor:"move",start:function start(){$("#draggableCover").show(),$(".sortable-list").each(function(){$(this).addClass("pulse")})},end:function end(e){$("#draggableCover").hide(),$(".sortable-list").each(function(){$(this).removeClass("pulse")});var t=v.setContext(e.sender.element);v.endDragWidget(e,t)}}).data("kendoSortable")},// Toolbar sorting initialisation function for layout widgets
initToolbarSorting:function initToolbarSorting(){function initToolbarNormalSorting(e){$(e+" .navbar-controlbar ul.nav").each(function(t){v.sortableToolbarWidgets[t]=$(this).kendoSortable({connectWith:e+" .navbar-controlbar ul.nav,"+e+" .navbar-controlbar ul.dropdown-menu",placeholder:v.placeholder,hint:v.hint,handle:".toolbar-widget-options .col-xs-6:first-child",filter:">li:not(.add-toolbar-widget)",ignore:".form-control, .form-group, .form-group *, .dropdown-menu *",cursor:"move",end:function end(e){var t=v.setContext(e.sender.element);if("receive"===e.action){var a=e.item.closest("li"),o="ToolbarDropdown"===v.draggedToolbarWidgetTempCopy.FieldName?"ToolbarDropdown":"ToolbarSubDropdown"===v.draggedToolbarWidgetTempCopy.FieldName?"ToolbarDropdown":"ButtonWidget"===v.draggedToolbarWidgetTempCopy.FieldName?"Widget":"ToolbarWidget";sysproInterop.getHtmlFromModel(o,v.draggedToolbarWidgetTempCopy.toJSON(),function(e){var t=$($.trim(e));a.replaceWith(t);var o=v.draggedToolbarWidgetTempCopy.OffCanvasLayoutId||null;if(o){var n=parseInt(b.OffCanvasLayouts["offcanvas-"+o].OffCanvas);if(3===n)t.find("a").removeClass("offcanvas-toggle"),t.find("a").on("click",function(){v.offCanvasWindows[$(this).data("target")].center().open()});else{$(t.find("a.offcanvas-toggle").data("target")).removeClass("js-offcanvas-done");t.hasClass("offcanvas-toggle")?new Offcanvas(t):new Offcanvas(t.find("a.offcanvas-toggle"))}}sysproInterop.performBind(v.bindableFieldsData,!0,"",$("#navbar-toolbar")),$.material.init(),v.initEditRemoveDataWidget(),v.initToolbarSorting()},"",7,"","",function(e){console.log(e)},!1)}else if("remove"===e.action){//Rob: Now always do a get instead of getByUid so we can use our own Id.
var s=t.currentToolbarDataSource.get($(e.item).data("guid"));v.draggedToolbarWidgetTempCopy=s,t.currentToolbarDataSource.remove(s)}else if("sort"===e.action){var n=t.currentToolbarDataSource.get(e.item.data("guid")),d=n.toJSON();t.currentToolbarDataSource.remove(n),t.currentToolbarDataSource.at(t.column_num).children.insert(e.newIndex,d)}},change:function change(e){var t=v.setContext(e.item);v.finishDragToolbarWidget(e,t)}}).data("kendoSortable")}),$(e+" .navbar-controlbar ul.dropdown-menu").each(function(t){v.sortableToolbarWidgets[$(e+" .navbar-controlbar ul.nav").length+t]=$(this).kendoSortable({connectWith:e+" .navbar-controlbar ul.nav,"+e+" .navbar-controlbar ul.dropdown-menu",placeholder:v.placeholder,hint:v.hint,handle:".toolbar-widget-options .col-xs-6:first-child",filter:">li:not(.add-toolbar-widget)",ignore:".form-control, .form-group, .form-group *",cursor:"move",end:function end(e){var t=v.setContext(e.sender.element);if("receive"===e.action){var a=e.item.closest("li"),o="ToolbarDropdown"===v.draggedToolbarWidgetTempCopy.FieldName?"ToolbarDropdown":"ToolbarSubDropdown"===v.draggedToolbarWidgetTempCopy.FieldName?"ToolbarDropdown":"ButtonWidget"===v.draggedToolbarWidgetTempCopy.FieldName?"Widget":"ToolbarWidget";sysproInterop.getHtmlFromModel(o,v.draggedToolbarWidgetTempCopy.toJSON(),function(e){var t=$($.trim(e));//sysproInterop.performBind(SYSPRO_VB.bindableFieldsData, true);
a.replaceWith(t),sysproInterop.performBind(v.bindableFieldsData,!0,"",$("#navbar-toolbar")),$.material.init(),v.initEditRemoveDataWidget(),v.initToolbarSorting()},"",7,"","",function(e){console.log(e)},!1)}else if("remove"===e.action){//Rob: Now always do a get instead of getByUid so we can use our own Id.
var s=t.currentToolbarDataSource.get($(e.item).data("guid"));v.draggedToolbarWidgetTempCopy=s,t.currentToolbarDataSource.remove(s)}else if("sort"===e.action){var n=t.currentToolbarDataSource.get(e.item.data("guid")),d=n.toJSON();t.currentToolbarDataSource.remove(n);var l=$(e.item.closest("li.dropdown"));t.widget_index=$("ul.nav[data-column=\"".concat(t.column_num,"\"] > li:not(.add-toolbar-widget)")).index(l),t.currentToolbarDataSource.at(t.column_num).children.at(t.widget_index).children.insert(e.newIndex,d)}},change:function change(e){var t=v.setContext(e.item);v.finishDragToolbarWidget(e,t)}}).data("kendoSortable")})}var e=["wrapper"];for(var t in b.OffCanvasLayouts)t.includes("offcanvas")&&e.push(t);v.sortableToolbarWidgets.length&&v.destroySorting(v.sortableToolbarWidgets),v.sortableToolbarWidgets=[];for(var a=0;a<e.length;a++)initToolbarNormalSorting("#"+e[a])},// Initialise program list dragging to tile widgets
initProgramListTileDragging:function initProgramListTileDragging(t){function onDrop(a){if(a.dropTarget.find(".sys-bg-white").removeClass("pulse"),t){var e=a.draggable.element.find("a.syspro-program-link").clone();e.children().remove();var o=e.text();t(a.dropTarget,a.draggable.element.find("a.syspro-program-link").data("sysproprogramname"),o,a.draggable.element.find("a.syspro-program-link").data("syspromenuitemtype"),a.draggable.element.find("a.syspro-program-link").data("syspromenuitemsubtype"))}}//create a draggable for the parent container
$("#programListMenu .treeview-menu >li:not(.treeview)").each(function(){$(this).data("kendoDraggable")||$(this).kendoDraggable({hint:function hint(e){var t=e.clone();t.find("i, span").remove();return t.css({height:"142px",width:"142px",backgroundColor:"#fff"}),t.addClass("hint"),t},dragstart:function dragstart(){$(".tiles-parent").length&&$(".tiles-parent").find(".sys-bg-white").addClass("pulse")}})}),$(".tiles-parent").each(function(){$(this).data("kendoDropTarget")||$(this).kendoDropTarget({drop:onDrop})})},// Helper function to stringify a widget before sending to SysproInterop
stringifyJSONObject:function stringifyJSONObject(e,t,a){//Rob: Now always do a get instead of getByUid so we can use our own Id.
var o=a.get(e),n;return n=9===o.DisplayStyle?_objectSpread({},o.toJSON(),{Tabs:o.Tabs.data().toJSON()}):o.toJSON(),o.Rows&&$.each(o.Rows,function(e,t){t.Columns&&$.each(t.Columns,function(t,a){a.Widgets&&$.each(a.Widgets,function(a,o){n.Rows[e].Columns[t].Widgets[a].Id=o.Id})})}),n.Id=e,n},//Helper function to set correct active states and selected tile in view model when a user selects a tile from the autopredict search.
selectTileFromSearch:function selectTileFromSearch(e){if("tileWindow"===v.openWindow){$("#tile-widgets-list-wrapper .list-group-item.active").removeClass("active");var t=$("#tile-widgets-list-wrapper .list-group-item[data-tile-name='"+e.tileName+"']");t.addClass("active"),v.tilesList[0].resetDdMenu(),v.tilesList[0].drillto(t.closest(".dd-parent").parent().closest(".dd-parent")),v.tilesList[0].drillto(t.closest(".dd-parent")),setTimeout(function(){$("#tiles-list").scrollTop($("#tiles-list .list-group-item.active").position().top-140)},300),v.showTileParameters($(this).data("tile-name"),v.openWindow),$("#addTileButton").removeClass("disabled"),$("#addTileButton").prop("disabled",!1),$("#addTileButtonPopoverWrap").popover("destroy")}v.setupTileWIndowUI(v.openWindow)},//Helper function to set correct active states and selected field in view model when a user selects a field from the autopredict search.
selectFieldFromSearch:function selectFieldFromSearch(e){var t;"dataWindow"===v.openWindow?($("#initial-fields-list-data-window-wrapper .list-group-item.active").removeClass("active"),t=$("#initial-fields-list-data-window-wrapper .list-group-item[data-field-path='"+e.fieldpath+"']"),t.addClass("active"),v.dataWindowFieldsList[0].resetDdMenu(),v.dataWindowFieldsList[0].drillto(t.closest(".dd-parent").parent().closest(".dd-parent")),v.dataWindowFieldsList[0].drillto(t.closest(".dd-parent")),setTimeout(function(){$("#initial-fields-list-data-window .list-group-item")&&$("#initial-fields-list-data-window").scrollTop($("#initial-fields-list-data-window .list-group-item.active").position().top-140)},300),$("#addDataWidgetButton").removeClass("disabled"),$("#addDataWidgetButton").prop("disabled",!1),$("#addDataButtonPopoverWrap").popover("destroy")):"dataEditWindow"===v.openWindow&&(b.set("selected.FieldPath",e.fieldpath),b.set("selected.FieldName",""),b.set("selected.DataType",e.datatype),b.set("selected.HasSmartTag",e.smarttag),$("#initial-fields-list-data-edit-window-wrapper .list-group-item.active").removeClass("active"),t=$("#initial-fields-list-data-edit-window-wrapper .list-group-item[data-field-path='"+e.fieldpath+"']"),t.addClass("active"),v.dataEditWindowFieldsList[0].resetDdMenu(),v.dataEditWindowFieldsList[0].drillto(t.closest(".dd-parent").parent().closest(".dd-parent")),v.dataEditWindowFieldsList[0].drillto(t.closest(".dd-parent")),setTimeout(function(){$("#initial-fields-list-data-edit-window .list-group-item").length&&$("#initial-fields-list-data-edit-window").scrollTop($("#initial-fields-list-data-edit-window .list-group-item.active").position().top-140)},300)),v.setupDataWindowUI("#"+v.openWindow,t,$("#"+v.openWindow).data("kendoWindow").options.context.targetLayoutWidget.DisplayStyle)},hideErrorMessage:function hideErrorMessage(){v.errorNotification&&v.errorNotification.hide()},// Error Notification display function
showErrorMessage:function showErrorMessage(e,t){// Error Notification setup
t=t||"Sorry, something has gone wrong. The technical error message is:",v.errorNotification=$("#errorNotification").kendoNotification({position:{pinned:!0},autoHideAfter:0,button:!0,show:function(t){if(1==t.sender.getNotifications().length){var e=t.element.parent(),a=e.width(),o=e.height(),d=$(window).width(),s=$(window).height(),l,r;r=n(d/2-a/2),l=n(s/2-o/2),t.element.parent().css({top:l,left:r}),t.element.parent().addClass("avantiNotification")}},stacking:"down",templates:[{type:"error",template:$("#errorTemplate").html()}]}).data("kendoNotification"),v.errorNotification.show({title:t,message:e},"error")},initiateTiles:function initiateTiles(e){if(e.Rows[0].Columns){var t=e.Id;$.when($.each(e.Rows[0].Columns,function(){var e=this;e.Widgets[0].HTMLContent=function(){var t=sysproInterop.generateUUID();return sysproInterop.getHtmlFromModel("Widget",e.Widgets[0].toJSON(),function(e){$("#async_"+t).html($.trim(e))},"","","","",function(e){console.log(e)},!1),"<div id='async_"+t+"'> </div>"}})).then(function(){var a=kendo.template($("#tileTemplate").html()),o=kendo.render(a,e.Rows[0].Columns);//render the template
//append the result to the page
$(".layout-widget[data-guid=\""+t+"\"] .tile-widget").html(o),$(".layout-widget[data-guid=\""+t+"\"] .tile-widget").prepend("<div class=\"tile col-xs-6 col-sm-4 tile-width-marker\"></div>"),v.tileWidgets[t]&&v.tileWidgets[t].packery("destroy"),v.tileWidgets[t]=$(".layout-widget[data-guid=\""+t+"\"] .tile-widget").packery({itemSelector:".tile:not(.tile-width-marker)",gutter:0,columnWidth:142,transitionDuration:"0.27s"}),v.tileWidgets[t].packery("layout"),v.tileWidgets[t].find(".tile:not(.tile-width-marker)").each(function(e,a){var o=new Draggabilly(a,{handle:".drag-row-section"});// bind drag events to Packery
v.tileWidgets[t].packery("bindDraggabillyEvents",o)}),v.tileWidgets[t].off("dragItemPositioned").on("dragItemPositioned",function(e,a){var o=v.setContext(a.element),n=o.currentDataSource.get($(a.element).data("guid")),d=$(a.element).parents(".layout-widget").data("guid"),s=o.currentDataSource.get(d),l=v.tileWidgets[t].packery("getItemElements"),r=l.indexOf(a.element);o.currentDataSource.remove(n),s.children.at(0).children.insert(r,n),v.tileWidgets[t].packery("layout")}),v.initEditRemoveDataWidget(),v.sizeTiles()})}},sizeTiles:function sizeTiles(){function sizeTileTitles(e,t){$(e).css("height",t+"px"),$(e).addClass("show-more-icon"),$(e).hover(function(){$(e).removeClass("show-more-icon"),$(e).animate({height:$(e).get(0).scrollHeight},120)},function(){$(e).animate({height:t},60),$(e).addClass("show-more-icon")})}$(".tile-widget").each(function(){var e=$(this);v.tileWidgets[$(this).closest(".draggable-row-section").data("guid")]&&v.tileWidgets[$(this).closest(".draggable-row-section").data("guid")].packery("layout"),e.parents(".tile-widget-wrapper").find(".tile-loading-cover").hide()}),fitty(".small-tile .valueIconWrapper .tile-main-value",{minSize:16,maxSize:20.5,multiLine:!1}),fitty(".small-tile .metric-only .tile-main-value",{minSize:16,maxSize:30,multiLine:!0}),fitty(".wide-tile .tile-main-value, .big-tile .tile-main-value",{minSize:22,maxSize:56,multiLine:!0});$(".small-tile .tile-title:visible").each(function(){var e=this;33<$(e).get(0).scrollHeight&&(0<$(e).siblings(".tile-subtitle").text().length||0<$(e).closest(".ai-tile-icon-title").siblings(".tile-subtitle").text().length)?sizeTileTitles(e,32):46<$(e).get(0).scrollHeight&&(0===$(e).siblings(".tile-subtitle").text().length||0===$(e).closest(".ai-tile-icon-title").siblings(".tile-subtitle").text().length)&&sizeTileTitles(e,45)}),$(".wide-tile .tile-title:visible").each(function(){var e=this;40<$(e).get(0).scrollHeight&&(0<$(e).siblings(".tile-subtitle").text().length||0<$(e).closest(".ai-tile-icon-title").siblings(".tile-subtitle").text().length)?sizeTileTitles(e,39):40<$(e).get(0).scrollHeight&&(0===$(e).siblings(".tile-subtitle").text().length||0===$(e).closest(".ai-tile-icon-title").siblings(".tile-subtitle").text().length)&&sizeTileTitles(e,39)})},// Callback function for calling sizeTiles from performBind callback
sizeTilesCallback:function sizeTilesCallback(e,t){e?v.sizeTiles():v.showErrorMessage(t)},initiateExistingTiles:function initiateExistingTiles(){$(".tile-widget").each(function(){var e=v.setContext(this);if($(this).parents(".layout-widget").find(".data-section").removeClass("data-section"),$(this).parents(".layout-widget").children(".col-sm-12").addClass("tile-widget-wrapper"),$(this).parents(".layout-widget").find(".panel-body").first().prepend("<div class=\"tile-loading-cover\"><span class=\"spinner\"></span></div>"),$(this).parents(".layout-widget").data("guid")){var t=e.currentDataSource.get($(this).parents(".layout-widget").data("guid"));v.initiateTiles(t)}})},// General local JSON loading function, using vanilla JavaScript - tailored for icons
loadIconJSON:function loadIconJSON(e,t){sysproInterop.getIconsAvailable(function(a){// Parse JSON string into object
var o="";if($.each(a,function(){var t=this.Name,a=t.replace(/_/g," ");// value.name.toLowerCase().replace(/ /g, "_");
o+="<label data-container=\"body\" data-placement=\"top\" data-original-title=\""+a+"\" class=\"btn btn-radio btn-icon icon-option\" data-icon-name=\""+t,"base"===e?o+="\"><i class=\"material-icons\">":"editData"===e?o+="\" data-bind=\"iconName: selected.Icon.Name\"><i class=\"material-icons\">":"editRow"===e?o+="\" data-bind=\"iconName: selected.Icon\"><i class=\"material-icons\">":"editTile"==e&&(o+="\" data-bind=\"iconName: selected.Widgets[0].TileTypeIcon\"><i class=\"material-icons\">"),o+=t+"</i></label>"}),$(t+" .icon-field-container > .radio-btn-group").append(o),kendo.bind($(t+" .icon-field-container"),b),"#toolbarEditWindow"===t&&b.selected&&b.selected.Icon.Name){var n=$("#toolbarEditWindowIconList label[data-icon-name='"+b.selected.Icon.Name+"']");n.addClass("active"),setTimeout(function(){$(".toolbar-icon-option .icon-field-container").scrollTop($(".toolbar-icon-option .icon-field-container").scrollTop()+n.position().top-193)},300)}$(t+" .icon-field-container").off("click",".btn-icon").on("click",".btn-icon",function(){$(this).parents(".icon-field-container").find(".active").removeClass("active"),$(this).addClass("active")}),$(t+" .icon-search").each(function(){var e=$(this).siblings(".radio-btn-group").find(".icon-option");$(this).off().on("keyup",function(){var t=$(this).find("input").val();if(""===t)return void e.show();for(var a=0;a<e.length;a++)$(e[a]).attr("data-icon-name").replace("_"," ").includes(t)?$(e[a]).show():$(e[a]).hide()})}),$(t+".icon-field-container").each(function(e,t){$(t).find(".radio-btn-group").tooltip("destroy")}),$(t+".icon-field-container").each(function(e,t){$(t).find(".radio-btn-group").tooltip({selector:"label",title:function title(){return $(this).data("icon-name").replace(/_/g," ")},placement:"top",container:"body"})})})},// Initialise all Off Canvas sections
initAllOffCanvasSections:function initAllOffCanvasSections(){return $.each($(".modal-center"),function(){var e=this.id,t=$(this),a=$(".offcanvas-toggle[data-target=\"#"+e+"\"]");a.removeClass("offcanvas-toggle"),a.addClass("in-modal-window"),v.offCanvasWindows["#"+e]=v.createKendoWindow(e,t.data("modaltitle"),function(){},function(){},["Close"],null,null,!0,!0,!1),queryLayoutUIHelpers.kendoWindowsCreated.push(v.offCanvasWindows["#"+e])}),$("[data-toggle=\"offcanvas\"]").each(function(){if(v.offCanvasWindows.hasOwnProperty($(this).data("target")))$(this).on("click",function(){v.offCanvasWindows[$(this).data("target")].center().open()});else if(!$(this).hasClass("in-modal-window"))// Only if the off canvas initialised isn't a modal window
new Offcanvas($(this))}),$(".offcanvas-toggle").each(function(){return $(this).on("click",function(){var e,t;if(!$(this).hasClass("js-offcanvas-has-events")&&(t=$(this).attr("data-target"),e=$(t),e))return e.removeClass("in"),$("body").css({overflow:"",position:""})})})},// Fuction to create a Kendo UI Window
createKendoWindow:function createKendoWindow(e,t,a,o,n,d,s,l,r,c,p,u){n=n||[];var m=d&&0<d.indexOf("%")?d:d&&0>=d.indexOf("%")?d+"px":"900px",g=s&&0<s.indexOf("%")&&87<=parseInt(s.substring(0,s.length-1))?"86%":s&&0>=s.indexOf("%")&&parseInt(s)>=window.screen.height-60?window.screen.height-65:s,h=g&&"string"==typeof g&&0<g.indexOf("%")?g:g&&("number"==typeof g||0>=g.indexOf("%"))?g+"px":"550px",f=u&&0<u.indexOf("%")&&10>=parseInt(u.substring(0,u.length-1))?"10%":u&&0>=u.indexOf("%")&&60>=parseInt(u)?60:u,y=f&&"string"==typeof f&&0<f.indexOf("%")?f:f&&("number"==typeof f||0>=f.indexOf("%"))?f+"px":"50%",b=p&&0<p.indexOf("%")?p:p&&0>=p.indexOf("%")?p+"px":"50%",v=c?//If its a syspro window dispose of it after it closes.
function(){0<$(".syspro-trackfield-change-richtext").length&&(kendo.unbind($(".syspro-trackfield-change-richtext")),$.each(function(){$(this).data("kendoEditor")&&$(this).data("kendoEditor").destroy()})),this.destroy(),queryLayoutUIHelpers.disposeViewOnly(e)}://If its a syspro window dispose of it after it closes.
function(){0<$(".syspro-trackfield-change-richtext").length&&(kendo.unbind($(".syspro-trackfield-change-richtext")),$.each(function(){$(this).data("kendoEditor")&&$(this).data("kendoEditor").destroy()}))};$("#"+e).kendoWindow({//create a window
actions:n,draggable:!0,minHeight:"200px",minWidth:"200px",width:m,height:h,modal:!l,//pinned: false,
position:{top:y,left:b},animation:{open:{effects:"fadeIn",duration:100},close:{effects:"fadeOut",duration:80}},resizable:!0,title:t,deactivate:v,visible:!1,open:a,close:o,activate:function activate(){$(".k-window-action").attr("tabIndex",-1),$(".k-window-action").prop("tab-index",-1)}});var w=$("#"+e).data("kendoWindow");return r&&w&&w.wrapper.addClass("compact-window"),1===$(".special-text-notes","#"+e).length&&w.wrapper.addClass("special-notes-window"),w},// Helper function to initialise multipane functinality of windows
initialiseMultiPaneWindow:function initialiseMultiPaneWindow(t){$(t+" .window-container").on("click",".view-pane",function(a){a.preventDefault();var e=$(this).data("view-pane");$(t+" .data-section-pane-1, "+t+" .data-section-pane-2").velocity("fadeOut",{duration:300,begin:function begin(){var e=$(t+" .window-container").height()-50;$(t+" .window-content").wrapAll("<div class='animation-wrapper' style='height:"+e+"px'></div>")},complete:function complete(){$(t+" .data-section-pane-"+e).velocity("fadeIn",{duration:300,complete:function complete(){if(b.selected&&b.selected.Icon&&b.selected.Icon.Name){var e=$(t+" label[data-icon-name='"+b.selected.Icon.Name+"']");setTimeout(function(){$(t+" .icon-field-container").scrollTop($(t+" .icon-field-container").scrollTop()+e.position().top-193)},300)}else if(b.selected&&b.selected.Icon){var a=$(t+" label[data-icon-name='"+b.selected.Icon+"']");setTimeout(function(){$(t+" .icon-field-container").scrollTop($(t+" .icon-field-container").scrollTop()+a.position().top-193)},300)}if(b.selected&&b.selected.Widgets&&b.selected.Widgets[0].TileTypeIcon){var o=$(t+" label[data-icon-name='"+b.selected.Widgets[0].TileTypeIcon+"']");setTimeout(function(){$(t+" .icon-field-container").scrollTop($(t+" .icon-field-container").scrollTop()+o.position().top-193)},300)}$(t+" .window-content").unwrap()}})}})}),$(t+" .window-container").on("click",".back-to-data-section",function(a){a.preventDefault(),$(t+" .data-section-pane-2, "+t+" .data-section-pane-3").velocity("fadeOut",{duration:300,begin:function begin(){var e=$(t+" .window-container").height()-50;$(t+" .window-content").wrapAll("<div class='animation-wrapper' style='height:"+e+"px'></div>")},complete:function complete(){$(t+" .data-section-pane-1").velocity("fadeIn",{duration:300,complete:function complete(){$(t+" .window-content").unwrap()}})}})})},// Generic helper function to retrieve a value from the fields JSON
getPropertyValue:function getPropertyValue(e,t){var a="HasSmartTag"===t?"false":"";for(var o in e)o===t&&(a=e[o]);return a},// Specific helper function to grab captions with secondary captions
getCaption:function getCaption(e){var t="";for(var n in e)"Caption"==n&&(t=e[n]);var a=t.replace("[","").replace("]",""),o=t.replace(/\[.*\]/g,"");return t=t.replace("[","<span class='secondaryCaption'>("),t=t.replace("]",")</span>"),[t,a,o]},// Helper fuction to process Available Cards from the XML/JSON
processCards:function processCards(e,t){if(e){var a=Array.isArray(e)?e[t]:e,o="",n="",d=a.Name,s=a.Name+"_card",l=a.Description;n+="<label class=\"btn btn-radio col-sm-5 text-left no-sunken sys-mg-r-2\" data-tooltip=\"tooltip\" data-placement=\"top\" title=\" "+l+" \"><input type=\"radio\" name=\"row_options\" id=\""+s+"\" value=\""+s+"\" autocomplete=\"off\" data-layout-widget-type=\"Card\" data-layout-widget-subtype=\"MaxiCard\" data-layout-widget-displaystyle=\"0\" data-card-type-detail=\""+d+"\" data-parent-field-path=\"",a.KeyField&&a.KeyField.length&&(n+="Fields.SYSPROKeyData."+a.KeyField+".Value"),n+="\" required=\"required\"><i class=\"material-icons text-muted\">panorama_fish_eye</i><i class=\"material-icons text-success\">check_circle</i> "+l.replace(/ Card$/,"")+"</label>",v.finishedQuickAddWidgets||(o+="<div class=\"col-xs-6 mb-10 draggable quickAddWidget quickAddCard\" id=\""+s+"\" value=\""+s+"\" data-layout-widget-type=\"Card\" data-layout-widget-subtype=\"MaxiCard\" data-card-type-detail=\""+d+"\" data-layout-widget-displaystyle=\"0\" data-parent-field-path=\"",a.KeyField&&a.KeyField.length&&(o+="Fields.SYSPROKeyData."+a.KeyField+".Value"),o+="\"><div class=\"draggableLayoutWidget draggable\"><i class=\"material-icons text-primary quickAddDragHandle\">open_with</i> "+l+" </div></div>",$("#quick-add-layout .quick-sortable-list.row").append(o)),$("#AvailableCards .layout-radio-options").append(n),e.length&&(t++,t<e.length&&v.processCards(e,t))}},// Helper fuction to process Available Harmony Widgets from the XML/JSON
processHarmony:function processHarmony(e,t){if(e){var a=Array.isArray(e)?e[t]:e,o="",n="",d=a.ComponentId,s=a.Name,l=a.Description;n+="<label class=\"btn btn-radio col-sm-5 text-left no-sunken sys-mg-r-2\" data-tooltip=\"tooltip\" data-placement=\"top\" title=\" "+l+" \"><input type=\"radio\" name=\"row_options\" id=\""+s+"\" value=\""+s+"\" autocomplete=\"off\" data-layout-widget-type=\"HarmonyWidget\" data-layout-widget-subtype=\"MaxiWidget\" data-layout-widget-displaystyle=\"0\" data-component-id=\""+d+"\" required=\"required\"><i class=\"material-icons text-muted\">panorama_fish_eye</i><i class=\"material-icons text-success\">check_circle</i> "+l+"</label>",v.finishedQuickAddWidgets||(o+="<div class=\"col-xs-6 mb-10 draggable quickAddWidget quickAddCard\" id=\""+s+"\" value=\""+s+"\" data-layout-widget-type=\"HarmonyWidget\" data-layout-widget-subtype=\"MaxiWidget\" data-layout-widget-displaystyle=\"0\" data-component-id=\""+d+"\"><div class=\"draggableLayoutWidget draggable\"><i class=\"material-icons text-primary quickAddDragHandle\">open_with</i> "+l+" </div></div>",$("#quick-add-layout .quick-sortable-list.row").append(o)),$("#HarmonyWidgets .layout-radio-options").append(n),e.length&&(t++,t<e.length&&v.processHarmony(e,t))}},// Helper fuction to process GridLists from the XML/JSON
processGridLists:function processGridLists(e,t){if(e){var a=Array.isArray(e)?e[t]:e,o="",n="",d=a.FieldName,s=a.Caption;n+="<label class=\"btn btn-radio text-left no-sunken sys-mg-r-2\" data-tooltip=\"tooltip\" data-placement=\"top\" title=\" "+s+" \"><input type=\"radio\" name=\"row_options\" id=\""+d+"\" value=\""+d+"\" autocomplete=\"off\" data-layout-widget-type=\"GridList\" data-layout-widget-displaystyle=\"0\" data-gridlist-field-name=\""+d+"\" required=\"required\" data-caption=\""+s+"\"><i class=\"material-icons text-muted\">panorama_fish_eye</i><i class=\"material-icons text-success\">check_circle</i> "+s+"</label>",v.finishedQuickAddWidgets||(o+="<div class=\"col-xs-6 mb-10 draggable quickAddWidget quickAddCard\" id=\""+d+"\" value=\""+d+"\" data-layout-widget-type=\"GridList\" data-layout-widget-displaystyle=\"0\" data-gridlist-field-name=\""+d+"\" data-caption=\""+s+"\"><div class=\"draggableLayoutWidget draggable\"><i class=\"material-icons text-primary quickAddDragHandle\">open_with</i> "+s+" </div></div>",$("#quick-add-layout .quick-sortable-list.row").append(o)),$("#GridlistWidgets .layout-radio-options").append(n),e.length&&(t++,t<e.length&&v.processGridLists(e,t))}},// Helper fuction to process TreeLists from the XML/JSON
processTreeLists:function processTreeLists(e,t){if(e){var a=Array.isArray(e)?e[t]:e,o="",n="",d=a.FieldName,s=a.Caption;n+="<label class=\"btn btn-radio text-left no-sunken sys-mg-r-2\" data-tooltip=\"tooltip\" data-placement=\"top\" title=\" "+s+" \"><input type=\"radio\" name=\"row_options\" id=\""+d+"\" value=\""+d+"\" autocomplete=\"off\" data-layout-widget-type=\"TreeList\" data-layout-widget-displaystyle=\"0\" data-gridlist-field-name=\""+d+"\" required=\"required\" data-caption=\""+s+"\"><i class=\"material-icons text-muted\">panorama_fish_eye</i><i class=\"material-icons text-success\">check_circle</i> "+s+"</label>",v.finishedQuickAddWidgets||(o+="<div class=\"col-xs-6 mb-10 draggable quickAddWidget quickAddCard\" id=\""+d+"\" value=\""+d+"\" data-layout-widget-type=\"TreeList\" data-layout-widget-displaystyle=\"0\" data-gridlist-field-name=\""+d+"\" data-caption=\""+s+"\"><div class=\"draggableLayoutWidget draggable\"><i class=\"material-icons text-primary quickAddDragHandle\">open_with</i> "+s+" </div></div>",$("#quick-add-layout .quick-sortable-list.row").append(o)),$("#TreelistWidgets .layout-radio-options").append(n),e.length&&(t++,t<e.length&&v.processTreeLists(e,t))}},// Helper fuction to process TreeViews from the XML/JSON
processTreeViews:function processTreeViews(e,t){if(e){var a=Array.isArray(e)?e[t]:e,o="",n="",d=a.FieldName,s=a.Caption;n+="<label class=\"btn btn-radio text-left no-sunken sys-mg-r-2\" data-tooltip=\"tooltip\" data-placement=\"top\" title=\" "+s+" \"><input type=\"radio\" name=\"row_options\" id=\""+d+"\" value=\""+d+"\" autocomplete=\"off\" data-layout-widget-type=\"TreeView\" data-layout-widget-displaystyle=\"0\" data-gridlist-field-name=\""+d+"\" required=\"required\" data-caption=\""+s+"\"><i class=\"material-icons text-muted\">panorama_fish_eye</i><i class=\"material-icons text-success\">check_circle</i> "+s+"</label>",v.finishedQuickAddWidgets||(o+="<div class=\"col-xs-6 mb-10 draggable quickAddWidget quickAddCard\" id=\""+d+"\" value=\""+d+"\" data-layout-widget-type=\"TreeView\" data-layout-widget-displaystyle=\"0\" data-gridlist-field-name=\""+d+"\" data-caption=\""+s+"\"><div class=\"draggableLayoutWidget draggable\"><i class=\"material-icons text-primary quickAddDragHandle\">open_with</i> "+s+" </div></div>",$("#quick-add-layout .quick-sortable-list.row").append(o)),$("#TreeviewWidgets .layout-radio-options").append(n),e.length&&(t++,t<e.length&&v.processTreeViews(e,t))}},// Helper fuction to process TreeLists from the XML/JSON
processNotepadWidgets:function processNotepadWidgets(e,t){if(e){var a=Array.isArray(e)?e[t]:e,o="",n="",d=a.FieldName,s=a.Caption;n+="<label class=\"btn btn-radio text-left no-sunken sys-mg-r-2\" data-tooltip=\"tooltip\" data-placement=\"top\" title=\" "+s+" \"><input type=\"radio\" name=\"row_options\" id=\""+d+"\" value=\""+d+"\" autocomplete=\"off\" data-layout-widget-type=\"RichTextWidget\" data-layout-widget-displaystyle=\"0\" data-richtext-field-name=\""+d+"\" required=\"required\" data-caption=\""+s+"\"><i class=\"material-icons text-muted\">panorama_fish_eye</i><i class=\"material-icons text-success\">check_circle</i> "+s+"</label>",v.finishedQuickAddWidgets||(o+="<div class=\"col-xs-6 mb-10 draggable quickAddWidget quickAddCard\" id=\""+d+"\" value=\""+d+"\" data-layout-widget-type=\"RichTextWidget\" data-layout-widget-displaystyle=\"0\" data-richtext-field-name=\""+d+"\" data-caption=\""+s+"\"><div class=\"draggableLayoutWidget draggable\"><i class=\"material-icons text-primary quickAddDragHandle\">open_with</i> "+s+" </div></div>",$("#quick-add-layout .quick-sortable-list.row").append(o)),$("#NotepadWidgets .layout-radio-options").append(n),e.length&&(t++,t<e.length&&v.processNotepadWidgets(e,t))}},// Parse tiles, getting them in a structure suitable for the drill down menu UI
processTileJSON:function processTileJSON(e){var t={};for(var f in e)if(e.hasOwnProperty(f))for(var y in e[f])if(e[f].hasOwnProperty(y)){var b=e[f][y];if(Array.isArray(b))for(var w=0;w<b.length;w++){var a=b[w],o=v.getPropertyValue(a,"KeyType"),n=v.getPropertyValue(a,"Description"),d=v.getPropertyValue(a,"Name"),s=v.getPropertyValue(a,"Type"),l=v.getPropertyValue(a,"Activity"),r=v.getPropertyValue(a,"DetailAvailable");v.tilesJSONReady||(t[d]=a.Parameters,v.tilesSearchJSON.push({keyField:o,description:n,tileType:s,detailAvailable:r,activity:l,tileName:d,name:n+("Workspace"===l?"":o?" ("+o+")":"")}))}else{var c=v.getPropertyValue(b,"KeyType"),p=v.getPropertyValue(b,"Description"),u=v.getPropertyValue(b,"Name"),m=v.getPropertyValue(b,"Type"),g=v.getPropertyValue(b,"Activity"),h=v.getPropertyValue(b,"DetailAvailable");v.tilesJSONReady||(t[u]=b.Parameters,v.tilesSearchJSON.push({keyField:c,description:p,tileType:m,detailAvailable:h,activity:g,tileName:u,name:p+("Workspace"===g?"":c?" ("+c+")":"")}))}}sysproInterop.storeData("tilesJSON",JSON.stringify(t)),v.tilesJSONReady=!0},// Parse tiles, getting them in a structure suitable for the drill down menu UI
processTiles:function processTiles(e){var t={},a="";for(var k in e)if(e.hasOwnProperty(k)){for(var x in a+="<li class=\"list-group-item\"><a href=\"#\">"+k.replace(/_/g," ")+"</a><ul class=\"list-group\">",e[k])if(e[k].hasOwnProperty(x)){var S=e[k][x];if(Array.isArray(S))for(var T=0;T<S.length;T++){var o=S[T],n=v.getPropertyValue(o,"Activity"),d=v.getPropertyValue(o,"Name"),s="Workspace"===n?d:v.getPropertyValue(o,"KeyType"),l=v.getPropertyValue(o,"Description"),r=v.getPropertyValue(o,"Type"),c=v.getPropertyValue(o,"Par1"),p=v.getPropertyValue(o,"KpiLevelFound"),u=v.getPropertyValue(o,"DetailAvailable");a+="<li data-bind=\"tileBind: selected.Widgets[0].TileTypeDetail\" class=\"list-group-item field-name\" id=\""+d+"\" data-tile-type=\""+r+"\" data-tile-keyfield=\""+s+"\" data-tile-name=\""+d+"\" data-detail-available=\""+u+"\" data-sub-type=\""+c+"\" data-kpi-indicator=\""+p+"\"><i class=\"material-icons text-primary quickAddDragHandle\">open_with</i> "+l,"Program"===r&&(a+=null!==s&&"null"!==s&&"Workspace"!==n?" - "+s:"",a+=n?"<span class=\"program-activity\">"+n+"</span>":""),a+="</li>",v.tilesJSONReady||(t[d]=o.Parameters,v.tilesSearchJSON.push({keyField:s,description:l,tileType:r,detailAvailable:u,activity:n,tileName:d,name:l+("Workspace"===n?"":s?" ("+s+")":"")}))}else{var m=v.getPropertyValue(S,"Description"),g=v.getPropertyValue(S,"Name"),h=v.getPropertyValue(S,"Type"),f=v.getPropertyValue(S,"Activity"),y="Workspace"===f?g:v.getPropertyValue(S,"KeyType"),b=v.getPropertyValue(S,"Par1"),w=v.getPropertyValue(S,"KpiLevelFound"),C=v.getPropertyValue(S,"DetailAvailable");a+="<li data-bind=\"tileBind: selected.Widgets[0].TileTypeDetail\" class=\"list-group-item field-name\" id=\""+g+"\" data-tile-type=\""+h+"\" data-tile-keyfield=\""+y+"\" data-tile-name=\""+g+"\" data-detail-available=\""+C+"\" data-sub-type=\""+b+"\" data-kpi-indicator=\""+w+"\"><i class=\"material-icons text-primary quickAddDragHandle\">open_with</i> "+m,"Program"===h&&(a+=null!==y&&"null"!==y&&"Workspace"!==f?" - "+y:"",a+=f?"<span class=\"program-activity\">"+f+"</span>":""),a+="</li>",v.tilesJSONReady||(t[g]=S.Parameters,v.tilesSearchJSON.push({keyField:y,description:m,tileType:h,detailAvailable:C,activity:f,tileName:g,name:m+("Workspace"===f?"":y?" ("+y+")":"")}))}a+="</ul>"}a+="</ul>"}return v.tilesJSONReady||(sysproInterop.storeData("tilesJSON",JSON.stringify(t)),v.tilesJSONReady=!0),a},// Parse display, entry and link fields, getting them in a structure suitable for the drill down menu UI
processDataWidgetFields:function processDataWidgetFields(e){function dataFieldsParser(e,t,o){var n=v.getPropertyValue(e,"KeyAction"),d=n?n:v.getPropertyValue(e,"FieldName")?v.getPropertyValue(e,"FieldName"):t,s=v.getCaption(e)[0],l=v.getCaption(e)[2],r=v.getPropertyValue(e,"HasSmartTag"),c=v.getPropertyValue(e,"EntryType"),p=v.getPropertyValue(e,"DataType"),u=d.split(" ").join("_"),m="",g;return"0"===c?g="Standard text entry field":"1"===c?g="Standard text entry field":"2"===c?g="Date entry field":"3"===c?g="Email entry field":"4"===c?g="Password entry field":"5"===c?g="Long/paragraph text entry field":"6"===c?g="Checkbox":"7"===c?g="Radio button":"8"===c?g="Dropdown":"9"===c?g="Dropdown multiple select":"10"===c?g="Browse":"11"===c?g="Slider":"12"===c?g="Dropdown editable":void 0,m+="<li class=\"list-group-item quickAddDataWidget field-name\" id=\""+u+"\" data-bind=\"dataPath: selected.FieldPath\" data-field-path=\"Fields."+d+"\" data-smart-tag=\""+r+"\" data-key-action=\""+n+"\" data-data-type=\""+p+"\" data-entry-type=\""+c+"\" data-type-name=\""+o+"\" data-description=\""+s+"\"><i class=\"material-icons text-primary quickAddDragHandle\">open_with</i> ",null!==g&&""!==g&&void 0!==g&&(m+="<i class=\"material-icons text-info\" data-tooltip=\"tooltip\" data-placement=\"right\" data-original-title=\""+g+"\">info</i> "),m+=s+"<span class=\"btn btn-xs btn-primary pull-right quickAddEntryField sys-pd-l-5 sys-pd-r-5\">Quick add</span></li>",s&&!v.fieldsSearchReady&&a.push({fieldpath:"Fields."+d,smarttag:r,datatype:p,name:l}),m}var t="",a=[];for(var o in e)if(e.hasOwnProperty(o)){var n=void 0,d=void 0;for(var s in"LinksAvailable"===o?(n="Links",d="LinkWidget"):"EntryFields"===o?(n="Entry Fields",d="EntryDataWidget"):"DisplayFields"===o&&(n="Display Fields",d="DataWidget"),t+="<li class=\"list-group-item "+o+"Section\"><a href=\"#\">"+n.replace(/_/g," ")+"</a><ul class=\"list-group\">",e[o])if(e[o].hasOwnProperty(s)){if(t+="<li class=\"list-group-item\"><a href=\"#\">"+s.replace(/_/g," ")+"</a><ul class=\"list-group\">",e[o][s].hasOwnProperty("KeyAction")||e[o][s].hasOwnProperty("Caption")||e[o][s].hasOwnProperty("FieldName"))t+=dataFieldsParser(e[o][s],null,d);else for(var l in e[o][s])e[o][s].hasOwnProperty(l)&&(t+=dataFieldsParser(e[o][s][l],l,d));t+="</ul>"}t+="</ul>"}// Set up fields auto-complete search
return v.fieldsSearchReady||($("#dataWindow .typeahead-fields, #dataEditWindow .typeahead-fields").typeahead({source:a,autoSelect:!0,afterSelect:v.selectFieldFromSearch}),v.fieldsSearchReady=!0),t+="<li class=\"divider\">or</li><li data-bind=\"dataPath: selected.FieldPath\" class=\"list-group-item field-name freeTextDataField\" data-field-path=\"freeTextDataField\" data-data-type=\"T\">Free text field</li><li data-bind=\"dataPath: selected.FieldPath\" class=\"OffCanvasLink list-group-item field-name\" data-field-path=\"OffCanvasLink\" data-type-name=\"ButtonWidget\">Off-canvas section</li>",t},processToolbarWidgetFields:function processToolbarWidgetFields(e){// Helper function for parsing toolbar widgets
function parseToolbarWidgets(e){var t=v.getPropertyValue(e,"FieldName"),a=v.getPropertyValue(e,"ActionType"),o=v.getCaption(e)[0],n=v.getCaption(e)[1],d=v.getCaption(e)[2],s=v.getPropertyValue(e,"Icon"),l=v.getPropertyValue(e,"Tooltip"),r=n.split(" ").join("_"),c="";return c+="<li class=\"list-group-item field-name","(TOOLBAR GROUP)"===o&&(c+=" toolbar-group-heading"),c+="\" id=\""+r+"\" data-bind=\"toolbarFieldName: selected.FieldName\" data-field-name=\"Toolbar."+t+"\" data-toolbar-widget-type=\""+a+"\" data-toolbar-icon=\""+s+"\" data-caption=\""+n+"\" data-shortcaption=\""+d+"\" data-toolbar-tooltip=\""+l+"\">",s&&(c+="<i class=\"material-icons text-primary\">"+s+"</i> "),c+=o+"<span class=\"btn btn-xs btn-primary pull-right quickAddEntryField sys-pd-l-5 sys-pd-r-5\">Quick add</span></li>",c}var t="";// Parse toolbar actions, getting them in a structure suitable for the drill down menu UI
for(var a in e)if(e.hasOwnProperty(a)){if(t+="<li class=\"list-group-item "+a+"Section\"><a href=\"#\">"+a.replace(/_/g," ")+"</a><ul class=\"list-group\">",Array.isArray(e[a]))for(var o in e[a])e[a].hasOwnProperty(o)&&(t+=parseToolbarWidgets(e[a][o]));else t+=parseToolbarWidgets(e[a]);t+="</ul>"}return t+="<li class=\"divider\">or</li><li class=\"list-group-item field-name\" id=\"ToolbarDropdown\" data-bind=\"toolbarFieldName: selected.TypeName\" data-field-name=\"ToolbarDropdown\" data-toolbar-widget-type=\"4\" data-toolbar-icon=\"\" data-caption=\"Dropdown Menu\" data-toolbar-tooltip=\"\">Dropdown Menu</li><li class=\"list-group-item field-name\" id=\"ToolbarSubDropdown\" data-bind=\"toolbarFieldName: selected.TypeName\" data-field-name=\"ToolbarSubDropdown\" data-toolbar-widget-type=\"4\" data-toolbar-icon=\"\" data-caption=\"Dropdown Sub-menu\" data-toolbar-tooltip=\"\">Dropdown Sub-menu</li><li class=\"list-group-item field-name\" id=\"OffCanvasToolbarItem\" data-bind=\"toolbarFieldName: selected.FieldName\" data-field-name=\"ButtonWidget\" data-toolbar-widget-type=\"0\" data-toolbar-icon=\"\" data-caption=\"Off-Canvas Section\" data-toolbar-tooltip=\"\">Off-canvas section</li>",t},processChartWidgetFields:function processChartWidgetFields(e){var t="";// Parse charts, getting them in a structure suitable for the drill down menu UI
for(var n in e)if(e.hasOwnProperty(n)){var a=e[n],o=v.getPropertyValue(a,"Category");if("Charts"===o){var d=n,s=v.getCaption(a)[0],l=d.split(" ").join("_");t+="<a class=\"list-group-item field-name",t+="\" id=\""+l+"\" data-bind=\"dataPath: selected.FieldPath\" data-field-path=\"Fields."+d+"\">"+s+"</a>"}}return t},// Process tile options
processTileOptions:function processTileOptions(e,t){function processIndividualTileOptions(t){var o="",n="";if(void 0!==e[t]&&e[t].hasOwnProperty("Parameter")){if(a+="<div class=\""+t+"Parameters tile-parameter-wrapper\" style=\"display:none;\">",e[t].Parameter.length)for(var r=0;r<e[t].Parameter.length;r++)e[t].Parameter[r].ParamName=e[t].Parameter[r].ParamName||e[t].Parameter[r].SysproKeyColumn,e[t].Parameter[r].ParamDescription=e[t].Parameter[r].ParamDescription||e[t].Parameter[r].SysproKeyColumn||e[t].Parameter[r].ParamName,""!==e[t].Parameter[r].SysproKeyColumn&&void 0!==e[t].Parameter[r].SysproKeyColumn&&null!==e[t].Parameter[r].SysproKeyColumn?"A"===e[t].Parameter[r].ParamType?(o+="<p class=\"tile-text-option-label\">"+e[t].Parameter[r].ParamDescription+"</p>",o+="<div class=\"form-group\"><input data-bind=\"value: selected.Widgets[0].TileParameters."+e[t].Parameter[r].ParamName+"\" type=\"text\" class=\"form-control\" name=\""+e[t].Parameter[r].ParamName+"\" id=\""+e[t].Parameter[r].ParamName+"\" autocomplete=\"off\" placeholder=\"\"></div>"):"L"===e[t].Parameter[r].ParamType&&(o+="<p class=\"tile-list-option-label\">"+e[t].Parameter[r].ParamDescription+"</p>",o+="<div class=\"form-group\"><select data-bind=\"value: selected.Widgets[0].TileParameters."+e[t].Parameter[r].ParamName+"\" class=\"form-control dropdown-select\" name=\""+e[t].Parameter[r].ParamName+"\" id=\""+e[t].Parameter[r].ParamName+"\" autocomplete=\"off\">",$.each(e[t].Parameter[r].ParamOptions.ParamOption,function(e,t){o+="<option value=\""+t+"\">"+t+"</option>"}),o+="</select></div>"):"A"===e[t].Parameter[r].ParamType?(n+="<p class=\"tile-text-option-label\">"+e[t].Parameter[r].ParamDescription+"</p>",n+="<div class=\"form-group\"><input data-bind=\"value: selected.Widgets[0].TileParameters."+e[t].Parameter[r].ParamName+"\" type=\"text\" class=\"form-control\" name=\""+e[t].Parameter[r].ParamName+"\" id=\""+e[t].Parameter[r].ParamName+"\" autocomplete=\"off\" placeholder=\"\"></div>"):"L"===e[t].Parameter[r].ParamType&&(n+="<p class=\"tile-list-option-label\">"+e[t].Parameter[r].ParamDescription+"</p>",n+="<div class=\"form-group\"><select data-bind=\"value: selected.Widgets[0].TileParameters."+e[t].Parameter[r].ParamName+"\" class=\"form-control dropdown-select\" name=\""+e[t].Parameter[r].ParamName+"\" id=\""+e[t].Parameter[r].ParamName+"\" autocomplete=\"off\">",$.each(e[t].Parameter[r].ParamOptions.ParamOption,function(e,t){n+="<option value=\""+t+"\">"+t+"</option>"}),n+="</select></div>");else e[t].Parameter.ParamName=e[t].Parameter.ParamName||e[t].Parameter.SysproKeyColumn,e[t].Parameter.ParamDescription=e[t].Parameter.ParamDescription||e[t].Parameter.SysproKeyColumn||e[t].Parameter.ParamName,""!==e[t].Parameter.SysproKeyColumn&&void 0!==e[t].Parameter.SysproKeyColumn&&null!==e[t].Parameter.SysproKeyColumn?"A"===e[t].Parameter.ParamType?(o+="<p class=\"tile-text-option-label\">"+e[t].Parameter.ParamDescription+"</p>",o+="<div class=\"form-group\"><input data-bind=\"value: selected.Widgets[0].TileParameters."+e[t].Parameter.ParamName+"\" type=\"text\" class=\"form-control\" name=\""+e[t].Parameter.ParamName+"\" id=\""+e[t].Parameter.ParamName+"\" autocomplete=\"off\" placeholder=\"\"></div>"):"L"===e[t].Parameter.ParamType&&(o+="<p class=\"tile-list-option-label\">"+e[t].Parameter.ParamDescription+"</p>",o+="<div class=\"form-group\"><select data-bind=\"value: selected.Widgets[0].TileParameters."+e[t].Parameter.ParamName+"\" class=\"form-control dropdown-select\" name=\""+e[t].Parameter.ParamName+"\" id=\""+e[t].Parameter.ParamName+"\" autocomplete=\"off\">",$.each(e[t].Parameter.ParamOptions.ParamOption,function(e,t){o+="<option value=\""+t+"\">"+t+"</option>"}),o+="</select></div>"):"A"===e[t].Parameter.ParamType?(n+="<p class=\"tile-text-option-label\">"+e[t].Parameter.ParamDescription+"</p>",n+="<div class=\"form-group\"><input data-bind=\"value: selected.Widgets[0].TileParameters."+e[t].Parameter.ParamName+"\" type=\"text\" class=\"form-control\" name=\""+e[t].Parameter.ParamName+"\" id=\""+e[t].Parameter.ParamName+"\" autocomplete=\"off\" placeholder=\"\"></div>"):"L"===e[t].Parameter.ParamType&&(n+="<p class=\"tile-list-option-label\">"+e[t].Parameter.ParamDescription+"</p>",n+="<div class=\"form-group\"><select data-bind=\"value: selected.Widgets[0].TileParameters."+e[t].Parameter.ParamName+"\" class=\"form-control dropdown-select\" name=\""+e[t].Parameter.ParamName+"\" id=\""+e[t].Parameter.ParamName+"\" autocomplete=\"off\">",$.each(e[t].Parameter.ParamOptions.ParamOption,function(e,t){n+="<option value=\""+t+"\">"+t+"</option>"}),n+="</select></div>");if(""!==o){var d=sysproInterop.generateUUID(),s=sysproInterop.generateUUID(),l=sysproInterop.generateUUID();a+=o,a+="<div class=\"panel-group\" id=\""+d+"\" role=\"tablist\" aria-multiselectable=\"true\"><div class=\"panel sys-widget sys-box-shadow-off\"><h4 class=\"sys-mg-off\" role=\"tab\" id=\""+l+"\"><a class=\"sys-fg-lighten panel-heading sys-block sys-bg-white sys-fg-inverse  collapsed\" data-toggle=\"collapse\" data-parent=\"#"+d+"\" href=\"#"+s+"\" ariaexpanded=\"false\" aria-controls=\""+s+"\">Additional parameters <i class=\"material-icons pull-right collapsible-open-icon\">keyboard_arrow_down</i><i class=\"material-icons pull-right collapsible-close-icon\">keyboard_arrow_up</i></a></h4><div class=\"panel-collapse collapse \" id=\""+s+"\" role=\"tabpanel\" aria-labelledby=\""+l+"\"><div class=\"panel-body sys-block sys-box-shadow-off sys-pd-off\"><div class=\"row sys-tbl\" data-row=\"0\"><div class=\"col-xs-12 sys-bg-white \">",a+=n,a+="</div></div></div></div></div></div>"}else a+=n;a+="</div>"}}var a="";if(t)processIndividualTileOptions(t);else for(var o in e)processIndividualTileOptions(o);return a},// initialise date pickers
initDatePicker:function initDatePicker(e){$(e+" .date").datepicker({format:sysproInterop.dateFormat.toLowerCase(),maxViewMode:2,todayBtn:!0,autoclose:!0,todayHighlight:!0,zIndexOffset:1e6})},// Initialise layout widget selection events
initLayoutWidgetEvents:function initLayoutWidgetEvents(){// open/close select
// clicking the options
v.layoutWidgetSelectOptions=[].slice.call(v.layoutWidgetSelect.find("li.widget-option-tab-li")),v.currentLayoutWidgetOption=-1,v.layoutWidgetSelectPlaceholder=v.layoutWidgetSelect.find("span.cs-placeholder"),v.layoutWidgetSelectPlaceholder.off().on("click",function(){v.toggleLayoutWidgetSelect()}),$.each(v.layoutWidgetSelectOptions,function(e,t){$(t).off().on("click",function(){// close select elem
v.currentLayoutWidgetOption=e,v.changeLayoutWidgetOption(),v.toggleLayoutWidgetSelect()})})},// open/close layout widget select; when opened show the default placeholder if any
toggleLayoutWidgetSelect:function toggleLayoutWidgetSelect(){v.layoutWidgetSelect.hasClass("cs-active")&&-1!==v.currentLayoutWidgetOption&&(v.layoutWidgetSelectPlaceholder.textContent=v.layoutWidgetSelectOptions[v.currentLayoutWidgetOption].textContent),v.layoutWidgetSelect.toggleClass("cs-active")},// change layout widget option - the new value is set
changeLayoutWidgetOption:function changeLayoutWidgetOption(){// current option
var e=v.layoutWidgetSelectOptions[v.currentLayoutWidgetOption];// update current selected value
v.layoutWidgetSelectPlaceholder.text($(e).text());// remove class cs-selected from old selected option and add it to current selected option
var t=v.layoutWidgetSelect.find("li.cs-selected");t&&$(t).removeClass("cs-selected"),$(e).addClass("cs-selected")},// Helper function to set correct colour on colour pickers
setColourPicker:function setColourPicker(e){$(e+" .colour-picker-dot").each(function(){var e=this,t=$(e).next(".colour-group-wrap"),a=t.find(".colour-group"),o;if(0<a.find("input[type='radio']:checked").length){var n=a.find("input[type='radio']:checked").parent("label").attr("class").split(/\s+/);$.each(n,function(e,t){t.includes("sys-bg-")&&(o=t)})}o?$(e).addClass(o):$(e).addClass("sys-bg-primary")})},// Get current off-canvas or main parent layout id
setContext:function setContext(e){var t=$(e).parents(".navbar-offcanvas").length?$(e).parents(".navbar-offcanvas").attr("id").split("offcanvas-")[1]:$(e).parents(".k-window").length?$(e).parents(".k-window-content").attr("id").split("offcanvas-")[1]:0,a=!!$(e).parents(".tab-pane").length&&$(e).parents("[data-displaystyle=\"TabControl\"]"),o=0===t?b.dataSource:b.OffCanvasLayouts["offcanvas-"+t].Columns,n=a?o.get(a.attr("data-guid")):null,d=n?n.Tabs// ? currentParentDataSource
:o,s=$(e).closest(".draggable-row-section").data("guid"),l=s?d.get(s):null,r=0===t?b.toolbar:b.OffCanvasLayouts["offcanvas-"+t].MainToolbar.Columns,c=$(e).parents(".main-column"),p=parseInt($(e).closest("ul.nav")&&$(e).closest("ul.nav").length?$(e).closest("ul.nav").data("column"):$(c[c.length-1]).data("column")),u=a?$(e).closest(".main-column").data("column"):null,m;m=0===t?n?$("div[data-guid=\""+n.Id+"\"] div[data-column=\""+u+"\"] .draggable-row-section").index($("div[data-guid=\""+s+"\"]")):$("#wrapper [id^=\"main_column\"][data-column=\""+p+"\"] > .sortable-list > .draggable-row-section").index($("div[data-guid=\""+s+"\"]")):n?$("#offcanvas-"+t+" div[data-guid=\""+n.Id+"\"] div[data-column=\""+u+"\"] .draggable-row-section").index($("div[data-guid=\""+s+"\"]")):$("#offcanvas-"+t+" div[data-column=\""+p+"\"] > .sortable-list > .draggable-row-section").index($("div[data-guid=\""+s+"\"]"));var g=$(e).closest(".row").data("row"),h=parseInt($(e).hasClass("data-section")?$(e).data("section")||0:$(e).parent(".data-section").data("section")||0);return{canvas_id:t,parentTabWidgetPresent:!1!==a,currentDataSource:d,currentParentDataSource:o,parentTabWidget:n,currentToolbarDataSource:r,column_num:p,layoutWidgetGuid:s,targetLayoutWidget:l,tab_column_num:u,widget_index:m,row_num:g,section_num:h}},// Helper function to set correct colour picker dot colour in tile Windows
setColourPickerDotColour:function setColourPickerDotColour(e,t,a){if([0,1,2,3,4,7,8].includes(parseInt($(t).val()))){$(e+" "+a+" .btn-radio").each(function(){$(this).toggleClass("disabled",!$(this).hasClass("sys-bg-white")),$(this).toggleClass("active",$(this).hasClass("sys-bg-white")),$(this).find("input").prop("checked",$(this).hasClass("sys-bg-white"))});var o=$(t).closest(".col-xs-6").siblings(".col-xs-6").find(".colour-picker-dot"),n=o.attr("class").match(/\bsys-bg\S+/g)[0];o.removeClass(n).addClass("sys-bg-white")}else if([5,9].includes(parseInt($(t).val()))){$(e+" "+a+" .btn-radio.sys-bg-white").addClass("disabled"),$(e+" "+a+" .btn-radio.sys-bg-white").addClass("disabled"),$(e+" "+a+" .btn-radio").each(function(){$(this).hasClass("sys-bg-white")||$(this).hasClass("sys-bg-very-light-gray")?($(this).addClass("disabled"),$(this).removeClass("active"),$(this).find("input").prop("checked",!1)):($(this).removeClass("disabled"),$(e+" "+a+" .btn-radio.sys-bg-inverse").find("input").prop("checked",!0),$(e+" "+a+" .btn-radio.sys-bg-inverse").addClass("active"))});var d=$(t).closest(".col-xs-6").siblings(".col-xs-6").find(".colour-picker-dot"),s=d.attr("class").match(/\bsys-bg\S+/g)[0];d.removeClass(s).addClass("sys-bg-inverse")}else $(e+" "+a+" .btn-radio").removeClass("disabled")},// Helper function to build treeviews for hierarchical datasource initialisation
createInvisibleTreeView:function createInvisibleTreeView(e,t){$("<div id='"+e+"'></div>").appendTo("#invisibleNodes"),v.invisibleTreeViews[e]=$("#"+e).kendoTreeView({dataSource:t,loadOnDemand:!1})},// Destroy all treeview Kendo widgets
destroyTreeViews:function destroyTreeViews(){for(var e in v.invisibleTreeViews)v.destroyTreeView(e)},destroyTreeView:function destroyTreeView(e){var t=$("#"+e).data("kendoTreeView");t&&t.destroy(),delete v.invisibleTreeViews[e],$("#"+e).remove()},//Regenerate all treeviews
regenerateTreeViews:function regenerateTreeViews(){for(var e in v.createInvisibleTreeView("invisibleNode",b.dataSource),v.createInvisibleTreeView("invisibleToolbarNode",b.toolbar),b.OffCanvasLayouts)e.includes("offcanvas")&&(v.createInvisibleTreeView("OC_"+b.OffCanvasLayouts[e].Id,b.OffCanvasLayouts[e].Columns),v.createInvisibleTreeView("OCT_"+b.OffCanvasLayouts[e].Id,b.OffCanvasLayouts[e].MainToolbar.Columns));// TODO: find tab widgets to regenerate treeviews...
$("[data-displaystyle='TabControl']").each(function(e,t){if(0===$(t).closest(".layout-widget-preview").length){var a=$(t).attr("data-guid"),o=$(t).parents(".navbar-offcanvas").length?$(t).parents(".navbar-offcanvas").attr("id").split("offcanvas-")[1]:$(t).parents(".k-window").length?$(t).parents(".k-window-content").attr("id").split("offcanvas-")[1]:0,n=0===o?b.dataSource:b.OffCanvasLayouts["offcanvas-"+o].Columns,d=n.get(a);v.createInvisibleTreeView("TABS_"+a,d.Tabs)}})},// Size add on buttons
sizeAddonButtons:function sizeAddonButtons(){$(".additional-input-button").each(function(){var e=$(this).width(),t=$(this).find(".input-group").length?$(this).find(".input-group"):$(this).find("input"),a=t.width(),o=$(this).find(".btn.btn-sm.btn-default"),n=o.textWidth()+18;e<=126+n?(o.css("width","100%"),o.css("margin-left","0px"),t.width("100%"),t.css("width","100%")):(o.width(n-18),o.css("margin-left","5px"),t.width(e-n-10))})},// Create a Kendo UI diagram
createDiagram:function createDiagram(e,t,a){function updateShapeProperties(e){$(".shapeBackgroundColorPicker",t).getKendoColorPicker().value(kendo.parseColor(e.dataItem.Color))}function updateConnectionProperties(e){$("input.connectionStartCap",t).getKendoDropDownList().value(e.startCap),$("input.connectionEndCap",t).getKendoDropDownList().value(e.endCap)}var o=v.localDataSource({data:e.shapesData||[],schema:{model:{id:"Id",fields:{Id:{type:"string",editable:!1},Title:{type:"string"},Program:{type:"string",parse:function parse(e){return"string"==typeof e?{Name:e}:"string"==typeof e.Name?e:{Name:"Select program"}}},Color:{type:"string"},path:{type:"string"},x:{type:"number"},y:{type:"number"},width:{type:"number"},height:{type:"number"}}}}}),n=v.localDataSource({data:e.connectionsData||[],schema:{model:{id:"Id",fields:{Id:{type:"string",editable:!1},from:{type:"string"},to:{type:"string"}}}}});return $(a?".diagramEdit":".diagram",t).kendoDiagram({theme:"default",dataSource:o,connectionsDataSource:n,shapeDefaults:{visual:v.visualTemplate,width:120,height:120,fill:"#ecf0f1",editable:!!a&&{tools:[{name:"edit",icon:"pencil"},{name:"delete",icon:"trash"}]}},connectionDefaults:{stroke:{color:"#2c3e50",width:2},type:"cascading",endCap:"ArrowEnd",editable:!!a&&{tools:[{name:"delete"}]}},layout:e.layout,editable:!!a&&{resize:!1,rotate:!1,tools:[{}],shapeTemplate:function shapeTemplate(e){return kendo.template($("#programEditTemplate").html())(e)}},select:!!a&&function(t){if(t.selected.length){v.diagramSelected=t.selected;var e=t.selected[0];e instanceof kendo.dataviz.diagram.Shape?updateShapeProperties(e):updateConnectionProperties(e.options)}},click:!a&&function(t){t.item instanceof kendo.dataviz.diagram.Shape?sysproInterop.runProgramInSYSPRO(t.item.dataItem.Program.Name,t.item.dataItem.Program.Type,t.item.dataItem.Program.Description,t.item.dataItem.Program.SubType):console.log("Clicked a connection.")},edit:function edit(t){v.diagramActiveItem=t.shape,v.diagramActiveItemProgram=t.shape.Program},zoom:.8,dataBound:function(){this.bringIntoView(this.shapes)}}).data("kendoDiagram")},// Return a Kendo Diagram shape from given options
visualTemplate:function visualTemplate(e){var t=kendo.dataviz,a=new t.diagram.Group,o=e.dataItem,n=o.Title,d=o.Subtitle||"",s=o.Program.Name,l=o.Program.Type,r=o.Clickable,c,p,u,m,g;if(a.drawingElement.options.tooltip={content:s+" ("+l+") - "+d,shared:!0},"circle"===o.type)a.append(new t.diagram.Circle({width:o.width||120,height:o.height||120,stroke:{width:0},fill:{color:o.Color||"#ecf0f1"}}));else if(null!==o.path&&void 0!==o.path)switch(a.append(new kendo.dataviz.diagram.Path({data:o.path,stroke:{width:0},fill:o.Color||"#ecf0f1"})),o.shapeName){case"data":c=35,p=25,u=25,m=55,g=100;break;case"decision":c=25,p=40,u=25,m=55,g=100;break;case"delay":c=15,p=25,u=15,m=55,g=80;break;case"display":c=25,p=30,u=25,m=55,g=120;break;case"document":c=15,p=25,u=15,m=50,g=120;break;case"manualinput":c=15,p=30,u=15,m=60,g=120;break;case"manualoperation":c=25,p=25,u=25,m=55,g=100;break;case"merge":n=(_readOnlyError("dataItemTitle"),""),s=(_readOnlyError("dataItemProgram"),"");break;case"or":n=(_readOnlyError("dataItemTitle"),""),s=(_readOnlyError("dataItemProgram"),"");break;case"preparation":c=25,p=25,u=25,m=55,g=110;break;case"process":c=15,p=25,u=15,m=55,g=120;break;case"octagon":c=20,p=20,u=20,m=40,g=120;break;default:}else a.append(new t.diagram.Rectangle({width:o.width||200,height:o.height||100,stroke:{width:0},fill:o.Color||"#ecf0f1"}));var h=new t.diagram.Layout(new t.diagram.Rect(c||15,p||15,120,50),{alignContent:"start",spacing:4});a.append(h);for(var f=n.split(" "),y=0;y<f.length;y++)h.append(new t.diagram.TextBlock({text:f[y],fill:"#fff"}));return h.reflow(),r&&a.append(new t.diagram.Image({source:"../../../img/openProgram.png",x:3,y:3,width:18,height:18})),a},// Helper function to create local data source for Kendo UI diagram
localDataSource:function localDataSource(e){var t=e.schema.model.id,a=e.data,o=new kendo.data.DataSource($.extend(!0,{transport:{read:function read(t){n={},d={},s={},t.success(a||[])},update:function update(a){var e=a.data;n[e[t]]||(d[e[t]]=e),a.success()},destroy:function destroy(a){var e=a.data[t];n[e]?delete n[e]:s[e]=a.data,a.success()},create:function create(a){var e=a.data;e[t]=sysproInterop.generateUUID(),n[e[t]]=$.extend(!0,{},e),a.success(e)}}},e)),n,d,s;return o.getChanges=function(){return{deleted:v.toArray(s),created:v.toArray(n),updated:v.toArray(d)}},o},toArray:function toArray(e){var t=[];for(var a in e)t.push(e[a]);return t},setupExpandableCard:function setupExpandableCard(t){function slideFade(e){e.css({opacity:0,marginLeft:"-200%"})}function slideInFade(e){e.css({opacity:1,marginLeft:"0%"})}function expandFade(e){e.css({opacity:1,height:o+"px"})}function shrinkFade(e){e.css({opacity:0,height:"0px"})}//const miniViewHeight = $(card).find(".miniView").outerHeight();
var a=$(t).find(".card-bindable").outerHeight(),o=$(t).find(".expandedView").outerHeight();$(t).find(".expandedView").css("height","0px"),$(t).find(".expandedView").css("display","block"),$(t).find(".card-bindable").css("minHeight",a),$(t).find(".expand-card").off("click").on("click",function(t){t.preventDefault(),slideFade($(this).closest(".miniView"))}),$(t).find(".shrink-card").off("click").on("click",function(t){t.preventDefault(),shrinkFade($(this).closest(".expandedView"))}),$(t).find(".miniView").off("transitionend webkitTransitionEnd oTransitionEnd").on("transitionend webkitTransitionEnd oTransitionEnd",function(t){"opacity"===t.originalEvent.propertyName&&0==$(this).css("opacity")&&(expandFade($(this).siblings(".expandedView")),$(this).css("height","0px"))}),$(t).find(".expandedView").off("transitionend webkitTransitionEnd oTransitionEnd").on("transitionend webkitTransitionEnd oTransitionEnd",function(a){"opacity"===a.originalEvent.propertyName&&0==$(this).css("opacity")&&($(t).find(".miniView").css("height","auto"),slideInFade($(this).siblings(".miniView")))})},lightenDarkenColour:function lightenDarkenColour(e,t){function rgbToHex(e){if(e=""+e,e&&!(0>e.indexOf("rgb"))){if("#"==e.charAt(0))return e;var t=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(e),a=parseInt(t[2],10).toString(16),o=parseInt(t[3],10).toString(16),n=parseInt(t[4],10).toString(16);return"#"+((1==a.length?"0"+a:a)+(1==o.length?"0"+o:o)+(1==n.length?"0"+n:n))}}e=rgbToHex(e);var a=!1;"#"==e[0]&&(e=e.slice(1),a=!0);var o=parseInt(e,16),n=(o>>16)+t;255<n?n=255:0>n&&(n=0);var d=(255&o>>8)+t;255<d?d=255:0>d&&(d=0);var s=(255&o)+t;return 255<s?s=255:0>s&&(s=0),(a?"#":"")+(s|d<<8|n<<16).toString(16)},// Prototype analytics
// initialiseTracking: function() {
//     if (!sysproInterop.hasOwnProperty('analytics')) {
//         sysproInterop.analytics = [];
//     }
//     var avantiAnalyticsInit = JSON.parse(localStorage.getItem('avantiAnalytics'));
//     localStorage.setItem('avantiAnalytics', avantiAnalyticsInit ? JSON.stringify(avantiAnalyticsInit) : JSON.stringify([]));
//     function logEvent(event, extra) {
//         console.log('event logged');
//         console.log(event, extra);
//         var avantiAnalytics = JSON.parse(localStorage.getItem('avantiAnalytics'));
//         const analyticsEvent = {
//             ...extra,
//             session: callLayerInterop.sessionId,
//             user: sysproInterop.currentUserSession.Operator,
//             type: event.type,
//             timeStamp: event.timeStamp,
//             timeSinceLastEvent:
//                 avantiAnalytics.length > 1
//                     ? avantiAnalytics[avantiAnalytics.length - 1].timeStamp -
//                       avantiAnalytics[avantiAnalytics.length - 2].timeStamp
//                     : null,
//             // timeSinceLastEvent:
//             //     sysproInterop.analytics.length > 1
//             //         ? sysproInterop.analytics[sysproInterop.analytics.length - 1].timeStamp -
//             //           sysproInterop.analytics[sysproInterop.analytics.length - 2].timeStamp
//             //         : null,
//         };
//         if (avantiAnalytics.length > 250) avantiAnalytics.shift();
//         avantiAnalytics.push(analyticsEvent);
//         localStorage.setItem('avantiAnalytics', JSON.stringify(avantiAnalytics));
//         // if (sysproInterop.analytics.length > 250) sysproInterop.analytics.shift();
//         // sysproInterop.analytics.push(analyticsEvent);
//     }
//     function getCurrentProgram() {
//         if ( $("#navbar-toolbar").find('[data-original-title="Show Favorites"]').length > 0 ) {
//             return "IMPMEN";
//         }
//         return callLayerInterop.programName;
//     }
//     $(document).off('click', '[data-sysproprogramname]', trackFunction1).on('click', '[data-sysproprogramname]', trackFunction1);
//     function trackFunction1(event) {
//         const extra = {
//             programLink: $(this).data('sysproprogramname') ? $(this).data('sysproprogramname') : null,
//             currentProgram: getCurrentProgram(),
//         };
//         logEvent(event, extra);
//     };
//     $(document).off('click', '[data-tiletype="Program"]', trackFunction2).on('click', '[data-tiletype="Program"]', trackFunction2);
//     function trackFunction2(event) {
//         const extra = {
//             programLink: $(this).data('parentfieldpath') ? $(this).data('parentfieldpath') : null,
//             currentProgram: getCurrentProgram(),
//         };
//         logEvent(event, extra);
//     };
//     $(document).off('click', '.navbar-brand', trackFunction3).on('click', '.navbar-brand', trackFunction3);
//     function trackFunction3(event) {
//         const extra = {
//             programLink: 'home',
//             currentProgram: getCurrentProgram(),
//         };
//         logEvent(event, extra);
//     };
//     $(document).off('click', '.fusion-maininstance-buttons:not(".offcanvas-toggle")', trackFunction4).on('click', '.fusion-maininstance-buttons:not(".offcanvas-toggle")', trackFunction4);
//     function trackFunction4(event) {
//         const extra = {
//             programLink: 'home',
//             currentProgram: getCurrentProgram(),
//         };
//         logEvent(event, extra);
//     };
//     $(document).on('click', '[data-fieldvalue]', function(event) {
//         const extra = {
//             modalOpen: $(this).data('fieldvalue') ? $(this).data('fieldvalue') : null,
//             modalName: $(this).text().trim(),
//             currentProgram: getCurrentProgram(),
//         };
//         logEvent(event, extra);
//     });
//     $(document).on('click', '[data-keyaction]', function(event) {
//         const extra = {
//             modalOpen: $(this).data('keyaction') ? $(this).data('keyaction') : null,
//             modalName: $(this).find(".data-content-wrapper").text().trim(),
//             currentProgram: getCurrentProgram(),
//         };
//         logEvent(event, extra);
//     });
//     $(document).on('click', '[data-toggle="offcanvas"]', function(event) {
//         const extra = {
//             modalOpen: $(this).data('target') ? $(this).data('target') : null,
//             modalName: $(this).text().trim(),
//             currentProgram: getCurrentProgram(),
//         };
//         logEvent(event, extra);
//     });
// },
// Display AI next step suggestions
// showSmartSuggestions: function () {
//     function getCurrentProgram() {
//         if ( $("#navbar-toolbar").find('[data-original-title="Show Favorites"]').length > 0 ) {
//             return 'IMPMEN';
//         }
//         return callLayerInterop.programName;
//     }
//     function getTopModal(program) {
//         console.log('getTopModal: ', program);
//         var modalList = [];
//         var avantiAnalytics = JSON.parse(localStorage.getItem('avantiAnalytics'));
//         console.log(avantiAnalytics);
//         // sysproInterop.analytics.forEach(function(event, idx) {
//         avantiAnalytics.forEach(function(event, idx) {
//             console.log(event);
//             if (event.modalOpen && event.currentProgram === program) {
//                 console.log('found one!');
//                 modalList.push({ modalName: event.modalName, modalOpen: event.modalOpen });
//             }
//         });
//         console.log(modalList);
//         return modalList.sort((a,b) =>
//             modalList.filter(v => v.modalName === a.modalName).length
//             - modalList.filter(v => v.modalName === b.modalName).length
//         ).pop();
//     }
//     function getTopProgram(program) {
//         var programList = [];
//         var avantiAnalytics = JSON.parse(localStorage.getItem('avantiAnalytics'));
//         // sysproInterop.analytics.forEach(function(event, idx) {
//         avantiAnalytics.forEach(function(event, idx) {
//             if (event.programLink && event.currentProgram === program) {
//                 programList.push(event.programLink);
//             }
//         });
//         return programList.sort((a,b) =>
//             programList.filter(v => v === a).length
//             - programList.filter(v => v === b).length
//         ).pop();
//     }
//     function getMostPopularProgram() {
//         var avantiAnalytics = JSON.parse(localStorage.getItem('avantiAnalytics'));
//         return avantiAnalytics
//             .reduce(
//                 function(acc, val) {
//                     var o = acc.filter(
//                         function(obj) {
//                             return obj.currentProgram == val.currentProgram;
//                         }).pop() || { currentProgram: val.currentProgram, timeSinceLastEvent:0 };
//                     o.timeSinceLastEvent += val.timeSinceLastEvent;
//                     acc.push(o);
//                     return acc;
//                 },[])
//             .filter(
//                 function(itm, i, a) {
//                     return i == a.indexOf(itm);
//                 })
//             .reduce(function(prev, current) { 
//                 return prev.y > current.y ? prev : current;
//             });
//     }
//     console.log(getTopModal(getCurrentProgram()), getTopProgram(getCurrentProgram()));
//     var popModal = getTopModal(getCurrentProgram());
//     var popProgram = getTopProgram(getCurrentProgram());
//     var mostPopProgram = getMostPopularProgram();
//     SYSPRO_VB.aiSuggestionNotification.show(
//         {
//             title: "New E-mail",
//             message: "You have 1 new mail message! here is some other content and so on",
//             suggestions: [
//                 {
//                     icon: {
//                         colour: "#388E3C",
//                         name: "assessment",
//                     },
//                     title: popModal.modalName,
//                     message: "Most opened Modal window in this program ...",
//                     link: popModal.modalOpen,
//                 },
//                 {
//                     icon: {
//                         colour: "#303F9F",
//                         name: "account_box",
//                     },
//                     title: popProgram,
//                     message: "Most popular next program...",
//                     link: "#",
//                 },
//                 {
//                     icon: {
//                         colour: "#C2185B",
//                         name: "store_mall_directory",
//                     },
//                     title: mostPopProgram.currentProgram,
//                     message: "Most popular program overall by time",
//                     link: "#",
//                 },
//             ],
//         },
//         "aiSuggestion"
//     );
// },
// Object for cloning HTML elements in the Quick add
layoutWidgetHTML:{row_4_block:"<div class=\"draggable-row-section sortable-item removeable panel sys-widget sys-bd-off sys-box-shadow-off\" data-guid=\"\"><div class=\"panel-body sys-bg-white text-center sys-pd-10\"><div class=\"row sys-tbl\" data-row=\"0\"><div data-section=\"0\" class=\"text-left col-xs-6 sys-bd-light-gray-right sys-pd-15 data-section\"><div><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div></div><div data-section=\"1\" class=\"text-right col-xs-6 sys-pd-15 data-section\"><div><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div></div></div><hr class=\"sys-hr-light-gray sys-mg-off\"><div class=\"row sys-tbl\" data-row=\"1\"><div data-section=\"0\" class=\"text-left col-xs-6 sys-bd-light-gray-right sys-pd-15 data-section\"><div><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div></div><div data-section=\"1\" class=\"text-right col-xs-6 sys-pd-15 data-section\"><div><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div></div></div></div></div>",row_1_col:"<div class=\"draggable-row-section sortable-item removeable panel sys-widget sys-bd-off sys-box-shadow-off\" data-guid=\"\"><div class=\"panel-body sys-bg-white text-center sys-pd-10\"><div class=\"row sys-tbl\" data-row=\"0\"><div data-section=\"0\" class=\"text-left col-xs-12 sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div></div></div></div>",row_2_col:"<div class=\"draggable-row-section sortable-item removeable panel sys-widget sys-bd-off sys-box-shadow-off\" data-guid=\"\"><div class=\"panel-body sys-bg-white text-center sys-pd-10\"><div class=\"row sys-tbl\" data-row=\"0\"><div data-section=\"0\" class=\"text-left col-xs-6 sys-bd-light-gray-right sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div><div data-section=\"1\" class=\"text-right col-xs-6 sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div></div></div></div>",row_3_col:"<div class=\"draggable-row-section sortable-item removeable panel sys-widget sys-bd-off sys-box-shadow-off\" data-guid=\"\"><div class=\"panel-body sys-bg-white text-center sys-pd-10\"><div class=\"row sys-tbl\" data-row=\"0\"><div data-section=\"0\" class=\"text-left col-xs-4 sys-bd-light-gray-right sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div><div data-section=\"1\" class=\"text-center col-xs-4 sys-bd-light-gray-right sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div><div data-section=\"2\" class=\"text-right col-xs-4 sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div></div></div></div>",row_4_col:"<div class=\"draggable-row-section sortable-item removeable panel sys-widget sys-bd-off sys-box-shadow-off\" data-guid=\"\"><div class=\"panel-body sys-bg-white text-center sys-pd-10\"><div class=\"row sys-tbl\" data-row=\"0\"><div data-section=\"0\" class=\"text-left col-xs-3 sys-bd-light-gray-right sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div><div data-section=\"1\" class=\"text-left col-xs-3 sys-bd-light-gray-right sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div><div data-section=\"2\" class=\"text-center col-xs-3 sys-bd-light-gray-right sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div><div data-section=\"3\" class=\"text-right col-xs-3 sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div></div></div></div>",row_6_block:"<div class=\"draggable-row-section sortable-item removeable panel sys-widget sys-bd-off sys-box-shadow-off\" data-guid=\"\"><div class=\"panel-body sys-bg-white text-center sys-pd-10\"><div class=\"row sys-tbl\" data-row=\"0\"><div data-section=\"0\" class=\"text-left col-xs-4 sys-bd-light-gray-right sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div><div data-section=\"1\" class=\"text-left col-xs-4 sys-bd-light-gray-right sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div><div data-section=\"2\" class=\"text-right col-xs-4 sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div></div><hr class=\"sys-hr-light-gray sys-mg-off\"><div class=\"row sys-tbl\" data-row=\"1\"><div data-section=\"0\" class=\"text-left col-xs-4 sys-bd-light-gray-right sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div><div data-section=\"1\" class=\"text-left col-xs-4 sys-bd-light-gray-right sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div><div data-section=\"2\" class=\"text-right col-xs-4 sys-pd-15 data-section\"><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></div></div></div></div>",row_list_view:"<div class=\"draggable-row-section sortable-item removeable panel card-widget sys-widget sys-bd-off sys-box-shadow-off\" data-guid=\"\"><div class=\"panel-body sys-bg-white text-center sys-pd-10\"><div class=\"row sys-tbl\" data-row=\"0\"><div data-section=\"0\" class=\"text-left col-xs-12 sys-pd-15 data-section\"><table class=\"table sys-mg-off-b\"><tbody><tr class=\"sys-fg-primary\"><td><a href=\"#\" class=\"pull-left text-center add-data-section\"><i class=\"material-icons\">note_add</i></a></td></tr></tbody></table></div></div></div></div>",row_carousel:"<div class=\"draggable-row-section sortable-item removeable panel card-widget sys-widget sys-carousel sys-box-shadow-off\" data-guid=\"\"><div class=\"panel-body sys-pd-off\"><div class=\"carousel slide\" id=\"a38cbe58-bd7a-43f9-8116-13838dc7d6b5\" data-ride=\"carousel\"><div class=\"carousel-inner\"><div class=\"item  active \"><div class=\"panel-body sys-bg-white text-left\"><div class=\"row \" data-row=\"0\"><div class=\"col-xs-12 data-section\" data-section=\"0\"><div class=\"panel sys-widget sys-box-shadow-off sys-mg-off  add-data-widget\"><div class=\"panel-body text-center sys-fg-primary\"><a class=\"pull-left text-center add-data-section\" href=\"#\"><i class=\"material-icons\">note_add</i></a></div></div></div></div></div></div></div></div><hr class=\"sys-mg-off\"><div class=\"panel-body sys-pd-off\"><div class=\"row\"><a class=\"col-xs-6 pull-left sys-bg-very-light-gray sys-fg-textcolor sys-pd-t-10 sys-pd-b-10 text-center\" href=\"#a38cbe58-bd7a-43f9-8116-13838dc7d6b5\" data-slide=\"prev\"><small><i class=\"fa fa-angle-left\"></i> PREVIOUS</small></a><a class=\"col-xs-6 pull-left sys-bg-very-light-gray sys-fg-textcolor sys-pd-t-10 sys-pd-b-10 text-center\" href=\"#a38cbe58-bd7a-43f9-8116-13838dc7d6b5\" data-slide=\"next\"><small>NEXT <i class=\"fa fa-angle-right\"></i></small></a></div></div></div></div></div>",row_link_list:"<div class=\"draggable-row-section sortable-item removeable panel card-widget sys-widget sys-box-shadow-off\" data-guid=\"\"><div class=\"panel-body sys-bg-white sys-pd-off\"><div class=\"list-group\"><a class=\"list-group-item data-section add-data-section text-center\" data-row=\"0\" data-section=\"0\" href=\"#\"><i class=\"material-icons text-primary\">note_add</i><i class=\"pull-right fa fa-angle-right\"></i></a></div></div></div>",row_tab_widget:"<div class=\"panel sys-widget sys-box-shadow-off\"><div class=\"panel-body sys-pd-off\"><ul class=\"nav nav-tabs nav-justified sys-bg-white card-tabs sys-fg-primary\" role=\"tablist\"><li class=\"nav-item active\"><a class=\"nav-link active\" data-toggle=\"tab\" href=\"#firstTab\" aria-expanded=\"true\">Details</a></li><li class=\"nav-item \"><a class=\"nav-link \" data-toggle=\"tab\" href=\"#secondTab\" aria-expanded=\"false\">History</a></li><li class=\"nav-item \"><a class=\"nav-link \" data-toggle=\"tab\" href=\"#thirdTab\" aria-expanded=\"false\">Another Tab</a></li></ul><div class=\"tab-content\"><div id=\"firstTab\" class=\"tab-pane fade sys-pd-t-5 active in\" role=\"tabpanel\"><div class=\"row\"><div class=\"col-sm-12 col-xs-12 column-parent\"><div class=\"panel sys-bd-off sys-box-shadow-off\"><div class=\"panel-body main-column\" id=\"main_column_0\" data-column=\"0\"><a class=\"add-row-section btn btn-block btn-default btn-lg\" href=\"#\" data-row-button=\"0\"><h4 class=\"text-primary sys-mg-t-5 sys-mg-b-5\"><i class=\"material-icons text-primary\">add_to_photos</i> Add layout section</h4></a><div class=\"tab-sortable-list mt-10\" data-role=\"sortable\"></div></div></div></div></div></div><div id=\"secondTab\" class=\"tab-pane fade sys-pd-t-5 active\" role=\"tabpanel\"><div class=\"row\"><div class=\"col-sm-12 col-xs-12 column-parent\"><div class=\"panel sys-bd-off sys-box-shadow-off\"><div class=\"panel-body main-column\" id=\"main_column_0\" data-column=\"0\"><a class=\"add-row-section btn btn-block btn-default btn-lg\" href=\"#\" data-row-button=\"0\"><h4 class=\"text-primary sys-mg-t-5 sys-mg-b-5\"><i class=\"material-icons text-primary\">add_to_photos</i> Add layout section</h4></a><div class=\"tab-sortable-list mt-10\" data-role=\"sortable\"></div></div></div></div></div></div><div id=\"thirdTab\" class=\"tab-pane fade sys-pd-t-5 active\" role=\"tabpanel\"><div class=\"row\"><div class=\"col-sm-12 col-xs-12 column-parent\"><div class=\"panel sys-bd-off sys-box-shadow-off\"><div class=\"panel-body main-column\" id=\"main_column_0\" data-column=\"0\"><a class=\"add-row-section btn btn-block btn-default btn-lg\" href=\"#\" data-row-button=\"0\"><h4 class=\"text-primary sys-mg-t-5 sys-mg-b-5\"><i class=\"material-icons text-primary\">add_to_photos</i> Add layout section</h4></a><div class=\"tab-sortable-list mt-10\" data-role=\"sortable\"></div></div></div></div></div></div></div></div></div>"}};// ES2015, ES6 etc. Polyfills (these can be removed when browser support for latest JS versions is wide enough, or if and when something like Babel JS is implemented
// textWidth jQuery function
e.includes||(e.includes=function(e,t){'use strict';return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function value(e,d){function sameValueZero(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}// 7. Repeat, while k < len
// 1. Let O be ? ToObject(this value).
if(null==this)throw new TypeError("\"this\" is null or not defined");var s=Object(this),o=s.length>>>0;// 2. Let len be ? ToLength(? Get(O, "length")).
// 3. If len is 0, return false.
if(0===o)return!1;// 4. Let n be ? ToInteger(fromIndex).
//    (If fromIndex is undefined, this step produces the value 0.)
for(var l=0|d,n=a(0<=l?l:o-t(l),0)// 5. If n â‰¥ 0, then
//  a. Let k be n.
// 6. Else n < 0,
//  a. Let k be len + n.
//  b. If k < 0, let k be 0.
;n<o;){// a. Let elementK be the result of ? Get(O, ! ToString(k)).
// b. If SameValueZero(searchElement, elementK) is true, return true.
// c. Increase k by 1.
if(sameValueZero(s[n],e))return!0;n++}// 8. Return false
return!1}}),$.fn.textWidth=function(e,t){$.fn.textWidth.fakeEl||($.fn.textWidth.fakeEl=$("<span>").hide().appendTo(document.body));var a=e||this.val()||this.text();return a=$.fn.textWidth.fakeEl.text(a).html(),a=a.replace(/\s/g,"&nbsp;"),$.fn.textWidth.fakeEl.html(a).css("font",t||this.css("font")),$.fn.textWidth.fakeEl.width()},window.SYSPRO_VB=v}();